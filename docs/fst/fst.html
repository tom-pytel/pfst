<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>fst.fst API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../fst.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;fst</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#parse">parse</a>
            </li>
            <li>
                    <a class="function" href="#unparse">unparse</a>
            </li>
            <li>
                    <a class="function" href="#dump">dump</a>
            </li>
            <li>
                    <a class="class" href="#FST">FST</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FST.__init__">FST</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.a">a</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.parent">parent</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.pfield">pfield</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.root">root</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.parse_params">parse_params</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.indent">indent</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.lines">lines</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.src">src</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_root">is_root</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.has_own_loc">has_own_loc</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.whole_loc">whole_loc</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.loc">loc</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.bloc">bloc</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.ln">ln</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.col">col</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.end_ln">end_ln</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.end_col">end_col</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.bln">bln</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.bcol">bcol</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.bend_ln">bend_ln</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.bend_col">bend_col</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.lineno">lineno</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.col_offset">col_offset</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.end_lineno">end_lineno</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.end_col_offset">end_col_offset</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_mod">is_mod</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_stmtish">is_stmtish</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_stmt">is_stmt</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_block">is_block</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_scope">is_scope</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_named_scope">is_named_scope</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_anon_scope">is_anon_scope</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_slice">is_slice</a>
                        </li>
                        <li>
                                <a class="variable" href="#FST.is_augop">is_augop</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.new">new</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.fromsrc">fromsrc</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.fromast">fromast</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.get_options">get_options</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.get_option">get_option</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.set_options">set_options</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.options">options</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.dump">dump</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.verify">verify</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.mark">mark</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.reconcile">reconcile</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.cut">cut</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.replace">replace</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.remove">remove</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.get">get</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.put">put</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.get_slice">get_slice</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.put_slice">put_slice</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.get_src">get_src</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.put_src">put_src</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.pars">pars</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.par">par</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.unpar">unpar</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.next">next</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.prev">prev</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.first_child">first_child</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.last_child">last_child</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.last_header_child">last_header_child</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.next_child">next_child</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.prev_child">prev_child</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.step_fwd">step_fwd</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.step_back">step_back</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.walk">walk</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.parents">parents</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.parent_stmt">parent_stmt</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.parent_stmtish">parent_stmtish</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.parent_block">parent_block</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.parent_scope">parent_scope</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.parent_named_scope">parent_named_scope</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.parent_non_expr">parent_non_expr</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.parent_pattern">parent_pattern</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.child_path">child_path</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.child_from_path">child_from_path</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.repath">repath</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.find_loc">find_loc</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.find_in_loc">find_in_loc</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.get_indent">get_indent</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_parsable">is_parsable</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_parenthesizable">is_parenthesizable</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_atom">is_atom</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_enclosed">is_enclosed</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_enclosed_in_parents">is_enclosed_in_parents</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_parenthesized_tuple">is_parenthesized_tuple</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_enclosed_matchseq">is_enclosed_matchseq</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_empty_set_call">is_empty_set_call</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_empty_set_seq">is_empty_set_seq</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_elif">is_elif</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_solo_class_base">is_solo_class_base</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_solo_call_arg">is_solo_call_arg</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_solo_call_arg_genexp">is_solo_call_arg_genexp</a>
                        </li>
                        <li>
                                <a class="function" href="#FST.is_solo_matchcls_pat">is_solo_matchcls_pat</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../fst.html">fst</a><wbr>.fst    </h1>

                        <div class="docstring"><p>Main FST module. Contains the <code><a href="#FST">FST</a></code> class as well as drop-in replacement <code><a href="#parse">parse()</a></code> and <code><a href="#unparse">unparse()</a></code> functions for
their respective <code>ast</code> module counterparts.</p>
</div>

                        <input id="mod-fst-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-fst-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;Main FST module. Contains the `FST` class as well as drop-in replacement `parse()` and `unparse()` functions for</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">their respective `ast` module counterparts.&quot;&quot;&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">builtins</span>  <span class="c1"># because of the unfortunate choice for the name of an Interpolation field, &#39;.str&#39;, we have a &#39;.str&#39; property in FST which messes with the type annotations</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">ast</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">ast</span><span class="w"> </span><span class="kn">import</span> <span class="n">dump</span> <span class="k">as</span> <span class="n">ast_dump</span><span class="p">,</span> <span class="n">unparse</span> <span class="k">as</span> <span class="n">ast_unparse</span><span class="p">,</span> <span class="n">mod</span> <span class="k">as</span> <span class="n">ast_mod</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">contextmanager</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">TextIOBase</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">,</span> <span class="n">Union</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.astutil</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.astutil</span><span class="w"> </span><span class="kn">import</span> <span class="n">FIELDS</span><span class="p">,</span> <span class="n">OPCLS2STR</span><span class="p">,</span> <span class="n">OPSTR2CLS_AUG</span><span class="p">,</span> <span class="n">TypeAlias</span><span class="p">,</span> <span class="n">TryStar</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">,</span> <span class="n">type_param</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.misc</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>    <span class="n">NodeError</span><span class="p">,</span> <span class="n">astfield</span><span class="p">,</span> <span class="n">fstloc</span><span class="p">,</span> <span class="n">fstlocns</span><span class="p">,</span> <span class="n">nspace</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>    <span class="n">EXPRISH_ALL</span><span class="p">,</span> <span class="n">STMTISH</span><span class="p">,</span> <span class="n">STMTISH_OR_MOD</span><span class="p">,</span> <span class="n">BLOCK</span><span class="p">,</span> <span class="n">BLOCK_OR_MOD</span><span class="p">,</span> <span class="n">SCOPE</span><span class="p">,</span> <span class="n">SCOPE_OR_MOD</span><span class="p">,</span> <span class="n">NAMED_SCOPE</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a>    <span class="n">NAMED_SCOPE_OR_MOD</span><span class="p">,</span> <span class="n">ANONYMOUS_SCOPE</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>    <span class="n">re_empty_line</span><span class="p">,</span> <span class="n">re_line_continuation</span><span class="p">,</span> <span class="n">re_line_end_cont_or_comment</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>    <span class="n">Self</span><span class="p">,</span> <span class="n">Code</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>    <span class="n">_next_pars</span><span class="p">,</span> <span class="n">_prev_pars</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>    <span class="n">_fixup_field_body</span><span class="p">,</span> <span class="n">_multiline_str_continuation_lns</span><span class="p">,</span> <span class="n">_multiline_fstr_continuation_lns</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="p">)</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>    <span class="s1">&#39;parse&#39;</span><span class="p">,</span> <span class="s1">&#39;unparse&#39;</span><span class="p">,</span> <span class="s1">&#39;dump&#39;</span><span class="p">,</span> <span class="s1">&#39;FST&#39;</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="p">]</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="n">_PY_VERSION</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="n">_PYLT13</span>     <span class="o">=</span> <span class="n">_PY_VERSION</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="n">_REPR_SRC_LINES</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># for debugging</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="n">_DEFAULT_PARSE_PARAMS</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="n">_DEFAULT_INDENT</span>       <span class="o">=</span> <span class="s1">&#39;    &#39;</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="n">_OPTIONS</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>    <span class="s1">&#39;pars&#39;</span><span class="p">:</span>      <span class="s1">&#39;auto&#39;</span><span class="p">,</span>  <span class="c1"># True | False | &#39;auto&#39;</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>    <span class="s1">&#39;raw&#39;</span><span class="p">:</span>       <span class="kc">False</span><span class="p">,</span>   <span class="c1"># True | False | &#39;auto&#39;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>    <span class="s1">&#39;elif_&#39;</span><span class="p">:</span>     <span class="kc">True</span><span class="p">,</span>    <span class="c1"># True | False</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>    <span class="s1">&#39;docstr&#39;</span><span class="p">:</span>    <span class="kc">True</span><span class="p">,</span>    <span class="c1"># True | False | &#39;strict&#39;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="s1">&#39;empty_set&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>    <span class="c1"># True | False | &#39;seq&#39; | &#39;call&#39;</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>    <span class="s1">&#39;pep8space&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>    <span class="c1"># True | False | 1</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>    <span class="s1">&#39;precomms&#39;</span><span class="p">:</span>  <span class="kc">True</span><span class="p">,</span>    <span class="c1"># True | False | &#39;all&#39;</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>    <span class="s1">&#39;postcomms&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>    <span class="c1"># True | False | &#39;all&#39; | &#39;block&#39;</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>    <span class="s1">&#39;prespace&#39;</span><span class="p">:</span>  <span class="kc">False</span><span class="p">,</span>   <span class="c1"># True | False | int</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>    <span class="s1">&#39;postspace&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>   <span class="c1"># True | False | int</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="p">}</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_swizzle_getput_params</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>                           <span class="n">default_stop</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>                           <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Allow passing `stop` and `field` positionally.&quot;&quot;&quot;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">start</span> <span class="o">!=</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">default_stop</span><span class="p">,</span> <span class="n">start</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>        <span class="k">return</span> <span class="n">start</span><span class="p">,</span> <span class="n">default_stop</span><span class="p">,</span> <span class="n">stop</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>    <span class="k">return</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="c1"># ----------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Executes `ast.parse()` and then adds `FST` nodes to the parsed tree. Drop-in replacement for `ast.parse()`. For</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">    parameters, see `ast.parse()`. Returned `AST` tree has added `.f` attribute at each node which accesses the parallel</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">    `FST` tree.</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    **Parameters:**</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">    - `source`: The python source to parse.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    - `filename`: `ast.parse()` parameter.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">    - `mode`: Parse mode, extended `ast.parse()` parameter, See `fst.misc.Mode`.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">    - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">    - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">    **Returns:**</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">    - `AST`: Tree with an `FST` `.f` attribute added to each `AST` node.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">    **Examples:**</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">    ```py</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">    &gt;&gt;&gt; import ast, fst</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">    &gt;&gt;&gt; a = fst.parse(&#39;if 1:\n  i = 2&#39;)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">    &gt;&gt;&gt; type(a)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">    &lt;class &#39;ast.Module&#39;&gt;</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">    &gt;&gt;&gt; a.f  # FST node</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">    &lt;Module ROOT 0,0..1,7&gt;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">    &gt;&gt;&gt; print(fst.dump(a, indent=2))</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">    Module(</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">      body=[</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">        If(</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">          test=Constant(value=1),</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">          body=[</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">            Assign(</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">              targets=[</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">                Name(id=&#39;i&#39;, ctx=Store())],</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">              value=Constant(value=2))],</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">          orelse=[])],</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">      type_ignores=[])</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="sd">    &gt;&gt;&gt; a.f.dump()</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">    Module - ROOT 0,0..1,7</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">      .body[1]</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">      0] If - 0,0..1,7</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">        .test Constant 1 - 0,3..0,4</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">        .body[1]</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">        0] Assign - 1,2..1,7</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">          .targets[1]</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="sd">          0] Name &#39;i&#39; Store - 1,2..1,3</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">          .value Constant 2 - 1,6..1,7</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">    ```</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>    <span class="k">return</span> <span class="n">FST</span><span class="o">.</span><span class="n">fromsrc</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="k">def</span><span class="w"> </span><span class="nf">unparse</span><span class="p">(</span><span class="n">ast_obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the formatted source that is kept for this tree. Drop-in replacement for `ast.unparse()` If there is no</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">    `FST` information in the `AST` tree then just executes `ast.unparse()`.</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">    **Parameters:**</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">    - `ast_obj`: The `AST` to unparse.</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">    **Returns:**</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">    - `str`: The unparsed source code, formatted if it came from `FST`.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">    **Examples:**</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">    ```py</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">    &gt;&gt;&gt; import ast, fst</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">    &gt;&gt;&gt; a = fst.parse(&#39;&#39;&#39;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">    ... if 1: i = 1  # same line</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">    ... else:</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">    ...   j=2 # comment</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">    ... &#39;&#39;&#39;.strip())</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">    &gt;&gt;&gt; print(ast.unparse(a))</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">    if 1:</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">        i = 1</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">    else:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">        j = 2</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">    &gt;&gt;&gt; print(fst.unparse(a))</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="sd">    if 1: i = 1  # same line</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">    else:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">      j=2 # comment</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">    &gt;&gt;&gt; a = ast.parse(&#39;i = 1&#39;)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">    &gt;&gt;&gt; ast.unparse(a)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">    &#39;i = 1&#39;</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">    &gt;&gt;&gt; fst.unparse(a)  # also unparses regular AST</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">    &#39;i = 1&#39;</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">    ```</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast_obj</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">FST</span><span class="p">):</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>            <span class="k">pass</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>    <span class="k">return</span> <span class="n">ast_unparse</span><span class="p">(</span><span class="n">ast_obj</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="k">def</span><span class="w"> </span><span class="nf">dump</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">annotate_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_attributes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;This function is a convenience function and only exists to make python version 3.13 and above `ast.dump()` output</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="sd">    compatible on a default call with previous python versions (important for doctests). All arguments correspond to</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">    their respective `ast.dump()` arguments and `show_empty` is eaten on python versions below 3.13.&quot;&quot;&quot;</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>    <span class="k">if</span> <span class="n">_PYLT13</span><span class="p">:</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>        <span class="k">return</span> <span class="n">ast_dump</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">annotate_fields</span><span class="p">,</span> <span class="n">include_attributes</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>        <span class="k">return</span> <span class="n">ast_dump</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">annotate_fields</span><span class="p">,</span> <span class="n">include_attributes</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="n">show_empty</span><span class="o">=</span><span class="n">show_empty</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="k">class</span><span class="w"> </span><span class="nc">FST</span><span class="p">:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class which maintains structure and formatted source code for an `AST` tree. An instance of this class is added</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">    to each `AST` node in a tree. It provides format-preserving operations as well as ability to navigate the tree in</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a><span class="sd">    any direction.&quot;&quot;&quot;</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>    <span class="n">a</span><span class="p">:</span>            <span class="n">AST</span>              <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The actual `AST` node.&quot;&quot;&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>    <span class="n">parent</span><span class="p">:</span>       <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span>       <span class="p">;</span> <span class="s2">&quot;&quot;&quot;Parent `FST` node, `None` in root node.&quot;&quot;&quot;</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>    <span class="n">pfield</span><span class="p">:</span>       <span class="n">astfield</span> <span class="o">|</span> <span class="kc">None</span>  <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The `astfield` location of this node in the parent, `None` in root node.&quot;&quot;&quot;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>    <span class="n">root</span><span class="p">:</span>         <span class="n">FST</span>              <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The root node of this tree, `self` in root node.&quot;&quot;&quot;</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>    <span class="n">_cache</span><span class="p">:</span>       <span class="nb">dict</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>    <span class="c1"># ROOT ONLY</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>    <span class="n">parse_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>  <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The parameters to use for any `ast.parse()` that needs to be done (filename, type_comments, feature_version), root node only.&quot;&quot;&quot;</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>    <span class="n">indent</span><span class="p">:</span>       <span class="n">builtins</span><span class="o">.</span><span class="n">str</span>             <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The default single level of block indentation string for this tree when not available from context, root node only.&quot;&quot;&quot;</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>    <span class="n">_lines</span><span class="p">:</span>       <span class="nb">list</span><span class="p">[</span><span class="n">bistr</span><span class="p">]</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>    <span class="n">_serial</span><span class="p">:</span>      <span class="nb">int</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>    <span class="c1"># class attributes</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>    <span class="n">is_FST</span><span class="p">:</span>       <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>      <span class="p">;</span> <span class="s2">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>  <span class="c1"># for quick checks vs. `fstloc` or `fstview`</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>    <span class="nd">@property</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whole lines which contain this node, may also contain parts of enclosing nodes. If gotten at root then the</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">        entire source is returned, which may extend beyond the location of the top level node (mostly for statements</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">        which may have leading / trailing comments or empty lines).&quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>        <span class="k">elif</span> <span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="o">.</span><span class="n">ln</span> <span class="p">:</span> <span class="n">loc</span><span class="o">.</span><span class="n">end_ln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>  <span class="c1"># arguments with no loc are empty arguments</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">:=</span> <span class="n">OPCLS2STR</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># for boolop only really, otherwise None</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>    <span class="nd">@property</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">src</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Source code of this node clipped out of as a single string, without any dedentation. Will have indentation as</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">        it appears in the top level source if multiple lines. If gotten at root then the entire source is returned,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">        regardless of whether the actual top level node location includes it or not.&quot;&quot;&quot;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>        <span class="k">elif</span> <span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="o">*</span><span class="n">loc</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>  <span class="c1"># arguments with no loc are empty arguments</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>            <span class="k">return</span> <span class="n">OPCLS2STR</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># for boolop only really, otherwise None</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>    <span class="nd">@property</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;`True` for the root node, `False` otherwise.&quot;&quot;&quot;</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>    <span class="nd">@property</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_own_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;`True` when the node has its own location which comes directly from AST `lineno` and other location fields.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">        Otherwise `False` if no `loc` or `loc` is calculated.&quot;&quot;&quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;end_col_offset&#39;</span><span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>    <span class="nd">@property</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">whole_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span><span class="p">:</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whole source location, from 0,0 to end of source. Works from any node (not just root).&quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>        <span class="k">return</span> <span class="n">fstloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>    <span class="nd">@property</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Zero based character indexed location of node (may not be entire location if node has decorators). Not all</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">        nodes have locations (like `expr_context`). Other nodes which normally don&#39;t have locations like `arguments` or</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">        most operators have this location calculated from their children or source. NOTE: Empty arguments do NOT have</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="sd">        a location even though the `AST` exists.&quot;&quot;&quot;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>            <span class="k">pass</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>            <span class="n">ln</span>             <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>            <span class="n">col_offset</span>     <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">col_offset</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>            <span class="n">end_ln</span>         <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">end_lineno</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>            <span class="n">end_col_offset</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">end_col_offset</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_arguments</span><span class="p">()</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">comprehension</span><span class="p">):</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_comprehension</span><span class="p">()</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">withitem</span><span class="p">):</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_withitem</span><span class="p">()</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">match_case</span><span class="p">):</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_match_case</span><span class="p">()</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">cmpop</span><span class="p">)):</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_operator</span><span class="p">()</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>            <span class="n">col</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">b2c</span><span class="p">(</span><span class="n">col_offset</span><span class="p">)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>            <span class="n">end_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">end_ln</span><span class="p">]</span><span class="o">.</span><span class="n">b2c</span><span class="p">(</span><span class="n">end_col_offset</span><span class="p">)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>            <span class="n">loc</span>     <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>        <span class="k">return</span> <span class="n">loc</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>    <span class="nd">@property</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bloc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Bounding location of node, including any preceding decorators. Not all nodes have locations but any node</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">        which has a `loc` will have a `bloc`. Will be same as `loc` for all nodes except those that have decorators, in</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">        which case it will start at the first decorator.&quot;&quot;&quot;</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;bloc&#39;</span><span class="p">]</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>            <span class="k">pass</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">bloc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">decos</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;decorator_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>            <span class="n">bloc</span> <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="n">decos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">ln</span><span class="p">,</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># column of deco &#39;@&#39; will be same as our column</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;bloc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bloc</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="k">return</span> <span class="n">bloc</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>    <span class="nd">@property</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the first line of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>    <span class="nd">@property</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># char index</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;CHARACTER index of the start of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>    <span class="nd">@property</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_ln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 0 based</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the LAST LINE of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>    <span class="nd">@property</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># char index</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;CHARACTER index one past the end of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>    <span class="nd">@property</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># bounding location including @decorators</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the first line of this node or the first decorator if present (0 based). The corresponding</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">        `bcol`, `bend_ln` and `bend_col` are just aliases for the normal values.&quot;&quot;&quot;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>    <span class="n">bcol</span>     <span class="o">=</span> <span class="n">col</span>  <span class="c1"># for symmetry</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>    <span class="n">bend_ln</span>  <span class="o">=</span> <span class="n">end_ln</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>    <span class="n">bend_col</span> <span class="o">=</span> <span class="n">end_col</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>    <span class="nd">@property</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lineno</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 1 based</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style Line number of the first line of this node (1 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>    <span class="nd">@property</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">col_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># byte index</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style BYTE index of the start of this node (0 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">c2b</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>    <span class="nd">@property</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_lineno</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 1 based</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style Line number of the LAST LINE of this node (1 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>    <span class="nd">@property</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_col_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># byte index</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style BYTE index one past the end of this node (0 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">c2b</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>    <span class="nd">@property</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_mod</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `mod`.&quot;&quot;&quot;</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>    <span class="nd">@property</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_stmtish</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `stmt`, `ExceptHandler` or `match_case`.&quot;&quot;&quot;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">STMTISH</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>    <span class="nd">@property</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `stmt`.&quot;&quot;&quot;</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">stmt</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>    <span class="nd">@property</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a block. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef`, `For`,</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">        `AsyncFor`, `While`, `If`, `With`, `AsyncWith`, `Match`, `Try`, `TryStar`, `ExceptHandler`, `match_case` or</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">        `mod`.&quot;&quot;&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">BLOCK_OR_MOD</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>    <span class="nd">@property</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a scope. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef`, `Lambda`,</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="sd">        `ListComp`, `SetComp`, `DictComp`, `GeneratorExp` or `mod`.&quot;&quot;&quot;</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">SCOPE_OR_MOD</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>    <span class="nd">@property</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_named_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a named scope. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef` or `mod`.&quot;&quot;&quot;</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">NAMED_SCOPE_OR_MOD</span><span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>    <span class="nd">@property</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_anon_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens an anonymous scope. Types include `Lambda`, `ListComp`, `SetComp`, `DictComp` or</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a><span class="sd">        `GeneratorExp`.&quot;&quot;&quot;</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">ANONYMOUS_SCOPE</span><span class="p">)</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>    <span class="nd">@property</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether self is a `Slice` or a `Tuple` which directly contains any `Slice`.</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">        ```py</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;, &#39;expr_slice&#39;).is_slice</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">        True</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, d:e&#39;, &#39;expr_slice&#39;).is_slice  # Tuple contains at least one Slice</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">        True</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">        &gt;&gt;&gt; # b is in the .slice field but is not a Slice or Slice Tuple</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b]&#39;).slice.is_slice</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">        False</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">        ```</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>                                                  <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">elts</span><span class="p">))</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>    <span class="nd">@property</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_augop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an augmented `operator` or not, or not an `operator` at all.</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a><span class="sd">        - `True` if is augmented `operator`, `False` if non-augmented `operator` and `None` if is not `operator` at all.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a><span class="sd">        ```py</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;+&#39;).is_augop</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a><span class="sd">        False</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;+=&#39;).is_augop</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a><span class="sd">        True</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a><span class="sd">        &gt;&gt;&gt; repr(FST(&#39;~&#39;).is_augop)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a><span class="sd">        &#39;None&#39;</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="sd">        ```</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">operator</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">in</span> <span class="n">OPSTR2CLS_AUG</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>    <span class="c1"># Management</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>        <span class="n">tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repr_tail</span><span class="p">()</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>        <span class="n">head</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="n">tail</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_REPR_SRC_LINES</span><span class="p">:</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>            <span class="k">return</span> <span class="n">head</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>            <span class="k">if</span> <span class="n">end_ln</span> <span class="o">-</span> <span class="n">ln</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">_REPR_SRC_LINES</span><span class="p">:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>                <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span> <span class="p">:</span> <span class="n">end_ln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>                <span class="n">ls</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span> <span class="p">:</span> <span class="n">ln</span> <span class="o">+</span> <span class="p">((</span><span class="n">_REPR_SRC_LINES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;...&#39;</span><span class="p">]</span> <span class="o">+</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>                      <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">end_ln</span> <span class="o">-</span> <span class="p">((</span><span class="n">_REPR_SRC_LINES</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="p">:</span> <span class="n">end_ln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>            <span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="n">end_col</span><span class="p">]</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>            <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">col</span> <span class="o">+</span> <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">col</span><span class="p">:]</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">head</span><span class="p">]</span> <span class="o">+</span> <span class="n">ls</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>            <span class="k">pass</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>        <span class="k">return</span> <span class="n">head</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">???&#39;</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>                <span class="n">ast_or_src</span><span class="p">:</span> <span class="n">AST</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>                <span class="n">mode_or_lines_or_parent</span><span class="p">:</span> <span class="n">FST</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mode</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>                <span class="n">pfield</span><span class="p">:</span> <span class="n">astfield</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>                <span class="o">/</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new individual `FST` node or full tree. The main way to use this constructor is as a shortcut for</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a><span class="sd">        `FST.fromsrc()` or `FST.fromast()`, the usage is:</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="sd">        **`FST(ast_or_src, mode=None)`**</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">        This will create an `FST` from either an `AST` or source code in the form of a string or list of lines. The</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a><span class="sd">        first parameter can be `None` instead of an `AST` or source to indicate a blank new module of one of the three</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a><span class="sd">        types `&#39;exec&#39;`, `&#39;eval&#39;` or `&#39;single&#39;`. Otherwise if there is `source` or an `AST` then `mode` specifies how it</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a><span class="sd">        will be parsed / reparsed and it can take any of the values from `fst.misc.Mode`.</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="sd">        - `ast_or_src`: Source code, an `AST` node or `None`.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a><span class="sd">        - `mode`: See `fst.misc.Mode`. If this is `None` then if `ast_or_src` is an `AST` the mode defaults to the</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a><span class="sd">            type of the `AST`. Otherwise if the `ast_or_src` is actual source code then `mode` used is `&#39;all&#39;` to allow</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a><span class="sd">            parsing anything. And if `ast_or_src` is `None` then `mode` must be provided and be one of `&#39;exec&#39;`,</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a><span class="sd">            `&#39;eval&#39;` or `&#39;single&#39;`.</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a><span class="sd">        The other forms of this function are meant for internal use and their parameters are below:</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a><span class="sd">        - `ast_or_src`: `AST` node for `FST` or source code in the form of a `str` or a list of lines. If an `AST` then</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a><span class="sd">            will be processed differently depending on if creating child node, top level node or using this as a</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a><span class="sd">            shortcut for a full `fromsrc()` or `fromast()`.</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="sd">        - `mode_or_lines_or_parent`: Parent node for this child node or lines for a root node creating a new tree. If</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">            `pfield` is `None` and this is a shortcut to create a full tree from an `AST` node or source provided in</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="sd">            `ast_or_src`.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">        - `pfield`: `astfield` indication position in parent of this node. If provided then creating a simple child node</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">            and it is created with the `self.parent` set to `mode_or_lines_or_parent` node and `self.pfield` set to</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">            this. If `None` then it means the creation of a full new `FST` tree and this is the root node with</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="sd">            `mode_or_lines_or_parent` providing the source.</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a><span class="sd">        - `kwargs`: Contextual parameters:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">            - `from_`: If this is provided then it must be an `FST` node from which this node is being created. This</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a><span class="sd">                allows to copy parse parameters and already determined default indentation.</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">            - `parse_params`: A `dict` with values for &#39;filename&#39;, &#39;type_comments&#39; and &#39;feature_version&#39; which will be</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a><span class="sd">                used for any `AST` reparse done on this tree. Only valid when creating a root node.</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">            - `indent`: Indentation string to use as default indentation. If not provided and not gotten from `from_`</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">                then indentation will be inferred from source. Only valid when creating a root node.</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="sd">            - `filename`, `type_comments` and `feature_version`: If creating from an `AST` or source only then these are</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a><span class="sd">                the parameteres passed to the respective `.new()`, `.fromsrc()` or `.fromast()` functions. Only valid</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="sd">                when `mode_or_lines_or_parent` and `pfield` are `None`.</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>        <span class="k">if</span> <span class="n">pfield</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># top level shortcut</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;type_comments&#39;</span><span class="p">,</span> <span class="s1">&#39;feature_version&#39;</span><span class="p">)</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                      <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">k</span><span class="p">}</span>  <span class="c1"># k used as sentinel</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>            <span class="n">indent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>            <span class="k">if</span> <span class="n">from_</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;from_&#39;</span><span class="p">):</span> <span class="c1"># copy parse params from source tree</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">from_</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">parse_params</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">}</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>                <span class="n">indent</span> <span class="o">=</span> <span class="n">from_</span><span class="o">.</span><span class="n">indent</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>            <span class="k">if</span> <span class="n">ast_or_src</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span> <span class="k">if</span> <span class="n">mode_or_lines_or_parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">fromast</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">fromsrc</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span> <span class="k">if</span> <span class="n">mode_or_lines_or_parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>                                <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>            <span class="k">if</span> <span class="n">indent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>            <span class="k">return</span> <span class="n">f</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>        <span class="c1"># creating actual node</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># reuse FST node assigned to AST node (because otherwise it isn&#39;t valid anyway)</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_touch</span><span class="p">()</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">ast_or_src</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span>       <span class="o">=</span> <span class="n">ast_or_src</span>  <span class="c1"># we don&#39;t assume `self.a` is `ast_or_src` if `.f` exists</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span>  <span class="o">=</span> <span class="n">pfield</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>  <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_serial</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>        <span class="k">if</span> <span class="n">pfield</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">mode_or_lines_or_parent</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span>   <span class="o">=</span> <span class="n">mode_or_lines_or_parent</span><span class="o">.</span><span class="n">root</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>        <span class="c1"># ROOT</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span>   <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span> <span class="o">=</span> <span class="p">([</span><span class="n">bistr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">mode_or_lines_or_parent</span><span class="p">]</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lcopy&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">else</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>                       <span class="n">mode_or_lines_or_parent</span><span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>        <span class="k">if</span> <span class="n">from_</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;from_&#39;</span><span class="p">):</span>  <span class="c1"># copy params from source tree</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>            <span class="n">from_root</span>         <span class="o">=</span> <span class="n">from_</span><span class="o">.</span><span class="n">root</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_params&#39;</span><span class="p">,</span> <span class="n">from_root</span><span class="o">.</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">indent</span>       <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">,</span> <span class="n">from_root</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_params&#39;</span><span class="p">,</span> <span class="n">_DEFAULT_PARSE_PARAMS</span><span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">indent</span>       <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;?&#39;</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>                                  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">Module</span><span class="p">)</span> <span class="k">else</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>                                  <span class="n">_DEFAULT_INDENT</span><span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>                                 <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>                                 <span class="n">indent</span><span class="p">)</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_make_fst_tree</span><span class="p">()</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>  <span class="c1"># infer indentation from source, just use first indentation found for performance, don&#39;t try to find most common or anything like that</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ast_or_src</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">AsyncFunctionDef</span><span class="p">,</span> <span class="n">ClassDef</span><span class="p">,</span> <span class="n">With</span><span class="p">,</span> <span class="n">AsyncWith</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>                                  <span class="n">match_case</span><span class="p">)):</span>  <span class="c1"># we check ExceptHandler and match_case because they may be supported as standalone parsed elements eventually</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>                    <span class="n">indent</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">For</span><span class="p">,</span> <span class="n">AsyncFor</span><span class="p">,</span> <span class="n">While</span><span class="p">,</span> <span class="n">If</span><span class="p">)):</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">orelse</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">orelse</span><span class="p">):</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()):</span>  <span class="c1"># because can be &#39;elif&#39;</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>                            <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">Try</span><span class="p">,</span> <span class="n">TryStar</span><span class="p">)):</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">orelse</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">orelse</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">finalbody</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">finalbody</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">finalbody</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>                                <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>                                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">handler</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">!=</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>                                        <span class="k">break</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Match</span><span class="p">):</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>                    <span class="n">indent</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>                    <span class="k">continue</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>                <span class="k">if</span> <span class="n">indent</span> <span class="o">!=</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>                    <span class="k">break</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">_DEFAULT_INDENT</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>            <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new empty `FST` tree with the top level node dictated by the `mode` parameter.</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">        - `mode`: `ast.parse()` parameter, can only be `&#39;exec&#39;`, `&#39;eval&#39;` or `&#39;single&#39;` here.</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a><span class="sd">        - `FST`: The new empty top level `FST` node.</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="sd">        ```py</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="sd">        &gt;&gt;&gt; FST.new()</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        &lt;Module ROOT 0,0..0,0&gt;</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">        &gt;&gt;&gt; FST.new(mode=&#39;single&#39;)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="sd">        &lt;Interactive ROOT 0,0..0,0&gt;</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a><span class="sd">        &gt;&gt;&gt; FST.new(mode=&#39;eval&#39;)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="sd">        &lt;Expression ROOT 0,0..0,4&gt;</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">        &gt;&gt;&gt; _.dump()</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">        Expression - ROOT 0,0..0,4</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">          .body Constant None - 0,0..0,4</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="sd">        &gt;&gt;&gt; _.src</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        &#39;None&#39;</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        ```</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;exec&#39;</span><span class="p">:</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Module</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="p">[],</span> <span class="n">type_ignores</span><span class="o">=</span><span class="p">[])</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;eval&#39;</span><span class="p">:</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lineno</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_lineno</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end_col_offset</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Interactive</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="p">[])</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid mode &#39;</span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&#39; for blank FST&quot;</span><span class="p">)</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">src</span><span class="p">)],</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">,</span> <span class="n">lcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fromsrc</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">],</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">=</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>                <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse and create a new `FST` tree from source, preserving the original source and locations.</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="sd">        - `src`: The source to parse as a single `str` or list of individual line strings (without newlines).</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">        - `mode`: Parse mode, extended `ast.parse()` parameter, See `fst.misc.Mode`.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">        - `FST`: The parsed tree with `.f` attributes added to each `AST` node for `FST` access.</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">        ```py</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;).dump()</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">        Module - ROOT 0,0..0,3</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">          .body[1]</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">          0] Expr - 0,0..0,3</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="sd">            .value Name &#39;var&#39; Load - 0,0..0,3</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;, mode=&#39;stmt&#39;).dump()</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="sd">        Expr - ROOT 0,0..0,3</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="sd">          .value Name &#39;var&#39; Load - 0,0..0,3</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;, mode=&#39;expr&#39;).dump()</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">        Name &#39;var&#39; Load - ROOT 0,0..0,3</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;except Exception: pass&#39;, &#39;stmtish&#39;).dump()</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="sd">        ExceptHandler - ROOT 0,0..0,22</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a><span class="sd">          .type Name &#39;Exception&#39; Load - 0,7..0,16</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="sd">          .body[1]</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a><span class="sd">          0] Pass - 0,18..0,22</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;case f(a=1): pass&#39;, &#39;stmtish&#39;).dump()</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a><span class="sd">        match_case - ROOT 0,0..0,17</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a><span class="sd">          .pattern MatchClass - 0,5..0,11</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="sd">            .cls Name &#39;f&#39; Load - 0,5..0,6</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="sd">            .kwd_attrs[1]</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a><span class="sd">            0] &#39;a&#39;</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a><span class="sd">            .kwd_patterns[1]</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">            0] MatchValue - 0,9..0,10</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">              .value Constant 1 - 0,9..0,10</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">          .body[1]</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">          0] Pass - 0,13..0,17</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;a:b&#39;, Slice).dump()</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">        Slice - ROOT 0,0..0,3</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">          .lower Name &#39;a&#39; Load - 0,0..0,1</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="sd">          .upper Name &#39;b&#39; Load - 0,2..0,3</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="sd">        ```</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">src</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>            <span class="n">src</span>   <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>        <span class="n">ast</span>          <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">parse_params</span><span class="p">)</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fromast</span><span class="p">(</span><span class="n">ast</span><span class="p">:</span> <span class="n">AST</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>                <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Unparse and reparse an `AST` for new `FST` (the reparse is necessary to make sure locations are correct).</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">        - `ast`: The root `AST` node.</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">        - `mode`: Parse mode, extended `ast.parse()` parameter, see `fst.misc.Mode`. Two special values are added:</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a><span class="sd">            - `None`: This will attempt to reparse to the same node type as was passed in. This is the default and all</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">                other values should be considered overrides for special cases.</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">            - `False`: This will skip the reparse and just `ast.unparse()` the `AST` to generate source for the `FST`.</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">                Use this only if you are absolutely certain that the `AST` unparsed source will correspond with the</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="sd">                locations already present in the `AST`. This is almost never the case unless the `AST` was</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a><span class="sd">                `ast.parse()`d from an explicitly `ast.unparse()`d `AST`.</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">        - `ctx`: Whether to make sure that the `ctx` field of the reparsed `AST` matches or not. `False` for</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">            convenience, `True` if you&#39;re feeling pedantic.</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">        - `FST`: The augmented tree with `.f` attributes added to each `AST` node for `FST` access.</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a><span class="sd">        ```py</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">        &gt;&gt;&gt; import ast</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(Assign(targets=[Name(id=&#39;var&#39;)],</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">        ...                    value=Constant(value=123))).dump(&#39;stmt&#39;)</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">        0: var = 123</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a><span class="sd">        Assign - ROOT 0,0..0,9</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">          .targets[1]</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">          0] Name &#39;var&#39; Store - 0,0..0,3</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a><span class="sd">          .value Constant 123 - 0,6..0,9</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(ast.parse(&#39;if 1:\n    j = 5&#39;)).dump(&#39;stmt&#39;)</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="sd">        Module - ROOT 0,0..1,9</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="sd">          .body[1]</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a><span class="sd">        0: if 1:</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a><span class="sd">          0] If - 0,0..1,9</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a><span class="sd">            .test Constant 1 - 0,3..0,4</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a><span class="sd">            .body[1]</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a><span class="sd">        1:     j = 5</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="sd">            0] Assign - 1,4..1,9</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="sd">              .targets[1]</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a><span class="sd">              0] Name &#39;j&#39; Store - 1,4..1,5</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">              .value Constant 5 - 1,8..1,9</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(Slice(lower=Constant(value=1), step=Name(id=&#39;step&#39;))).dump(&#39;all&#39;)</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">        0: 1::step</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">        Slice - ROOT 0,0..0,7</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a><span class="sd">        0: 1</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">          .lower Constant 1 - 0,0..0,1</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">        0:    step</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a><span class="sd">          .step Name &#39;step&#39; Load - 0,3..0,7</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">        ```</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="k">if</span> <span class="n">type_comments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>            <span class="n">type_comments</span> <span class="o">=</span> <span class="n">has_type_comments</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>        <span class="n">src</span>          <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_unparse</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>        <span class="n">lines</span>        <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>            <span class="n">org</span> <span class="o">=</span> <span class="n">ast</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span> <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode</span><span class="p">,</span> <span class="n">parse_params</span><span class="p">)</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>                <span class="n">compare_asts</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">raise_</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>            <span class="k">except</span> <span class="n">WalkFail</span><span class="p">:</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;could not reparse ast identically&#39;</span><span class="p">)</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s1">&#39;    &#39;</span><span class="p">)</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a dictionary of ALL options. These are the same `options` that can be passed to operations and this</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">        function returns their global defaults which are used when those options are not passed to operations or if they</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">        are passed with a value of `None`.</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a><span class="sd">        When these options are missing or `None` in a call to an operation, then the default option as specified here is</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">        used.</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">        **Options:**</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">        - `pars`: How parentheses are handled, can be `False`, `True` or `&#39;auto&#39;`. This is for individual puts, for</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">            slices parentheses are always unchanged. Raw puts generally do not have parentheses added or removed</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">            automatically, except removed from the destination node if putting to a node instead of a pure location.</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">            - `False`: Parentheses are not MODIFIED, doesn&#39;t mean remove all parentheses. Not copied with nodes or</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">                removed on put from source or destination.</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a><span class="sd">            - `True`: Parentheses are copied with nodes, added to copies if needed and not present, removed from</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">                destination on put if not needed there (but not source).</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a><span class="sd">            - `&#39;auto&#39;`: Same as `True` except they are not returned with a copy and possibly removed from source</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a><span class="sd">                on put if not needed (removed from destination first if needed and present on both).</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a><span class="sd">        - `raw`: When to do raw source operations. This may result in more nodes changed than just the targeted one(s).</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a><span class="sd">            - `False`: Do not do raw source operations.</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">            - `True`: Only do raw source operations.</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a><span class="sd">            - `&#39;auto&#39;`: Only do raw source operations if the normal operation fails in a way that raw might not.</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a><span class="sd">        - `elif_`: How to handle lone `If` statements as the only statements in an `If` statement `orelse` field.</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="sd">            - `True`: If putting a single `If` statement to an `orelse` field of a parent `If` statement then</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a><span class="sd">                put it as an `elif`.</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">            - `False`: Always put as a standalone `If` statement.</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="sd">        - `docstr`: Which docstrings are indentable / dedentable.</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a><span class="sd">            - `False`: None.</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">            - `True`: All `Expr` multiline strings (as they serve no coding purpose).</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">            - `&#39;strict&#39;`: Only multiline strings in expected docstring positions (functions and classes).</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">        - `empty_set`: Empty set source during a slice put (considered to have no elements).</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">            - `False`: Nothing is considered an empty set and an empty set slice put is only possible using a non-set</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">                type of empty sequence (tuple or list).</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">            - `True`: `set()` call and `{*()}`, `{*[]}` and `{*{}}` starred sequences are considered empty.</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">            - `&#39;seq&#39;`: Only starred sequences `{*()}`, `{*[]}` and `{*{}}` are considered empty.</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">            - `&#39;call&#39;`: Only `set()` call is considered empty.</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">        - `pep8space`: Preceding and trailing empty lines for function and class definitions.</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">            - `False`: No empty lines.</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">            - `True`: Two empty lines at module scope and one empty line in other scopes.</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">            - `1`: One empty line in all scopes.</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">        - `precomms`: Preceding comments.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">            - `False`: No preceding comments.</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">            - `True`: Single contiguous comment block immediately preceding position.</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">            - `&#39;all&#39;`: Comment blocks (possibly separated by empty lines) preceding position.</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">        - `postcomms`: Trailing comments.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">            - `False`: No trailing comments.</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">            - `True`: Only comment trailing on line of position, nothing past that on its own lines.</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">            - `&#39;block&#39;`: Single contiguous comment block following position.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">            - `&#39;all&#39;`: Comment blocks (possibly separated by empty lines) following position.</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">        - `prespace`: Preceding empty lines (max of this and `pep8space` used).  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">            - `False`: No empty lines.</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">            - `True`: All empty lines.</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="sd">            - `int`: A maximum number of empty lines.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">        - `postspace`: Same as `prespace` except for trailing empty lines.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">        **Note:**</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">        `pars` behavior (see Examples for more):</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">        ```</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="sd">                                                                  False      True    &#39;auto&#39;</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">        Copy pars from source on copy / cut:                         no       yes        no</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">        Add pars needed for parsability to copy:                     no       yes       yes</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">        Remove unneeded pars from destination on put:                no       yes       yes</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">        Remove unneeded pars from source on put:                     no        no       yes</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">        Add pars needed for parse / precedence to source on put:     no       yes       yes</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">        ```</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="sd">        - `{option: value, ...}`: Dictionary of all global default options.</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">        ```py</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">        &gt;&gt;&gt; from pprint import pp</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">        &gt;&gt;&gt; pp(FST.get_options())</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;,</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">         &#39;raw&#39;: False,</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">         &#39;elif_&#39;: True,</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">         &#39;docstr&#39;: True,</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">         &#39;empty_set&#39;: True,</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a><span class="sd">         &#39;pep8space&#39;: True,</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">         &#39;precomms&#39;: True,</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a><span class="sd">         &#39;postcomms&#39;: True,</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a><span class="sd">         &#39;prespace&#39;: False,</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="sd">         &#39;postspace&#39;: False}</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a><span class="sd">        ```</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>        <span class="k">return</span> <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_option</span><span class="p">(</span><span class="n">option</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a single option from `options` dict or global default if option not in dict or is `None` there. For a</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="sd">        list of options used see `get_options()`.</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a><span class="sd">        - `option`: Name of option to get, see `get_options()`.</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a><span class="sd">        - `options`: Dictionary which may or may not contain the requested option.</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a><span class="sd">        - `Any`: The `option` value from the passed `options` dict, if passed and not `None` there, else the global</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="sd">            default value for `option`.</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">        ```py</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;, {&#39;pars&#39;: True})</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">        True</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;, {&#39;pars&#39;: None})</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="sd">        ```</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="k">return</span> <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">:=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">o</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set global defaults for `options` parameters.</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        - `options`: Names / values of parameters to set. These can also be passed to various methods to override the</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">            defaults set here for those individual operations, see `get_options()`.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a><span class="sd">        - `options`: `dict` of previous values of changed parameters, reset with `set_options(**options)`.</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">        ```py</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(pars=False)</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;}</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a><span class="sd">        False</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(**{&#39;pars&#39;: &#39;auto&#39;})</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">        {&#39;pars&#39;: False}</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(pars=True, raw=True, docstr=False)</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;, &#39;raw&#39;: False, &#39;docstr&#39;: True}</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">        ```</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="n">o</span><span class="p">:</span> <span class="n">_OPTIONS</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">options</span><span class="p">}</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>        <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>    <span class="nd">@contextmanager</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">):</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Context manager to temporarily set global options defaults for a group of operations.</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        - `options`: Names / values of options to set temporarily, see `get_options()`.</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">        ```py</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">        &gt;&gt;&gt; print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">        auto</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">        &gt;&gt;&gt; with FST.options(pars=False):</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">        ...     print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">        False</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">        &gt;&gt;&gt; print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">        auto</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">        ```</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>        <span class="n">old_options</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>            <span class="k">yield</span> <span class="n">old_options</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>            <span class="n">FST</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">old_options</span><span class="p">)</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>             <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="n">TextIO</span> <span class="o">=</span> <span class="nb">print</span><span class="p">,</span> <span class="n">eol</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Dump a representation of the tree to stdout or other `TextIO` or return as a `str` or `list` of lines, or</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">        call a provided function once with each line of the output.</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">        - `src`: `&#39;stmt&#39;` means output statement source lines (including `ExceptHandler` and `match_case`), `&#39;all&#39;`</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">            means output source for each individual and node and `None` does not output any source. Can also be a string</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a><span class="sd">            for shortcut specification of source and flags by first letter: `&#39;s&#39;` means `src=&#39;stmt&#39;`, `&#39;a&#39;` means</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">            `src=&#39;all&#39;`, `&#39;f&#39;` means `full=True` and `&#39;e&#39;` means `expand=True`, so `&#39;sfe&#39;` would be a full expanded dump</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">            showing statement source lines.</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a><span class="sd">        - `full`: If `True` then will list all fields in nodes including empty ones, otherwise will exclude most empty</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">            fields.</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="sd">        - `expand`: If `True` then the output is a nice compact representation. If `False` then it is ugly and wasteful.</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="sd">        - `indent`: The average airspeed of an unladen swallow (European).</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">        - `out`: `print` means print to stdout, `list` returns a list of lines and `str` returns a whole string.</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">            `TextIO` will cann the `write` method for each line of output. Otherwise a `Callable[[str], None]` which is</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">            called for each line of output individually.</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="sd">        - `eol`: What to put at the end of each text line, `None` means newline for `TextIO` out and nothing for other.</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="sd">        - `str | list[str]`: If those were requested with `out=str` or `out=list` else `None` and the output is send one</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">            line at a time to `linefunc`, which by default is `print`.</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">        - `None`: Otherwise.</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="sd">        ```py</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;&#39;&#39;</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">        ... if 1:</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">        ...     call(a[i], **b)</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="sd">        ... &#39;&#39;&#39;.strip())</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">        &gt;&gt;&gt; f.dump()</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">        If - ROOT 0,0..1,19</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">          .test Constant 1 - 0,3..0,4</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="sd">          .body[1]</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">          0] Expr - 1,4..1,19</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="sd">            .value Call - 1,4..1,19</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">              .func Name &#39;call&#39; Load - 1,4..1,8</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="sd">              .args[1]</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">              0] Subscript - 1,9..1,13</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a><span class="sd">                .value Name &#39;a&#39; Load - 1,9..1,10</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">                .slice Name &#39;i&#39; Load - 1,11..1,12</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">                .ctx Load</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">              .keywords[1]</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">              0] keyword - 1,15..1,18</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">                .value Name &#39;b&#39; Load - 1,17..1,18</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">        &gt;&gt;&gt; f.dump(src=&#39;all&#39;, indent=4)</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">        0: if 1:</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">        If - ROOT 0,0..1,19</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">        0:    1</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">            .test Constant 1 - 0,3..0,4</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">            .body[1]</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">        1:     call(a[i], **b)</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">            0] Expr - 1,4..1,19</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">                .value Call - 1,4..1,19</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">        1:     call</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a><span class="sd">                    .func Name &#39;call&#39; Load - 1,4..1,8</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="sd">                    .args[1]</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="sd">        1:          a[i]</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">                    0] Subscript - 1,9..1,13</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a><span class="sd">        1:          a</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">                        .value Name &#39;a&#39; Load - 1,9..1,10</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a><span class="sd">        1:            i</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a><span class="sd">                        .slice Name &#39;i&#39; Load - 1,11..1,12</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a><span class="sd">                        .ctx Load</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a><span class="sd">                    .keywords[1]</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="sd">        1:                **b</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="sd">                    0] keyword - 1,15..1,18</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="sd">        1:                  b</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">                        .value Name &#39;b&#39; Load - 1,17..1,18</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">        &gt;&gt;&gt; f.dump(out=str)[:64]</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">        &#39;If - ROOT 0,0..1,19\n  .test Constant 1 - 0,3..0,4\n  .body[1]\n  0&#39;</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">        &gt;&gt;&gt; for l in f.dump(&#39;stmt&#39;, out=list):</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        ...     print(repr(l))</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">        &#39;0: if 1:&#39;</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="sd">        &#39;If - ROOT 0,0..1,19&#39;</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">        &#39;  .test Constant 1 - 0,3..0,4&#39;</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        &#39;  .body[1]&#39;</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a><span class="sd">        &#39;1:     call(a[i], **b)&#39;</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">        &#39;  0] Expr - 1,4..1,19&#39;</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a><span class="sd">        &#39;    .value Call - 1,4..1,19&#39;</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a><span class="sd">        &quot;      .func Name &#39;call&#39; Load - 1,4..1,8&quot;</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a><span class="sd">        &#39;      .args[1]&#39;</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a><span class="sd">        &#39;      0] Subscript - 1,9..1,13&#39;</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a><span class="sd">        &quot;        .value Name &#39;a&#39; Load - 1,9..1,10&quot;</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a><span class="sd">        &quot;        .slice Name &#39;i&#39; Load - 1,11..1,12&quot;</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a><span class="sd">        &#39;        .ctx Load&#39;</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a><span class="sd">        &#39;      .keywords[1]&#39;</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a><span class="sd">        &#39;      0] keyword - 1,15..1,18&#39;</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a><span class="sd">        &quot;        .value Name &#39;b&#39; Load - 1,17..1,18&quot;</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a><span class="sd">        ```</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">src</span> <span class="o">:=</span> <span class="n">src</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>                <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid character(s) in &#39;src&#39; string&quot;</span><span class="p">)</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>                <span class="n">full</span>   <span class="o">=</span> <span class="s1">&#39;f&#39;</span> <span class="ow">in</span> <span class="n">src</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>                <span class="n">expand</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span> <span class="ow">in</span> <span class="n">src</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>                <span class="n">src</span>    <span class="o">=</span> <span class="s1">&#39;all&#39;</span> <span class="k">if</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">src</span> <span class="k">else</span> <span class="s1">&#39;stmt&#39;</span> <span class="k">if</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">src</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">write</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>            <span class="k">if</span> <span class="n">eol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>                <span class="n">eol</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>        <span class="k">elif</span> <span class="n">eol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>            <span class="n">eol</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="n">nspace</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="n">expand</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="n">eol</span><span class="o">=</span><span class="n">eol</span><span class="p">)</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>        <span class="k">if</span> <span class="n">out</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>            <span class="n">lines</span>       <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>            <span class="n">st</span><span class="o">.</span><span class="n">linefunc</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">append</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>            <span class="k">return</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">linefunc</span> <span class="o">=</span> <span class="n">out</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reparse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">locs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>               <span class="n">raise_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Self</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sanity check. Walk the tree and make sure all `AST`s have corresponding `FST` nodes with valid parent / child</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">        links, then (optionally) reparse source and make sure parsed tree matches currently stored tree (locations and</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">        everything). The reparse can only be carried out on root nodes but the link validation can be done on any level.</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">        - `mode`: Parse mode to use, otherwise if `None` then use the top level AST node type for the mode. Depending on</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">            how this is set will determine whether the verification is checking if is parsable by python (`&#39;exec&#39;` for</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">            example), or if the node itself is just in a valid state (where `None` is good). See `fst.misc.Mode`.</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">        - `reparse`: Whether to reparse the source and compare ASTs (including location). Otherwise the check is limited</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">            to a structure check that all children have `FST` nodes which are all liked correctly to their parents.</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a><span class="sd">            `reparse=True` only allowed on root node.</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">        - `locs`: Whether to compare locations after reparse or not.</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a><span class="sd">        - `ctx`: Whether to compare `ctx` nodes after reparse or not.</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a><span class="sd">        - `raise_`: Whether to raise an exception on verify failed or return `None`.</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a><span class="sd">        - `None` on failure to verify (if not `raise_`), otherwise `self`.</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a><span class="sd">        ```py</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;var = 123&#39;).verify()</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a><span class="sd">        &lt;Assign ROOT 0,0..0,9&gt;</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;).verify()</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a><span class="sd">        &lt;Slice ROOT 0,0..0,5&gt;</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a><span class="sd">        &gt;&gt;&gt; bool(FST(&#39;a:b:c&#39;).verify(&#39;exec&#39;, raise_=False))</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a><span class="sd">        False</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a><span class="sd">        ```</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>        <span class="c1"># validate tree links</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>        <span class="n">ast</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>        <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ast</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)]</span>  <span class="c1"># [(AST, parent FST, pfield), ...]</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>            <span class="n">a</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">pfield</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">parent</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">pfield</span> <span class="o">!=</span> <span class="n">pfield</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">raise_</span><span class="p">:</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>                <span class="n">path</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">pfield</span><span class="p">]</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ast</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>                <span class="n">path</span>   <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">af</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">af</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">af</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">for</span> <span class="n">af</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>                <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;, no AST.f node&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span> <span class="k">else</span> <span class="s1">&#39;, bad parent&#39;</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">parent</span> <span class="k">else</span> <span class="s1">&#39;, bad pfield&#39;</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>                <span class="k">raise</span> <span class="n">WalkFail</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;invalid child </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> at </span><span class="si">{</span><span class="n">path</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;self&quot;</span><span class="si">}{</span><span class="n">reason</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>            <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">iter_fields</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">)))</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">child</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">AST</span><span class="p">))</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">reparse</span><span class="p">:</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>        <span class="c1"># reparse</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;verify with reparse can only be called on root node&#39;</span><span class="p">)</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>            <span class="n">astp</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="n">mode</span> <span class="ow">or</span> <span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="n">NodeError</span><span class="p">):</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>            <span class="k">if</span> <span class="n">raise_</span><span class="p">:</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>                <span class="k">raise</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">compare_asts</span><span class="p">(</span><span class="n">astp</span><span class="p">,</span> <span class="n">ast</span><span class="p">,</span> <span class="n">locs</span><span class="o">=</span><span class="n">locs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">parse_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type_comments&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>                            <span class="n">raise_</span><span class="o">=</span><span class="n">raise_</span><span class="p">):</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>    <span class="c1"># Reconcile</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mark</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>  <span class="c1"># placeholder for pydoc, otherwise it puts these at the end of the class</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reconcile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_reconcile</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>        <span class="n">mark</span><span class="p">,</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="n">reconcile</span><span class="p">,</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>    <span class="p">)</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>    <span class="c1"># High level</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy this node to a new top-level tree, dedenting and fixing as necessary.</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="sd">        - `FST`: Copied node.</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">        ```py</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).elts[1].copy().src</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a><span class="sd">        ```</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_get_one</span><span class="p">((</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">copy_ast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">[:],</span> <span class="n">from_</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">lcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cut out this node to a new top-level tree (if possible), dedenting and fixing as necessary. Cannot cut root</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="sd">        node.</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="sd">        - `FST`: Cut node.</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">        ```py</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).elts[1].cut().src</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">        &#39;[0, 2, 3]&#39;</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">        ```</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_get_one</span><span class="p">((</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cannot cut root node&#39;</span><span class="p">)</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># -&gt; replaced Self or None if deleted</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace or delete (if `code=None`, if possible) this node. Returns the new node for `self`, not the old</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a><span class="sd">        replaced node, or `None` if was deleted or raw replaced and the old node disappeared. Cannot delete root node.</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a><span class="sd">        CAN replace root node, in which case the accessing `FST` node remains the same but the top-level `AST` and</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a><span class="sd">        source change.</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">        - `code`: `FST`, `AST` or source `str` or `list[str]` to put at this location. `None` to delete this node.</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a><span class="sd">            - `to`: Special option which only applies replacing in `raw` mode (either through `True` or `&#39;auto&#39;`).</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a><span class="sd">                Instead of replacing just this node, will replace the entire span from this node to the node specified</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a><span class="sd">                in `to` with the `code` passed.</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a><span class="sd">        - `FST | None`: Returns the new node if successfully replaced or `None` if deleted.</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a><span class="sd">        ```py</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).elts[1].replace(&#39;4&#39;).root.src</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;def f(a, /, b, *c, **d) -&gt; int: pass&#39;)</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a><span class="sd">        &gt;&gt;&gt; f.args.posonlyargs[0].replace(&#39;)&#39;, to=f.returns, raw=True)  # raw reparse</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a><span class="sd">        &#39;def f(): pass&#39;</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a><span class="sd">        ```</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="p">(</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cannot delete root node&#39;</span><span class="p">)</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">):</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot replace root node using a &#39;to&#39; parameter&quot;</span><span class="p">)</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>        <span class="n">code</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_code_as_all</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_ast</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete this node if possible, equivalent to `replace(None, ...)`. Cannot delete root node.</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">        ```py</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).elts[1].remove(); f.src</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">        &#39;[0, 2, 3]&#39;</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a><span class="sd">        ```</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">(</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot delete root node&#39;</span><span class="p">)</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>            <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="n">constant</span><span class="p">:</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copy or cut an individual child node or a slice of child nodes from `self` if possible. This function can do</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a><span class="sd">        everything that `get_slice()` can.</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a><span class="sd">        - `idx`: The index of the child node to get if the field being gotten from contains multiple elements or the</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a><span class="sd">            start of the slice to get if getting a slice (by specifying `stop`). If the field being gotten from is</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a><span class="sd">            an individual element then this should be `None`. If `stop` is specified and getting a slice then a `None`</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a><span class="sd">            here means copy from the start of the list.</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a><span class="sd">        - `stop`: The end index (exclusive) of the child node to get if getting a slice from a field that contains</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a><span class="sd">            multiple elements. This should be one past the last element to get (like python list indexing). If this is</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a><span class="sd">            `False` then it indicates that a single element is being requested and not a slice. If this is `None` then</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a><span class="sd">            it indicates a slice operation to the end of the list (like python `a[start:]`).</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a><span class="sd">        - `field`: The name of the field to get the element(s) from, which can be an individual element like a `value`</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a><span class="sd">            or a list like `body`. If this is `None` then the default field for the node type is used. Most node types</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a><span class="sd">            have a common-sense default field, e.g. `body` for all block statements, `value` for things like `Return`</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a><span class="sd">            and `Yield`. `Dict`, `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a><span class="sd">        - `cut`: Whether to cut out the child node (if possible) or not (just copy).</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `idx` or `stop` parameter. If passed in</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a><span class="sd">        `idx` then the field is assumed individual and if passed in `stop` then it is a list and an individual element</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a><span class="sd">        is being gotten from `idx` and not a slice.</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a><span class="sd">        - `FST`: When getting an actual node (most situations).</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a><span class="sd">        - `str`: When getting am identifier, like from `Name.id`.</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a><span class="sd">        - `constant`: When getting a constant (`fst.astutil.constant`), like from `MatchSingleton.value`.</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a><span class="sd">        ```py</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(1).src</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get(1, 3).src</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get(1, 3, cut=True).src</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a><span class="sd">        &#39;[0, 3]&#39;</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(None, 3).src</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a><span class="sd">        &#39;[0, 1, 2]&#39;</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(-3, None).src</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">        &#39;[1, 2, 3]&#39;</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2&#39;).get(0).src</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">        &#39;i = 1&#39;</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2&#39;).get(&#39;orelse&#39;).src</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a><span class="sd">        &#39;j = 2&#39;</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2; k = 3&#39;).get(1, &#39;orelse&#39;).src</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a><span class="sd">        &#39;k = 3&#39;</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2; k = 3; l = 4; m = 5&#39;).get(1, 3, &#39;orelse&#39;).src</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a><span class="sd">        &#39;k = 3; l = 4&#39;</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;return 1&#39;).get().src  # default field is &#39;value&#39;</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get().src  # &#39;elts&#39; slice copy is made</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a><span class="sd">        ```</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>        <span class="n">ast</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>        <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>     <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot get() non-slice from index &#39;end&#39;&quot;</span><span class="p">)</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>        <span class="k">elif</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">field_</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1"> does not take an index&#39;</span><span class="p">)</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_one</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="n">constant</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>            <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a>            <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put an individual node or a slice of nodes to `self` if possible. This function can do everything that</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">        `put_slice()` can. The node is passed as an existing top-level `FST`, `AST`, string or list of string lines. If</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">        passed as an `FST` then it should be considered &quot;consumed&quot; after this function returns and is no logner valid,</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">        even on failure. `AST` is copied.</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a><span class="sd">        **WARNING!** The original `self` node may be invalidated during the operation if using raw mode (either</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a><span class="sd">        specifically or as a fallback), so make sure to swap it out for the return value of this function if you will</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="sd">        keep using the variable you called this method on. It will be changed accordingly in the tree but any other</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a><span class="sd">        outside references to the node may become invalid.</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="sd">        - `code`: The node to put as an `FST` (must be root node), `AST`, a string or list of line strings. If putting</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a><span class="sd">            to an identifier field then this should be a string and it will be taken literally (no parsing). If putting</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">            to a constant likew `MatchSingleton.value` or `Constant.value` then this should be an appropriate primitive</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">            constant value.</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">        - `idx`: The index of the field node to put to if the field being put to contains multiple elements or the start</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">            of the slice to put if putting a slice (by specifying `stop`). If the field being put to is an individual</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">            element then this should be `None`. If `stop` is specified and putting a slice then a `None` here means put</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">            starting from the beginning of the list.</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">        - `stop`: The end index (exclusive) of the field node to put to if putting a slice to a field that contains</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="sd">            multiple elements. This should be one past the last element to put (like python list indexing). If this is</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a><span class="sd">            `False` then it indicates that a single element is being put and not a slice. If this is `None` then it</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a><span class="sd">            indicates a slice operation to the end of the list (like python `a[start:]`).</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a><span class="sd">        - `field`: The name of the field to put the element(s) to, which can be an individual element like a `value` or</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a><span class="sd">            a list like `body`. If this is `None` then the default field for the node type is used. Most node types have</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a><span class="sd">            a common-sense default field, e.g. `body` for all block statements, `value` for things like `Return` and</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="sd">            `Yield`. `Dict`, `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a><span class="sd">        - `one`: Only has meaning if putting a slice, and in this case `True` specifies that the source should be  put</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a><span class="sd">            as a single element to the range specified even if it is a valid slice. `False` indicates a true slice</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a><span class="sd">            operation replacing the range with the slice passed, which must in this case be a compatible slice type.</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">            - `to`: Special option which only applies when putting a single element in `raw` mode (either through `True`</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a><span class="sd">                or `&#39;auto&#39;`). Instead of replacing just the target node, will replace the entire span from the target</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">                node to the node specified in `to` with the `code` passed.</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `idx` or `stop` parameter. If passed in</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a><span class="sd">        `idx` then the field is assumed individual and if passed in `stop` then it is a list and an individual element</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a><span class="sd">        is being gotten from `idx` and not a slice.</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="sd">        - `self`</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a><span class="sd">        ```py</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4&#39;, 1).src</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3).src</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a><span class="sd">        &#39;[0, (4, 5), 3]&#39;</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3, one=False).src</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a><span class="sd">        &#39;[0, 4, 5, 3]&#39;</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, None, 3).src</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a><span class="sd">        &#39;[(4, 5), 3]&#39;</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).put(&#39;4, 5&#39;, -3, None, one=False).src</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="sd">        &#39;[0, 4, 5]&#39;</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0).src)</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a><span class="sd">        if 1:</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a><span class="sd">            z = -1</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a><span class="sd">        else: j = 2</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0, &#39;orelse&#39;).src.rstrip())</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a><span class="sd">        else:</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a><span class="sd">            z = -1</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;)</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a><span class="sd">        ...       .put(&#39;z = -1\ny = -2\nx = -3&#39;, &#39;orelse&#39;, one=False).src.rstrip())</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a><span class="sd">        else:</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a><span class="sd">            z = -1</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a><span class="sd">            y = -2</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a><span class="sd">            x = -3</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a><span class="sd">        &gt;&gt;&gt; print((f := FST(&#39;if 1: i = 1\nelse: j = 2&#39;))</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a><span class="sd">        ...       .put(&#39;z = -1&#39;, 0, raw=True, to=f.orelse[0]).root.src)</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a><span class="sd">        if 1: z = -1</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a><span class="sd">        ```</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>        <span class="n">ast</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>        <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>     <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot put() non-slice to index &#39;end&#39;&quot;</span><span class="p">)</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>        <span class="k">elif</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">field_</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1"> does not take an index&#39;</span><span class="p">)</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">one</span><span class="p">:</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot use &#39;one=False&#39; in non-slice put()&quot;</span><span class="p">)</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">repath</span><span class="p">()</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>                  <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copy or cut a slice of child nodes from `self` if possible.</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a><span class="sd">        - `start`: The start of the slice to get, or `None` for the beginning of the entire range.</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a><span class="sd">        - `stop`: The end index (exclusive) of the slice to get. This should be one past the last element to get (like</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a><span class="sd">            python list indexing). If this is `None` then it indicates a slice operation to the end of the list (like</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a><span class="sd">            python `a[start:]`).</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a><span class="sd">        - `field`: The name of the field to get the elements from, which can be an individual element like a `value` or</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a><span class="sd">            a list like `body`. If this is `None` then the default field for the node type is used. Most node types</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a><span class="sd">            have a common-sense default field, e.g. `body` for all block statements, `elts` for things like `List` and</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">            `Tuple`. `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a><span class="sd">        - `cut`: Whether to cut out the slice or not (just copy).</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `start` or `stop` parameter. If passed in</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a><span class="sd">        `start` then the slice is assumed to be the entire range, and if passed in `stop` then the slice goes from</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a><span class="sd">        `start` to the end of the range.</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a><span class="sd">        - `FST`: Slice node of nodes gotten.</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a><span class="sd">        ```py</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get_slice(1).src</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a><span class="sd">        &#39;[1, 2, 3]&#39;</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get_slice(None, -1).src</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a><span class="sd">        &#39;[0, 1, 2]&#39;</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get_slice(1, 3, cut=True).src</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a><span class="sd">        &#39;[0, 3]&#39;</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;if 1: i = 1\nelse: j = 2; k = 3; l = 4; m = 5&#39;)</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a><span class="sd">        &gt;&gt;&gt; s = f.get_slice(1, 3, &#39;orelse&#39;, cut=True)</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a><span class="sd">        else: j = 2; m = 5</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a><span class="sd">        &gt;&gt;&gt; print(s.src)</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a><span class="sd">        k = 3; l = 4</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a><span class="sd">        ```</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>        <span class="n">ast</span>                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>       <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot get slice from non-list field </span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>                  <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put a slice of nodes to `self` if possible.  The node is passed as an existing top-level `FST`, `AST`, string</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a><span class="sd">        or list of string lines. If passed as an `FST` then it should be considered &quot;consumed&quot; after this function</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a><span class="sd">        returns and is no logner valid, even on failure. `AST` is copied.</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a><span class="sd">        **WARNING!** The original `self` node may be invalidated during the operation if using raw mode (either</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a><span class="sd">        specifically or as a fallback), so make sure to swap it out for the return value of this function if you will</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a><span class="sd">        keep using the variable you called this method on. It will be changed accordingly in the tree but any other</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="sd">        outside references to the node may become invalid.</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a><span class="sd">        - `code`: The slice to put as an `FST` (must be root node), `AST`, a string or list of line strings.</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a><span class="sd">        - `start`: The start of the slice to put, or `None` for the beginning of the entire range.</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a><span class="sd">        - `stop`: The end index (exclusive) of the slice. This should be one past the last element to put (like python</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a><span class="sd">            list indexing). If this is `None` then it indicates a slice operation to the end of the list (like python</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a><span class="sd">            `a[start:]`).</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a><span class="sd">        - `field`: The name of the field to put the elements to. If this is `None` then the default field for the node</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a><span class="sd">            type is used. Most node types have a common-sense default field, e.g. `body` for all block statements,</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a><span class="sd">            `elts` for things like `List` and `Tuple`. `MatchMapping` and `Compare` nodes have special-case handling for</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a><span class="sd">            a `None` field.</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `start` or `stop` parameter. If passed in</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a><span class="sd">        `start` then the slice is assumed to be the entire range, and if passed in `stop` then the slice goes from</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="sd">        `start` to the end of the range.</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="sd">        - `self`</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a><span class="sd">        ```py</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4&#39;, 1).src</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3).src</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a><span class="sd">        &#39;[0, (4, 5), 3]&#39;</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3, one=False).src</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a><span class="sd">        &#39;[0, 4, 5, 3]&#39;</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, None, 3).src</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a><span class="sd">        &#39;[(4, 5), 3]&#39;</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).put(&#39;4, 5&#39;, -3, None, one=False).src</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a><span class="sd">        &#39;[0, 4, 5]&#39;</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0).src)</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a><span class="sd">        if 1:</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a><span class="sd">            z = -1</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a><span class="sd">        else: j = 2</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0, &#39;orelse&#39;).src.rstrip())</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a><span class="sd">        else:</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a><span class="sd">            z = -1</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;)</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a><span class="sd">        ...       .put(&#39;z = -1\ny = -2\nx = -3&#39;, &#39;orelse&#39;, one=False).src.rstrip())</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a><span class="sd">        else:</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a><span class="sd">            z = -1</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a><span class="sd">            y = -2</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a><span class="sd">            x = -3</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a><span class="sd">        &gt;&gt;&gt; print((f := FST(&#39;if 1: i = 1\nelse: j = 2&#39;))</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a><span class="sd">        ...       .put(&#39;z = -1&#39;, 0, raw=True, to=f.orelse[0]).root.src)</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a><span class="sd">        if 1: z = -1</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a><span class="sd">        ```</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>        <span class="n">ast</span>                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>       <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot put slice to non-list field </span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_src</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">as_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>                <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]:</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get source at location, without dedenting or any other modification, returned as a string or individual</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a><span class="sd">        lines. The first and last lines are cropped to start `col` and `end_col`.</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a><span class="sd">        Can call on any node in tree to access source for the whole tree.</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a><span class="sd">        - `ln`: Start line of span to get (0 based).</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a><span class="sd">        - `end_ln`: End line of span to get (0 based, inclusive).</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a><span class="sd">        - `end_col`: End column (character, exclusive) on end line.</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a><span class="sd">        - `as_lines`: If `False` then source is returned as a single string with embedded newlines. If `True` then</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a><span class="sd">            source is returned as a list of line strings (without newlines).</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a><span class="sd">        - `str | list[str]`: A single string or a list of lines if `as_lines=True`. If lines then there are no trailing</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a><span class="sd">            newlines in the individual line strings.</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a><span class="sd">        ```py</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 2&#39;).get_src(0, 3, 1, 5)</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a><span class="sd">        &#39;1:\n  i =&#39;</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 2&#39;).get_src(0, 3, 1, 5, as_lines=True)</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a><span class="sd">        [&#39;1:&#39;, &#39;  i =&#39;]</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;if 1:\n  i = 2&#39;)).get_src(*f.body[0].bloc)</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a><span class="sd">        &#39;i = 2&#39;</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a><span class="sd">        ```</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a>        <span class="k">if</span> <span class="n">as_lines</span><span class="p">:</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>            <span class="k">return</span> <span class="p">([</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">end_col</span><span class="p">])]</span>  <span class="c1"># no real reason for bistr, just to be consistent and minor optimization if passed back into put_src()</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>                    <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="k">else</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>                    <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span><span class="p">:])]</span> <span class="o">+</span> <span class="n">ls</span><span class="p">[</span><span class="n">ln</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">end_ln</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">end_ln</span><span class="p">][:</span><span class="n">end_col</span><span class="p">])])</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">end_col</span><span class="p">]</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>                    <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="k">else</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span><span class="p">:]]</span> <span class="o">+</span> <span class="n">ls</span><span class="p">[</span><span class="n">ln</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">end_ln</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">ls</span><span class="p">[</span><span class="n">end_ln</span><span class="p">][:</span><span class="n">end_col</span><span class="p">]]))</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put_src</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>                <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put source and reparse. There are no rules on what is put, it is simply put and parse is attempted. If the</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a><span class="sd">        `code` is passed as an `AST` then it is unparsed to a string and that string is put into the location. If `FST`</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a><span class="sd">        then the exact source of the `FST` is put. If passed as a string or lines then that is put directly.</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a><span class="sd">        The reparse that is triggered is of at least a statement level node or a statement block header, and can be</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a><span class="sd">        multiple statements if the location spans those or even statements outside of the location if the reparse</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a><span class="sd">        affects things like `elif`. `FST` nodes in the region of the put or even outside of it can become invalid. The</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a><span class="sd">        only `FST` node guaranteed not to change is the root node (identity, the `AST` it holds can change).</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a><span class="sd">        When putting source raw by location like this there are no automatic modifications made to the source or</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a><span class="sd">        destination. No parenthesization, prefixes or suffixes or indentation, the source is just put and parsed so you</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a><span class="sd">        are responsible for the correct indentation and precedence.</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a><span class="sd">        After put and successful reparse the location of the put is examined and an appropriate node is returned which</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a><span class="sd">        fits best for a node which may have been added or replaced. It is possible that `None` is returned if no good</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a><span class="sd">        candidate is found (since this can be used to delete or merge nodes).</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a><span class="sd">        Can call on any node in tree to modify source for the whole tree.</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a><span class="sd">        - `code`: The code to put as an `FST` (must be root node), `AST`, a string or list of line strings.</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a><span class="sd">        - `ln`: Start line of span to put (0 based).</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a><span class="sd">        - `end_ln`: End line of span to put (0 based, inclusive).</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a><span class="sd">        - `end_col`: End column (character, exclusive) on end line.</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a><span class="sd">        - `exact`: This specifies how the node check after a successful reparse is done. `True` means allow return of</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a><span class="sd">            node which matches location exactly. Otherwise if `False`, the location must be inside the node but cannot</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a><span class="sd">            be touching BOTH ends of the node. This basically determines whether you can get the exact node of the</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a><span class="sd">            location or its parent. If passed as `None` then the check is even more restricted.</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a><span class="sd">        - `FST | None`: FIRST highest level node contained entirely within replacement source location (there may be</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a><span class="sd">            others following), or `None` if no such candidate and `exact=None`. If no candidate and `exact` is `True`</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a><span class="sd">            or `False` then will attempt to return a node which encloses the location using `find_loc(..., exact)`.</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a><span class="sd">        ```py</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).put_src(&#39;2&#39;, 0, 4, 0, 5).root.src</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a><span class="sd">        &#39;i = 2&#39;</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).put_src(&#39;+= 3&#39;, 0, 2, 0, 5).root.src</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a><span class="sd">        &#39;i += 3&#39;</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{a: b, c: d, e: f}&#39;).put_src(&#39;**&#39;, 0, 7, 0, 10).root.src</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a><span class="sd">        &#39;{a: b, **d, e: f}&#39;</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;i = 1&#39;)</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a><span class="sd">        &gt;&gt;&gt; g = f.targets[0]</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a))</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt;</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a><span class="sd">        &gt;&gt;&gt; f.put_src(&#39;4&#39;, 0, 4, 0, 5).src</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a><span class="sd">        &#39;4&#39;</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a><span class="sd">        &gt;&gt;&gt; print(g.a)</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a><span class="sd">        None</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a><span class="sd">        &gt;&gt;&gt; print(type(f.targets[0].a))</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt;</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;&#39;&#39;</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a><span class="sd">        ... if a:</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a><span class="sd">        ...   i = 2</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a><span class="sd">        ... elif b:</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a><span class="sd">        ...   j = 3</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a><span class="sd">        ... &#39;&#39;&#39;.strip())</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a><span class="sd">        if a:</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a><span class="sd">          i = 2</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a><span class="sd">        elif b:</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a><span class="sd">          j = 3</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a><span class="sd">        &gt;&gt;&gt; f.put_src(&#39;&#39;&#39;</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a><span class="sd">        ... else:</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a><span class="sd">        ...   if b:</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a><span class="sd">        ...     k = 4</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a><span class="sd">        ... &#39;&#39;&#39;.strip(), *f.orelse[0].loc[:2], *f.loc[2:])</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a><span class="sd">        &lt;If 3,2..4,9&gt;</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a><span class="sd">        if a:</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a><span class="sd">          i = 2</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a><span class="sd">        else:</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a><span class="sd">          if b:</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a><span class="sd">            k = 4</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a><span class="sd">        ```</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>        <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_reparse_raw</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">exact</span><span class="p">)</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the location of enclosing GROUPING parentheses if present. Will balance parentheses if `self` is an</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a><span class="sd">        element of a tuple and not return the parentheses of the tuple. Likwise will not normally return the parentheses</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a><span class="sd">        of an enclosing `arguments` parent or class bases list (unless `shared=None`, but that is mostly for internal</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a><span class="sd">        use).</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a><span class="sd">        Only normally works on (and makes sense for) `expr` or `pattern` nodes, otherwise returns `self.bloc` and count</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a><span class="sd">        of 0. Also handles special case of a single generator expression argument to a function sharing parameters with</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a><span class="sd">        the call arguments, in which case a count of -1 and the location of the `GeneratorExp` without its enclosing</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a><span class="sd">        parentheses may be returned, if this is enabled with `shared=False`.</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a><span class="sd">        This function is cached so feel free to call as often as is needed.</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a><span class="sd">        - `shared`: If `True` then will include parentheses of a single call argument generator expression if they are</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a><span class="sd">            shared with the call arguments enclosing parentheses with a count of 0. If `False` then does not return</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a><span class="sd">            these and returns a count of -1, and thus the location is not a full valid `GeneratorExp` location. If</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a><span class="sd">            `None` then returns ANY directly enclosing parentheses, whether they belong to this node or not.</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a><span class="sd">        - `fstloc | None`: Location of enclosing parentheses if present else `self.bloc` (which can be `None`). Negative</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a><span class="sd">            parentheses count (from shared parens solo call arg generator expression) can also be checked in the case of</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a><span class="sd">            `shared=False` via `fst.pars() &gt; fst.bloc`. If only loc is returned, it will be an `fstloc` which will</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a><span class="sd">            still have the count of parentheses in an attribute `.n`.</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a><span class="sd">        ```py</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).pars()</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a><span class="sd">        fstlocns(0, 0, 0, 1, n=0)</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(i)&#39;).pars()</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a><span class="sd">        fstlocns(0, 0, 0, 3, n=1)</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((i))&#39;).pars()</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a><span class="sd">        fstlocns(0, 0, 0, 5, n=2)</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).pars()  # tuple pars are not considered grouping pars</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a><span class="sd">        fstlocns(0, 0, 0, 6, n=0)</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((1, 2))&#39;).pars()</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a><span class="sd">        fstlocns(0, 0, 0, 8, n=1)</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].pars()  # any node, not just root</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a><span class="sd">        fstlocns(0, 5, 0, 6, n=0)</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((a))&#39;).args[0].pars()</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a><span class="sd">        fstlocns(0, 5, 0, 8, n=1)</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in j)&#39;).args[0].pars()</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a><span class="sd">        fstlocns(0, 4, 0, 18, n=0)</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in j)&#39;).args[0].pars(shared=False)  # exclude shared pars</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a><span class="sd">        fstlocns(0, 5, 0, 17, n=-1)</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in j))&#39;).args[0].pars(shared=False)</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a><span class="sd">        fstlocns(0, 5, 0, 19, n=0)</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a><span class="sd">        ```</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;pars_</span><span class="si">{</span><span class="kc">None</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nb">bool</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>            <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a>            <span class="k">pass</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>            <span class="k">return</span> <span class="n">cached</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span> <span class="ow">and</span> <span class="n">shared</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a>        <span class="n">rpars</span> <span class="o">=</span> <span class="n">_next_pars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_bound</span><span class="p">())</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lrpars</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpars</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># no pars on right</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">shared</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_call_arg_genexp</span><span class="p">():</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a>                <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>                <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>        <span class="n">lpars</span> <span class="o">=</span> <span class="n">_prev_pars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_prev_bound</span><span class="p">(),</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">llpars</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lpars</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># no pars on left</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">llpars</span> <span class="o">&lt;=</span> <span class="n">lrpars</span> <span class="ow">and</span> <span class="n">shared</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_solo_call_arg</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_class_base</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_matchcls_pat</span><span class="p">())</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a>        <span class="p">):</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>            <span class="n">llpars</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>        <span class="k">if</span> <span class="n">llpars</span> <span class="o">!=</span> <span class="n">lrpars</span><span class="p">:</span>  <span class="c1"># unbalanced pars so we know we can safely use the lower count</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>            <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="o">*</span><span class="n">lpars</span><span class="p">[</span><span class="n">npars</span> <span class="o">:=</span> <span class="nb">min</span><span class="p">(</span><span class="n">llpars</span><span class="p">,</span> <span class="n">lrpars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="o">*</span><span class="n">rpars</span><span class="p">[</span><span class="n">npars</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="n">npars</span><span class="p">)</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>            <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="o">*</span><span class="n">lpars</span><span class="p">[</span><span class="n">npars</span> <span class="o">:=</span> <span class="n">llpars</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="o">*</span><span class="n">rpars</span><span class="p">[</span><span class="n">npars</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="n">npars</span><span class="p">)</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>        <span class="k">return</span> <span class="n">locn</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">whole</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parenthesize node if it MAY need it. Will not parenthesize atoms which are always enclosed like `List`, or</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a><span class="sd">        nodes which are not `is_parenthesizable()`, unless `force=True`. Will add parentheses to unparenthesized `Tuple`</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a><span class="sd">        and brackets to unbracketed `MatchSequence` adjusting the node location. If dealing with a `Starred` then the</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a><span class="sd">        parentheses are applied to the child.</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a><span class="sd">        **WARNING!** This function doesn&#39;t do any higher level syntactic validation. So if you parenthesize something</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a><span class="sd">        that shouldn&#39;t be parenthesized, and you wind up poking an eye out, that&#39;s on you.</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a><span class="sd">        - `force`: If `True` then will add another layer of parentheses regardless if any already present.</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a><span class="sd">        - `whole`: If at root then parenthesize whole source instead of just node, if `False` then only node.</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a><span class="sd">        - `self`</span>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a><span class="sd">        ```py</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).par().src</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a><span class="sd">        &#39;(a + b)&#39;</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).par().src  # already parenthesized, so nothing done</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a><span class="sd">        &#39;(a + b)&#39;</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).par(force=True).src  # force it</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a><span class="sd">        &#39;((a + b))&#39;</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;).par().src  # parenthesize tuple</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).par().src  # an atom doesn&#39;t need parentheses</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).par(force=True).src  # so must be forced</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a><span class="sd">        &#39;(i)&#39;</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a><span class="sd">        &gt;&gt;&gt; # parethesize MatchSequence puts brackets like ast.unparse()</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;, &#39;pattern&#39;).par().src</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;*a or b&#39;).par().src  # par() a Starred parenthesizes its child</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a><span class="sd">        &#39;*(a or b)&#39;</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i = 1 + 2)&#39;).keywords[0].value.par().root.src  # not just root node</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a><span class="sd">        &#39;call(i = (1 + 2))&#39;</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a><span class="sd">        ```</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a>            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span> <span class="ow">or</span> <span class="p">(</span><span class="n">is_atom</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atom</span><span class="p">())</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;pars&#39;</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a>                <span class="p">(</span><span class="n">is_atom</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">())</span>  <span class="c1"># &#39;unenclosable&#39;</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a>            <span class="p">):</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">():</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">):</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_node</span><span class="p">(</span><span class="n">whole</span><span class="p">)</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_node</span><span class="p">(</span><span class="n">whole</span><span class="p">,</span> <span class="s1">&#39;[]&#39;</span><span class="p">)</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_grouping</span><span class="p">(</span><span class="n">whole</span><span class="p">)</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unpar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intrinsic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">shared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove all parentheses from node if present. Normally removes just grouping parentheses but can also remove</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a><span class="sd">        `Tuple` parentheses and `MatchSequence` parentheses or brackets if `intrinsic=True`. If dealing with a `Starred`</span>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a><span class="sd">        then the parentheses are checked in and removed from the child. If `shared=None` then will also remove</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a><span class="sd">        parentheses which do not belong to this node but enclose it directly.</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a><span class="sd">        **WARNING!** This function doesn&#39;t do any higher level syntactic validation. So if you unparenthesize something</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a><span class="sd">        that shouldn&#39;t be unparenthesized, and you wind up poking an eye out, that&#39;s on you.</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a><span class="sd">        - `intrinsic`: If `True` then will remove parentheses from a parenthesized `Tuple` and parentheses / brackets</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a><span class="sd">            from parenthesized / bracketed `MatchSequence`, otherwise only removes grouping parentheses if present.</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a><span class="sd">        - `shared`: Whether to allow merge of parentheses of single call argument generator expression with `Call`</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a><span class="sd">            parentheses or not. If `None` then will attempt to unparenthesize any enclosing parentheses, whether they</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a><span class="sd">            belong to this node or not (meant for internal use).</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a><span class="sd">        - `self`</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a><span class="sd">        ```py</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).unpar().src  # nothing done if no pars</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).unpar().src</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((a + b))&#39;).unpar().src  # removes all</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).unpar().src  # but not from tuple</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).unpar(intrinsic=True).src  # unless explicitly specified</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(((1, 2)))&#39;).unpar().src</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(((1, 2)))&#39;).unpar(intrinsic=True).src</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1, 2]&#39;, &#39;pattern&#39;).unpar().src</span>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1, 2]&#39;, &#39;pattern&#39;).unpar(intrinsic=True).src</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;*(a or b)&#39;).unpar().src  # unpar() a Starred unparenthesizes its child</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a><span class="sd">        &#39;*a or b&#39;</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a><span class="sd">        &gt;&gt;&gt; # not just root node</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i = (1 + 2))&#39;).keywords[0].value.unpar().root.src</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a><span class="sd">        &#39;call(i = 1 + 2)&#39;</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a><span class="sd">        &gt;&gt;&gt; # by default allows sharing</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(((i for i in j)))&#39;).args[0].unpar().root.src</span>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a><span class="sd">        &#39;call(i for i in j)&#39;</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a><span class="sd">        &gt;&gt;&gt; # unless told not to</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(((i for i in j)))&#39;).args[0].unpar(shared=False).root.src</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a><span class="sd">        &#39;call((i for i in j))&#39;</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a><span class="sd">        ```</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Starred</span><span class="p">):</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">():</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>                    <span class="n">value</span><span class="o">.</span><span class="n">_unparenthesize_grouping</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>        <span class="n">modifying</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">(</span><span class="kc">None</span> <span class="k">if</span> <span class="n">shared</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a>            <span class="n">modifying</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_grouping</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a>        <span class="k">if</span> <span class="n">intrinsic</span><span class="p">:</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">):</span>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a>                <span class="n">modifying</span> <span class="o">=</span> <span class="n">modifying</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_node</span><span class="p">()</span>  <span class="c1"># ret = self._unparenthesize_node() or ret</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a>                <span class="n">modifying</span> <span class="o">=</span> <span class="n">modifying</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_node</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">)</span>  <span class="c1"># ret = self._unparenthesize_node() or ret</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a>        <span class="k">if</span> <span class="n">modifying</span><span class="p">:</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>            <span class="n">modifying</span><span class="o">.</span><span class="n">done</span><span class="p">()</span>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a>        <span class="k">return</span> <span class="bp">self</span>  <span class="c1"># ret</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a>    <span class="c1"># Structure stuff</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>  <span class="c1"># placeholder for pydoc, otherwise it puts these at the end of the class</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">first_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">last_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">last_header_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prev_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">step_fwd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">step_back</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_walk</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a>        <span class="nb">next</span><span class="p">,</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a>        <span class="n">prev</span><span class="p">,</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>        <span class="n">first_child</span><span class="p">,</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>        <span class="n">last_child</span><span class="p">,</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a>        <span class="n">last_header_child</span><span class="p">,</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a>        <span class="n">next_child</span><span class="p">,</span>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a>        <span class="n">prev_child</span><span class="p">,</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>        <span class="n">step_fwd</span><span class="p">,</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>        <span class="n">step_back</span><span class="p">,</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a>        <span class="n">walk</span><span class="p">,</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a>    <span class="p">)</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FST</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generator which yields parents all the way up to root. If `self_` is `True` then will yield `self` first.</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a><span class="sd">        - `self_`: Whether to yield `self` first.</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a><span class="sd">        ```py</span>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a><span class="sd">        &gt;&gt;&gt; list(FST(&#39;i = (f(), g())&#39;, &#39;exec&#39;).body[0].value.elts[0].parents())</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a><span class="sd">        [&lt;Tuple 0,4..0,14&gt;, &lt;Assign 0,0..0,14&gt;, &lt;Module ROOT 0,0..0,14&gt;]</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a><span class="sd">        &gt;&gt;&gt; list(FST(&#39;i = (f(), g())&#39;, &#39;exec&#39;).body[0].value.elts[0].parents(self_=True))</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a><span class="sd">        [&lt;Call 0,5..0,8&gt;, &lt;Tuple 0,4..0,14&gt;, &lt;Assign 0,0..0,14&gt;, &lt;Module ROOT 0,0..0,14&gt;]</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a><span class="sd">        ```</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>        <span class="k">if</span> <span class="n">self_</span><span class="p">:</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>            <span class="k">yield</span> <span class="bp">self</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a>        <span class="k">while</span> <span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>            <span class="k">yield</span> <span class="bp">self</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The first parent which is a `stmt` or optionally `mod` node (if any). If `self_` is `True` then will check</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a><span class="sd">        `self` first (possibly returning `self`), otherwise only checks parents.</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a><span class="sd">        - `mod`: Whether to return `mod` nodes if found.</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a><span class="sd">        ```py</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_stmt()</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a><span class="sd">        &lt;Assign 0,6..0,11&gt;</span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].parent_stmt()</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt()</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt(mod=False))</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a><span class="sd">        None</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt(self_=True)</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a><span class="sd">        ```</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">ast_mod</span><span class="p">)</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">stmt</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a>            <span class="k">pass</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_stmtish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is a `stmt`, `ExceptHandler`, `match_case` or optionally `mod` node (if any). If</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a><span class="sd">        `self_` is `True` then will check `self` first, otherwise only checks parents.</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a><span class="sd">        ```py</span>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;)</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a><span class="sd">        ...  .body[0].handlers[0].body[0].parent_stmtish())</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a><span class="sd">        &lt;ExceptHandler 1,0..1,12&gt;</span>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;).body[0].handlers[0].parent_stmtish()</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a><span class="sd">        &lt;Try 0,0..1,12&gt;</span>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;).body[0].parent_stmtish()</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a><span class="sd">        &lt;Module ROOT 0,0..1,12&gt;</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].body[0].parent_stmtish()</span>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a><span class="sd">        &lt;match_case 1,2..1,14&gt;</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].pattern.parent_stmtish()</span>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a><span class="sd">        &lt;match_case 1,2..1,14&gt;</span>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a><span class="sd">        ```</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos">2199</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos">2200</span></a>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos">2201</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">STMTISH_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">STMTISH</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos">2202</span></a>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos">2203</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos">2204</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos">2205</span></a>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos">2206</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos">2207</span></a>            <span class="k">pass</span>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos">2208</span></a>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos">2209</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos">2210</span></a>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos">2211</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos">2212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The first parent which opens a block that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos">2213</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef`, `For`, `AsyncFor`, `While`, `If`, `With`, `AsyncWith`, `Match`, `Try`,</span>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos">2214</span></a><span class="sd">        `TryStar`, `ExceptHandler`, `match_case` or optionally `mod` node (if any). If `self_` is `True` then will check</span>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos">2215</span></a><span class="sd">        `self` first, otherwise only checks parents.</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos">2216</span></a>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos">2217</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos">2218</span></a><span class="sd">        ```py</span>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos">2219</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_block()</span>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos">2220</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos">2221</span></a>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos">2222</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_block()</span>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos">2223</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos">2224</span></a><span class="sd">        ```</span>
</span><span id="L-2225"><a href="#L-2225"><span class="linenos">2225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos">2226</span></a>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos">2227</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">BLOCK_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">BLOCK</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos">2228</span></a>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos">2229</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos">2230</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos">2231</span></a>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos">2232</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos">2233</span></a>            <span class="k">pass</span>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos">2234</span></a>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos">2235</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos">2236</span></a>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos">2237</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos">2238</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which opens a scope that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos">2239</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef`, `Lambda`, `ListComp`, `SetComp`, `DictComp`, `GeneratorExp` or optionally `mod`</span>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos">2240</span></a><span class="sd">        node (if any). If `self_` is `True` then will check `self` first, otherwise only checks parents.</span>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos">2241</span></a>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos">2242</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos">2243</span></a><span class="sd">        ```py</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos">2244</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_scope()</span>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos">2245</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos">2246</span></a>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos">2247</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f():\n  if 1: i = 1&#39;, &#39;exec&#39;)</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos">2248</span></a><span class="sd">        ...  .body[0].body[0].body[0].value.parent_scope())</span>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos">2249</span></a><span class="sd">        &lt;FunctionDef 0,0..1,13&gt;</span>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos">2250</span></a>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos">2251</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;lambda: None&#39;, &#39;exec&#39;).body[0].value.body.parent_scope()</span>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos">2252</span></a><span class="sd">        &lt;Lambda 0,0..0,12&gt;</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos">2253</span></a>
</span><span id="L-2254"><a href="#L-2254"><span class="linenos">2254</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[i for i in j]&#39;, &#39;exec&#39;).body[0].value.elt.parent_scope()</span>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos">2255</span></a><span class="sd">        &lt;ListComp 0,0..0,14&gt;</span>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos">2256</span></a><span class="sd">        ```</span>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos">2257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2258"><a href="#L-2258"><span class="linenos">2258</span></a>
</span><span id="L-2259"><a href="#L-2259"><span class="linenos">2259</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">SCOPE_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">SCOPE</span>
</span><span id="L-2260"><a href="#L-2260"><span class="linenos">2260</span></a>
</span><span id="L-2261"><a href="#L-2261"><span class="linenos">2261</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2262"><a href="#L-2262"><span class="linenos">2262</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2263"><a href="#L-2263"><span class="linenos">2263</span></a>
</span><span id="L-2264"><a href="#L-2264"><span class="linenos">2264</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2265"><a href="#L-2265"><span class="linenos">2265</span></a>            <span class="k">pass</span>
</span><span id="L-2266"><a href="#L-2266"><span class="linenos">2266</span></a>
</span><span id="L-2267"><a href="#L-2267"><span class="linenos">2267</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2268"><a href="#L-2268"><span class="linenos">2268</span></a>
</span><span id="L-2269"><a href="#L-2269"><span class="linenos">2269</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_named_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2270"><a href="#L-2270"><span class="linenos">2270</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which opens a named scope that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="L-2271"><a href="#L-2271"><span class="linenos">2271</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef` or optionally `mod` node (if any). If `self_` is `True` then will check `self`</span>
</span><span id="L-2272"><a href="#L-2272"><span class="linenos">2272</span></a><span class="sd">        first, otherwise only checks parents.</span>
</span><span id="L-2273"><a href="#L-2273"><span class="linenos">2273</span></a>
</span><span id="L-2274"><a href="#L-2274"><span class="linenos">2274</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2275"><a href="#L-2275"><span class="linenos">2275</span></a><span class="sd">        ```py</span>
</span><span id="L-2276"><a href="#L-2276"><span class="linenos">2276</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_named_scope()</span>
</span><span id="L-2277"><a href="#L-2277"><span class="linenos">2277</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="L-2278"><a href="#L-2278"><span class="linenos">2278</span></a>
</span><span id="L-2279"><a href="#L-2279"><span class="linenos">2279</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f():\n  if 1: i = 1&#39;, &#39;exec&#39;)</span>
</span><span id="L-2280"><a href="#L-2280"><span class="linenos">2280</span></a><span class="sd">        ...  .body[0].body[0].body[0].value.parent_named_scope())</span>
</span><span id="L-2281"><a href="#L-2281"><span class="linenos">2281</span></a><span class="sd">        &lt;FunctionDef 0,0..1,13&gt;</span>
</span><span id="L-2282"><a href="#L-2282"><span class="linenos">2282</span></a>
</span><span id="L-2283"><a href="#L-2283"><span class="linenos">2283</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f(): lambda: None&#39;, &#39;exec&#39;)</span>
</span><span id="L-2284"><a href="#L-2284"><span class="linenos">2284</span></a><span class="sd">        ...  .body[0].body[0].value.body.parent_named_scope())</span>
</span><span id="L-2285"><a href="#L-2285"><span class="linenos">2285</span></a><span class="sd">        &lt;FunctionDef 0,0..0,21&gt;</span>
</span><span id="L-2286"><a href="#L-2286"><span class="linenos">2286</span></a>
</span><span id="L-2287"><a href="#L-2287"><span class="linenos">2287</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;class cls: [i for i in j]&#39;, &#39;exec&#39;)</span>
</span><span id="L-2288"><a href="#L-2288"><span class="linenos">2288</span></a><span class="sd">        ...  .body[0].body[0].value.elt.parent_named_scope())</span>
</span><span id="L-2289"><a href="#L-2289"><span class="linenos">2289</span></a><span class="sd">        &lt;ClassDef 0,0..0,25&gt;</span>
</span><span id="L-2290"><a href="#L-2290"><span class="linenos">2290</span></a><span class="sd">        ```</span>
</span><span id="L-2291"><a href="#L-2291"><span class="linenos">2291</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2292"><a href="#L-2292"><span class="linenos">2292</span></a>
</span><span id="L-2293"><a href="#L-2293"><span class="linenos">2293</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">NAMED_SCOPE_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">NAMED_SCOPE</span>
</span><span id="L-2294"><a href="#L-2294"><span class="linenos">2294</span></a>
</span><span id="L-2295"><a href="#L-2295"><span class="linenos">2295</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2296"><a href="#L-2296"><span class="linenos">2296</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2297"><a href="#L-2297"><span class="linenos">2297</span></a>
</span><span id="L-2298"><a href="#L-2298"><span class="linenos">2298</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2299"><a href="#L-2299"><span class="linenos">2299</span></a>            <span class="k">pass</span>
</span><span id="L-2300"><a href="#L-2300"><span class="linenos">2300</span></a>
</span><span id="L-2301"><a href="#L-2301"><span class="linenos">2301</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2302"><a href="#L-2302"><span class="linenos">2302</span></a>
</span><span id="L-2303"><a href="#L-2303"><span class="linenos">2303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_non_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2304"><a href="#L-2304"><span class="linenos">2304</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is not an `expr`. If `self_` is `True` then will check `self` first (possibly</span>
</span><span id="L-2305"><a href="#L-2305"><span class="linenos">2305</span></a><span class="sd">        returning `self`), otherwise only checks parents.</span>
</span><span id="L-2306"><a href="#L-2306"><span class="linenos">2306</span></a>
</span><span id="L-2307"><a href="#L-2307"><span class="linenos">2307</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2308"><a href="#L-2308"><span class="linenos">2308</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="L-2309"><a href="#L-2309"><span class="linenos">2309</span></a><span class="sd">        - `strict`: `False` means consider `comprehension`, `arguments`, `arg` and `keyword` nodes as `expr` for the</span>
</span><span id="L-2310"><a href="#L-2310"><span class="linenos">2310</span></a><span class="sd">            sake of the walk up since these nodes can have other `expr` parents. `True` means only `expr` nodes, which</span>
</span><span id="L-2311"><a href="#L-2311"><span class="linenos">2311</span></a><span class="sd">            means you could get an `arg` or `comprehension` node for example which still has `expr` parents. Also</span>
</span><span id="L-2312"><a href="#L-2312"><span class="linenos">2312</span></a><span class="sd">            `expr_context`, `boolop`, `operator`, `unaruop` and `cmpop` are included if `strict=False` but this only</span>
</span><span id="L-2313"><a href="#L-2313"><span class="linenos">2313</span></a><span class="sd">            makes sense if `self_=True` and you are calling this function on one of those.</span>
</span><span id="L-2314"><a href="#L-2314"><span class="linenos">2314</span></a>
</span><span id="L-2315"><a href="#L-2315"><span class="linenos">2315</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2316"><a href="#L-2316"><span class="linenos">2316</span></a><span class="sd">        ```py</span>
</span><span id="L-2317"><a href="#L-2317"><span class="linenos">2317</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1 + a[b]&#39;).body[0].value.right.value.parent_non_expr()</span>
</span><span id="L-2318"><a href="#L-2318"><span class="linenos">2318</span></a><span class="sd">        &lt;Assign 0,6..0,18&gt;</span>
</span><span id="L-2319"><a href="#L-2319"><span class="linenos">2319</span></a>
</span><span id="L-2320"><a href="#L-2320"><span class="linenos">2320</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n case {a.b.c: 1}: pass&#39;)</span>
</span><span id="L-2321"><a href="#L-2321"><span class="linenos">2321</span></a><span class="sd">        ...  .cases[0].pattern.keys[0].value.value.parent_non_expr())</span>
</span><span id="L-2322"><a href="#L-2322"><span class="linenos">2322</span></a><span class="sd">        &lt;MatchMapping 1,6..1,16&gt;</span>
</span><span id="L-2323"><a href="#L-2323"><span class="linenos">2323</span></a>
</span><span id="L-2324"><a href="#L-2324"><span class="linenos">2324</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;var = call(a, b=1)&#39;).value.keywords[0].value.parent_non_expr()</span>
</span><span id="L-2325"><a href="#L-2325"><span class="linenos">2325</span></a><span class="sd">        &lt;Assign ROOT 0,0..0,18&gt;</span>
</span><span id="L-2326"><a href="#L-2326"><span class="linenos">2326</span></a>
</span><span id="L-2327"><a href="#L-2327"><span class="linenos">2327</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;var = call(a, b=1)&#39;)</span>
</span><span id="L-2328"><a href="#L-2328"><span class="linenos">2328</span></a><span class="sd">        ...  .value.keywords[0].value.parent_non_expr(strict=True))</span>
</span><span id="L-2329"><a href="#L-2329"><span class="linenos">2329</span></a><span class="sd">        &lt;keyword 0,14..0,17&gt;</span>
</span><span id="L-2330"><a href="#L-2330"><span class="linenos">2330</span></a><span class="sd">        ```</span>
</span><span id="L-2331"><a href="#L-2331"><span class="linenos">2331</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2332"><a href="#L-2332"><span class="linenos">2332</span></a>
</span><span id="L-2333"><a href="#L-2333"><span class="linenos">2333</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">expr</span> <span class="k">if</span> <span class="n">strict</span> <span class="k">else</span> <span class="n">EXPRISH_ALL</span>  <span class="c1"># ops because of maybe self_</span>
</span><span id="L-2334"><a href="#L-2334"><span class="linenos">2334</span></a>
</span><span id="L-2335"><a href="#L-2335"><span class="linenos">2335</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2336"><a href="#L-2336"><span class="linenos">2336</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2337"><a href="#L-2337"><span class="linenos">2337</span></a>
</span><span id="L-2338"><a href="#L-2338"><span class="linenos">2338</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="L-2339"><a href="#L-2339"><span class="linenos">2339</span></a>            <span class="k">pass</span>
</span><span id="L-2340"><a href="#L-2340"><span class="linenos">2340</span></a>
</span><span id="L-2341"><a href="#L-2341"><span class="linenos">2341</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2342"><a href="#L-2342"><span class="linenos">2342</span></a>
</span><span id="L-2343"><a href="#L-2343"><span class="linenos">2343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2344"><a href="#L-2344"><span class="linenos">2344</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is a `pattern`. If `self_` is `True` then will check `self` first (possibly returning</span>
</span><span id="L-2345"><a href="#L-2345"><span class="linenos">2345</span></a><span class="sd">        `self`), otherwise only checks parents.</span>
</span><span id="L-2346"><a href="#L-2346"><span class="linenos">2346</span></a>
</span><span id="L-2347"><a href="#L-2347"><span class="linenos">2347</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2348"><a href="#L-2348"><span class="linenos">2348</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="L-2349"><a href="#L-2349"><span class="linenos">2349</span></a>
</span><span id="L-2350"><a href="#L-2350"><span class="linenos">2350</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2351"><a href="#L-2351"><span class="linenos">2351</span></a><span class="sd">        ```py</span>
</span><span id="L-2352"><a href="#L-2352"><span class="linenos">2352</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;case 1+1j: pass&#39;).pattern.value.left.parent_pattern().src</span>
</span><span id="L-2353"><a href="#L-2353"><span class="linenos">2353</span></a><span class="sd">        &#39;1+1j&#39;</span>
</span><span id="L-2354"><a href="#L-2354"><span class="linenos">2354</span></a>
</span><span id="L-2355"><a href="#L-2355"><span class="linenos">2355</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="L-2356"><a href="#L-2356"><span class="linenos">2356</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern(self_=True))</span>
</span><span id="L-2357"><a href="#L-2357"><span class="linenos">2357</span></a><span class="sd">        &lt;MatchAs 0,15..0,16&gt;</span>
</span><span id="L-2358"><a href="#L-2358"><span class="linenos">2358</span></a>
</span><span id="L-2359"><a href="#L-2359"><span class="linenos">2359</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="L-2360"><a href="#L-2360"><span class="linenos">2360</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern())</span>
</span><span id="L-2361"><a href="#L-2361"><span class="linenos">2361</span></a><span class="sd">        &lt;MatchMapping 0,9..0,17&gt;</span>
</span><span id="L-2362"><a href="#L-2362"><span class="linenos">2362</span></a>
</span><span id="L-2363"><a href="#L-2363"><span class="linenos">2363</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="L-2364"><a href="#L-2364"><span class="linenos">2364</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern().parent_pattern())</span>
</span><span id="L-2365"><a href="#L-2365"><span class="linenos">2365</span></a><span class="sd">        &lt;MatchOr 0,5..0,17&gt;</span>
</span><span id="L-2366"><a href="#L-2366"><span class="linenos">2366</span></a><span class="sd">        ```</span>
</span><span id="L-2367"><a href="#L-2367"><span class="linenos">2367</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2368"><a href="#L-2368"><span class="linenos">2368</span></a>
</span><span id="L-2369"><a href="#L-2369"><span class="linenos">2369</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
</span><span id="L-2370"><a href="#L-2370"><span class="linenos">2370</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2371"><a href="#L-2371"><span class="linenos">2371</span></a>
</span><span id="L-2372"><a href="#L-2372"><span class="linenos">2372</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
</span><span id="L-2373"><a href="#L-2373"><span class="linenos">2373</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">match_case</span><span class="p">,</span> <span class="n">stmt</span><span class="p">)):</span>
</span><span id="L-2374"><a href="#L-2374"><span class="linenos">2374</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-2375"><a href="#L-2375"><span class="linenos">2375</span></a>
</span><span id="L-2376"><a href="#L-2376"><span class="linenos">2376</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2377"><a href="#L-2377"><span class="linenos">2377</span></a>
</span><span id="L-2378"><a href="#L-2378"><span class="linenos">2378</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">child_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">FST</span><span class="p">,</span> <span class="n">as_str</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">astfield</span><span class="p">]</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">:</span>
</span><span id="L-2379"><a href="#L-2379"><span class="linenos">2379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get path to `child` node from `self` which can later be used on a copy of this tree to get to the  same</span>
</span><span id="L-2380"><a href="#L-2380"><span class="linenos">2380</span></a><span class="sd">        relative child node.</span>
</span><span id="L-2381"><a href="#L-2381"><span class="linenos">2381</span></a>
</span><span id="L-2382"><a href="#L-2382"><span class="linenos">2382</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2383"><a href="#L-2383"><span class="linenos">2383</span></a><span class="sd">        - `child`: Child node to get path to, can be `self` in which case an empty path is returned.</span>
</span><span id="L-2384"><a href="#L-2384"><span class="linenos">2384</span></a><span class="sd">        - `as_str`: If `True` will return the path as a python-ish string suitable for attribute access, else a list of</span>
</span><span id="L-2385"><a href="#L-2385"><span class="linenos">2385</span></a><span class="sd">            `astfield`s which can be used more directly.</span>
</span><span id="L-2386"><a href="#L-2386"><span class="linenos">2386</span></a>
</span><span id="L-2387"><a href="#L-2387"><span class="linenos">2387</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2388"><a href="#L-2388"><span class="linenos">2388</span></a><span class="sd">        - `list[astfield] | str`: Path to child if exists, otherwise raises.</span>
</span><span id="L-2389"><a href="#L-2389"><span class="linenos">2389</span></a>
</span><span id="L-2390"><a href="#L-2390"><span class="linenos">2390</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2391"><a href="#L-2391"><span class="linenos">2391</span></a><span class="sd">        ```py</span>
</span><span id="L-2392"><a href="#L-2392"><span class="linenos">2392</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[i for i in j]&#39;, &#39;exec&#39;)).child_path(f.body[0].value.elt)</span>
</span><span id="L-2393"><a href="#L-2393"><span class="linenos">2393</span></a><span class="sd">        [astfield(&#39;body&#39;, 0), astfield(&#39;value&#39;), astfield(&#39;elt&#39;)]</span>
</span><span id="L-2394"><a href="#L-2394"><span class="linenos">2394</span></a>
</span><span id="L-2395"><a href="#L-2395"><span class="linenos">2395</span></a><span class="sd">        &gt;&gt;&gt; ((f := FST(&#39;[i for i in j]&#39;, &#39;exec&#39;))</span>
</span><span id="L-2396"><a href="#L-2396"><span class="linenos">2396</span></a><span class="sd">        ...  .child_path(f.body[0].value.elt, as_str=True))</span>
</span><span id="L-2397"><a href="#L-2397"><span class="linenos">2397</span></a><span class="sd">        &#39;body[0].value.elt&#39;</span>
</span><span id="L-2398"><a href="#L-2398"><span class="linenos">2398</span></a>
</span><span id="L-2399"><a href="#L-2399"><span class="linenos">2399</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_path(f)</span>
</span><span id="L-2400"><a href="#L-2400"><span class="linenos">2400</span></a><span class="sd">        []</span>
</span><span id="L-2401"><a href="#L-2401"><span class="linenos">2401</span></a>
</span><span id="L-2402"><a href="#L-2402"><span class="linenos">2402</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_path(f, as_str=True)</span>
</span><span id="L-2403"><a href="#L-2403"><span class="linenos">2403</span></a><span class="sd">        &#39;&#39;</span>
</span><span id="L-2404"><a href="#L-2404"><span class="linenos">2404</span></a><span class="sd">        ```</span>
</span><span id="L-2405"><a href="#L-2405"><span class="linenos">2405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2406"><a href="#L-2406"><span class="linenos">2406</span></a>
</span><span id="L-2407"><a href="#L-2407"><span class="linenos">2407</span></a>        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
</span><span id="L-2408"><a href="#L-2408"><span class="linenos">2408</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;child is not part of same tree&#39;</span><span class="p">)</span>
</span><span id="L-2409"><a href="#L-2409"><span class="linenos">2409</span></a>
</span><span id="L-2410"><a href="#L-2410"><span class="linenos">2410</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2411"><a href="#L-2411"><span class="linenos">2411</span></a>
</span><span id="L-2412"><a href="#L-2412"><span class="linenos">2412</span></a>        <span class="k">while</span> <span class="n">child</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="L-2413"><a href="#L-2413"><span class="linenos">2413</span></a>            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span>
</span><span id="L-2414"><a href="#L-2414"><span class="linenos">2414</span></a>
</span><span id="L-2415"><a href="#L-2415"><span class="linenos">2415</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">child</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="L-2416"><a href="#L-2416"><span class="linenos">2416</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid child&#39;</span><span class="p">)</span>
</span><span id="L-2417"><a href="#L-2417"><span class="linenos">2417</span></a>
</span><span id="L-2418"><a href="#L-2418"><span class="linenos">2418</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-2419"><a href="#L-2419"><span class="linenos">2419</span></a>
</span><span id="L-2420"><a href="#L-2420"><span class="linenos">2420</span></a>        <span class="k">return</span> <span class="n">path</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">as_str</span> <span class="k">else</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">af</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">af</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">af</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">for</span> <span class="n">af</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
</span><span id="L-2421"><a href="#L-2421"><span class="linenos">2421</span></a>
</span><span id="L-2422"><a href="#L-2422"><span class="linenos">2422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">child_from_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">astfield</span><span class="p">]</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">last_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]:</span>
</span><span id="L-2423"><a href="#L-2423"><span class="linenos">2423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get child node specified by `path` if it exists. If succeeds then it doesn&#39;t mean that the child node is</span>
</span><span id="L-2424"><a href="#L-2424"><span class="linenos">2424</span></a><span class="sd">        guaranteed to be the same or even same type as was originally used to get the path, just that the path is valid.</span>
</span><span id="L-2425"><a href="#L-2425"><span class="linenos">2425</span></a><span class="sd">        For example after deleting an element from a list the item at the former element&#39;s location will be the previous</span>
</span><span id="L-2426"><a href="#L-2426"><span class="linenos">2426</span></a><span class="sd">        next element.</span>
</span><span id="L-2427"><a href="#L-2427"><span class="linenos">2427</span></a>
</span><span id="L-2428"><a href="#L-2428"><span class="linenos">2428</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2429"><a href="#L-2429"><span class="linenos">2429</span></a><span class="sd">        - `path`: Path to child as a list of `astfield`s or string.</span>
</span><span id="L-2430"><a href="#L-2430"><span class="linenos">2430</span></a><span class="sd">        - `last_valid`: If `True` then return the last valid node along the path, will not fail, can return `self`.</span>
</span><span id="L-2431"><a href="#L-2431"><span class="linenos">2431</span></a>
</span><span id="L-2432"><a href="#L-2432"><span class="linenos">2432</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2433"><a href="#L-2433"><span class="linenos">2433</span></a><span class="sd">        - `FST`: Child node if path is valid, otherwise `False` if path invalid. `False` and not `None` because `None`</span>
</span><span id="L-2434"><a href="#L-2434"><span class="linenos">2434</span></a><span class="sd">            can be in a field that can hold an `AST` but `False` can not.</span>
</span><span id="L-2435"><a href="#L-2435"><span class="linenos">2435</span></a>
</span><span id="L-2436"><a href="#L-2436"><span class="linenos">2436</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2437"><a href="#L-2437"><span class="linenos">2437</span></a><span class="sd">        ```py</span>
</span><span id="L-2438"><a href="#L-2438"><span class="linenos">2438</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;[i for i in j]&#39;, &#39;exec&#39;)</span>
</span><span id="L-2439"><a href="#L-2439"><span class="linenos">2439</span></a><span class="sd">        &gt;&gt;&gt; f.child_from_path(f.child_path(f.body[0].value.elt)).src</span>
</span><span id="L-2440"><a href="#L-2440"><span class="linenos">2440</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="L-2441"><a href="#L-2441"><span class="linenos">2441</span></a>
</span><span id="L-2442"><a href="#L-2442"><span class="linenos">2442</span></a><span class="sd">        &gt;&gt;&gt; f.child_from_path(f.child_path(f.body[0].value.elt, True)).src</span>
</span><span id="L-2443"><a href="#L-2443"><span class="linenos">2443</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="L-2444"><a href="#L-2444"><span class="linenos">2444</span></a>
</span><span id="L-2445"><a href="#L-2445"><span class="linenos">2445</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;, &#39;exec&#39;).child_from_path(&#39;body[0].value.elts[4]&#39;)</span>
</span><span id="L-2446"><a href="#L-2446"><span class="linenos">2446</span></a><span class="sd">        False</span>
</span><span id="L-2447"><a href="#L-2447"><span class="linenos">2447</span></a>
</span><span id="L-2448"><a href="#L-2448"><span class="linenos">2448</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;[0, 1, 2, 3]&#39;, &#39;exec&#39;)</span>
</span><span id="L-2449"><a href="#L-2449"><span class="linenos">2449</span></a><span class="sd">        ...  .child_from_path(&#39;body[0].value.elts[4]&#39;, last_valid=True).src)</span>
</span><span id="L-2450"><a href="#L-2450"><span class="linenos">2450</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="L-2451"><a href="#L-2451"><span class="linenos">2451</span></a>
</span><span id="L-2452"><a href="#L-2452"><span class="linenos">2452</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_from_path([]) is f</span>
</span><span id="L-2453"><a href="#L-2453"><span class="linenos">2453</span></a><span class="sd">        True</span>
</span><span id="L-2454"><a href="#L-2454"><span class="linenos">2454</span></a>
</span><span id="L-2455"><a href="#L-2455"><span class="linenos">2455</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_from_path(&#39;&#39;) is f</span>
</span><span id="L-2456"><a href="#L-2456"><span class="linenos">2456</span></a><span class="sd">        True</span>
</span><span id="L-2457"><a href="#L-2457"><span class="linenos">2457</span></a><span class="sd">        ```</span>
</span><span id="L-2458"><a href="#L-2458"><span class="linenos">2458</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2459"><a href="#L-2459"><span class="linenos">2459</span></a>
</span><span id="L-2460"><a href="#L-2460"><span class="linenos">2460</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-2461"><a href="#L-2461"><span class="linenos">2461</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">astfield</span><span class="p">(</span><span class="n">p</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">p</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">astfield</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-2462"><a href="#L-2462"><span class="linenos">2462</span></a>                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span> <span class="k">if</span> <span class="n">path</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-2463"><a href="#L-2463"><span class="linenos">2463</span></a>
</span><span id="L-2464"><a href="#L-2464"><span class="linenos">2464</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
</span><span id="L-2465"><a href="#L-2465"><span class="linenos">2465</span></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">next</span> <span class="o">:=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_no_raise</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-2466"><a href="#L-2466"><span class="linenos">2466</span></a>                <span class="k">return</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">last_valid</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="L-2467"><a href="#L-2467"><span class="linenos">2467</span></a>
</span><span id="L-2468"><a href="#L-2468"><span class="linenos">2468</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="nb">next</span>
</span><span id="L-2469"><a href="#L-2469"><span class="linenos">2469</span></a>
</span><span id="L-2470"><a href="#L-2470"><span class="linenos">2470</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2471"><a href="#L-2471"><span class="linenos">2471</span></a>
</span><span id="L-2472"><a href="#L-2472"><span class="linenos">2472</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">repath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="L-2473"><a href="#L-2473"><span class="linenos">2473</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recalculate `self` from path from root. Useful if `self` has been replaced by another node by some operation.</span>
</span><span id="L-2474"><a href="#L-2474"><span class="linenos">2474</span></a><span class="sd">        When nodes are deleted the corresponding `FST.a` and `AST.f` attributes are set to `None`. The `root`, `parent`</span>
</span><span id="L-2475"><a href="#L-2475"><span class="linenos">2475</span></a><span class="sd">        and `pfield` attributes are left so that things like this can work. Useful when a node has been deleted but you</span>
</span><span id="L-2476"><a href="#L-2476"><span class="linenos">2476</span></a><span class="sd">        want to know where it was and what may be there now.</span>
</span><span id="L-2477"><a href="#L-2477"><span class="linenos">2477</span></a>
</span><span id="L-2478"><a href="#L-2478"><span class="linenos">2478</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2479"><a href="#L-2479"><span class="linenos">2479</span></a><span class="sd">        - `FST`: Possibly `self` or the node which took our place at our relative position from `root`.</span>
</span><span id="L-2480"><a href="#L-2480"><span class="linenos">2480</span></a>
</span><span id="L-2481"><a href="#L-2481"><span class="linenos">2481</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2482"><a href="#L-2482"><span class="linenos">2482</span></a><span class="sd">        ```py</span>
</span><span id="L-2483"><a href="#L-2483"><span class="linenos">2483</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;[0, 1, 2, 3]&#39;)</span>
</span><span id="L-2484"><a href="#L-2484"><span class="linenos">2484</span></a><span class="sd">        &gt;&gt;&gt; g = f.elts[1]</span>
</span><span id="L-2485"><a href="#L-2485"><span class="linenos">2485</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a), g.root)</span>
</span><span id="L-2486"><a href="#L-2486"><span class="linenos">2486</span></a><span class="sd">        &lt;class &#39;ast.Constant&#39;&gt; &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="L-2487"><a href="#L-2487"><span class="linenos">2487</span></a>
</span><span id="L-2488"><a href="#L-2488"><span class="linenos">2488</span></a><span class="sd">        &gt;&gt;&gt; f.put(&#39;x&#39;, 1, raw=True)  # raw forces reparse at List</span>
</span><span id="L-2489"><a href="#L-2489"><span class="linenos">2489</span></a><span class="sd">        &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="L-2490"><a href="#L-2490"><span class="linenos">2490</span></a>
</span><span id="L-2491"><a href="#L-2491"><span class="linenos">2491</span></a><span class="sd">        &gt;&gt;&gt; print(g.a, g.root)</span>
</span><span id="L-2492"><a href="#L-2492"><span class="linenos">2492</span></a><span class="sd">        None &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="L-2493"><a href="#L-2493"><span class="linenos">2493</span></a>
</span><span id="L-2494"><a href="#L-2494"><span class="linenos">2494</span></a><span class="sd">        &gt;&gt;&gt; g = g.repath()</span>
</span><span id="L-2495"><a href="#L-2495"><span class="linenos">2495</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a), g.root)</span>
</span><span id="L-2496"><a href="#L-2496"><span class="linenos">2496</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt; &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="L-2497"><a href="#L-2497"><span class="linenos">2497</span></a><span class="sd">        ```</span>
</span><span id="L-2498"><a href="#L-2498"><span class="linenos">2498</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2499"><a href="#L-2499"><span class="linenos">2499</span></a>
</span><span id="L-2500"><a href="#L-2500"><span class="linenos">2500</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">root</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">child_from_path</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="L-2501"><a href="#L-2501"><span class="linenos">2501</span></a>
</span><span id="L-2502"><a href="#L-2502"><span class="linenos">2502</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2503"><a href="#L-2503"><span class="linenos">2503</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Find the lowest level node which entirely contains location (starting search at `self`). To reiterate, the</span>
</span><span id="L-2504"><a href="#L-2504"><span class="linenos">2504</span></a><span class="sd">        search will only find nodes at self or below, no parents.</span>
</span><span id="L-2505"><a href="#L-2505"><span class="linenos">2505</span></a>
</span><span id="L-2506"><a href="#L-2506"><span class="linenos">2506</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2507"><a href="#L-2507"><span class="linenos">2507</span></a><span class="sd">        - `ln`: Start line of location to search for (0 based).</span>
</span><span id="L-2508"><a href="#L-2508"><span class="linenos">2508</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="L-2509"><a href="#L-2509"><span class="linenos">2509</span></a><span class="sd">        - `end_ln`: End line of location to search for (0 based, inclusive).</span>
</span><span id="L-2510"><a href="#L-2510"><span class="linenos">2510</span></a><span class="sd">        - `end_col`: End column (character, inclusive with `FST.end_col`, exclusive with `FST.col`) on end line.</span>
</span><span id="L-2511"><a href="#L-2511"><span class="linenos">2511</span></a><span class="sd">        - `exact`: Whether to allow return of exact location match with node or not. `True` means allow return of node</span>
</span><span id="L-2512"><a href="#L-2512"><span class="linenos">2512</span></a><span class="sd">            which matches location exactly. Otherwise the location must be inside the node but cannot be touching BOTH</span>
</span><span id="L-2513"><a href="#L-2513"><span class="linenos">2513</span></a><span class="sd">            ends of the node. This basically determines whether you can get the exact node of the location or its</span>
</span><span id="L-2514"><a href="#L-2514"><span class="linenos">2514</span></a><span class="sd">            parent.</span>
</span><span id="L-2515"><a href="#L-2515"><span class="linenos">2515</span></a>
</span><span id="L-2516"><a href="#L-2516"><span class="linenos">2516</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2517"><a href="#L-2517"><span class="linenos">2517</span></a><span class="sd">        - `FST | None`: Node which entirely contains location, either exactly or not, or `None` if no such node.</span>
</span><span id="L-2518"><a href="#L-2518"><span class="linenos">2518</span></a>
</span><span id="L-2519"><a href="#L-2519"><span class="linenos">2519</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2520"><a href="#L-2520"><span class="linenos">2520</span></a><span class="sd">        ```py</span>
</span><span id="L-2521"><a href="#L-2521"><span class="linenos">2521</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 6, 0, 7)</span>
</span><span id="L-2522"><a href="#L-2522"><span class="linenos">2522</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="L-2523"><a href="#L-2523"><span class="linenos">2523</span></a>
</span><span id="L-2524"><a href="#L-2524"><span class="linenos">2524</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 7)</span>
</span><span id="L-2525"><a href="#L-2525"><span class="linenos">2525</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="L-2526"><a href="#L-2526"><span class="linenos">2526</span></a>
</span><span id="L-2527"><a href="#L-2527"><span class="linenos">2527</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 7, exact=False)</span>
</span><span id="L-2528"><a href="#L-2528"><span class="linenos">2528</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="L-2529"><a href="#L-2529"><span class="linenos">2529</span></a>
</span><span id="L-2530"><a href="#L-2530"><span class="linenos">2530</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 5, 0, 7, exact=False)</span>
</span><span id="L-2531"><a href="#L-2531"><span class="linenos">2531</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="L-2532"><a href="#L-2532"><span class="linenos">2532</span></a>
</span><span id="L-2533"><a href="#L-2533"><span class="linenos">2533</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 6, exact=False)</span>
</span><span id="L-2534"><a href="#L-2534"><span class="linenos">2534</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="L-2535"><a href="#L-2535"><span class="linenos">2535</span></a>
</span><span id="L-2536"><a href="#L-2536"><span class="linenos">2536</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 3, 0, 7)</span>
</span><span id="L-2537"><a href="#L-2537"><span class="linenos">2537</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="L-2538"><a href="#L-2538"><span class="linenos">2538</span></a>
</span><span id="L-2539"><a href="#L-2539"><span class="linenos">2539</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 3, 0, 7, exact=False)</span>
</span><span id="L-2540"><a href="#L-2540"><span class="linenos">2540</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="L-2541"><a href="#L-2541"><span class="linenos">2541</span></a>
</span><span id="L-2542"><a href="#L-2542"><span class="linenos">2542</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 0, 0, 7, exact=False))</span>
</span><span id="L-2543"><a href="#L-2543"><span class="linenos">2543</span></a><span class="sd">        None</span>
</span><span id="L-2544"><a href="#L-2544"><span class="linenos">2544</span></a>
</span><span id="L-2545"><a href="#L-2545"><span class="linenos">2545</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val\n&#39;, &#39;exec&#39;).find_loc(0, 0, 0, 7, exact=False)</span>
</span><span id="L-2546"><a href="#L-2546"><span class="linenos">2546</span></a><span class="sd">        &lt;Module ROOT 0,0..1,0&gt;</span>
</span><span id="L-2547"><a href="#L-2547"><span class="linenos">2547</span></a><span class="sd">        ```</span>
</span><span id="L-2548"><a href="#L-2548"><span class="linenos">2548</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2549"><a href="#L-2549"><span class="linenos">2549</span></a>
</span><span id="L-2550"><a href="#L-2550"><span class="linenos">2550</span></a>        <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-2551"><a href="#L-2551"><span class="linenos">2551</span></a>
</span><span id="L-2552"><a href="#L-2552"><span class="linenos">2552</span></a>        <span class="k">if</span> <span class="p">((((</span><span class="n">same_ln</span> <span class="o">:=</span> <span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&lt;=</span> <span class="n">col</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fln</span> <span class="o">&lt;</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="L-2553"><a href="#L-2553"><span class="linenos">2553</span></a>            <span class="p">(((</span><span class="n">same_end_ln</span> <span class="o">:=</span> <span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&gt;=</span> <span class="n">end_col</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fend_ln</span> <span class="o">&gt;</span> <span class="n">end_ln</span><span class="p">)</span>
</span><span id="L-2554"><a href="#L-2554"><span class="linenos">2554</span></a>        <span class="p">):</span>
</span><span id="L-2555"><a href="#L-2555"><span class="linenos">2555</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exact</span> <span class="ow">and</span> <span class="n">same_ln</span> <span class="ow">and</span> <span class="n">same_end_ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">==</span> <span class="n">col</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">==</span> <span class="n">end_col</span><span class="p">:</span>
</span><span id="L-2556"><a href="#L-2556"><span class="linenos">2556</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-2557"><a href="#L-2557"><span class="linenos">2557</span></a>
</span><span id="L-2558"><a href="#L-2558"><span class="linenos">2558</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2559"><a href="#L-2559"><span class="linenos">2559</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-2560"><a href="#L-2560"><span class="linenos">2560</span></a>
</span><span id="L-2561"><a href="#L-2561"><span class="linenos">2561</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-2562"><a href="#L-2562"><span class="linenos">2562</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">self_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-2563"><a href="#L-2563"><span class="linenos">2563</span></a>                <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-2564"><a href="#L-2564"><span class="linenos">2564</span></a>
</span><span id="L-2565"><a href="#L-2565"><span class="linenos">2565</span></a>                <span class="k">if</span> <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">col</span><span class="p">):</span>
</span><span id="L-2566"><a href="#L-2566"><span class="linenos">2566</span></a>                    <span class="k">continue</span>
</span><span id="L-2567"><a href="#L-2567"><span class="linenos">2567</span></a>
</span><span id="L-2568"><a href="#L-2568"><span class="linenos">2568</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">fln</span> <span class="o">&gt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">((</span><span class="n">same_ln</span> <span class="o">:=</span> <span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&gt;</span> <span class="n">col</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="L-2569"><a href="#L-2569"><span class="linenos">2569</span></a>                    <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">((</span><span class="n">same_end_ln</span> <span class="o">:=</span> <span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;</span> <span class="n">end_col</span><span class="p">)</span>
</span><span id="L-2570"><a href="#L-2570"><span class="linenos">2570</span></a>                <span class="p">):</span>
</span><span id="L-2571"><a href="#L-2571"><span class="linenos">2571</span></a>                    <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2572"><a href="#L-2572"><span class="linenos">2572</span></a>
</span><span id="L-2573"><a href="#L-2573"><span class="linenos">2573</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">exact</span> <span class="ow">and</span> <span class="n">same_ln</span> <span class="ow">and</span> <span class="n">same_end_ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">==</span> <span class="n">col</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">==</span> <span class="n">end_col</span><span class="p">:</span>
</span><span id="L-2574"><a href="#L-2574"><span class="linenos">2574</span></a>                    <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2575"><a href="#L-2575"><span class="linenos">2575</span></a>
</span><span id="L-2576"><a href="#L-2576"><span class="linenos">2576</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="L-2577"><a href="#L-2577"><span class="linenos">2577</span></a>
</span><span id="L-2578"><a href="#L-2578"><span class="linenos">2578</span></a>                <span class="k">break</span>
</span><span id="L-2579"><a href="#L-2579"><span class="linenos">2579</span></a>
</span><span id="L-2580"><a href="#L-2580"><span class="linenos">2580</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2581"><a href="#L-2581"><span class="linenos">2581</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2582"><a href="#L-2582"><span class="linenos">2582</span></a>
</span><span id="L-2583"><a href="#L-2583"><span class="linenos">2583</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_in_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2584"><a href="#L-2584"><span class="linenos">2584</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the first highest level node which is contained entirely in location (inclusive, starting search at</span>
</span><span id="L-2585"><a href="#L-2585"><span class="linenos">2585</span></a><span class="sd">        `self`). To reiterate, the search will only find nodes at self or below, no parents.</span>
</span><span id="L-2586"><a href="#L-2586"><span class="linenos">2586</span></a>
</span><span id="L-2587"><a href="#L-2587"><span class="linenos">2587</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2588"><a href="#L-2588"><span class="linenos">2588</span></a><span class="sd">        - `ln`: Start line of location to search (0 based).</span>
</span><span id="L-2589"><a href="#L-2589"><span class="linenos">2589</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="L-2590"><a href="#L-2590"><span class="linenos">2590</span></a><span class="sd">        - `end_ln`: End line of location to search (0 based, inclusive).</span>
</span><span id="L-2591"><a href="#L-2591"><span class="linenos">2591</span></a><span class="sd">        - `end_col`: End column (character, inclusive with `FST.end_col`, exclusive with `FST.col`) on end line.</span>
</span><span id="L-2592"><a href="#L-2592"><span class="linenos">2592</span></a>
</span><span id="L-2593"><a href="#L-2593"><span class="linenos">2593</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2594"><a href="#L-2594"><span class="linenos">2594</span></a><span class="sd">        - `FST | None`: First node which is entirely contained in the location or `None` if no such node.</span>
</span><span id="L-2595"><a href="#L-2595"><span class="linenos">2595</span></a>
</span><span id="L-2596"><a href="#L-2596"><span class="linenos">2596</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2597"><a href="#L-2597"><span class="linenos">2597</span></a><span class="sd">        ```py</span>
</span><span id="L-2598"><a href="#L-2598"><span class="linenos">2598</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 0, 0, 7)</span>
</span><span id="L-2599"><a href="#L-2599"><span class="linenos">2599</span></a><span class="sd">        &lt;Module ROOT 0,0..0,7&gt;</span>
</span><span id="L-2600"><a href="#L-2600"><span class="linenos">2600</span></a>
</span><span id="L-2601"><a href="#L-2601"><span class="linenos">2601</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 1, 0, 7)</span>
</span><span id="L-2602"><a href="#L-2602"><span class="linenos">2602</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="L-2603"><a href="#L-2603"><span class="linenos">2603</span></a>
</span><span id="L-2604"><a href="#L-2604"><span class="linenos">2604</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 4, 0, 7)</span>
</span><span id="L-2605"><a href="#L-2605"><span class="linenos">2605</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="L-2606"><a href="#L-2606"><span class="linenos">2606</span></a>
</span><span id="L-2607"><a href="#L-2607"><span class="linenos">2607</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 5, 0, 7))</span>
</span><span id="L-2608"><a href="#L-2608"><span class="linenos">2608</span></a><span class="sd">        None</span>
</span><span id="L-2609"><a href="#L-2609"><span class="linenos">2609</span></a><span class="sd">        ```</span>
</span><span id="L-2610"><a href="#L-2610"><span class="linenos">2610</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2611"><a href="#L-2611"><span class="linenos">2611</span></a>
</span><span id="L-2612"><a href="#L-2612"><span class="linenos">2612</span></a>        <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-2613"><a href="#L-2613"><span class="linenos">2613</span></a>
</span><span id="L-2614"><a href="#L-2614"><span class="linenos">2614</span></a>        <span class="k">if</span> <span class="p">((</span><span class="n">fln</span> <span class="o">&gt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&gt;=</span> <span class="n">col</span><span class="p">))</span> <span class="ow">and</span>
</span><span id="L-2615"><a href="#L-2615"><span class="linenos">2615</span></a>            <span class="p">(</span><span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">end_col</span><span class="p">))</span>
</span><span id="L-2616"><a href="#L-2616"><span class="linenos">2616</span></a>        <span class="p">):</span>
</span><span id="L-2617"><a href="#L-2617"><span class="linenos">2617</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-2618"><a href="#L-2618"><span class="linenos">2618</span></a>
</span><span id="L-2619"><a href="#L-2619"><span class="linenos">2619</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-2620"><a href="#L-2620"><span class="linenos">2620</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">self_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-2621"><a href="#L-2621"><span class="linenos">2621</span></a>                <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-2622"><a href="#L-2622"><span class="linenos">2622</span></a>
</span><span id="L-2623"><a href="#L-2623"><span class="linenos">2623</span></a>                <span class="k">if</span> <span class="n">fln</span> <span class="o">&lt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&lt;</span> <span class="n">col</span><span class="p">):</span>
</span><span id="L-2624"><a href="#L-2624"><span class="linenos">2624</span></a>                    <span class="k">continue</span>
</span><span id="L-2625"><a href="#L-2625"><span class="linenos">2625</span></a>
</span><span id="L-2626"><a href="#L-2626"><span class="linenos">2626</span></a>                <span class="k">if</span> <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">end_col</span><span class="p">):</span>
</span><span id="L-2627"><a href="#L-2627"><span class="linenos">2627</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="L-2628"><a href="#L-2628"><span class="linenos">2628</span></a>
</span><span id="L-2629"><a href="#L-2629"><span class="linenos">2629</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="L-2630"><a href="#L-2630"><span class="linenos">2630</span></a>
</span><span id="L-2631"><a href="#L-2631"><span class="linenos">2631</span></a>                <span class="k">break</span>
</span><span id="L-2632"><a href="#L-2632"><span class="linenos">2632</span></a>
</span><span id="L-2633"><a href="#L-2633"><span class="linenos">2633</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2634"><a href="#L-2634"><span class="linenos">2634</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-2635"><a href="#L-2635"><span class="linenos">2635</span></a>
</span><span id="L-2636"><a href="#L-2636"><span class="linenos">2636</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-2637"><a href="#L-2637"><span class="linenos">2637</span></a>    <span class="c1"># Low level</span>
</span><span id="L-2638"><a href="#L-2638"><span class="linenos">2638</span></a>
</span><span id="L-2639"><a href="#L-2639"><span class="linenos">2639</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">:</span>
</span><span id="L-2640"><a href="#L-2640"><span class="linenos">2640</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine proper indentation of node at `stmt` (or other similar) level at or above `self`. Even if it is a</span>
</span><span id="L-2641"><a href="#L-2641"><span class="linenos">2641</span></a><span class="sd">        continuation or on same line as block statement. If indentation is impossible to determine because is solo</span>
</span><span id="L-2642"><a href="#L-2642"><span class="linenos">2642</span></a><span class="sd">        statement on same line as parent block then the current tree default indentation is added to the parent block</span>
</span><span id="L-2643"><a href="#L-2643"><span class="linenos">2643</span></a><span class="sd">        indentation and returned.</span>
</span><span id="L-2644"><a href="#L-2644"><span class="linenos">2644</span></a>
</span><span id="L-2645"><a href="#L-2645"><span class="linenos">2645</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2646"><a href="#L-2646"><span class="linenos">2646</span></a><span class="sd">        - `str`: Entire indentation string for the block this node lives in (not just a single level).</span>
</span><span id="L-2647"><a href="#L-2647"><span class="linenos">2647</span></a>
</span><span id="L-2648"><a href="#L-2648"><span class="linenos">2648</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2649"><a href="#L-2649"><span class="linenos">2649</span></a><span class="sd">        ```py</span>
</span><span id="L-2650"><a href="#L-2650"><span class="linenos">2650</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).get_indent()</span>
</span><span id="L-2651"><a href="#L-2651"><span class="linenos">2651</span></a><span class="sd">        &#39;&#39;</span>
</span><span id="L-2652"><a href="#L-2652"><span class="linenos">2652</span></a>
</span><span id="L-2653"><a href="#L-2653"><span class="linenos">2653</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="L-2654"><a href="#L-2654"><span class="linenos">2654</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="L-2655"><a href="#L-2655"><span class="linenos">2655</span></a>
</span><span id="L-2656"><a href="#L-2656"><span class="linenos">2656</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;).body[0].get_indent()</span>
</span><span id="L-2657"><a href="#L-2657"><span class="linenos">2657</span></a><span class="sd">        &#39;    &#39;</span>
</span><span id="L-2658"><a href="#L-2658"><span class="linenos">2658</span></a>
</span><span id="L-2659"><a href="#L-2659"><span class="linenos">2659</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1; j = 2&#39;).body[1].get_indent()</span>
</span><span id="L-2660"><a href="#L-2660"><span class="linenos">2660</span></a><span class="sd">        &#39;    &#39;</span>
</span><span id="L-2661"><a href="#L-2661"><span class="linenos">2661</span></a>
</span><span id="L-2662"><a href="#L-2662"><span class="linenos">2662</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 1\n  j = 2&#39;).body[1].get_indent()</span>
</span><span id="L-2663"><a href="#L-2663"><span class="linenos">2663</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="L-2664"><a href="#L-2664"><span class="linenos">2664</span></a>
</span><span id="L-2665"><a href="#L-2665"><span class="linenos">2665</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 2:\n    if 1:\n      i = 1\n      j = 2&#39;).body[0].body[1].get_indent()</span>
</span><span id="L-2666"><a href="#L-2666"><span class="linenos">2666</span></a><span class="sd">        &#39;      &#39;</span>
</span><span id="L-2667"><a href="#L-2667"><span class="linenos">2667</span></a>
</span><span id="L-2668"><a href="#L-2668"><span class="linenos">2668</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n\\\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="L-2669"><a href="#L-2669"><span class="linenos">2669</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="L-2670"><a href="#L-2670"><span class="linenos">2670</span></a>
</span><span id="L-2671"><a href="#L-2671"><span class="linenos">2671</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n \\\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="L-2672"><a href="#L-2672"><span class="linenos">2672</span></a><span class="sd">        &#39; &#39;</span>
</span><span id="L-2673"><a href="#L-2673"><span class="linenos">2673</span></a><span class="sd">        ```</span>
</span><span id="L-2674"><a href="#L-2674"><span class="linenos">2674</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2675"><a href="#L-2675"><span class="linenos">2675</span></a>
</span><span id="L-2676"><a href="#L-2676"><span class="linenos">2676</span></a>        <span class="k">while</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">STMTISH</span><span class="p">):</span>
</span><span id="L-2677"><a href="#L-2677"><span class="linenos">2677</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="L-2678"><a href="#L-2678"><span class="linenos">2678</span></a>
</span><span id="L-2679"><a href="#L-2679"><span class="linenos">2679</span></a>        <span class="n">root</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
</span><span id="L-2680"><a href="#L-2680"><span class="linenos">2680</span></a>        <span class="n">lines</span>  <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="L-2681"><a href="#L-2681"><span class="linenos">2681</span></a>        <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-2682"><a href="#L-2682"><span class="linenos">2682</span></a>
</span><span id="L-2683"><a href="#L-2683"><span class="linenos">2683</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="L-2684"><a href="#L-2684"><span class="linenos">2684</span></a>            <span class="n">f</span>             <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span>
</span><span id="L-2685"><a href="#L-2685"><span class="linenos">2685</span></a>            <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-2686"><a href="#L-2686"><span class="linenos">2686</span></a>            <span class="n">prev</span>          <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">prev</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># there may not be one (&quot;try&quot; at start of module)</span>
</span><span id="L-2687"><a href="#L-2687"><span class="linenos">2687</span></a>            <span class="n">prev_end_ln</span>   <span class="o">=</span> <span class="n">prev</span><span class="o">.</span><span class="n">end_ln</span> <span class="k">if</span> <span class="n">prev</span> <span class="k">else</span> <span class="o">-</span><span class="mi">2</span>  <span class="c1"># -2 so it never hits it</span>
</span><span id="L-2688"><a href="#L-2688"><span class="linenos">2688</span></a>            <span class="n">good_line</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-2689"><a href="#L-2689"><span class="linenos">2689</span></a>
</span><span id="L-2690"><a href="#L-2690"><span class="linenos">2690</span></a>            <span class="k">while</span> <span class="n">ln</span> <span class="o">&gt;</span> <span class="n">prev_end_ln</span> <span class="ow">and</span> <span class="n">re_empty_line</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line_start</span> <span class="o">:=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
</span><span id="L-2691"><a href="#L-2691"><span class="linenos">2691</span></a>                <span class="n">end_col</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">preceding_ln</span> <span class="o">:=</span> <span class="n">ln</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prev_end_ln</span> <span class="k">else</span> <span class="n">prev</span><span class="o">.</span><span class="n">end_col</span>
</span><span id="L-2692"><a href="#L-2692"><span class="linenos">2692</span></a>
</span><span id="L-2693"><a href="#L-2693"><span class="linenos">2693</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">ln</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">re_line_continuation</span><span class="o">.</span><span class="n">match</span><span class="p">((</span><span class="n">l</span> <span class="o">:=</span> <span class="n">lines</span><span class="p">[</span><span class="n">preceding_ln</span><span class="p">]),</span> <span class="n">end_col</span><span class="p">):</span>
</span><span id="L-2694"><a href="#L-2694"><span class="linenos">2694</span></a>                    <span class="k">return</span> <span class="p">(</span><span class="n">line_start</span><span class="p">[:</span><span class="n">col</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="k">else</span> <span class="n">good_line</span><span class="p">)</span> <span class="o">+</span> <span class="n">indent</span>
</span><span id="L-2695"><a href="#L-2695"><span class="linenos">2695</span></a>
</span><span id="L-2696"><a href="#L-2696"><span class="linenos">2696</span></a>                <span class="k">if</span> <span class="n">col</span><span class="p">:</span>  <span class="c1"># we do this to skip backslashes at the start of line as those are just a noop</span>
</span><span id="L-2697"><a href="#L-2697"><span class="linenos">2697</span></a>                    <span class="n">good_line</span> <span class="o">=</span> <span class="n">line_start</span><span class="p">[:</span><span class="n">col</span><span class="p">]</span>
</span><span id="L-2698"><a href="#L-2698"><span class="linenos">2698</span></a>
</span><span id="L-2699"><a href="#L-2699"><span class="linenos">2699</span></a>                <span class="n">ln</span>  <span class="o">=</span> <span class="n">preceding_ln</span>
</span><span id="L-2700"><a href="#L-2700"><span class="linenos">2700</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># was line continuation so last char is &#39;\&#39; and rest should be empty</span>
</span><span id="L-2701"><a href="#L-2701"><span class="linenos">2701</span></a>
</span><span id="L-2702"><a href="#L-2702"><span class="linenos">2702</span></a>            <span class="n">indent</span> <span class="o">+=</span> <span class="n">root</span><span class="o">.</span><span class="n">indent</span>
</span><span id="L-2703"><a href="#L-2703"><span class="linenos">2703</span></a>            <span class="bp">self</span>    <span class="o">=</span> <span class="n">parent</span>
</span><span id="L-2704"><a href="#L-2704"><span class="linenos">2704</span></a>            <span class="n">parent</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
</span><span id="L-2705"><a href="#L-2705"><span class="linenos">2705</span></a>
</span><span id="L-2706"><a href="#L-2706"><span class="linenos">2706</span></a>        <span class="k">return</span> <span class="n">indent</span>
</span><span id="L-2707"><a href="#L-2707"><span class="linenos">2707</span></a>
</span><span id="L-2708"><a href="#L-2708"><span class="linenos">2708</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parsable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2709"><a href="#L-2709"><span class="linenos">2709</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether the source for this node is parsable by `FST` or not (if properly dedented for top level). This is</span>
</span><span id="L-2710"><a href="#L-2710"><span class="linenos">2710</span></a><span class="sd">        different from `astutil.is_parsable` because that one indicates what is parsable by the python `ast` module,</span>
</span><span id="L-2711"><a href="#L-2711"><span class="linenos">2711</span></a><span class="sd">        while `FST` can parse more things.</span>
</span><span id="L-2712"><a href="#L-2712"><span class="linenos">2712</span></a>
</span><span id="L-2713"><a href="#L-2713"><span class="linenos">2713</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2714"><a href="#L-2714"><span class="linenos">2714</span></a><span class="sd">        - `bool`: Whether is parsable by `FST` from a string or not.</span>
</span><span id="L-2715"><a href="#L-2715"><span class="linenos">2715</span></a>
</span><span id="L-2716"><a href="#L-2716"><span class="linenos">2716</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2717"><a href="#L-2717"><span class="linenos">2717</span></a><span class="sd">        ```py</span>
</span><span id="L-2718"><a href="#L-2718"><span class="linenos">2718</span></a><span class="sd">        &gt;&gt;&gt; from fst import astutil</span>
</span><span id="L-2719"><a href="#L-2719"><span class="linenos">2719</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).is_parsable()</span>
</span><span id="L-2720"><a href="#L-2720"><span class="linenos">2720</span></a><span class="sd">        True</span>
</span><span id="L-2721"><a href="#L-2721"><span class="linenos">2721</span></a>
</span><span id="L-2722"><a href="#L-2722"><span class="linenos">2722</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b]&#39;).slice.is_parsable()</span>
</span><span id="L-2723"><a href="#L-2723"><span class="linenos">2723</span></a><span class="sd">        True</span>
</span><span id="L-2724"><a href="#L-2724"><span class="linenos">2724</span></a>
</span><span id="L-2725"><a href="#L-2725"><span class="linenos">2725</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b:c]&#39;).slice.is_parsable()</span>
</span><span id="L-2726"><a href="#L-2726"><span class="linenos">2726</span></a><span class="sd">        True</span>
</span><span id="L-2727"><a href="#L-2727"><span class="linenos">2727</span></a>
</span><span id="L-2728"><a href="#L-2728"><span class="linenos">2728</span></a><span class="sd">        &gt;&gt;&gt; is_parsable(FST(&#39;a[b:c]&#39;).slice.a)</span>
</span><span id="L-2729"><a href="#L-2729"><span class="linenos">2729</span></a><span class="sd">        False</span>
</span><span id="L-2730"><a href="#L-2730"><span class="linenos">2730</span></a>
</span><span id="L-2731"><a href="#L-2731"><span class="linenos">2731</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].is_parsable()</span>
</span><span id="L-2732"><a href="#L-2732"><span class="linenos">2732</span></a><span class="sd">        False</span>
</span><span id="L-2733"><a href="#L-2733"><span class="linenos">2733</span></a>
</span><span id="L-2734"><a href="#L-2734"><span class="linenos">2734</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].value.is_parsable()</span>
</span><span id="L-2735"><a href="#L-2735"><span class="linenos">2735</span></a><span class="sd">        True</span>
</span><span id="L-2736"><a href="#L-2736"><span class="linenos">2736</span></a>
</span><span id="L-2737"><a href="#L-2737"><span class="linenos">2737</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].format_spec.is_parsable()</span>
</span><span id="L-2738"><a href="#L-2738"><span class="linenos">2738</span></a><span class="sd">        False</span>
</span><span id="L-2739"><a href="#L-2739"><span class="linenos">2739</span></a>
</span><span id="L-2740"><a href="#L-2740"><span class="linenos">2740</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).body[0].is_parsable()</span>
</span><span id="L-2741"><a href="#L-2741"><span class="linenos">2741</span></a><span class="sd">        True</span>
</span><span id="L-2742"><a href="#L-2742"><span class="linenos">2742</span></a>
</span><span id="L-2743"><a href="#L-2743"><span class="linenos">2743</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].is_parsable()</span>
</span><span id="L-2744"><a href="#L-2744"><span class="linenos">2744</span></a><span class="sd">        True</span>
</span><span id="L-2745"><a href="#L-2745"><span class="linenos">2745</span></a>
</span><span id="L-2746"><a href="#L-2746"><span class="linenos">2746</span></a><span class="sd">        &gt;&gt;&gt; astutil.is_parsable(FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].a)</span>
</span><span id="L-2747"><a href="#L-2747"><span class="linenos">2747</span></a><span class="sd">        False</span>
</span><span id="L-2748"><a href="#L-2748"><span class="linenos">2748</span></a>
</span><span id="L-2749"><a href="#L-2749"><span class="linenos">2749</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].body[0].is_parsable()</span>
</span><span id="L-2750"><a href="#L-2750"><span class="linenos">2750</span></a><span class="sd">        True</span>
</span><span id="L-2751"><a href="#L-2751"><span class="linenos">2751</span></a>
</span><span id="L-2752"><a href="#L-2752"><span class="linenos">2752</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].is_parsable()</span>
</span><span id="L-2753"><a href="#L-2753"><span class="linenos">2753</span></a><span class="sd">        True</span>
</span><span id="L-2754"><a href="#L-2754"><span class="linenos">2754</span></a>
</span><span id="L-2755"><a href="#L-2755"><span class="linenos">2755</span></a><span class="sd">        &gt;&gt;&gt; is_parsable(FST(&#39;match a:\n  case 1: pass&#39;).cases[0].a)</span>
</span><span id="L-2756"><a href="#L-2756"><span class="linenos">2756</span></a><span class="sd">        False</span>
</span><span id="L-2757"><a href="#L-2757"><span class="linenos">2757</span></a><span class="sd">        ```</span>
</span><span id="L-2758"><a href="#L-2758"><span class="linenos">2758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2759"><a href="#L-2759"><span class="linenos">2759</span></a>
</span><span id="L-2760"><a href="#L-2760"><span class="linenos">2760</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">:</span>
</span><span id="L-2761"><a href="#L-2761"><span class="linenos">2761</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2762"><a href="#L-2762"><span class="linenos">2762</span></a>
</span><span id="L-2763"><a href="#L-2763"><span class="linenos">2763</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-2764"><a href="#L-2764"><span class="linenos">2764</span></a>
</span><span id="L-2765"><a href="#L-2765"><span class="linenos">2765</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">expr_context</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">,</span> <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">)):</span>
</span><span id="L-2766"><a href="#L-2766"><span class="linenos">2766</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2767"><a href="#L-2767"><span class="linenos">2767</span></a>
</span><span id="L-2768"><a href="#L-2768"><span class="linenos">2768</span></a>        <span class="k">elif</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="L-2769"><a href="#L-2769"><span class="linenos">2769</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">):</span>  <span class="c1"># TemplateStr doesn&#39;t go into a .format_spec, &#39;.1f&#39; type strings without quote delimiters</span>
</span><span id="L-2770"><a href="#L-2770"><span class="linenos">2770</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;format_spec&#39;</span><span class="p">:</span>  <span class="c1"># isinstance(parent.a, (FormattedValue, Interpolation)):</span>
</span><span id="L-2771"><a href="#L-2771"><span class="linenos">2771</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2772"><a href="#L-2772"><span class="linenos">2772</span></a>
</span><span id="L-2773"><a href="#L-2773"><span class="linenos">2773</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>  <span class="c1"># string parts of f-string without quote delimiters</span>
</span><span id="L-2774"><a href="#L-2774"><span class="linenos">2774</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;values&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">)):</span>  <span class="c1"># isinstance(ast.value, str)</span>
</span><span id="L-2775"><a href="#L-2775"><span class="linenos">2775</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2776"><a href="#L-2776"><span class="linenos">2776</span></a>
</span><span id="L-2777"><a href="#L-2777"><span class="linenos">2777</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2778"><a href="#L-2778"><span class="linenos">2778</span></a>
</span><span id="L-2779"><a href="#L-2779"><span class="linenos">2779</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parenthesizable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2780"><a href="#L-2780"><span class="linenos">2780</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is parenthesizable with grouping parentheses or now. Essentially all `expr`s and `pattern`s</span>
</span><span id="L-2781"><a href="#L-2781"><span class="linenos">2781</span></a><span class="sd">        except for `Slice`.</span>
</span><span id="L-2782"><a href="#L-2782"><span class="linenos">2782</span></a>
</span><span id="L-2783"><a href="#L-2783"><span class="linenos">2783</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2784"><a href="#L-2784"><span class="linenos">2784</span></a><span class="sd">        - `bool`: Whether is syntactically legal to add grouping parentheses or not. Can always be forced.</span>
</span><span id="L-2785"><a href="#L-2785"><span class="linenos">2785</span></a>
</span><span id="L-2786"><a href="#L-2786"><span class="linenos">2786</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2787"><a href="#L-2787"><span class="linenos">2787</span></a><span class="sd">        ```py</span>
</span><span id="L-2788"><a href="#L-2788"><span class="linenos">2788</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i + j&#39;).is_parenthesizable()  # expr</span>
</span><span id="L-2789"><a href="#L-2789"><span class="linenos">2789</span></a><span class="sd">        True</span>
</span><span id="L-2790"><a href="#L-2790"><span class="linenos">2790</span></a>
</span><span id="L-2791"><a href="#L-2791"><span class="linenos">2791</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{a.b: c, **d}&#39;, &#39;pattern&#39;).is_parenthesizable()</span>
</span><span id="L-2792"><a href="#L-2792"><span class="linenos">2792</span></a><span class="sd">        True</span>
</span><span id="L-2793"><a href="#L-2793"><span class="linenos">2793</span></a>
</span><span id="L-2794"><a href="#L-2794"><span class="linenos">2794</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;).is_parenthesizable()  # Slice</span>
</span><span id="L-2795"><a href="#L-2795"><span class="linenos">2795</span></a><span class="sd">        False</span>
</span><span id="L-2796"><a href="#L-2796"><span class="linenos">2796</span></a>
</span><span id="L-2797"><a href="#L-2797"><span class="linenos">2797</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;for i in j&#39;).is_parenthesizable()  # comprehension</span>
</span><span id="L-2798"><a href="#L-2798"><span class="linenos">2798</span></a><span class="sd">        False</span>
</span><span id="L-2799"><a href="#L-2799"><span class="linenos">2799</span></a>
</span><span id="L-2800"><a href="#L-2800"><span class="linenos">2800</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a: int, b=2&#39;).is_parenthesizable()  # arguments</span>
</span><span id="L-2801"><a href="#L-2801"><span class="linenos">2801</span></a><span class="sd">        False</span>
</span><span id="L-2802"><a href="#L-2802"><span class="linenos">2802</span></a>
</span><span id="L-2803"><a href="#L-2803"><span class="linenos">2803</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a: int&#39;, &#39;arg&#39;).is_parenthesizable()</span>
</span><span id="L-2804"><a href="#L-2804"><span class="linenos">2804</span></a><span class="sd">        False</span>
</span><span id="L-2805"><a href="#L-2805"><span class="linenos">2805</span></a>
</span><span id="L-2806"><a href="#L-2806"><span class="linenos">2806</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;key=&quot;word&quot;&#39;, &#39;keyword&#39;).is_parenthesizable()</span>
</span><span id="L-2807"><a href="#L-2807"><span class="linenos">2807</span></a><span class="sd">        False</span>
</span><span id="L-2808"><a href="#L-2808"><span class="linenos">2808</span></a>
</span><span id="L-2809"><a href="#L-2809"><span class="linenos">2809</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a as b&#39;, &#39;alias&#39;).is_parenthesizable()</span>
</span><span id="L-2810"><a href="#L-2810"><span class="linenos">2810</span></a><span class="sd">        False</span>
</span><span id="L-2811"><a href="#L-2811"><span class="linenos">2811</span></a>
</span><span id="L-2812"><a href="#L-2812"><span class="linenos">2812</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a as b&#39;, &#39;withitem&#39;).is_parenthesizable()</span>
</span><span id="L-2813"><a href="#L-2813"><span class="linenos">2813</span></a><span class="sd">        False</span>
</span><span id="L-2814"><a href="#L-2814"><span class="linenos">2814</span></a><span class="sd">        ```</span>
</span><span id="L-2815"><a href="#L-2815"><span class="linenos">2815</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2816"><a href="#L-2816"><span class="linenos">2816</span></a>
</span><span id="L-2817"><a href="#L-2817"><span class="linenos">2817</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">else</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
</span><span id="L-2818"><a href="#L-2818"><span class="linenos">2818</span></a>
</span><span id="L-2819"><a href="#L-2819"><span class="linenos">2819</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">always_enclosed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;unenclosable&#39;</span><span class="p">,</span> <span class="s1">&#39;pars&#39;</span><span class="p">]:</span>
</span><span id="L-2820"><a href="#L-2820"><span class="linenos">2820</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is innately atomic precedence-wise like `Name`, `Constant`, `List`, etc... Or otherwise</span>
</span><span id="L-2821"><a href="#L-2821"><span class="linenos">2821</span></a><span class="sd">        optionally enclosed in parentheses so that it functions as a parsable atom and cannot be split up by precedence</span>
</span><span id="L-2822"><a href="#L-2822"><span class="linenos">2822</span></a><span class="sd">        rules when reparsed.</span>
</span><span id="L-2823"><a href="#L-2823"><span class="linenos">2823</span></a>
</span><span id="L-2824"><a href="#L-2824"><span class="linenos">2824</span></a><span class="sd">        Node types where this doesn&#39;t normally apply like `stmt` or `alias` return `True`.</span>
</span><span id="L-2825"><a href="#L-2825"><span class="linenos">2825</span></a>
</span><span id="L-2826"><a href="#L-2826"><span class="linenos">2826</span></a><span class="sd">        Being atomic precedence-wise does not guarantee parsability as an otherwise atomic node could be spread across</span>
</span><span id="L-2827"><a href="#L-2827"><span class="linenos">2827</span></a><span class="sd">        multiple lines without line continuations or grouping parentheses, in this case `&#39;unenclosable&#39;` is returned (if</span>
</span><span id="L-2828"><a href="#L-2828"><span class="linenos">2828</span></a><span class="sd">        these nodes are not excluded altogether with `always_enclosed=True`). Also see `is_enclosed()`.</span>
</span><span id="L-2829"><a href="#L-2829"><span class="linenos">2829</span></a>
</span><span id="L-2830"><a href="#L-2830"><span class="linenos">2830</span></a><span class="sd">        If this function returns `&#39;pars&#39;` then `self` is enclosed due to the grouping parentheses.</span>
</span><span id="L-2831"><a href="#L-2831"><span class="linenos">2831</span></a>
</span><span id="L-2832"><a href="#L-2832"><span class="linenos">2832</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2833"><a href="#L-2833"><span class="linenos">2833</span></a><span class="sd">        - `pars`: Whether to check for grouping parentheses or not for node types which are not innately atomic</span>
</span><span id="L-2834"><a href="#L-2834"><span class="linenos">2834</span></a><span class="sd">            (`NamedExpr`, `BinOp`, `Yield`, etc...). If `True` then `(a + b)` is considered atomic, if `False` then it</span>
</span><span id="L-2835"><a href="#L-2835"><span class="linenos">2835</span></a><span class="sd">            is not.</span>
</span><span id="L-2836"><a href="#L-2836"><span class="linenos">2836</span></a><span class="sd">        - `always_enclosed`: If `True` then will only consider nodes innately atomic which are always enclosed like</span>
</span><span id="L-2837"><a href="#L-2837"><span class="linenos">2837</span></a><span class="sd">            `List` or parenthesized `Tuple`. Nodes which may be split up across multiple lines like `Call` or</span>
</span><span id="L-2838"><a href="#L-2838"><span class="linenos">2838</span></a><span class="sd">            `Attribute` will not be considered atomic and will return `False` unless `pars=True` and grouping</span>
</span><span id="L-2839"><a href="#L-2839"><span class="linenos">2839</span></a><span class="sd">            parentheses present, in which case `&#39;pars&#39;` is returned.</span>
</span><span id="L-2840"><a href="#L-2840"><span class="linenos">2840</span></a>
</span><span id="L-2841"><a href="#L-2841"><span class="linenos">2841</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2842"><a href="#L-2842"><span class="linenos">2842</span></a><span class="sd">        - `True`: Is atomic and no combination of changes in the source will make it parse to a different node.</span>
</span><span id="L-2843"><a href="#L-2843"><span class="linenos">2843</span></a><span class="sd">        - `&#39;unenclosable&#39;`: Is atomic precedence-wise but may be made non-parsable by being spread over multiple lines.</span>
</span><span id="L-2844"><a href="#L-2844"><span class="linenos">2844</span></a><span class="sd">        - `&#39;pars&#39;`: Is atomic due to enclosing grouping parentheses and would not be otherwise, can not be returned for</span>
</span><span id="L-2845"><a href="#L-2845"><span class="linenos">2845</span></a><span class="sd">            `&#39;unenclosable&#39;` nodes if `always_enclosed=False`.</span>
</span><span id="L-2846"><a href="#L-2846"><span class="linenos">2846</span></a><span class="sd">        - `False`: Not atomic.</span>
</span><span id="L-2847"><a href="#L-2847"><span class="linenos">2847</span></a>
</span><span id="L-2848"><a href="#L-2848"><span class="linenos">2848</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2849"><a href="#L-2849"><span class="linenos">2849</span></a><span class="sd">        ```py</span>
</span><span id="L-2850"><a href="#L-2850"><span class="linenos">2850</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a&#39;).is_atom()</span>
</span><span id="L-2851"><a href="#L-2851"><span class="linenos">2851</span></a><span class="sd">        True</span>
</span><span id="L-2852"><a href="#L-2852"><span class="linenos">2852</span></a>
</span><span id="L-2853"><a href="#L-2853"><span class="linenos">2853</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).is_atom()</span>
</span><span id="L-2854"><a href="#L-2854"><span class="linenos">2854</span></a><span class="sd">        False</span>
</span><span id="L-2855"><a href="#L-2855"><span class="linenos">2855</span></a>
</span><span id="L-2856"><a href="#L-2856"><span class="linenos">2856</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).is_atom()</span>
</span><span id="L-2857"><a href="#L-2857"><span class="linenos">2857</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="L-2858"><a href="#L-2858"><span class="linenos">2858</span></a>
</span><span id="L-2859"><a href="#L-2859"><span class="linenos">2859</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).is_atom(pars=False)</span>
</span><span id="L-2860"><a href="#L-2860"><span class="linenos">2860</span></a><span class="sd">        False</span>
</span><span id="L-2861"><a href="#L-2861"><span class="linenos">2861</span></a>
</span><span id="L-2862"><a href="#L-2862"><span class="linenos">2862</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a.b&#39;).is_atom()</span>
</span><span id="L-2863"><a href="#L-2863"><span class="linenos">2863</span></a><span class="sd">        &#39;unenclosable&#39;</span>
</span><span id="L-2864"><a href="#L-2864"><span class="linenos">2864</span></a>
</span><span id="L-2865"><a href="#L-2865"><span class="linenos">2865</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a.b&#39;).is_atom(always_enclosed=True)  # because of &quot;a\n.b&quot;</span>
</span><span id="L-2866"><a href="#L-2866"><span class="linenos">2866</span></a><span class="sd">        False</span>
</span><span id="L-2867"><a href="#L-2867"><span class="linenos">2867</span></a>
</span><span id="L-2868"><a href="#L-2868"><span class="linenos">2868</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a.b)&#39;).is_atom(always_enclosed=True)</span>
</span><span id="L-2869"><a href="#L-2869"><span class="linenos">2869</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="L-2870"><a href="#L-2870"><span class="linenos">2870</span></a>
</span><span id="L-2871"><a href="#L-2871"><span class="linenos">2871</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_atom(always_enclosed=True)  # because List is always enclosed</span>
</span><span id="L-2872"><a href="#L-2872"><span class="linenos">2872</span></a><span class="sd">        True</span>
</span><span id="L-2873"><a href="#L-2873"><span class="linenos">2873</span></a><span class="sd">        ```</span>
</span><span id="L-2874"><a href="#L-2874"><span class="linenos">2874</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2875"><a href="#L-2875"><span class="linenos">2875</span></a>
</span><span id="L-2876"><a href="#L-2876"><span class="linenos">2876</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-2877"><a href="#L-2877"><span class="linenos">2877</span></a>
</span><span id="L-2878"><a href="#L-2878"><span class="linenos">2878</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span>
</span><span id="L-2879"><a href="#L-2879"><span class="linenos">2879</span></a>                            <span class="n">MatchValue</span><span class="p">,</span> <span class="n">MatchSingleton</span><span class="p">,</span> <span class="n">MatchMapping</span><span class="p">,</span>
</span><span id="L-2880"><a href="#L-2880"><span class="linenos">2880</span></a>                            <span class="n">expr_context</span><span class="p">,</span> <span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span>
</span><span id="L-2881"><a href="#L-2881"><span class="linenos">2881</span></a>                            <span class="n">stmt</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="L-2882"><a href="#L-2882"><span class="linenos">2882</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2883"><a href="#L-2883"><span class="linenos">2883</span></a>
</span><span id="L-2884"><a href="#L-2884"><span class="linenos">2884</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">always_enclosed</span><span class="p">:</span>
</span><span id="L-2885"><a href="#L-2885"><span class="linenos">2885</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="L-2886"><a href="#L-2886"><span class="linenos">2886</span></a>                <span class="k">return</span> <span class="s1">&#39;unenclosable&#39;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="L-2887"><a href="#L-2887"><span class="linenos">2887</span></a>
</span><span id="L-2888"><a href="#L-2888"><span class="linenos">2888</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">Call</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">,</span> <span class="n">Constant</span><span class="p">,</span> <span class="n">Attribute</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">,</span>
</span><span id="L-2889"><a href="#L-2889"><span class="linenos">2889</span></a>                                <span class="n">MatchClass</span><span class="p">,</span> <span class="n">MatchStar</span><span class="p">,</span>
</span><span id="L-2890"><a href="#L-2890"><span class="linenos">2890</span></a>                                <span class="n">cmpop</span><span class="p">,</span> <span class="n">comprehension</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span>
</span><span id="L-2891"><a href="#L-2891"><span class="linenos">2891</span></a>                                <span class="n">arg</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">withitem</span><span class="p">,</span> <span class="n">type_param</span><span class="p">)):</span>
</span><span id="L-2892"><a href="#L-2892"><span class="linenos">2892</span></a>                <span class="k">return</span> <span class="s1">&#39;unenclosable&#39;</span>
</span><span id="L-2893"><a href="#L-2893"><span class="linenos">2893</span></a>
</span><span id="L-2894"><a href="#L-2894"><span class="linenos">2894</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">comprehension</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">type_param</span><span class="p">)):</span>  <span class="c1"># can&#39;t be parenthesized</span>
</span><span id="L-2895"><a href="#L-2895"><span class="linenos">2895</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2896"><a href="#L-2896"><span class="linenos">2896</span></a>
</span><span id="L-2897"><a href="#L-2897"><span class="linenos">2897</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="L-2898"><a href="#L-2898"><span class="linenos">2898</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>  <span class="c1"># str and bytes can be multiline implicit needing parentheses</span>
</span><span id="L-2899"><a href="#L-2899"><span class="linenos">2899</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2900"><a href="#L-2900"><span class="linenos">2900</span></a>
</span><span id="L-2901"><a href="#L-2901"><span class="linenos">2901</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">withitem</span><span class="p">):</span>  <span class="c1"># isn&#39;t atom on its own and can&#39;t be parenthesized directly but if only has context_expr then take on value of that if starts and ends on same lines</span>
</span><span id="L-2902"><a href="#L-2902"><span class="linenos">2902</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">optional_vars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">ce</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">context_expr</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()[::</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span>
</span><span id="L-2903"><a href="#L-2903"><span class="linenos">2903</span></a>                    <span class="n">ce</span><span class="o">.</span><span class="n">is_atom</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="n">pars</span><span class="p">,</span> <span class="n">always_enclosed</span><span class="o">=</span><span class="n">always_enclosed</span><span class="p">))</span>
</span><span id="L-2904"><a href="#L-2904"><span class="linenos">2904</span></a>
</span><span id="L-2905"><a href="#L-2905"><span class="linenos">2905</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">cmpop</span><span class="p">):</span>
</span><span id="L-2906"><a href="#L-2906"><span class="linenos">2906</span></a>            <span class="k">return</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">IsNot</span><span class="p">,</span> <span class="n">NotIn</span><span class="p">))</span>  <span class="c1"># could be spread across multiple lines</span>
</span><span id="L-2907"><a href="#L-2907"><span class="linenos">2907</span></a>
</span><span id="L-2908"><a href="#L-2908"><span class="linenos">2908</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># if this is False then cannot be enclosed in grouping pars because that would reparse to a parenthesized Tuple and so is inconsistent</span>
</span><span id="L-2909"><a href="#L-2909"><span class="linenos">2909</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-2910"><a href="#L-2910"><span class="linenos">2910</span></a>
</span><span id="L-2911"><a href="#L-2911"><span class="linenos">2911</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># like Tuple, cannot be enclosed in grouping pars</span>
</span><span id="L-2912"><a href="#L-2912"><span class="linenos">2912</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-2913"><a href="#L-2913"><span class="linenos">2913</span></a>
</span><span id="L-2914"><a href="#L-2914"><span class="linenos">2914</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">pattern</span><span class="p">))</span>
</span><span id="L-2915"><a href="#L-2915"><span class="linenos">2915</span></a>
</span><span id="L-2916"><a href="#L-2916"><span class="linenos">2916</span></a>        <span class="k">return</span> <span class="s1">&#39;pars&#39;</span> <span class="k">if</span> <span class="n">pars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="L-2917"><a href="#L-2917"><span class="linenos">2917</span></a>
</span><span id="L-2918"><a href="#L-2918"><span class="linenos">2918</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pars&#39;</span><span class="p">]:</span>
</span><span id="L-2919"><a href="#L-2919"><span class="linenos">2919</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` lives on a single line or is otherwise enclosed in some kind of delimiters `()`, `[]`, `{}` or</span>
</span><span id="L-2920"><a href="#L-2920"><span class="linenos">2920</span></a><span class="sd">        entirely terminated with line continuations so that it can be parsed without error due to being spread across</span>
</span><span id="L-2921"><a href="#L-2921"><span class="linenos">2921</span></a><span class="sd">        multiple lines. This does not mean it can&#39;t have other errors, such as a `Slice` outside of `Subscript.slice`.</span>
</span><span id="L-2922"><a href="#L-2922"><span class="linenos">2922</span></a>
</span><span id="L-2923"><a href="#L-2923"><span class="linenos">2923</span></a><span class="sd">        Node types where this doesn&#39;t normally apply like `stmt`, `ExceptHandler`, `boolop`, `expr_context`, etc...</span>
</span><span id="L-2924"><a href="#L-2924"><span class="linenos">2924</span></a><span class="sd">        return `True`. Node types that are not enclosed but which are never used without being enclosed by a parent like</span>
</span><span id="L-2925"><a href="#L-2925"><span class="linenos">2925</span></a><span class="sd">        `Slice`, `keyword` or `type_param` will also return `True`. Other node types which cannot be enclosed</span>
</span><span id="L-2926"><a href="#L-2926"><span class="linenos">2926</span></a><span class="sd">        individually and are not on a single line or not parenthesized and do not have line continuations but would need</span>
</span><span id="L-2927"><a href="#L-2927"><span class="linenos">2927</span></a><span class="sd">        a parent to enclose them like `arguments` or the `cmpop`s `is not` or `not in` will return `False`.</span>
</span><span id="L-2928"><a href="#L-2928"><span class="linenos">2928</span></a>
</span><span id="L-2929"><a href="#L-2929"><span class="linenos">2929</span></a><span class="sd">        This function does NOT check whether `self` is enclosed by some parent up the tree if it is not enclosed itself,</span>
</span><span id="L-2930"><a href="#L-2930"><span class="linenos">2930</span></a><span class="sd">        for that see `is_enclosed_in_parents()`.</span>
</span><span id="L-2931"><a href="#L-2931"><span class="linenos">2931</span></a>
</span><span id="L-2932"><a href="#L-2932"><span class="linenos">2932</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-2933"><a href="#L-2933"><span class="linenos">2933</span></a><span class="sd">        - `pars`: Whether to check for grouping parentheses or not for nodes which are not enclosed or otherwise</span>
</span><span id="L-2934"><a href="#L-2934"><span class="linenos">2934</span></a><span class="sd">            multiline-safe. Grouping parentheses are different from tuple parentheses which are always checked.</span>
</span><span id="L-2935"><a href="#L-2935"><span class="linenos">2935</span></a>
</span><span id="L-2936"><a href="#L-2936"><span class="linenos">2936</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-2937"><a href="#L-2937"><span class="linenos">2937</span></a><span class="sd">        - `True`: Mode is enclosed.</span>
</span><span id="L-2938"><a href="#L-2938"><span class="linenos">2938</span></a><span class="sd">        - `&#39;pars&#39;` Enclosed by grouping parentheses and would not be otherwise.</span>
</span><span id="L-2939"><a href="#L-2939"><span class="linenos">2939</span></a><span class="sd">        - `False`: Not enclosed and should be parenthesized or put into an enclosed parent for successful parse.</span>
</span><span id="L-2940"><a href="#L-2940"><span class="linenos">2940</span></a>
</span><span id="L-2941"><a href="#L-2941"><span class="linenos">2941</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-2942"><a href="#L-2942"><span class="linenos">2942</span></a><span class="sd">        ```py</span>
</span><span id="L-2943"><a href="#L-2943"><span class="linenos">2943</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a&#39;).is_enclosed()</span>
</span><span id="L-2944"><a href="#L-2944"><span class="linenos">2944</span></a><span class="sd">        True</span>
</span><span id="L-2945"><a href="#L-2945"><span class="linenos">2945</span></a>
</span><span id="L-2946"><a href="#L-2946"><span class="linenos">2946</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + \\\n b&#39;).is_enclosed()  # because of the line continuation</span>
</span><span id="L-2947"><a href="#L-2947"><span class="linenos">2947</span></a><span class="sd">        True</span>
</span><span id="L-2948"><a href="#L-2948"><span class="linenos">2948</span></a>
</span><span id="L-2949"><a href="#L-2949"><span class="linenos">2949</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + \n b)&#39;).is_enclosed()</span>
</span><span id="L-2950"><a href="#L-2950"><span class="linenos">2950</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="L-2951"><a href="#L-2951"><span class="linenos">2951</span></a>
</span><span id="L-2952"><a href="#L-2952"><span class="linenos">2952</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + \n b&#39;).is_enclosed()</span>
</span><span id="L-2953"><a href="#L-2953"><span class="linenos">2953</span></a><span class="sd">        False</span>
</span><span id="L-2954"><a href="#L-2954"><span class="linenos">2954</span></a>
</span><span id="L-2955"><a href="#L-2955"><span class="linenos">2955</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[a + \n b]&#39;).elts[0].is_enclosed()</span>
</span><span id="L-2956"><a href="#L-2956"><span class="linenos">2956</span></a><span class="sd">        False</span>
</span><span id="L-2957"><a href="#L-2957"><span class="linenos">2957</span></a>
</span><span id="L-2958"><a href="#L-2958"><span class="linenos">2958</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[a + \n b]&#39;).elts[0].is_enclosed_in_parents()</span>
</span><span id="L-2959"><a href="#L-2959"><span class="linenos">2959</span></a><span class="sd">        True</span>
</span><span id="L-2960"><a href="#L-2960"><span class="linenos">2960</span></a>
</span><span id="L-2961"><a href="#L-2961"><span class="linenos">2961</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a, b): pass&#39;).args.is_enclosed()</span>
</span><span id="L-2962"><a href="#L-2962"><span class="linenos">2962</span></a><span class="sd">        True</span>
</span><span id="L-2963"><a href="#L-2963"><span class="linenos">2963</span></a>
</span><span id="L-2964"><a href="#L-2964"><span class="linenos">2964</span></a><span class="sd">        &gt;&gt;&gt; # because the parentheses belong to the FunctionDef</span>
</span><span id="L-2965"><a href="#L-2965"><span class="linenos">2965</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a,\n b): pass&#39;).args.is_enclosed()</span>
</span><span id="L-2966"><a href="#L-2966"><span class="linenos">2966</span></a><span class="sd">        False</span>
</span><span id="L-2967"><a href="#L-2967"><span class="linenos">2967</span></a>
</span><span id="L-2968"><a href="#L-2968"><span class="linenos">2968</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a,\n b): pass&#39;).args.is_enclosed_in_parents()</span>
</span><span id="L-2969"><a href="#L-2969"><span class="linenos">2969</span></a><span class="sd">        True</span>
</span><span id="L-2970"><a href="#L-2970"><span class="linenos">2970</span></a>
</span><span id="L-2971"><a href="#L-2971"><span class="linenos">2971</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a is not b)&#39;).ops[0].is_enclosed()</span>
</span><span id="L-2972"><a href="#L-2972"><span class="linenos">2972</span></a><span class="sd">        True</span>
</span><span id="L-2973"><a href="#L-2973"><span class="linenos">2973</span></a>
</span><span id="L-2974"><a href="#L-2974"><span class="linenos">2974</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a is \n not b)&#39;).ops[0].is_enclosed()</span>
</span><span id="L-2975"><a href="#L-2975"><span class="linenos">2975</span></a><span class="sd">        False</span>
</span><span id="L-2976"><a href="#L-2976"><span class="linenos">2976</span></a><span class="sd">        ```</span>
</span><span id="L-2977"><a href="#L-2977"><span class="linenos">2977</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2978"><a href="#L-2978"><span class="linenos">2978</span></a>
</span><span id="L-2979"><a href="#L-2979"><span class="linenos">2979</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-2980"><a href="#L-2980"><span class="linenos">2980</span></a>
</span><span id="L-2981"><a href="#L-2981"><span class="linenos">2981</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span> <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">,</span>
</span><span id="L-2982"><a href="#L-2982"><span class="linenos">2982</span></a>                            <span class="n">Name</span><span class="p">,</span> <span class="n">Slice</span><span class="p">,</span>
</span><span id="L-2983"><a href="#L-2983"><span class="linenos">2983</span></a>                            <span class="n">MatchValue</span><span class="p">,</span> <span class="n">MatchSingleton</span><span class="p">,</span> <span class="n">MatchMapping</span><span class="p">,</span>
</span><span id="L-2984"><a href="#L-2984"><span class="linenos">2984</span></a>                            <span class="n">expr_context</span><span class="p">,</span> <span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">type_param</span><span class="p">,</span>
</span><span id="L-2985"><a href="#L-2985"><span class="linenos">2985</span></a>                            <span class="n">stmt</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="L-2986"><a href="#L-2986"><span class="linenos">2986</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2987"><a href="#L-2987"><span class="linenos">2987</span></a>
</span><span id="L-2988"><a href="#L-2988"><span class="linenos">2988</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">):</span>  <span class="c1"># this catches empty `arguments` mostly</span>
</span><span id="L-2989"><a href="#L-2989"><span class="linenos">2989</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2990"><a href="#L-2990"><span class="linenos">2990</span></a>
</span><span id="L-2991"><a href="#L-2991"><span class="linenos">2991</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="n">loc</span>
</span><span id="L-2992"><a href="#L-2992"><span class="linenos">2992</span></a>
</span><span id="L-2993"><a href="#L-2993"><span class="linenos">2993</span></a>        <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">:</span>
</span><span id="L-2994"><a href="#L-2994"><span class="linenos">2994</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2995"><a href="#L-2995"><span class="linenos">2995</span></a>
</span><span id="L-2996"><a href="#L-2996"><span class="linenos">2996</span></a>        <span class="k">if</span> <span class="n">pars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="L-2997"><a href="#L-2997"><span class="linenos">2997</span></a>            <span class="k">return</span> <span class="s1">&#39;pars&#39;</span>
</span><span id="L-2998"><a href="#L-2998"><span class="linenos">2998</span></a>
</span><span id="L-2999"><a href="#L-2999"><span class="linenos">2999</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="L-3000"><a href="#L-3000"><span class="linenos">3000</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
</span><span id="L-3001"><a href="#L-3001"><span class="linenos">3001</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3002"><a href="#L-3002"><span class="linenos">3002</span></a>
</span><span id="L-3003"><a href="#L-3003"><span class="linenos">3003</span></a>            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_multiline_str_continuation_lns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">))</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="o">-</span> <span class="n">ln</span>
</span><span id="L-3004"><a href="#L-3004"><span class="linenos">3004</span></a>
</span><span id="L-3005"><a href="#L-3005"><span class="linenos">3005</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">)):</span>
</span><span id="L-3006"><a href="#L-3006"><span class="linenos">3006</span></a>            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_multiline_fstr_continuation_lns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">))</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="o">-</span> <span class="n">ln</span>
</span><span id="L-3007"><a href="#L-3007"><span class="linenos">3007</span></a>
</span><span id="L-3008"><a href="#L-3008"><span class="linenos">3008</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3009"><a href="#L-3009"><span class="linenos">3009</span></a>            <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="L-3010"><a href="#L-3010"><span class="linenos">3010</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3011"><a href="#L-3011"><span class="linenos">3011</span></a>
</span><span id="L-3012"><a href="#L-3012"><span class="linenos">3012</span></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3013"><a href="#L-3013"><span class="linenos">3013</span></a>            <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="L-3014"><a href="#L-3014"><span class="linenos">3014</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3015"><a href="#L-3015"><span class="linenos">3015</span></a>
</span><span id="L-3016"><a href="#L-3016"><span class="linenos">3016</span></a>        <span class="n">last_ln</span> <span class="o">=</span> <span class="n">ln</span>
</span><span id="L-3017"><a href="#L-3017"><span class="linenos">3017</span></a>        <span class="n">lines</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="L-3018"><a href="#L-3018"><span class="linenos">3018</span></a>
</span><span id="L-3019"><a href="#L-3019"><span class="linenos">3019</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Call</span><span class="p">):</span>
</span><span id="L-3020"><a href="#L-3020"><span class="linenos">3020</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">func</span><span class="p">,</span>
</span><span id="L-3021"><a href="#L-3021"><span class="linenos">3021</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_Call_pars</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="L-3022"><a href="#L-3022"><span class="linenos">3022</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">):</span>
</span><span id="L-3023"><a href="#L-3023"><span class="linenos">3023</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="L-3024"><a href="#L-3024"><span class="linenos">3024</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_Subscript_brackets</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="L-3025"><a href="#L-3025"><span class="linenos">3025</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">):</span>
</span><span id="L-3026"><a href="#L-3026"><span class="linenos">3026</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">cls</span><span class="p">,</span>
</span><span id="L-3027"><a href="#L-3027"><span class="linenos">3027</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_MatchClass_pars</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="L-3028"><a href="#L-3028"><span class="linenos">3028</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># we don&#39;t check always-enclosed statement fields here because statements will never get here</span>
</span><span id="L-3029"><a href="#L-3029"><span class="linenos">3029</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="n">syntax_ordered_children</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="L-3030"><a href="#L-3030"><span class="linenos">3030</span></a>
</span><span id="L-3031"><a href="#L-3031"><span class="linenos">3031</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
</span><span id="L-3032"><a href="#L-3032"><span class="linenos">3032</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="p">(</span><span class="n">childf</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="n">child_end_ln</span> <span class="o">:=</span> <span class="n">loc</span><span class="o">.</span><span class="n">end_ln</span><span class="p">)</span> <span class="o">==</span> <span class="n">last_ln</span><span class="p">:</span>
</span><span id="L-3033"><a href="#L-3033"><span class="linenos">3033</span></a>                <span class="k">continue</span>
</span><span id="L-3034"><a href="#L-3034"><span class="linenos">3034</span></a>
</span><span id="L-3035"><a href="#L-3035"><span class="linenos">3035</span></a>            <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_ln</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">ln</span><span class="p">):</span>
</span><span id="L-3036"><a href="#L-3036"><span class="linenos">3036</span></a>                <span class="k">if</span> <span class="n">re_line_end_cont_or_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="L-3037"><a href="#L-3037"><span class="linenos">3037</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3038"><a href="#L-3038"><span class="linenos">3038</span></a>
</span><span id="L-3039"><a href="#L-3039"><span class="linenos">3039</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">childf</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-3040"><a href="#L-3040"><span class="linenos">3040</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3041"><a href="#L-3041"><span class="linenos">3041</span></a>
</span><span id="L-3042"><a href="#L-3042"><span class="linenos">3042</span></a>            <span class="n">last_ln</span> <span class="o">=</span> <span class="n">child_end_ln</span>
</span><span id="L-3043"><a href="#L-3043"><span class="linenos">3043</span></a>
</span><span id="L-3044"><a href="#L-3044"><span class="linenos">3044</span></a>        <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_ln</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">):</span>  <span class="c1"># tail</span>
</span><span id="L-3045"><a href="#L-3045"><span class="linenos">3045</span></a>            <span class="k">if</span> <span class="n">re_line_end_cont_or_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="L-3046"><a href="#L-3046"><span class="linenos">3046</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3047"><a href="#L-3047"><span class="linenos">3047</span></a>
</span><span id="L-3048"><a href="#L-3048"><span class="linenos">3048</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3049"><a href="#L-3049"><span class="linenos">3049</span></a>
</span><span id="L-3050"><a href="#L-3050"><span class="linenos">3050</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed_in_parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-3051"><a href="#L-3051"><span class="linenos">3051</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is enclosed by some parent up the tree. This is different from `is_enclosed()` as it does not</span>
</span><span id="L-3052"><a href="#L-3052"><span class="linenos">3052</span></a><span class="sd">        check for line continuations or anyting like that, just enclosing delimiters like from `Call` or `FunctionDef`</span>
</span><span id="L-3053"><a href="#L-3053"><span class="linenos">3053</span></a><span class="sd">        arguments parentheses, `List` brackets, `FormattedValue`, parent grouping parentheses, etc... Statements do not</span>
</span><span id="L-3054"><a href="#L-3054"><span class="linenos">3054</span></a><span class="sd">        generally enclose except for a few parts of things like `FunctionDef.args` or `type_params`, `ClassDef.bases`,</span>
</span><span id="L-3055"><a href="#L-3055"><span class="linenos">3055</span></a><span class="sd">        etc...</span>
</span><span id="L-3056"><a href="#L-3056"><span class="linenos">3056</span></a>
</span><span id="L-3057"><a href="#L-3057"><span class="linenos">3057</span></a><span class="sd">        **Parameters:**</span>
</span><span id="L-3058"><a href="#L-3058"><span class="linenos">3058</span></a><span class="sd">        - `field`: This is meant to allow check for nonexistent child which would go into this field of `self`. If this</span>
</span><span id="L-3059"><a href="#L-3059"><span class="linenos">3059</span></a><span class="sd">            is not `None` then `self` is considered the first parent with an imaginary child being checked at `field`.</span>
</span><span id="L-3060"><a href="#L-3060"><span class="linenos">3060</span></a>
</span><span id="L-3061"><a href="#L-3061"><span class="linenos">3061</span></a><span class="sd">        **WARNING!** This will not pick up parentheses which belong to `self` and the rules for this can be confusing. E.g.</span>
</span><span id="L-3062"><a href="#L-3062"><span class="linenos">3062</span></a><span class="sd">        in `with (x): pass` the parentheses belong to the variable `x` while `with (x as y): pass` they belong to the</span>
</span><span id="L-3063"><a href="#L-3063"><span class="linenos">3063</span></a><span class="sd">        `with` because `alias`es cannot be parenthesized.</span>
</span><span id="L-3064"><a href="#L-3064"><span class="linenos">3064</span></a>
</span><span id="L-3065"><a href="#L-3065"><span class="linenos">3065</span></a><span class="sd">        Will pick up parentheses which belong to `self` if `field` is passed because in that case `self` is considered</span>
</span><span id="L-3066"><a href="#L-3066"><span class="linenos">3066</span></a><span class="sd">        the first parent and we are really considering the node which would live at `field`, whether it exists or not.</span>
</span><span id="L-3067"><a href="#L-3067"><span class="linenos">3067</span></a>
</span><span id="L-3068"><a href="#L-3068"><span class="linenos">3068</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3069"><a href="#L-3069"><span class="linenos">3069</span></a><span class="sd">        ```py</span>
</span><span id="L-3070"><a href="#L-3070"><span class="linenos">3070</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1 + 2&#39;).left.is_enclosed_in_parents()</span>
</span><span id="L-3071"><a href="#L-3071"><span class="linenos">3071</span></a><span class="sd">        False</span>
</span><span id="L-3072"><a href="#L-3072"><span class="linenos">3072</span></a>
</span><span id="L-3073"><a href="#L-3073"><span class="linenos">3073</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1 + 2)&#39;).left.is_enclosed_in_parents()</span>
</span><span id="L-3074"><a href="#L-3074"><span class="linenos">3074</span></a><span class="sd">        True</span>
</span><span id="L-3075"><a href="#L-3075"><span class="linenos">3075</span></a>
</span><span id="L-3076"><a href="#L-3076"><span class="linenos">3076</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1 + 2)&#39;).is_enclosed_in_parents()  # because owns the parentheses</span>
</span><span id="L-3077"><a href="#L-3077"><span class="linenos">3077</span></a><span class="sd">        False</span>
</span><span id="L-3078"><a href="#L-3078"><span class="linenos">3078</span></a>
</span><span id="L-3079"><a href="#L-3079"><span class="linenos">3079</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1 + 2]&#39;).elts[0].left.is_enclosed_in_parents()</span>
</span><span id="L-3080"><a href="#L-3080"><span class="linenos">3080</span></a><span class="sd">        True</span>
</span><span id="L-3081"><a href="#L-3081"><span class="linenos">3081</span></a>
</span><span id="L-3082"><a href="#L-3082"><span class="linenos">3082</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1 + 2]&#39;).elts[0].is_enclosed_in_parents()</span>
</span><span id="L-3083"><a href="#L-3083"><span class="linenos">3083</span></a><span class="sd">        True</span>
</span><span id="L-3084"><a href="#L-3084"><span class="linenos">3084</span></a>
</span><span id="L-3085"><a href="#L-3085"><span class="linenos">3085</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f(1)&#39;).args[0].is_enclosed_in_parents()</span>
</span><span id="L-3086"><a href="#L-3086"><span class="linenos">3086</span></a><span class="sd">        True</span>
</span><span id="L-3087"><a href="#L-3087"><span class="linenos">3087</span></a>
</span><span id="L-3088"><a href="#L-3088"><span class="linenos">3088</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{1}&quot;&#39;).values[0].value.is_enclosed_in_parents()</span>
</span><span id="L-3089"><a href="#L-3089"><span class="linenos">3089</span></a><span class="sd">        True</span>
</span><span id="L-3090"><a href="#L-3090"><span class="linenos">3090</span></a>
</span><span id="L-3091"><a href="#L-3091"><span class="linenos">3091</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_enclosed_in_parents()</span>
</span><span id="L-3092"><a href="#L-3092"><span class="linenos">3092</span></a><span class="sd">        False</span>
</span><span id="L-3093"><a href="#L-3093"><span class="linenos">3093</span></a>
</span><span id="L-3094"><a href="#L-3094"><span class="linenos">3094</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_enclosed_in_parents(field=&#39;elts&#39;)</span>
</span><span id="L-3095"><a href="#L-3095"><span class="linenos">3095</span></a><span class="sd">        True</span>
</span><span id="L-3096"><a href="#L-3096"><span class="linenos">3096</span></a>
</span><span id="L-3097"><a href="#L-3097"><span class="linenos">3097</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;with (x): pass&#39;).items[0].is_enclosed_in_parents()</span>
</span><span id="L-3098"><a href="#L-3098"><span class="linenos">3098</span></a><span class="sd">        False</span>
</span><span id="L-3099"><a href="#L-3099"><span class="linenos">3099</span></a>
</span><span id="L-3100"><a href="#L-3100"><span class="linenos">3100</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;with (x as y): pass&#39;).items[0].is_enclosed_in_parents()</span>
</span><span id="L-3101"><a href="#L-3101"><span class="linenos">3101</span></a><span class="sd">        True</span>
</span><span id="L-3102"><a href="#L-3102"><span class="linenos">3102</span></a><span class="sd">        ```</span>
</span><span id="L-3103"><a href="#L-3103"><span class="linenos">3103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3104"><a href="#L-3104"><span class="linenos">3104</span></a>
</span><span id="L-3105"><a href="#L-3105"><span class="linenos">3105</span></a>        <span class="k">if</span> <span class="n">field</span><span class="p">:</span>
</span><span id="L-3106"><a href="#L-3106"><span class="linenos">3106</span></a>            <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="s1">&#39;ctx&#39;</span><span class="p">:</span>  <span class="c1"># so that the `ctx` of a List is not considered enclosed</span>
</span><span id="L-3107"><a href="#L-3107"><span class="linenos">3107</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">nspace</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">pfield</span><span class="o">=</span><span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
</span><span id="L-3108"><a href="#L-3108"><span class="linenos">3108</span></a>
</span><span id="L-3109"><a href="#L-3109"><span class="linenos">3109</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">expr_context</span><span class="p">):</span>  <span class="c1"># so that the `ctx` of a List is not considered enclosed</span>
</span><span id="L-3110"><a href="#L-3110"><span class="linenos">3110</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="L-3111"><a href="#L-3111"><span class="linenos">3111</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3112"><a href="#L-3112"><span class="linenos">3112</span></a>
</span><span id="L-3113"><a href="#L-3113"><span class="linenos">3113</span></a>        <span class="k">while</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="L-3114"><a href="#L-3114"><span class="linenos">3114</span></a>            <span class="n">parenta</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span>
</span><span id="L-3115"><a href="#L-3115"><span class="linenos">3115</span></a>
</span><span id="L-3116"><a href="#L-3116"><span class="linenos">3116</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span>
</span><span id="L-3117"><a href="#L-3117"><span class="linenos">3117</span></a>                                    <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">,</span>
</span><span id="L-3118"><a href="#L-3118"><span class="linenos">3118</span></a>                                    <span class="n">MatchMapping</span><span class="p">)):</span>
</span><span id="L-3119"><a href="#L-3119"><span class="linenos">3119</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3120"><a href="#L-3120"><span class="linenos">3120</span></a>
</span><span id="L-3121"><a href="#L-3121"><span class="linenos">3121</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">AsyncFunctionDef</span><span class="p">)):</span>
</span><span id="L-3122"><a href="#L-3122"><span class="linenos">3122</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span>
</span><span id="L-3123"><a href="#L-3123"><span class="linenos">3123</span></a>
</span><span id="L-3124"><a href="#L-3124"><span class="linenos">3124</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">ClassDef</span><span class="p">):</span>
</span><span id="L-3125"><a href="#L-3125"><span class="linenos">3125</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="s1">&#39;bases&#39;</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">)</span>
</span><span id="L-3126"><a href="#L-3126"><span class="linenos">3126</span></a>
</span><span id="L-3127"><a href="#L-3127"><span class="linenos">3127</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">TypeAlias</span><span class="p">):</span>
</span><span id="L-3128"><a href="#L-3128"><span class="linenos">3128</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;type_params&#39;</span>
</span><span id="L-3129"><a href="#L-3129"><span class="linenos">3129</span></a>
</span><span id="L-3130"><a href="#L-3130"><span class="linenos">3130</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">ImportFrom</span><span class="p">):</span>
</span><span id="L-3131"><a href="#L-3131"><span class="linenos">3131</span></a>                <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_is_parenthesized_ImportFrom_names</span><span class="p">()</span>  <span class="c1"># we know we are in `names`</span>
</span><span id="L-3132"><a href="#L-3132"><span class="linenos">3132</span></a>
</span><span id="L-3133"><a href="#L-3133"><span class="linenos">3133</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">With</span><span class="p">,</span> <span class="n">AsyncWith</span><span class="p">)):</span>
</span><span id="L-3134"><a href="#L-3134"><span class="linenos">3134</span></a>                <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_is_parenthesized_With_items</span><span class="p">()</span>  <span class="c1"># we know we are in `names`</span>
</span><span id="L-3135"><a href="#L-3135"><span class="linenos">3135</span></a>
</span><span id="L-3136"><a href="#L-3136"><span class="linenos">3136</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="L-3137"><a href="#L-3137"><span class="linenos">3137</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3138"><a href="#L-3138"><span class="linenos">3138</span></a>
</span><span id="L-3139"><a href="#L-3139"><span class="linenos">3139</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">Call</span><span class="p">):</span>
</span><span id="L-3140"><a href="#L-3140"><span class="linenos">3140</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;args&#39;</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">):</span>
</span><span id="L-3141"><a href="#L-3141"><span class="linenos">3141</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3142"><a href="#L-3142"><span class="linenos">3142</span></a>
</span><span id="L-3143"><a href="#L-3143"><span class="linenos">3143</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">):</span>
</span><span id="L-3144"><a href="#L-3144"><span class="linenos">3144</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;slice&#39;</span><span class="p">:</span>
</span><span id="L-3145"><a href="#L-3145"><span class="linenos">3145</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3146"><a href="#L-3146"><span class="linenos">3146</span></a>
</span><span id="L-3147"><a href="#L-3147"><span class="linenos">3147</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">):</span>
</span><span id="L-3148"><a href="#L-3148"><span class="linenos">3148</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">,</span> <span class="s1">&#39;kwd_attrs&#39;</span><span class="p">,</span> <span class="s1">&#39;kwd_patterns&#39;</span><span class="p">):</span>
</span><span id="L-3149"><a href="#L-3149"><span class="linenos">3149</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3150"><a href="#L-3150"><span class="linenos">3150</span></a>
</span><span id="L-3151"><a href="#L-3151"><span class="linenos">3151</span></a>            <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3152"><a href="#L-3152"><span class="linenos">3152</span></a>                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="L-3153"><a href="#L-3153"><span class="linenos">3153</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3154"><a href="#L-3154"><span class="linenos">3154</span></a>
</span><span id="L-3155"><a href="#L-3155"><span class="linenos">3155</span></a>            <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3156"><a href="#L-3156"><span class="linenos">3156</span></a>                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="L-3157"><a href="#L-3157"><span class="linenos">3157</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3158"><a href="#L-3158"><span class="linenos">3158</span></a>
</span><span id="L-3159"><a href="#L-3159"><span class="linenos">3159</span></a>            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">pars</span><span class="p">(),</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>  <span class="c1"># could be empty args which has None for a loc</span>
</span><span id="L-3160"><a href="#L-3160"><span class="linenos">3160</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3161"><a href="#L-3161"><span class="linenos">3161</span></a>
</span><span id="L-3162"><a href="#L-3162"><span class="linenos">3162</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="L-3163"><a href="#L-3163"><span class="linenos">3163</span></a>
</span><span id="L-3164"><a href="#L-3164"><span class="linenos">3164</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3165"><a href="#L-3165"><span class="linenos">3165</span></a>
</span><span id="L-3166"><a href="#L-3166"><span class="linenos">3166</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parenthesized_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3167"><a href="#L-3167"><span class="linenos">3167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a parenthesized `Tuple` or not, or not a `Tuple` at all.</span>
</span><span id="L-3168"><a href="#L-3168"><span class="linenos">3168</span></a>
</span><span id="L-3169"><a href="#L-3169"><span class="linenos">3169</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-3170"><a href="#L-3170"><span class="linenos">3170</span></a><span class="sd">        - `True` if is parenthesized `Tuple`, `False` if is unparenthesized `Tuple`, `None` if is not `Tuple` at all.</span>
</span><span id="L-3171"><a href="#L-3171"><span class="linenos">3171</span></a>
</span><span id="L-3172"><a href="#L-3172"><span class="linenos">3172</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3173"><a href="#L-3173"><span class="linenos">3173</span></a><span class="sd">        ```py</span>
</span><span id="L-3174"><a href="#L-3174"><span class="linenos">3174</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;).is_parenthesized_tuple()</span>
</span><span id="L-3175"><a href="#L-3175"><span class="linenos">3175</span></a><span class="sd">        False</span>
</span><span id="L-3176"><a href="#L-3176"><span class="linenos">3176</span></a>
</span><span id="L-3177"><a href="#L-3177"><span class="linenos">3177</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).is_parenthesized_tuple()</span>
</span><span id="L-3178"><a href="#L-3178"><span class="linenos">3178</span></a><span class="sd">        True</span>
</span><span id="L-3179"><a href="#L-3179"><span class="linenos">3179</span></a>
</span><span id="L-3180"><a href="#L-3180"><span class="linenos">3180</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;1&#39;).is_parenthesized_tuple())</span>
</span><span id="L-3181"><a href="#L-3181"><span class="linenos">3181</span></a><span class="sd">        None</span>
</span><span id="L-3182"><a href="#L-3182"><span class="linenos">3182</span></a><span class="sd">        ```</span>
</span><span id="L-3183"><a href="#L-3183"><span class="linenos">3183</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3184"><a href="#L-3184"><span class="linenos">3184</span></a>
</span><span id="L-3185"><a href="#L-3185"><span class="linenos">3185</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3186"><a href="#L-3186"><span class="linenos">3186</span></a>
</span><span id="L-3187"><a href="#L-3187"><span class="linenos">3187</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed_matchseq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3188"><a href="#L-3188"><span class="linenos">3188</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is an enclosed `MatchSequence` or not, or not a `MatchSequence` at all (can be pars `()` or</span>
</span><span id="L-3189"><a href="#L-3189"><span class="linenos">3189</span></a><span class="sd">        brackets `[]`).</span>
</span><span id="L-3190"><a href="#L-3190"><span class="linenos">3190</span></a>
</span><span id="L-3191"><a href="#L-3191"><span class="linenos">3191</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-3192"><a href="#L-3192"><span class="linenos">3192</span></a><span class="sd">        - `True` if is enclosed `MatchSequence`, `False` if is unparenthesized `MatchSequence`, `None` if is not</span>
</span><span id="L-3193"><a href="#L-3193"><span class="linenos">3193</span></a><span class="sd">            `MatchSequence` at all.</span>
</span><span id="L-3194"><a href="#L-3194"><span class="linenos">3194</span></a>
</span><span id="L-3195"><a href="#L-3195"><span class="linenos">3195</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3196"><a href="#L-3196"><span class="linenos">3196</span></a><span class="sd">        ```py</span>
</span><span id="L-3197"><a href="#L-3197"><span class="linenos">3197</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1, 2: pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="L-3198"><a href="#L-3198"><span class="linenos">3198</span></a><span class="sd">        False</span>
</span><span id="L-3199"><a href="#L-3199"><span class="linenos">3199</span></a>
</span><span id="L-3200"><a href="#L-3200"><span class="linenos">3200</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case [1, 2]: pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="L-3201"><a href="#L-3201"><span class="linenos">3201</span></a><span class="sd">        True</span>
</span><span id="L-3202"><a href="#L-3202"><span class="linenos">3202</span></a>
</span><span id="L-3203"><a href="#L-3203"><span class="linenos">3203</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case (1, 2): pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="L-3204"><a href="#L-3204"><span class="linenos">3204</span></a><span class="sd">        True</span>
</span><span id="L-3205"><a href="#L-3205"><span class="linenos">3205</span></a>
</span><span id="L-3206"><a href="#L-3206"><span class="linenos">3206</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;match a:\n  case 1: pass&#39;).cases[0].pattern.is_enclosed_matchseq())</span>
</span><span id="L-3207"><a href="#L-3207"><span class="linenos">3207</span></a><span class="sd">        None</span>
</span><span id="L-3208"><a href="#L-3208"><span class="linenos">3208</span></a><span class="sd">        ```</span>
</span><span id="L-3209"><a href="#L-3209"><span class="linenos">3209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3210"><a href="#L-3210"><span class="linenos">3210</span></a>
</span><span id="L-3211"><a href="#L-3211"><span class="linenos">3211</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="L-3212"><a href="#L-3212"><span class="linenos">3212</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-3213"><a href="#L-3213"><span class="linenos">3213</span></a>
</span><span id="L-3214"><a href="#L-3214"><span class="linenos">3214</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-3215"><a href="#L-3215"><span class="linenos">3215</span></a>        <span class="n">lpar</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># could be end of line</span>
</span><span id="L-3216"><a href="#L-3216"><span class="linenos">3216</span></a>
</span><span id="L-3217"><a href="#L-3217"><span class="linenos">3217</span></a>        <span class="k">if</span> <span class="n">lpar</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
</span><span id="L-3218"><a href="#L-3218"><span class="linenos">3218</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">)</span>
</span><span id="L-3219"><a href="#L-3219"><span class="linenos">3219</span></a>        <span class="k">if</span> <span class="n">lpar</span> <span class="o">==</span> <span class="s1">&#39;[&#39;</span><span class="p">:</span>
</span><span id="L-3220"><a href="#L-3220"><span class="linenos">3220</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
</span><span id="L-3221"><a href="#L-3221"><span class="linenos">3221</span></a>
</span><span id="L-3222"><a href="#L-3222"><span class="linenos">3222</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3223"><a href="#L-3223"><span class="linenos">3223</span></a>
</span><span id="L-3224"><a href="#L-3224"><span class="linenos">3224</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty_set_call</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-3225"><a href="#L-3225"><span class="linenos">3225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an empty `set()` call.</span>
</span><span id="L-3226"><a href="#L-3226"><span class="linenos">3226</span></a>
</span><span id="L-3227"><a href="#L-3227"><span class="linenos">3227</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3228"><a href="#L-3228"><span class="linenos">3228</span></a><span class="sd">        ```py</span>
</span><span id="L-3229"><a href="#L-3229"><span class="linenos">3229</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{1}&#39;).is_empty_set_call()</span>
</span><span id="L-3230"><a href="#L-3230"><span class="linenos">3230</span></a><span class="sd">        False</span>
</span><span id="L-3231"><a href="#L-3231"><span class="linenos">3231</span></a>
</span><span id="L-3232"><a href="#L-3232"><span class="linenos">3232</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;set()&#39;).is_empty_set_call()</span>
</span><span id="L-3233"><a href="#L-3233"><span class="linenos">3233</span></a><span class="sd">        True</span>
</span><span id="L-3234"><a href="#L-3234"><span class="linenos">3234</span></a>
</span><span id="L-3235"><a href="#L-3235"><span class="linenos">3235</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;frozenset()&#39;).is_empty_set_call()</span>
</span><span id="L-3236"><a href="#L-3236"><span class="linenos">3236</span></a><span class="sd">        False</span>
</span><span id="L-3237"><a href="#L-3237"><span class="linenos">3237</span></a>
</span><span id="L-3238"><a href="#L-3238"><span class="linenos">3238</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{*()}&#39;).is_empty_set_call()</span>
</span><span id="L-3239"><a href="#L-3239"><span class="linenos">3239</span></a><span class="sd">        False</span>
</span><span id="L-3240"><a href="#L-3240"><span class="linenos">3240</span></a><span class="sd">        ```</span>
</span><span id="L-3241"><a href="#L-3241"><span class="linenos">3241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3242"><a href="#L-3242"><span class="linenos">3242</span></a>
</span><span id="L-3243"><a href="#L-3243"><span class="linenos">3243</span></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span>
</span><span id="L-3244"><a href="#L-3244"><span class="linenos">3244</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">func</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s1">&#39;set&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">Load</span><span class="p">))</span>
</span><span id="L-3245"><a href="#L-3245"><span class="linenos">3245</span></a>
</span><span id="L-3246"><a href="#L-3246"><span class="linenos">3246</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty_set_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-3247"><a href="#L-3247"><span class="linenos">3247</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an empty `Set` from an empty `Starred` `Constant` sequence, recognized are `{*()}`, `{*[]}`</span>
</span><span id="L-3248"><a href="#L-3248"><span class="linenos">3248</span></a><span class="sd">        and `{*{}}`.</span>
</span><span id="L-3249"><a href="#L-3249"><span class="linenos">3249</span></a>
</span><span id="L-3250"><a href="#L-3250"><span class="linenos">3250</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3251"><a href="#L-3251"><span class="linenos">3251</span></a><span class="sd">        ```py</span>
</span><span id="L-3252"><a href="#L-3252"><span class="linenos">3252</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{1}&#39;).is_empty_set_seq()</span>
</span><span id="L-3253"><a href="#L-3253"><span class="linenos">3253</span></a><span class="sd">        False</span>
</span><span id="L-3254"><a href="#L-3254"><span class="linenos">3254</span></a>
</span><span id="L-3255"><a href="#L-3255"><span class="linenos">3255</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{*()}&#39;).is_empty_set_seq()</span>
</span><span id="L-3256"><a href="#L-3256"><span class="linenos">3256</span></a><span class="sd">        True</span>
</span><span id="L-3257"><a href="#L-3257"><span class="linenos">3257</span></a>
</span><span id="L-3258"><a href="#L-3258"><span class="linenos">3258</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;set()&#39;).is_empty_set_seq()</span>
</span><span id="L-3259"><a href="#L-3259"><span class="linenos">3259</span></a><span class="sd">        False</span>
</span><span id="L-3260"><a href="#L-3260"><span class="linenos">3260</span></a><span class="sd">        ```</span>
</span><span id="L-3261"><a href="#L-3261"><span class="linenos">3261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3262"><a href="#L-3262"><span class="linenos">3262</span></a>
</span><span id="L-3263"><a href="#L-3263"><span class="linenos">3263</span></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Set</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">elts</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">elts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e0</span> <span class="o">:=</span> <span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Starred</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="L-3264"><a href="#L-3264"><span class="linenos">3264</span></a>                <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="n">e0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">elts</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Dict</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">keys</span><span class="p">)))</span>
</span><span id="L-3265"><a href="#L-3265"><span class="linenos">3265</span></a>
</span><span id="L-3266"><a href="#L-3266"><span class="linenos">3266</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_elif</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3267"><a href="#L-3267"><span class="linenos">3267</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is an `elif` or not, or not an `If` at all.</span>
</span><span id="L-3268"><a href="#L-3268"><span class="linenos">3268</span></a>
</span><span id="L-3269"><a href="#L-3269"><span class="linenos">3269</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-3270"><a href="#L-3270"><span class="linenos">3270</span></a><span class="sd">        - `True` if is `elif` `If`, `False` if is normal `If`, `None` if is not `If` at all.</span>
</span><span id="L-3271"><a href="#L-3271"><span class="linenos">3271</span></a>
</span><span id="L-3272"><a href="#L-3272"><span class="linenos">3272</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3273"><a href="#L-3273"><span class="linenos">3273</span></a><span class="sd">        ```py</span>
</span><span id="L-3274"><a href="#L-3274"><span class="linenos">3274</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: pass\nelif 2: pass&#39;).orelse[0].is_elif()</span>
</span><span id="L-3275"><a href="#L-3275"><span class="linenos">3275</span></a><span class="sd">        True</span>
</span><span id="L-3276"><a href="#L-3276"><span class="linenos">3276</span></a>
</span><span id="L-3277"><a href="#L-3277"><span class="linenos">3277</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: pass\nelse:\n  if 2: pass&#39;).orelse[0].is_elif()</span>
</span><span id="L-3278"><a href="#L-3278"><span class="linenos">3278</span></a><span class="sd">        False</span>
</span><span id="L-3279"><a href="#L-3279"><span class="linenos">3279</span></a>
</span><span id="L-3280"><a href="#L-3280"><span class="linenos">3280</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: pass\nelse:\n  i = 2&#39;).orelse[0].is_elif())</span>
</span><span id="L-3281"><a href="#L-3281"><span class="linenos">3281</span></a><span class="sd">        None</span>
</span><span id="L-3282"><a href="#L-3282"><span class="linenos">3282</span></a><span class="sd">        ```</span>
</span><span id="L-3283"><a href="#L-3283"><span class="linenos">3283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3284"><a href="#L-3284"><span class="linenos">3284</span></a>
</span><span id="L-3285"><a href="#L-3285"><span class="linenos">3285</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span><span class="o">.</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;elif&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">col</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">If</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-3286"><a href="#L-3286"><span class="linenos">3286</span></a>
</span><span id="L-3287"><a href="#L-3287"><span class="linenos">3287</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_class_base</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3288"><a href="#L-3288"><span class="linenos">3288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `ClassDef` base in list without any keywords, or not a class base at all.</span>
</span><span id="L-3289"><a href="#L-3289"><span class="linenos">3289</span></a>
</span><span id="L-3290"><a href="#L-3290"><span class="linenos">3290</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-3291"><a href="#L-3291"><span class="linenos">3291</span></a><span class="sd">        - `True` if is solo class base, `False` if is class base, but not solo and `None` if is not class base at all.</span>
</span><span id="L-3292"><a href="#L-3292"><span class="linenos">3292</span></a>
</span><span id="L-3293"><a href="#L-3293"><span class="linenos">3293</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3294"><a href="#L-3294"><span class="linenos">3294</span></a><span class="sd">        ```py</span>
</span><span id="L-3295"><a href="#L-3295"><span class="linenos">3295</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="L-3296"><a href="#L-3296"><span class="linenos">3296</span></a><span class="sd">        True</span>
</span><span id="L-3297"><a href="#L-3297"><span class="linenos">3297</span></a>
</span><span id="L-3298"><a href="#L-3298"><span class="linenos">3298</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1, b2): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="L-3299"><a href="#L-3299"><span class="linenos">3299</span></a><span class="sd">        False</span>
</span><span id="L-3300"><a href="#L-3300"><span class="linenos">3300</span></a>
</span><span id="L-3301"><a href="#L-3301"><span class="linenos">3301</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1, meta=m): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="L-3302"><a href="#L-3302"><span class="linenos">3302</span></a><span class="sd">        False</span>
</span><span id="L-3303"><a href="#L-3303"><span class="linenos">3303</span></a>
</span><span id="L-3304"><a href="#L-3304"><span class="linenos">3304</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;class cls(b1, meta=m): pass&#39;).keywords[0].is_solo_class_base())</span>
</span><span id="L-3305"><a href="#L-3305"><span class="linenos">3305</span></a><span class="sd">        None</span>
</span><span id="L-3306"><a href="#L-3306"><span class="linenos">3306</span></a><span class="sd">        ```</span>
</span><span id="L-3307"><a href="#L-3307"><span class="linenos">3307</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3308"><a href="#L-3308"><span class="linenos">3308</span></a>
</span><span id="L-3309"><a href="#L-3309"><span class="linenos">3309</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;bases&#39;</span><span class="p">:</span>
</span><span id="L-3310"><a href="#L-3310"><span class="linenos">3310</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-3311"><a href="#L-3311"><span class="linenos">3311</span></a>
</span><span id="L-3312"><a href="#L-3312"><span class="linenos">3312</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">((</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">bases</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span>
</span><span id="L-3313"><a href="#L-3313"><span class="linenos">3313</span></a>
</span><span id="L-3314"><a href="#L-3314"><span class="linenos">3314</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_call_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-3315"><a href="#L-3315"><span class="linenos">3315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `Call` non-keyword argument.</span>
</span><span id="L-3316"><a href="#L-3316"><span class="linenos">3316</span></a>
</span><span id="L-3317"><a href="#L-3317"><span class="linenos">3317</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3318"><a href="#L-3318"><span class="linenos">3318</span></a><span class="sd">        ```py</span>
</span><span id="L-3319"><a href="#L-3319"><span class="linenos">3319</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].is_solo_call_arg()</span>
</span><span id="L-3320"><a href="#L-3320"><span class="linenos">3320</span></a><span class="sd">        True</span>
</span><span id="L-3321"><a href="#L-3321"><span class="linenos">3321</span></a>
</span><span id="L-3322"><a href="#L-3322"><span class="linenos">3322</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a, b)&#39;).args[0].is_solo_call_arg()</span>
</span><span id="L-3323"><a href="#L-3323"><span class="linenos">3323</span></a><span class="sd">        False</span>
</span><span id="L-3324"><a href="#L-3324"><span class="linenos">3324</span></a>
</span><span id="L-3325"><a href="#L-3325"><span class="linenos">3325</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in range(3))&#39;).args[0].is_solo_call_arg()</span>
</span><span id="L-3326"><a href="#L-3326"><span class="linenos">3326</span></a><span class="sd">        True</span>
</span><span id="L-3327"><a href="#L-3327"><span class="linenos">3327</span></a><span class="sd">        ```</span>
</span><span id="L-3328"><a href="#L-3328"><span class="linenos">3328</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3329"><a href="#L-3329"><span class="linenos">3329</span></a>
</span><span id="L-3330"><a href="#L-3330"><span class="linenos">3330</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="L-3331"><a href="#L-3331"><span class="linenos">3331</span></a>                <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-3332"><a href="#L-3332"><span class="linenos">3332</span></a>
</span><span id="L-3333"><a href="#L-3333"><span class="linenos">3333</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_call_arg_genexp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-3334"><a href="#L-3334"><span class="linenos">3334</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is the dreaded solo call non-keyword argument generator expression in `sum(i for i in a)`.</span>
</span><span id="L-3335"><a href="#L-3335"><span class="linenos">3335</span></a><span class="sd">        This function doesn&#39;t say if it shares its parentheses or not, so it could still be `sum((i for i in a))` or</span>
</span><span id="L-3336"><a href="#L-3336"><span class="linenos">3336</span></a><span class="sd">        even `sum(((i for i in a)))`. To differentiate that see `pars(shared=False)`.</span>
</span><span id="L-3337"><a href="#L-3337"><span class="linenos">3337</span></a>
</span><span id="L-3338"><a href="#L-3338"><span class="linenos">3338</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3339"><a href="#L-3339"><span class="linenos">3339</span></a><span class="sd">        ```py</span>
</span><span id="L-3340"><a href="#L-3340"><span class="linenos">3340</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in range(3))&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="L-3341"><a href="#L-3341"><span class="linenos">3341</span></a><span class="sd">        True</span>
</span><span id="L-3342"><a href="#L-3342"><span class="linenos">3342</span></a>
</span><span id="L-3343"><a href="#L-3343"><span class="linenos">3343</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in range(3)))&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="L-3344"><a href="#L-3344"><span class="linenos">3344</span></a><span class="sd">        True</span>
</span><span id="L-3345"><a href="#L-3345"><span class="linenos">3345</span></a>
</span><span id="L-3346"><a href="#L-3346"><span class="linenos">3346</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in range(3)), b)&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="L-3347"><a href="#L-3347"><span class="linenos">3347</span></a><span class="sd">        False</span>
</span><span id="L-3348"><a href="#L-3348"><span class="linenos">3348</span></a>
</span><span id="L-3349"><a href="#L-3349"><span class="linenos">3349</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="L-3350"><a href="#L-3350"><span class="linenos">3350</span></a><span class="sd">        False</span>
</span><span id="L-3351"><a href="#L-3351"><span class="linenos">3351</span></a><span class="sd">        ```</span>
</span><span id="L-3352"><a href="#L-3352"><span class="linenos">3352</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3353"><a href="#L-3353"><span class="linenos">3353</span></a>
</span><span id="L-3354"><a href="#L-3354"><span class="linenos">3354</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="L-3355"><a href="#L-3355"><span class="linenos">3355</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-3356"><a href="#L-3356"><span class="linenos">3356</span></a>
</span><span id="L-3357"><a href="#L-3357"><span class="linenos">3357</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_matchcls_pat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-3358"><a href="#L-3358"><span class="linenos">3358</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `MatchClass` non-keyword pattern. The solo `Constant` held by a `MatchValue`</span>
</span><span id="L-3359"><a href="#L-3359"><span class="linenos">3359</span></a><span class="sd">        qualifies as `True` for this check if the `MatchValue` does.</span>
</span><span id="L-3360"><a href="#L-3360"><span class="linenos">3360</span></a>
</span><span id="L-3361"><a href="#L-3361"><span class="linenos">3361</span></a><span class="sd">        **Examples:**</span>
</span><span id="L-3362"><a href="#L-3362"><span class="linenos">3362</span></a><span class="sd">        ```py</span>
</span><span id="L-3363"><a href="#L-3363"><span class="linenos">3363</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n  case cls(a): pass&#39;)</span>
</span><span id="L-3364"><a href="#L-3364"><span class="linenos">3364</span></a><span class="sd">        ...  .cases[0].pattern.patterns[0].is_solo_matchcls_pat())</span>
</span><span id="L-3365"><a href="#L-3365"><span class="linenos">3365</span></a><span class="sd">        True</span>
</span><span id="L-3366"><a href="#L-3366"><span class="linenos">3366</span></a>
</span><span id="L-3367"><a href="#L-3367"><span class="linenos">3367</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n  case cls(a, b): pass&#39;)</span>
</span><span id="L-3368"><a href="#L-3368"><span class="linenos">3368</span></a><span class="sd">        ...  .cases[0].pattern.patterns[0].is_solo_matchcls_pat())</span>
</span><span id="L-3369"><a href="#L-3369"><span class="linenos">3369</span></a><span class="sd">        False</span>
</span><span id="L-3370"><a href="#L-3370"><span class="linenos">3370</span></a><span class="sd">        ```</span>
</span><span id="L-3371"><a href="#L-3371"><span class="linenos">3371</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-3372"><a href="#L-3372"><span class="linenos">3372</span></a>
</span><span id="L-3373"><a href="#L-3373"><span class="linenos">3373</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="L-3374"><a href="#L-3374"><span class="linenos">3374</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3375"><a href="#L-3375"><span class="linenos">3375</span></a>
</span><span id="L-3376"><a href="#L-3376"><span class="linenos">3376</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchValue</span><span class="p">):</span>
</span><span id="L-3377"><a href="#L-3377"><span class="linenos">3377</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="L-3378"><a href="#L-3378"><span class="linenos">3378</span></a>
</span><span id="L-3379"><a href="#L-3379"><span class="linenos">3379</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;patterns&#39;</span> <span class="ow">and</span>
</span><span id="L-3380"><a href="#L-3380"><span class="linenos">3380</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">kwd_patterns</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">patterns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-3381"><a href="#L-3381"><span class="linenos">3381</span></a>
</span><span id="L-3382"><a href="#L-3382"><span class="linenos">3382</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-3383"><a href="#L-3383"><span class="linenos">3383</span></a>    <span class="c1"># Private and other misc stuff</span>
</span><span id="L-3384"><a href="#L-3384"><span class="linenos">3384</span></a>
</span><span id="L-3385"><a href="#L-3385"><span class="linenos">3385</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_misc</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-3386"><a href="#L-3386"><span class="linenos">3386</span></a>        <span class="n">_new_empty_module</span><span class="p">,</span>
</span><span id="L-3387"><a href="#L-3387"><span class="linenos">3387</span></a>        <span class="n">_new_empty_tuple</span><span class="p">,</span>
</span><span id="L-3388"><a href="#L-3388"><span class="linenos">3388</span></a>        <span class="n">_new_empty_list</span><span class="p">,</span>
</span><span id="L-3389"><a href="#L-3389"><span class="linenos">3389</span></a>        <span class="n">_new_empty_dict</span><span class="p">,</span>
</span><span id="L-3390"><a href="#L-3390"><span class="linenos">3390</span></a>        <span class="n">_new_empty_set</span><span class="p">,</span>
</span><span id="L-3391"><a href="#L-3391"><span class="linenos">3391</span></a>        <span class="n">_new_empty_set_curlies</span><span class="p">,</span>
</span><span id="L-3392"><a href="#L-3392"><span class="linenos">3392</span></a>        <span class="n">_make_fst_tree</span><span class="p">,</span>
</span><span id="L-3393"><a href="#L-3393"><span class="linenos">3393</span></a>        <span class="n">_unmake_fst_tree</span><span class="p">,</span>
</span><span id="L-3394"><a href="#L-3394"><span class="linenos">3394</span></a>        <span class="n">_unmake_fst_parents</span><span class="p">,</span>
</span><span id="L-3395"><a href="#L-3395"><span class="linenos">3395</span></a>        <span class="n">_set_ast</span><span class="p">,</span>
</span><span id="L-3396"><a href="#L-3396"><span class="linenos">3396</span></a>        <span class="n">_set_ctx</span><span class="p">,</span>
</span><span id="L-3397"><a href="#L-3397"><span class="linenos">3397</span></a>        <span class="n">_repr_tail</span><span class="p">,</span>
</span><span id="L-3398"><a href="#L-3398"><span class="linenos">3398</span></a>        <span class="n">_dump</span><span class="p">,</span>
</span><span id="L-3399"><a href="#L-3399"><span class="linenos">3399</span></a>        <span class="n">_next_bound</span><span class="p">,</span>
</span><span id="L-3400"><a href="#L-3400"><span class="linenos">3400</span></a>        <span class="n">_prev_bound</span><span class="p">,</span>
</span><span id="L-3401"><a href="#L-3401"><span class="linenos">3401</span></a>        <span class="n">_next_bound_step</span><span class="p">,</span>
</span><span id="L-3402"><a href="#L-3402"><span class="linenos">3402</span></a>        <span class="n">_prev_bound_step</span><span class="p">,</span>
</span><span id="L-3403"><a href="#L-3403"><span class="linenos">3403</span></a>        <span class="n">_loc_block_header_end</span><span class="p">,</span>
</span><span id="L-3404"><a href="#L-3404"><span class="linenos">3404</span></a>        <span class="n">_loc_operator</span><span class="p">,</span>
</span><span id="L-3405"><a href="#L-3405"><span class="linenos">3405</span></a>        <span class="n">_loc_comprehension</span><span class="p">,</span>
</span><span id="L-3406"><a href="#L-3406"><span class="linenos">3406</span></a>        <span class="n">_loc_arguments</span><span class="p">,</span>
</span><span id="L-3407"><a href="#L-3407"><span class="linenos">3407</span></a>        <span class="n">_loc_arguments_empty</span><span class="p">,</span>
</span><span id="L-3408"><a href="#L-3408"><span class="linenos">3408</span></a>        <span class="n">_loc_lambda_args_entire</span><span class="p">,</span>
</span><span id="L-3409"><a href="#L-3409"><span class="linenos">3409</span></a>        <span class="n">_loc_withitem</span><span class="p">,</span>
</span><span id="L-3410"><a href="#L-3410"><span class="linenos">3410</span></a>        <span class="n">_loc_match_case</span><span class="p">,</span>
</span><span id="L-3411"><a href="#L-3411"><span class="linenos">3411</span></a>        <span class="n">_loc_Call_pars</span><span class="p">,</span>
</span><span id="L-3412"><a href="#L-3412"><span class="linenos">3412</span></a>        <span class="n">_loc_Subscript_brackets</span><span class="p">,</span>
</span><span id="L-3413"><a href="#L-3413"><span class="linenos">3413</span></a>        <span class="n">_loc_MatchClass_pars</span><span class="p">,</span>
</span><span id="L-3414"><a href="#L-3414"><span class="linenos">3414</span></a>        <span class="n">_loc_Global_Nonlocal_names</span><span class="p">,</span>
</span><span id="L-3415"><a href="#L-3415"><span class="linenos">3415</span></a>        <span class="n">_is_arguments_empty</span><span class="p">,</span>
</span><span id="L-3416"><a href="#L-3416"><span class="linenos">3416</span></a>        <span class="n">_is_parenthesized_ImportFrom_names</span><span class="p">,</span>
</span><span id="L-3417"><a href="#L-3417"><span class="linenos">3417</span></a>        <span class="n">_is_parenthesized_With_items</span><span class="p">,</span>
</span><span id="L-3418"><a href="#L-3418"><span class="linenos">3418</span></a>        <span class="n">_is_parenthesized_seq</span><span class="p">,</span>
</span><span id="L-3419"><a href="#L-3419"><span class="linenos">3419</span></a>        <span class="n">_dict_key_or_mock_loc</span><span class="p">,</span>
</span><span id="L-3420"><a href="#L-3420"><span class="linenos">3420</span></a>        <span class="n">_set_end_pos</span><span class="p">,</span>
</span><span id="L-3421"><a href="#L-3421"><span class="linenos">3421</span></a>        <span class="n">_set_block_end_from_last_child</span><span class="p">,</span>
</span><span id="L-3422"><a href="#L-3422"><span class="linenos">3422</span></a>        <span class="n">_maybe_add_comma</span><span class="p">,</span>
</span><span id="L-3423"><a href="#L-3423"><span class="linenos">3423</span></a>        <span class="n">_maybe_add_singleton_tuple_comma</span><span class="p">,</span>
</span><span id="L-3424"><a href="#L-3424"><span class="linenos">3424</span></a>        <span class="n">_maybe_fix_tuple</span><span class="p">,</span>
</span><span id="L-3425"><a href="#L-3425"><span class="linenos">3425</span></a>        <span class="n">_maybe_fix_set</span><span class="p">,</span>
</span><span id="L-3426"><a href="#L-3426"><span class="linenos">3426</span></a>        <span class="n">_maybe_fix_elif</span><span class="p">,</span>
</span><span id="L-3427"><a href="#L-3427"><span class="linenos">3427</span></a>        <span class="n">_maybe_fix_with_items</span><span class="p">,</span>
</span><span id="L-3428"><a href="#L-3428"><span class="linenos">3428</span></a>        <span class="n">_maybe_fix_copy</span><span class="p">,</span>
</span><span id="L-3429"><a href="#L-3429"><span class="linenos">3429</span></a>        <span class="n">_touch</span><span class="p">,</span>
</span><span id="L-3430"><a href="#L-3430"><span class="linenos">3430</span></a>        <span class="n">_sanitize</span><span class="p">,</span>
</span><span id="L-3431"><a href="#L-3431"><span class="linenos">3431</span></a>        <span class="n">_parenthesize_grouping</span><span class="p">,</span>
</span><span id="L-3432"><a href="#L-3432"><span class="linenos">3432</span></a>        <span class="n">_parenthesize_node</span><span class="p">,</span>
</span><span id="L-3433"><a href="#L-3433"><span class="linenos">3433</span></a>        <span class="n">_unparenthesize_grouping</span><span class="p">,</span>
</span><span id="L-3434"><a href="#L-3434"><span class="linenos">3434</span></a>        <span class="n">_unparenthesize_node</span><span class="p">,</span>
</span><span id="L-3435"><a href="#L-3435"><span class="linenos">3435</span></a>        <span class="n">_normalize_block</span><span class="p">,</span>
</span><span id="L-3436"><a href="#L-3436"><span class="linenos">3436</span></a>        <span class="n">_elif_to_else_if</span><span class="p">,</span>
</span><span id="L-3437"><a href="#L-3437"><span class="linenos">3437</span></a>        <span class="n">_reparse_docstrings</span><span class="p">,</span>
</span><span id="L-3438"><a href="#L-3438"><span class="linenos">3438</span></a>        <span class="n">_make_fst_and_dedent</span><span class="p">,</span>
</span><span id="L-3439"><a href="#L-3439"><span class="linenos">3439</span></a>        <span class="n">_get_fmtval_interp_strs</span><span class="p">,</span>
</span><span id="L-3440"><a href="#L-3440"><span class="linenos">3440</span></a>        <span class="n">_get_indentable_lns</span><span class="p">,</span>
</span><span id="L-3441"><a href="#L-3441"><span class="linenos">3441</span></a>        <span class="n">_modifying</span><span class="p">,</span>
</span><span id="L-3442"><a href="#L-3442"><span class="linenos">3442</span></a>        <span class="n">_touchall</span><span class="p">,</span>
</span><span id="L-3443"><a href="#L-3443"><span class="linenos">3443</span></a>        <span class="n">_put_src</span><span class="p">,</span>
</span><span id="L-3444"><a href="#L-3444"><span class="linenos">3444</span></a>        <span class="n">_offset</span><span class="p">,</span>
</span><span id="L-3445"><a href="#L-3445"><span class="linenos">3445</span></a>        <span class="n">_offset_lns</span><span class="p">,</span>
</span><span id="L-3446"><a href="#L-3446"><span class="linenos">3446</span></a>        <span class="n">_indent_lns</span><span class="p">,</span>
</span><span id="L-3447"><a href="#L-3447"><span class="linenos">3447</span></a>        <span class="n">_dedent_lns</span><span class="p">,</span>
</span><span id="L-3448"><a href="#L-3448"><span class="linenos">3448</span></a>    <span class="p">)</span>
</span><span id="L-3449"><a href="#L-3449"><span class="linenos">3449</span></a>
</span><span id="L-3450"><a href="#L-3450"><span class="linenos">3450</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_parse</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-3451"><a href="#L-3451"><span class="linenos">3451</span></a>        <span class="n">_unparse</span><span class="p">,</span>
</span><span id="L-3452"><a href="#L-3452"><span class="linenos">3452</span></a>        <span class="n">_parse</span><span class="p">,</span>
</span><span id="L-3453"><a href="#L-3453"><span class="linenos">3453</span></a>        <span class="n">_parse_all</span><span class="p">,</span>
</span><span id="L-3454"><a href="#L-3454"><span class="linenos">3454</span></a>        <span class="n">_parse_most</span><span class="p">,</span>
</span><span id="L-3455"><a href="#L-3455"><span class="linenos">3455</span></a>        <span class="n">_parse_min</span><span class="p">,</span>
</span><span id="L-3456"><a href="#L-3456"><span class="linenos">3456</span></a>        <span class="n">_parse_Module</span><span class="p">,</span>
</span><span id="L-3457"><a href="#L-3457"><span class="linenos">3457</span></a>        <span class="n">_parse_Expression</span><span class="p">,</span>
</span><span id="L-3458"><a href="#L-3458"><span class="linenos">3458</span></a>        <span class="n">_parse_Interactive</span><span class="p">,</span>
</span><span id="L-3459"><a href="#L-3459"><span class="linenos">3459</span></a>        <span class="n">_parse_stmtishs</span><span class="p">,</span>
</span><span id="L-3460"><a href="#L-3460"><span class="linenos">3460</span></a>        <span class="n">_parse_stmtish</span><span class="p">,</span>
</span><span id="L-3461"><a href="#L-3461"><span class="linenos">3461</span></a>        <span class="n">_parse_stmts</span><span class="p">,</span>
</span><span id="L-3462"><a href="#L-3462"><span class="linenos">3462</span></a>        <span class="n">_parse_stmt</span><span class="p">,</span>
</span><span id="L-3463"><a href="#L-3463"><span class="linenos">3463</span></a>        <span class="n">_parse_ExceptHandlers</span><span class="p">,</span>
</span><span id="L-3464"><a href="#L-3464"><span class="linenos">3464</span></a>        <span class="n">_parse_ExceptHandler</span><span class="p">,</span>
</span><span id="L-3465"><a href="#L-3465"><span class="linenos">3465</span></a>        <span class="n">_parse_match_cases</span><span class="p">,</span>
</span><span id="L-3466"><a href="#L-3466"><span class="linenos">3466</span></a>        <span class="n">_parse_match_case</span><span class="p">,</span>
</span><span id="L-3467"><a href="#L-3467"><span class="linenos">3467</span></a>        <span class="n">_parse_expr</span><span class="p">,</span>
</span><span id="L-3468"><a href="#L-3468"><span class="linenos">3468</span></a>        <span class="n">_parse_expr_slice</span><span class="p">,</span>
</span><span id="L-3469"><a href="#L-3469"><span class="linenos">3469</span></a>        <span class="n">_parse_expr_sliceelt</span><span class="p">,</span>
</span><span id="L-3470"><a href="#L-3470"><span class="linenos">3470</span></a>        <span class="n">_parse_expr_callarg</span><span class="p">,</span>
</span><span id="L-3471"><a href="#L-3471"><span class="linenos">3471</span></a>        <span class="n">_parse_boolop</span><span class="p">,</span>
</span><span id="L-3472"><a href="#L-3472"><span class="linenos">3472</span></a>        <span class="n">_parse_operator</span><span class="p">,</span>
</span><span id="L-3473"><a href="#L-3473"><span class="linenos">3473</span></a>        <span class="n">_parse_binop</span><span class="p">,</span>
</span><span id="L-3474"><a href="#L-3474"><span class="linenos">3474</span></a>        <span class="n">_parse_augop</span><span class="p">,</span>
</span><span id="L-3475"><a href="#L-3475"><span class="linenos">3475</span></a>        <span class="n">_parse_unaryop</span><span class="p">,</span>
</span><span id="L-3476"><a href="#L-3476"><span class="linenos">3476</span></a>        <span class="n">_parse_cmpop</span><span class="p">,</span>
</span><span id="L-3477"><a href="#L-3477"><span class="linenos">3477</span></a>        <span class="n">_parse_comprehension</span><span class="p">,</span>
</span><span id="L-3478"><a href="#L-3478"><span class="linenos">3478</span></a>        <span class="n">_parse_arguments</span><span class="p">,</span>
</span><span id="L-3479"><a href="#L-3479"><span class="linenos">3479</span></a>        <span class="n">_parse_arguments_lambda</span><span class="p">,</span>
</span><span id="L-3480"><a href="#L-3480"><span class="linenos">3480</span></a>        <span class="n">_parse_arg</span><span class="p">,</span>
</span><span id="L-3481"><a href="#L-3481"><span class="linenos">3481</span></a>        <span class="n">_parse_keyword</span><span class="p">,</span>
</span><span id="L-3482"><a href="#L-3482"><span class="linenos">3482</span></a>        <span class="n">_parse_alias</span><span class="p">,</span>
</span><span id="L-3483"><a href="#L-3483"><span class="linenos">3483</span></a>        <span class="n">_parse_alias_dotted</span><span class="p">,</span>
</span><span id="L-3484"><a href="#L-3484"><span class="linenos">3484</span></a>        <span class="n">_parse_alias_star</span><span class="p">,</span>
</span><span id="L-3485"><a href="#L-3485"><span class="linenos">3485</span></a>        <span class="n">_parse_withitem</span><span class="p">,</span>
</span><span id="L-3486"><a href="#L-3486"><span class="linenos">3486</span></a>        <span class="n">_parse_pattern</span><span class="p">,</span>
</span><span id="L-3487"><a href="#L-3487"><span class="linenos">3487</span></a>        <span class="n">_parse_type_param</span><span class="p">,</span>
</span><span id="L-3488"><a href="#L-3488"><span class="linenos">3488</span></a>        <span class="n">_code_as_all</span><span class="p">,</span>
</span><span id="L-3489"><a href="#L-3489"><span class="linenos">3489</span></a>        <span class="n">_code_as_stmtishs</span><span class="p">,</span>
</span><span id="L-3490"><a href="#L-3490"><span class="linenos">3490</span></a>        <span class="n">_code_as_stmts</span><span class="p">,</span>
</span><span id="L-3491"><a href="#L-3491"><span class="linenos">3491</span></a>        <span class="n">_code_as_ExceptHandlers</span><span class="p">,</span>
</span><span id="L-3492"><a href="#L-3492"><span class="linenos">3492</span></a>        <span class="n">_code_as_match_cases</span><span class="p">,</span>
</span><span id="L-3493"><a href="#L-3493"><span class="linenos">3493</span></a>        <span class="n">_code_as_expr</span><span class="p">,</span>
</span><span id="L-3494"><a href="#L-3494"><span class="linenos">3494</span></a>        <span class="n">_code_as_expr_slice</span><span class="p">,</span>
</span><span id="L-3495"><a href="#L-3495"><span class="linenos">3495</span></a>        <span class="n">_code_as_expr_sliceelt</span><span class="p">,</span>
</span><span id="L-3496"><a href="#L-3496"><span class="linenos">3496</span></a>        <span class="n">_code_as_expr_callarg</span><span class="p">,</span>
</span><span id="L-3497"><a href="#L-3497"><span class="linenos">3497</span></a>        <span class="n">_code_as_boolop</span><span class="p">,</span>
</span><span id="L-3498"><a href="#L-3498"><span class="linenos">3498</span></a>        <span class="n">_code_as_binop</span><span class="p">,</span>
</span><span id="L-3499"><a href="#L-3499"><span class="linenos">3499</span></a>        <span class="n">_code_as_augop</span><span class="p">,</span>
</span><span id="L-3500"><a href="#L-3500"><span class="linenos">3500</span></a>        <span class="n">_code_as_unaryop</span><span class="p">,</span>
</span><span id="L-3501"><a href="#L-3501"><span class="linenos">3501</span></a>        <span class="n">_code_as_cmpop</span><span class="p">,</span>
</span><span id="L-3502"><a href="#L-3502"><span class="linenos">3502</span></a>        <span class="n">_code_as_comprehension</span><span class="p">,</span>
</span><span id="L-3503"><a href="#L-3503"><span class="linenos">3503</span></a>        <span class="n">_code_as_arguments</span><span class="p">,</span>
</span><span id="L-3504"><a href="#L-3504"><span class="linenos">3504</span></a>        <span class="n">_code_as_arguments_lambda</span><span class="p">,</span>
</span><span id="L-3505"><a href="#L-3505"><span class="linenos">3505</span></a>        <span class="n">_code_as_arg</span><span class="p">,</span>
</span><span id="L-3506"><a href="#L-3506"><span class="linenos">3506</span></a>        <span class="n">_code_as_keyword</span><span class="p">,</span>
</span><span id="L-3507"><a href="#L-3507"><span class="linenos">3507</span></a>        <span class="n">_code_as_alias</span><span class="p">,</span>
</span><span id="L-3508"><a href="#L-3508"><span class="linenos">3508</span></a>        <span class="n">_code_as_alias_dotted</span><span class="p">,</span>
</span><span id="L-3509"><a href="#L-3509"><span class="linenos">3509</span></a>        <span class="n">_code_as_alias_star</span><span class="p">,</span>
</span><span id="L-3510"><a href="#L-3510"><span class="linenos">3510</span></a>        <span class="n">_code_as_withitem</span><span class="p">,</span>
</span><span id="L-3511"><a href="#L-3511"><span class="linenos">3511</span></a>        <span class="n">_code_as_pattern</span><span class="p">,</span>
</span><span id="L-3512"><a href="#L-3512"><span class="linenos">3512</span></a>        <span class="n">_code_as_type_param</span><span class="p">,</span>
</span><span id="L-3513"><a href="#L-3513"><span class="linenos">3513</span></a>        <span class="n">_code_as_identifier</span><span class="p">,</span>
</span><span id="L-3514"><a href="#L-3514"><span class="linenos">3514</span></a>        <span class="n">_code_as_identifier_dotted</span><span class="p">,</span>
</span><span id="L-3515"><a href="#L-3515"><span class="linenos">3515</span></a>        <span class="n">_code_as_identifier_star</span><span class="p">,</span>
</span><span id="L-3516"><a href="#L-3516"><span class="linenos">3516</span></a>        <span class="n">_code_as_identifier_alias</span><span class="p">,</span>
</span><span id="L-3517"><a href="#L-3517"><span class="linenos">3517</span></a>        <span class="n">_code_as_constant</span><span class="p">,</span>
</span><span id="L-3518"><a href="#L-3518"><span class="linenos">3518</span></a>    <span class="p">)</span>
</span><span id="L-3519"><a href="#L-3519"><span class="linenos">3519</span></a>
</span><span id="L-3520"><a href="#L-3520"><span class="linenos">3520</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_raw</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-3521"><a href="#L-3521"><span class="linenos">3521</span></a>        <span class="n">_reparse_raw</span><span class="p">,</span>
</span><span id="L-3522"><a href="#L-3522"><span class="linenos">3522</span></a>    <span class="p">)</span>
</span><span id="L-3523"><a href="#L-3523"><span class="linenos">3523</span></a>
</span><span id="L-3524"><a href="#L-3524"><span class="linenos">3524</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_slice_old</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-3525"><a href="#L-3525"><span class="linenos">3525</span></a>        <span class="n">_get_slice_tuple_list_or_set</span><span class="p">,</span>
</span><span id="L-3526"><a href="#L-3526"><span class="linenos">3526</span></a>        <span class="c1"># _get_slice_empty_set,</span>
</span><span id="L-3527"><a href="#L-3527"><span class="linenos">3527</span></a>        <span class="n">_get_slice_dict</span><span class="p">,</span>
</span><span id="L-3528"><a href="#L-3528"><span class="linenos">3528</span></a>        <span class="n">_get_slice_stmtish</span><span class="p">,</span>
</span><span id="L-3529"><a href="#L-3529"><span class="linenos">3529</span></a>        <span class="n">_put_slice_tuple_list_or_set</span><span class="p">,</span>
</span><span id="L-3530"><a href="#L-3530"><span class="linenos">3530</span></a>        <span class="c1"># _put_slice_empty_set,</span>
</span><span id="L-3531"><a href="#L-3531"><span class="linenos">3531</span></a>        <span class="n">_put_slice_dict</span><span class="p">,</span>
</span><span id="L-3532"><a href="#L-3532"><span class="linenos">3532</span></a>        <span class="n">_put_slice_stmtish</span><span class="p">,</span>
</span><span id="L-3533"><a href="#L-3533"><span class="linenos">3533</span></a>    <span class="p">)</span>
</span><span id="L-3534"><a href="#L-3534"><span class="linenos">3534</span></a>
</span><span id="L-3535"><a href="#L-3535"><span class="linenos">3535</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_slice</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-3536"><a href="#L-3536"><span class="linenos">3536</span></a>        <span class="n">_is_slice_compatible</span><span class="p">,</span>
</span><span id="L-3537"><a href="#L-3537"><span class="linenos">3537</span></a>        <span class="n">_get_slice</span><span class="p">,</span>
</span><span id="L-3538"><a href="#L-3538"><span class="linenos">3538</span></a>        <span class="n">_put_slice</span><span class="p">,</span>
</span><span id="L-3539"><a href="#L-3539"><span class="linenos">3539</span></a>    <span class="p">)</span>
</span><span id="L-3540"><a href="#L-3540"><span class="linenos">3540</span></a>
</span><span id="L-3541"><a href="#L-3541"><span class="linenos">3541</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_one</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-3542"><a href="#L-3542"><span class="linenos">3542</span></a>        <span class="n">_get_one</span><span class="p">,</span>
</span><span id="L-3543"><a href="#L-3543"><span class="linenos">3543</span></a>        <span class="n">_put_one</span><span class="p">,</span>
</span><span id="L-3544"><a href="#L-3544"><span class="linenos">3544</span></a>    <span class="p">)</span>
</span><span id="L-3545"><a href="#L-3545"><span class="linenos">3545</span></a>
</span><span id="L-3546"><a href="#L-3546"><span class="linenos">3546</span></a>    <span class="nd">@property</span>
</span><span id="L-3547"><a href="#L-3547"><span class="linenos">3547</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-3548"><a href="#L-3548"><span class="linenos">3548</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="L-3549"><a href="#L-3549"><span class="linenos">3549</span></a>
</span><span id="L-3550"><a href="#L-3550"><span class="linenos">3550</span></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;you probably think you&#39;re accessing an AST node &#39;.f&#39;, but you&#39;re not, &quot;</span>
</span><span id="L-3551"><a href="#L-3551"><span class="linenos">3551</span></a>                           <span class="sa">f</span><span class="s2">&quot;you&#39;re accessing an FST </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">.f&#39;&quot;</span><span class="p">)</span>
</span><span id="L-3552"><a href="#L-3552"><span class="linenos">3552</span></a>
</span><span id="L-3553"><a href="#L-3553"><span class="linenos">3553</span></a>
</span><span id="L-3554"><a href="#L-3554"><span class="linenos">3554</span></a><span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-3555"><a href="#L-3555"><span class="linenos">3555</span></a><span class="c1"># Make AST field accessors</span>
</span><span id="L-3556"><a href="#L-3556"><span class="linenos">3556</span></a>
</span><span id="L-3557"><a href="#L-3557"><span class="linenos">3557</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_make_AST_field_accessor</span><span class="p">(</span><span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cardinality</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">property</span><span class="p">:</span>
</span><span id="L-3558"><a href="#L-3558"><span class="linenos">3558</span></a>    <span class="k">if</span> <span class="n">cardinality</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-3559"><a href="#L-3559"><span class="linenos">3559</span></a>        <span class="nd">@property</span>
</span><span id="L-3560"><a href="#L-3560"><span class="linenos">3560</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">accessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">constant</span><span class="p">:</span>
</span><span id="L-3561"><a href="#L-3561"><span class="linenos">3561</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="L-3562"><a href="#L-3562"><span class="linenos">3562</span></a>
</span><span id="L-3563"><a href="#L-3563"><span class="linenos">3563</span></a>            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">field</span><span class="p">),</span> <span class="n">AST</span><span class="p">)</span> <span class="k">else</span> <span class="n">child</span>
</span><span id="L-3564"><a href="#L-3564"><span class="linenos">3564</span></a>
</span><span id="L-3565"><a href="#L-3565"><span class="linenos">3565</span></a>        <span class="nd">@accessor</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-3566"><a href="#L-3566"><span class="linenos">3566</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">accessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="n">constant</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-3567"><a href="#L-3567"><span class="linenos">3567</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="L-3568"><a href="#L-3568"><span class="linenos">3568</span></a>
</span><span id="L-3569"><a href="#L-3569"><span class="linenos">3569</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="L-3570"><a href="#L-3570"><span class="linenos">3570</span></a>
</span><span id="L-3571"><a href="#L-3571"><span class="linenos">3571</span></a>    <span class="k">elif</span> <span class="n">cardinality</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-3572"><a href="#L-3572"><span class="linenos">3572</span></a>        <span class="nd">@property</span>
</span><span id="L-3573"><a href="#L-3573"><span class="linenos">3573</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">accessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstview</span><span class="p">:</span>
</span><span id="L-3574"><a href="#L-3574"><span class="linenos">3574</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="L-3575"><a href="#L-3575"><span class="linenos">3575</span></a>
</span><span id="L-3576"><a href="#L-3576"><span class="linenos">3576</span></a>            <span class="k">return</span> <span class="n">fstview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">field</span><span class="p">)))</span>
</span><span id="L-3577"><a href="#L-3577"><span class="linenos">3577</span></a>
</span><span id="L-3578"><a href="#L-3578"><span class="linenos">3578</span></a>        <span class="nd">@accessor</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-3579"><a href="#L-3579"><span class="linenos">3579</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">accessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-3580"><a href="#L-3580"><span class="linenos">3580</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="L-3581"><a href="#L-3581"><span class="linenos">3581</span></a>
</span><span id="L-3582"><a href="#L-3582"><span class="linenos">3582</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="L-3583"><a href="#L-3583"><span class="linenos">3583</span></a>
</span><span id="L-3584"><a href="#L-3584"><span class="linenos">3584</span></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># cardinality == 3  # can be single element or list depending on the AST type</span>
</span><span id="L-3585"><a href="#L-3585"><span class="linenos">3585</span></a>        <span class="nd">@property</span>
</span><span id="L-3586"><a href="#L-3586"><span class="linenos">3586</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">accessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstview</span> <span class="o">|</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">constant</span><span class="p">:</span>
</span><span id="L-3587"><a href="#L-3587"><span class="linenos">3587</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="L-3588"><a href="#L-3588"><span class="linenos">3588</span></a>
</span><span id="L-3589"><a href="#L-3589"><span class="linenos">3589</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">field</span><span class="p">),</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-3590"><a href="#L-3590"><span class="linenos">3590</span></a>                <span class="k">return</span> <span class="n">fstview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">child</span><span class="p">))</span>
</span><span id="L-3591"><a href="#L-3591"><span class="linenos">3591</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="L-3592"><a href="#L-3592"><span class="linenos">3592</span></a>                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-3593"><a href="#L-3593"><span class="linenos">3593</span></a>
</span><span id="L-3594"><a href="#L-3594"><span class="linenos">3594</span></a>            <span class="k">return</span> <span class="n">child</span>
</span><span id="L-3595"><a href="#L-3595"><span class="linenos">3595</span></a>
</span><span id="L-3596"><a href="#L-3596"><span class="linenos">3596</span></a>        <span class="nd">@accessor</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-3597"><a href="#L-3597"><span class="linenos">3597</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">accessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-3598"><a href="#L-3598"><span class="linenos">3598</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="L-3599"><a href="#L-3599"><span class="linenos">3599</span></a>
</span><span id="L-3600"><a href="#L-3600"><span class="linenos">3600</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">field</span><span class="p">),</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-3601"><a href="#L-3601"><span class="linenos">3601</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="L-3602"><a href="#L-3602"><span class="linenos">3602</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-3603"><a href="#L-3603"><span class="linenos">3603</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="L-3604"><a href="#L-3604"><span class="linenos">3604</span></a>
</span><span id="L-3605"><a href="#L-3605"><span class="linenos">3605</span></a>    <span class="k">return</span> <span class="n">accessor</span>
</span><span id="L-3606"><a href="#L-3606"><span class="linenos">3606</span></a>
</span><span id="L-3607"><a href="#L-3607"><span class="linenos">3607</span></a>
</span><span id="L-3608"><a href="#L-3608"><span class="linenos">3608</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_make_AST_field_accessors</span><span class="p">():</span>
</span><span id="L-3609"><a href="#L-3609"><span class="linenos">3609</span></a>    <span class="n">FST_dict</span>    <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="vm">__dict__</span>
</span><span id="L-3610"><a href="#L-3610"><span class="linenos">3610</span></a>    <span class="n">cardinality</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {&#39;field&#39;: 1 means single element | 2 means list, ...}</span>
</span><span id="L-3611"><a href="#L-3611"><span class="linenos">3611</span></a>
</span><span id="L-3612"><a href="#L-3612"><span class="linenos">3612</span></a>    <span class="k">for</span> <span class="n">fields</span> <span class="ow">in</span> <span class="n">FIELDS</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-3613"><a href="#L-3613"><span class="linenos">3613</span></a>        <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
</span><span id="L-3614"><a href="#L-3614"><span class="linenos">3614</span></a>            <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="s1">&#39;lineno&#39;</span><span class="p">:</span>
</span><span id="L-3615"><a href="#L-3615"><span class="linenos">3615</span></a>                <span class="k">continue</span>
</span><span id="L-3616"><a href="#L-3616"><span class="linenos">3616</span></a>
</span><span id="L-3617"><a href="#L-3617"><span class="linenos">3617</span></a>            <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">FST_dict</span><span class="p">:</span>
</span><span id="L-3618"><a href="#L-3618"><span class="linenos">3618</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;AST field name </span><span class="si">{</span><span class="n">f</span><span class="si">!r}</span><span class="s1"> already taken in FST class&#39;</span><span class="p">)</span>
</span><span id="L-3619"><a href="#L-3619"><span class="linenos">3619</span></a>
</span><span id="L-3620"><a href="#L-3620"><span class="linenos">3620</span></a>            <span class="n">cardinality</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardinality</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-3621"><a href="#L-3621"><span class="linenos">3621</span></a>
</span><span id="L-3622"><a href="#L-3622"><span class="linenos">3622</span></a>    <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cardinality</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-3623"><a href="#L-3623"><span class="linenos">3623</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">FST</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">_make_AST_field_accessor</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
</span><span id="L-3624"><a href="#L-3624"><span class="linenos">3624</span></a>
</span><span id="L-3625"><a href="#L-3625"><span class="linenos">3625</span></a>
</span><span id="L-3626"><a href="#L-3626"><span class="linenos">3626</span></a><span class="n">_make_AST_field_accessors</span><span class="p">()</span>
</span><span id="L-3627"><a href="#L-3627"><span class="linenos">3627</span></a>
</span><span id="L-3628"><a href="#L-3628"><span class="linenos">3628</span></a><span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-3629"><a href="#L-3629"><span class="linenos">3629</span></a>
</span><span id="L-3630"><a href="#L-3630"><span class="linenos">3630</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.view</span><span class="w"> </span><span class="kn">import</span> <span class="n">fstview</span>
</span></pre></div>


            </section>
                <section id="parse">
                            <input id="parse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span>,</span><span class="param">	<span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&lt;unknown&gt;&#39;</span>,</span><span class="param">	<span class="n">mode</span><span class="o">=</span><span class="s1">&#39;exec&#39;</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">type_comments</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">feature_version</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span>:</span></span>

                <label class="view-source-button" for="parse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse-69"><a href="#parse-69"><span class="linenos"> 69</span></a><span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
</span><span id="parse-70"><a href="#parse-70"><span class="linenos"> 70</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Executes `ast.parse()` and then adds `FST` nodes to the parsed tree. Drop-in replacement for `ast.parse()`. For</span>
</span><span id="parse-71"><a href="#parse-71"><span class="linenos"> 71</span></a><span class="sd">    parameters, see `ast.parse()`. Returned `AST` tree has added `.f` attribute at each node which accesses the parallel</span>
</span><span id="parse-72"><a href="#parse-72"><span class="linenos"> 72</span></a><span class="sd">    `FST` tree.</span>
</span><span id="parse-73"><a href="#parse-73"><span class="linenos"> 73</span></a>
</span><span id="parse-74"><a href="#parse-74"><span class="linenos"> 74</span></a><span class="sd">    **Parameters:**</span>
</span><span id="parse-75"><a href="#parse-75"><span class="linenos"> 75</span></a><span class="sd">    - `source`: The python source to parse.</span>
</span><span id="parse-76"><a href="#parse-76"><span class="linenos"> 76</span></a><span class="sd">    - `filename`: `ast.parse()` parameter.</span>
</span><span id="parse-77"><a href="#parse-77"><span class="linenos"> 77</span></a><span class="sd">    - `mode`: Parse mode, extended `ast.parse()` parameter, See `fst.misc.Mode`.</span>
</span><span id="parse-78"><a href="#parse-78"><span class="linenos"> 78</span></a><span class="sd">    - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="parse-79"><a href="#parse-79"><span class="linenos"> 79</span></a><span class="sd">    - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="parse-80"><a href="#parse-80"><span class="linenos"> 80</span></a>
</span><span id="parse-81"><a href="#parse-81"><span class="linenos"> 81</span></a><span class="sd">    **Returns:**</span>
</span><span id="parse-82"><a href="#parse-82"><span class="linenos"> 82</span></a><span class="sd">    - `AST`: Tree with an `FST` `.f` attribute added to each `AST` node.</span>
</span><span id="parse-83"><a href="#parse-83"><span class="linenos"> 83</span></a>
</span><span id="parse-84"><a href="#parse-84"><span class="linenos"> 84</span></a><span class="sd">    **Examples:**</span>
</span><span id="parse-85"><a href="#parse-85"><span class="linenos"> 85</span></a><span class="sd">    ```py</span>
</span><span id="parse-86"><a href="#parse-86"><span class="linenos"> 86</span></a><span class="sd">    &gt;&gt;&gt; import ast, fst</span>
</span><span id="parse-87"><a href="#parse-87"><span class="linenos"> 87</span></a><span class="sd">    &gt;&gt;&gt; a = fst.parse(&#39;if 1:\n  i = 2&#39;)</span>
</span><span id="parse-88"><a href="#parse-88"><span class="linenos"> 88</span></a><span class="sd">    &gt;&gt;&gt; type(a)</span>
</span><span id="parse-89"><a href="#parse-89"><span class="linenos"> 89</span></a><span class="sd">    &lt;class &#39;ast.Module&#39;&gt;</span>
</span><span id="parse-90"><a href="#parse-90"><span class="linenos"> 90</span></a>
</span><span id="parse-91"><a href="#parse-91"><span class="linenos"> 91</span></a><span class="sd">    &gt;&gt;&gt; a.f  # FST node</span>
</span><span id="parse-92"><a href="#parse-92"><span class="linenos"> 92</span></a><span class="sd">    &lt;Module ROOT 0,0..1,7&gt;</span>
</span><span id="parse-93"><a href="#parse-93"><span class="linenos"> 93</span></a>
</span><span id="parse-94"><a href="#parse-94"><span class="linenos"> 94</span></a><span class="sd">    &gt;&gt;&gt; print(fst.dump(a, indent=2))</span>
</span><span id="parse-95"><a href="#parse-95"><span class="linenos"> 95</span></a><span class="sd">    Module(</span>
</span><span id="parse-96"><a href="#parse-96"><span class="linenos"> 96</span></a><span class="sd">      body=[</span>
</span><span id="parse-97"><a href="#parse-97"><span class="linenos"> 97</span></a><span class="sd">        If(</span>
</span><span id="parse-98"><a href="#parse-98"><span class="linenos"> 98</span></a><span class="sd">          test=Constant(value=1),</span>
</span><span id="parse-99"><a href="#parse-99"><span class="linenos"> 99</span></a><span class="sd">          body=[</span>
</span><span id="parse-100"><a href="#parse-100"><span class="linenos">100</span></a><span class="sd">            Assign(</span>
</span><span id="parse-101"><a href="#parse-101"><span class="linenos">101</span></a><span class="sd">              targets=[</span>
</span><span id="parse-102"><a href="#parse-102"><span class="linenos">102</span></a><span class="sd">                Name(id=&#39;i&#39;, ctx=Store())],</span>
</span><span id="parse-103"><a href="#parse-103"><span class="linenos">103</span></a><span class="sd">              value=Constant(value=2))],</span>
</span><span id="parse-104"><a href="#parse-104"><span class="linenos">104</span></a><span class="sd">          orelse=[])],</span>
</span><span id="parse-105"><a href="#parse-105"><span class="linenos">105</span></a><span class="sd">      type_ignores=[])</span>
</span><span id="parse-106"><a href="#parse-106"><span class="linenos">106</span></a>
</span><span id="parse-107"><a href="#parse-107"><span class="linenos">107</span></a><span class="sd">    &gt;&gt;&gt; a.f.dump()</span>
</span><span id="parse-108"><a href="#parse-108"><span class="linenos">108</span></a><span class="sd">    Module - ROOT 0,0..1,7</span>
</span><span id="parse-109"><a href="#parse-109"><span class="linenos">109</span></a><span class="sd">      .body[1]</span>
</span><span id="parse-110"><a href="#parse-110"><span class="linenos">110</span></a><span class="sd">      0] If - 0,0..1,7</span>
</span><span id="parse-111"><a href="#parse-111"><span class="linenos">111</span></a><span class="sd">        .test Constant 1 - 0,3..0,4</span>
</span><span id="parse-112"><a href="#parse-112"><span class="linenos">112</span></a><span class="sd">        .body[1]</span>
</span><span id="parse-113"><a href="#parse-113"><span class="linenos">113</span></a><span class="sd">        0] Assign - 1,2..1,7</span>
</span><span id="parse-114"><a href="#parse-114"><span class="linenos">114</span></a><span class="sd">          .targets[1]</span>
</span><span id="parse-115"><a href="#parse-115"><span class="linenos">115</span></a><span class="sd">          0] Name &#39;i&#39; Store - 1,2..1,3</span>
</span><span id="parse-116"><a href="#parse-116"><span class="linenos">116</span></a><span class="sd">          .value Constant 2 - 1,6..1,7</span>
</span><span id="parse-117"><a href="#parse-117"><span class="linenos">117</span></a><span class="sd">    ```</span>
</span><span id="parse-118"><a href="#parse-118"><span class="linenos">118</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="parse-119"><a href="#parse-119"><span class="linenos">119</span></a>
</span><span id="parse-120"><a href="#parse-120"><span class="linenos">120</span></a>    <span class="k">return</span> <span class="n">FST</span><span class="o">.</span><span class="n">fromsrc</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">,</span>
</span><span id="parse-121"><a href="#parse-121"><span class="linenos">121</span></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">a</span>
</span></pre></div>


            <div class="docstring"><p>Executes <code>ast.parse()</code> and then adds <code><a href="#FST">FST</a></code> nodes to the parsed tree. Drop-in replacement for <code>ast.parse()</code>. For
parameters, see <code>ast.parse()</code>. Returned <code>AST</code> tree has added <code>.f</code> attribute at each node which accesses the parallel
<code><a href="#FST">FST</a></code> tree.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>source</code>: The python source to parse.</li>
<li><code>filename</code>: <code>ast.parse()</code> parameter.</li>
<li><code>mode</code>: Parse mode, extended <code>ast.parse()</code> parameter, See <code><a href="misc.html#Mode">fst.misc.Mode</a></code>.</li>
<li><code>type_comments</code>: <code>ast.parse()</code> parameter.</li>
<li><code>feature_version</code>: <code>ast.parse()</code> parameter.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>AST</code>: Tree with an <code><a href="#FST">FST</a></code> <code>.f</code> attribute added to each <code>AST</code> node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">ast</span><span class="o">,</span><span class="w"> </span><span class="nn">fst</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n"><a href="#parse">fst.parse</a></span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n</span><span class="s1">  i = 2&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">ast</span><span class="o">.</span><span class="n">Module</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span>  <span class="c1"># FST node</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n"><a href="#dump">fst.dump</a></span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">Module</span><span class="p">(</span>
  <span class="n">body</span><span class="o">=</span><span class="p">[</span>
    <span class="n">If</span><span class="p">(</span>
      <span class="n">test</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
      <span class="n">body</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Assign</span><span class="p">(</span>
          <span class="n">targets</span><span class="o">=</span><span class="p">[</span>
            <span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Store</span><span class="p">())],</span>
          <span class="n">value</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">))],</span>
      <span class="n">orelse</span><span class="o">=</span><span class="p">[])],</span>
  <span class="n">type_ignores</span><span class="o">=</span><span class="p">[])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="n">Module</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">7</span>
  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="mi">0</span><span class="p">]</span> <span class="n">If</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">7</span>
    <span class="o">.</span><span class="n">test</span> <span class="n">Constant</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">3..0</span><span class="p">,</span><span class="mi">4</span>
    <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="mi">0</span><span class="p">]</span> <span class="n">Assign</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">2..1</span><span class="p">,</span><span class="mi">7</span>
      <span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="mi">0</span><span class="p">]</span> <span class="n">Name</span> <span class="s1">&#39;i&#39;</span> <span class="n">Store</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">2..1</span><span class="p">,</span><span class="mi">3</span>
      <span class="o">.</span><span class="n">value</span> <span class="n">Constant</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">6..1</span><span class="p">,</span><span class="mi">7</span>
</code></pre>
</div>
</div>


                </section>
                <section id="unparse">
                            <input id="unparse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">unparse</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ast_obj</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="unparse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#unparse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="unparse-124"><a href="#unparse-124"><span class="linenos">124</span></a><span class="k">def</span><span class="w"> </span><span class="nf">unparse</span><span class="p">(</span><span class="n">ast_obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="unparse-125"><a href="#unparse-125"><span class="linenos">125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the formatted source that is kept for this tree. Drop-in replacement for `ast.unparse()` If there is no</span>
</span><span id="unparse-126"><a href="#unparse-126"><span class="linenos">126</span></a><span class="sd">    `FST` information in the `AST` tree then just executes `ast.unparse()`.</span>
</span><span id="unparse-127"><a href="#unparse-127"><span class="linenos">127</span></a>
</span><span id="unparse-128"><a href="#unparse-128"><span class="linenos">128</span></a><span class="sd">    **Parameters:**</span>
</span><span id="unparse-129"><a href="#unparse-129"><span class="linenos">129</span></a><span class="sd">    - `ast_obj`: The `AST` to unparse.</span>
</span><span id="unparse-130"><a href="#unparse-130"><span class="linenos">130</span></a>
</span><span id="unparse-131"><a href="#unparse-131"><span class="linenos">131</span></a><span class="sd">    **Returns:**</span>
</span><span id="unparse-132"><a href="#unparse-132"><span class="linenos">132</span></a><span class="sd">    - `str`: The unparsed source code, formatted if it came from `FST`.</span>
</span><span id="unparse-133"><a href="#unparse-133"><span class="linenos">133</span></a>
</span><span id="unparse-134"><a href="#unparse-134"><span class="linenos">134</span></a><span class="sd">    **Examples:**</span>
</span><span id="unparse-135"><a href="#unparse-135"><span class="linenos">135</span></a><span class="sd">    ```py</span>
</span><span id="unparse-136"><a href="#unparse-136"><span class="linenos">136</span></a><span class="sd">    &gt;&gt;&gt; import ast, fst</span>
</span><span id="unparse-137"><a href="#unparse-137"><span class="linenos">137</span></a><span class="sd">    &gt;&gt;&gt; a = fst.parse(&#39;&#39;&#39;</span>
</span><span id="unparse-138"><a href="#unparse-138"><span class="linenos">138</span></a><span class="sd">    ... if 1: i = 1  # same line</span>
</span><span id="unparse-139"><a href="#unparse-139"><span class="linenos">139</span></a><span class="sd">    ... else:</span>
</span><span id="unparse-140"><a href="#unparse-140"><span class="linenos">140</span></a><span class="sd">    ...   j=2 # comment</span>
</span><span id="unparse-141"><a href="#unparse-141"><span class="linenos">141</span></a><span class="sd">    ... &#39;&#39;&#39;.strip())</span>
</span><span id="unparse-142"><a href="#unparse-142"><span class="linenos">142</span></a><span class="sd">    &gt;&gt;&gt; print(ast.unparse(a))</span>
</span><span id="unparse-143"><a href="#unparse-143"><span class="linenos">143</span></a><span class="sd">    if 1:</span>
</span><span id="unparse-144"><a href="#unparse-144"><span class="linenos">144</span></a><span class="sd">        i = 1</span>
</span><span id="unparse-145"><a href="#unparse-145"><span class="linenos">145</span></a><span class="sd">    else:</span>
</span><span id="unparse-146"><a href="#unparse-146"><span class="linenos">146</span></a><span class="sd">        j = 2</span>
</span><span id="unparse-147"><a href="#unparse-147"><span class="linenos">147</span></a>
</span><span id="unparse-148"><a href="#unparse-148"><span class="linenos">148</span></a><span class="sd">    &gt;&gt;&gt; print(fst.unparse(a))</span>
</span><span id="unparse-149"><a href="#unparse-149"><span class="linenos">149</span></a><span class="sd">    if 1: i = 1  # same line</span>
</span><span id="unparse-150"><a href="#unparse-150"><span class="linenos">150</span></a><span class="sd">    else:</span>
</span><span id="unparse-151"><a href="#unparse-151"><span class="linenos">151</span></a><span class="sd">      j=2 # comment</span>
</span><span id="unparse-152"><a href="#unparse-152"><span class="linenos">152</span></a>
</span><span id="unparse-153"><a href="#unparse-153"><span class="linenos">153</span></a><span class="sd">    &gt;&gt;&gt; a = ast.parse(&#39;i = 1&#39;)</span>
</span><span id="unparse-154"><a href="#unparse-154"><span class="linenos">154</span></a><span class="sd">    &gt;&gt;&gt; ast.unparse(a)</span>
</span><span id="unparse-155"><a href="#unparse-155"><span class="linenos">155</span></a><span class="sd">    &#39;i = 1&#39;</span>
</span><span id="unparse-156"><a href="#unparse-156"><span class="linenos">156</span></a>
</span><span id="unparse-157"><a href="#unparse-157"><span class="linenos">157</span></a><span class="sd">    &gt;&gt;&gt; fst.unparse(a)  # also unparses regular AST</span>
</span><span id="unparse-158"><a href="#unparse-158"><span class="linenos">158</span></a><span class="sd">    &#39;i = 1&#39;</span>
</span><span id="unparse-159"><a href="#unparse-159"><span class="linenos">159</span></a><span class="sd">    ```</span>
</span><span id="unparse-160"><a href="#unparse-160"><span class="linenos">160</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="unparse-161"><a href="#unparse-161"><span class="linenos">161</span></a>
</span><span id="unparse-162"><a href="#unparse-162"><span class="linenos">162</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast_obj</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">FST</span><span class="p">):</span>
</span><span id="unparse-163"><a href="#unparse-163"><span class="linenos">163</span></a>        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="unparse-164"><a href="#unparse-164"><span class="linenos">164</span></a>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
</span><span id="unparse-165"><a href="#unparse-165"><span class="linenos">165</span></a>
</span><span id="unparse-166"><a href="#unparse-166"><span class="linenos">166</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="unparse-167"><a href="#unparse-167"><span class="linenos">167</span></a>            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
</span><span id="unparse-168"><a href="#unparse-168"><span class="linenos">168</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="unparse-169"><a href="#unparse-169"><span class="linenos">169</span></a>            <span class="k">pass</span>
</span><span id="unparse-170"><a href="#unparse-170"><span class="linenos">170</span></a>
</span><span id="unparse-171"><a href="#unparse-171"><span class="linenos">171</span></a>    <span class="k">return</span> <span class="n">ast_unparse</span><span class="p">(</span><span class="n">ast_obj</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the formatted source that is kept for this tree. Drop-in replacement for <code>ast.unparse()</code> If there is no
<code><a href="#FST">FST</a></code> information in the <code>AST</code> tree then just executes <code>ast.unparse()</code>.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>ast_obj</code>: The <code>AST</code> to unparse.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>str</code>: The unparsed source code, formatted if it came from <code><a href="#FST">FST</a></code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">ast</span><span class="o">,</span><span class="w"> </span><span class="nn">fst</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n"><a href="#parse">fst.parse</a></span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">... if 1: i = 1  # same line</span>
<span class="s1">... else:</span>
<span class="s1">...   j=2 # comment</span>
<span class="s1">... &#39;&#39;&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n"><a href="#unparse">fst.unparse</a></span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># same line</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">j</span><span class="o">=</span><span class="mi">2</span> <span class="c1"># comment</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;i = 1&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="s1">&#39;i = 1&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#unparse">fst.unparse</a></span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># also unparses regular AST</span>
<span class="s1">&#39;i = 1&#39;</span>
</code></pre>
</div>
</div>


                </section>
                <section id="dump">
                            <input id="dump-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dump</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">node</span>,</span><span class="param">	<span class="n">annotate_fields</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">include_attributes</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">indent</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">show_empty</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="dump-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#dump"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="dump-174"><a href="#dump-174"><span class="linenos">174</span></a><span class="k">def</span><span class="w"> </span><span class="nf">dump</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">annotate_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_attributes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="dump-175"><a href="#dump-175"><span class="linenos">175</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;This function is a convenience function and only exists to make python version 3.13 and above `ast.dump()` output</span>
</span><span id="dump-176"><a href="#dump-176"><span class="linenos">176</span></a><span class="sd">    compatible on a default call with previous python versions (important for doctests). All arguments correspond to</span>
</span><span id="dump-177"><a href="#dump-177"><span class="linenos">177</span></a><span class="sd">    their respective `ast.dump()` arguments and `show_empty` is eaten on python versions below 3.13.&quot;&quot;&quot;</span>
</span><span id="dump-178"><a href="#dump-178"><span class="linenos">178</span></a>
</span><span id="dump-179"><a href="#dump-179"><span class="linenos">179</span></a>    <span class="k">if</span> <span class="n">_PYLT13</span><span class="p">:</span>
</span><span id="dump-180"><a href="#dump-180"><span class="linenos">180</span></a>        <span class="k">return</span> <span class="n">ast_dump</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">annotate_fields</span><span class="p">,</span> <span class="n">include_attributes</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">)</span>
</span><span id="dump-181"><a href="#dump-181"><span class="linenos">181</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="dump-182"><a href="#dump-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="n">ast_dump</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">annotate_fields</span><span class="p">,</span> <span class="n">include_attributes</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="n">show_empty</span><span class="o">=</span><span class="n">show_empty</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This function is a convenience function and only exists to make python version 3.13 and above <code>ast.dump()</code> output
compatible on a default call with previous python versions (important for doctests). All arguments correspond to
their respective <code>ast.dump()</code> arguments and <code>show_empty</code> is eaten on python versions below 3.13.</p>
</div>


                </section>
                <section id="FST">
                            <input id="FST-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FST</span>:

                <label class="view-source-button" for="FST-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST-185"><a href="#FST-185"><span class="linenos"> 185</span></a><span class="k">class</span><span class="w"> </span><span class="nc">FST</span><span class="p">:</span>
</span><span id="FST-186"><a href="#FST-186"><span class="linenos"> 186</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class which maintains structure and formatted source code for an `AST` tree. An instance of this class is added</span>
</span><span id="FST-187"><a href="#FST-187"><span class="linenos"> 187</span></a><span class="sd">    to each `AST` node in a tree. It provides format-preserving operations as well as ability to navigate the tree in</span>
</span><span id="FST-188"><a href="#FST-188"><span class="linenos"> 188</span></a><span class="sd">    any direction.&quot;&quot;&quot;</span>
</span><span id="FST-189"><a href="#FST-189"><span class="linenos"> 189</span></a>
</span><span id="FST-190"><a href="#FST-190"><span class="linenos"> 190</span></a>    <span class="n">a</span><span class="p">:</span>            <span class="n">AST</span>              <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The actual `AST` node.&quot;&quot;&quot;</span>
</span><span id="FST-191"><a href="#FST-191"><span class="linenos"> 191</span></a>    <span class="n">parent</span><span class="p">:</span>       <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span>       <span class="p">;</span> <span class="s2">&quot;&quot;&quot;Parent `FST` node, `None` in root node.&quot;&quot;&quot;</span>
</span><span id="FST-192"><a href="#FST-192"><span class="linenos"> 192</span></a>    <span class="n">pfield</span><span class="p">:</span>       <span class="n">astfield</span> <span class="o">|</span> <span class="kc">None</span>  <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The `astfield` location of this node in the parent, `None` in root node.&quot;&quot;&quot;</span>
</span><span id="FST-193"><a href="#FST-193"><span class="linenos"> 193</span></a>    <span class="n">root</span><span class="p">:</span>         <span class="n">FST</span>              <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The root node of this tree, `self` in root node.&quot;&quot;&quot;</span>
</span><span id="FST-194"><a href="#FST-194"><span class="linenos"> 194</span></a>    <span class="n">_cache</span><span class="p">:</span>       <span class="nb">dict</span>
</span><span id="FST-195"><a href="#FST-195"><span class="linenos"> 195</span></a>
</span><span id="FST-196"><a href="#FST-196"><span class="linenos"> 196</span></a>    <span class="c1"># ROOT ONLY</span>
</span><span id="FST-197"><a href="#FST-197"><span class="linenos"> 197</span></a>    <span class="n">parse_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>  <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The parameters to use for any `ast.parse()` that needs to be done (filename, type_comments, feature_version), root node only.&quot;&quot;&quot;</span>
</span><span id="FST-198"><a href="#FST-198"><span class="linenos"> 198</span></a>    <span class="n">indent</span><span class="p">:</span>       <span class="n">builtins</span><span class="o">.</span><span class="n">str</span>             <span class="p">;</span> <span class="s2">&quot;&quot;&quot;The default single level of block indentation string for this tree when not available from context, root node only.&quot;&quot;&quot;</span>
</span><span id="FST-199"><a href="#FST-199"><span class="linenos"> 199</span></a>    <span class="n">_lines</span><span class="p">:</span>       <span class="nb">list</span><span class="p">[</span><span class="n">bistr</span><span class="p">]</span>
</span><span id="FST-200"><a href="#FST-200"><span class="linenos"> 200</span></a>    <span class="n">_serial</span><span class="p">:</span>      <span class="nb">int</span>
</span><span id="FST-201"><a href="#FST-201"><span class="linenos"> 201</span></a>
</span><span id="FST-202"><a href="#FST-202"><span class="linenos"> 202</span></a>    <span class="c1"># class attributes</span>
</span><span id="FST-203"><a href="#FST-203"><span class="linenos"> 203</span></a>    <span class="n">is_FST</span><span class="p">:</span>       <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>      <span class="p">;</span> <span class="s2">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>  <span class="c1"># for quick checks vs. `fstloc` or `fstview`</span>
</span><span id="FST-204"><a href="#FST-204"><span class="linenos"> 204</span></a>
</span><span id="FST-205"><a href="#FST-205"><span class="linenos"> 205</span></a>    <span class="nd">@property</span>
</span><span id="FST-206"><a href="#FST-206"><span class="linenos"> 206</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-207"><a href="#FST-207"><span class="linenos"> 207</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whole lines which contain this node, may also contain parts of enclosing nodes. If gotten at root then the</span>
</span><span id="FST-208"><a href="#FST-208"><span class="linenos"> 208</span></a><span class="sd">        entire source is returned, which may extend beyond the location of the top level node (mostly for statements</span>
</span><span id="FST-209"><a href="#FST-209"><span class="linenos"> 209</span></a><span class="sd">        which may have leading / trailing comments or empty lines).&quot;&quot;&quot;</span>
</span><span id="FST-210"><a href="#FST-210"><span class="linenos"> 210</span></a>
</span><span id="FST-211"><a href="#FST-211"><span class="linenos"> 211</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="FST-212"><a href="#FST-212"><span class="linenos"> 212</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST-213"><a href="#FST-213"><span class="linenos"> 213</span></a>        <span class="k">elif</span> <span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">:</span>
</span><span id="FST-214"><a href="#FST-214"><span class="linenos"> 214</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="o">.</span><span class="n">ln</span> <span class="p">:</span> <span class="n">loc</span><span class="o">.</span><span class="n">end_ln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="FST-215"><a href="#FST-215"><span class="linenos"> 215</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>  <span class="c1"># arguments with no loc are empty arguments</span>
</span><span id="FST-216"><a href="#FST-216"><span class="linenos"> 216</span></a>            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
</span><span id="FST-217"><a href="#FST-217"><span class="linenos"> 217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-218"><a href="#FST-218"><span class="linenos"> 218</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">:=</span> <span class="n">OPCLS2STR</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># for boolop only really, otherwise None</span>
</span><span id="FST-219"><a href="#FST-219"><span class="linenos"> 219</span></a>
</span><span id="FST-220"><a href="#FST-220"><span class="linenos"> 220</span></a>    <span class="nd">@property</span>
</span><span id="FST-221"><a href="#FST-221"><span class="linenos"> 221</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">src</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-222"><a href="#FST-222"><span class="linenos"> 222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Source code of this node clipped out of as a single string, without any dedentation. Will have indentation as</span>
</span><span id="FST-223"><a href="#FST-223"><span class="linenos"> 223</span></a><span class="sd">        it appears in the top level source if multiple lines. If gotten at root then the entire source is returned,</span>
</span><span id="FST-224"><a href="#FST-224"><span class="linenos"> 224</span></a><span class="sd">        regardless of whether the actual top level node location includes it or not.&quot;&quot;&quot;</span>
</span><span id="FST-225"><a href="#FST-225"><span class="linenos"> 225</span></a>
</span><span id="FST-226"><a href="#FST-226"><span class="linenos"> 226</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="FST-227"><a href="#FST-227"><span class="linenos"> 227</span></a>            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span>
</span><span id="FST-228"><a href="#FST-228"><span class="linenos"> 228</span></a>        <span class="k">elif</span> <span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">:</span>
</span><span id="FST-229"><a href="#FST-229"><span class="linenos"> 229</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="o">*</span><span class="n">loc</span><span class="p">)</span>
</span><span id="FST-230"><a href="#FST-230"><span class="linenos"> 230</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>  <span class="c1"># arguments with no loc are empty arguments</span>
</span><span id="FST-231"><a href="#FST-231"><span class="linenos"> 231</span></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST-232"><a href="#FST-232"><span class="linenos"> 232</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-233"><a href="#FST-233"><span class="linenos"> 233</span></a>            <span class="k">return</span> <span class="n">OPCLS2STR</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># for boolop only really, otherwise None</span>
</span><span id="FST-234"><a href="#FST-234"><span class="linenos"> 234</span></a>
</span><span id="FST-235"><a href="#FST-235"><span class="linenos"> 235</span></a>    <span class="nd">@property</span>
</span><span id="FST-236"><a href="#FST-236"><span class="linenos"> 236</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-237"><a href="#FST-237"><span class="linenos"> 237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;`True` for the root node, `False` otherwise.&quot;&quot;&quot;</span>
</span><span id="FST-238"><a href="#FST-238"><span class="linenos"> 238</span></a>
</span><span id="FST-239"><a href="#FST-239"><span class="linenos"> 239</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="FST-240"><a href="#FST-240"><span class="linenos"> 240</span></a>
</span><span id="FST-241"><a href="#FST-241"><span class="linenos"> 241</span></a>    <span class="nd">@property</span>
</span><span id="FST-242"><a href="#FST-242"><span class="linenos"> 242</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_own_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-243"><a href="#FST-243"><span class="linenos"> 243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;`True` when the node has its own location which comes directly from AST `lineno` and other location fields.</span>
</span><span id="FST-244"><a href="#FST-244"><span class="linenos"> 244</span></a><span class="sd">        Otherwise `False` if no `loc` or `loc` is calculated.&quot;&quot;&quot;</span>
</span><span id="FST-245"><a href="#FST-245"><span class="linenos"> 245</span></a>
</span><span id="FST-246"><a href="#FST-246"><span class="linenos"> 246</span></a>        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;end_col_offset&#39;</span><span class="p">)</span>
</span><span id="FST-247"><a href="#FST-247"><span class="linenos"> 247</span></a>
</span><span id="FST-248"><a href="#FST-248"><span class="linenos"> 248</span></a>    <span class="nd">@property</span>
</span><span id="FST-249"><a href="#FST-249"><span class="linenos"> 249</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">whole_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span><span class="p">:</span>
</span><span id="FST-250"><a href="#FST-250"><span class="linenos"> 250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whole source location, from 0,0 to end of source. Works from any node (not just root).&quot;&quot;&quot;</span>
</span><span id="FST-251"><a href="#FST-251"><span class="linenos"> 251</span></a>
</span><span id="FST-252"><a href="#FST-252"><span class="linenos"> 252</span></a>        <span class="k">return</span> <span class="n">fstloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="FST-253"><a href="#FST-253"><span class="linenos"> 253</span></a>
</span><span id="FST-254"><a href="#FST-254"><span class="linenos"> 254</span></a>    <span class="nd">@property</span>
</span><span id="FST-255"><a href="#FST-255"><span class="linenos"> 255</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-256"><a href="#FST-256"><span class="linenos"> 256</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Zero based character indexed location of node (may not be entire location if node has decorators). Not all</span>
</span><span id="FST-257"><a href="#FST-257"><span class="linenos"> 257</span></a><span class="sd">        nodes have locations (like `expr_context`). Other nodes which normally don&#39;t have locations like `arguments` or</span>
</span><span id="FST-258"><a href="#FST-258"><span class="linenos"> 258</span></a><span class="sd">        most operators have this location calculated from their children or source. NOTE: Empty arguments do NOT have</span>
</span><span id="FST-259"><a href="#FST-259"><span class="linenos"> 259</span></a><span class="sd">        a location even though the `AST` exists.&quot;&quot;&quot;</span>
</span><span id="FST-260"><a href="#FST-260"><span class="linenos"> 260</span></a>
</span><span id="FST-261"><a href="#FST-261"><span class="linenos"> 261</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST-262"><a href="#FST-262"><span class="linenos"> 262</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span>
</span><span id="FST-263"><a href="#FST-263"><span class="linenos"> 263</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="FST-264"><a href="#FST-264"><span class="linenos"> 264</span></a>            <span class="k">pass</span>
</span><span id="FST-265"><a href="#FST-265"><span class="linenos"> 265</span></a>
</span><span id="FST-266"><a href="#FST-266"><span class="linenos"> 266</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-267"><a href="#FST-267"><span class="linenos"> 267</span></a>
</span><span id="FST-268"><a href="#FST-268"><span class="linenos"> 268</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST-269"><a href="#FST-269"><span class="linenos"> 269</span></a>            <span class="n">ln</span>             <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="FST-270"><a href="#FST-270"><span class="linenos"> 270</span></a>            <span class="n">col_offset</span>     <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">col_offset</span>
</span><span id="FST-271"><a href="#FST-271"><span class="linenos"> 271</span></a>            <span class="n">end_ln</span>         <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">end_lineno</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="FST-272"><a href="#FST-272"><span class="linenos"> 272</span></a>            <span class="n">end_col_offset</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">end_col_offset</span>
</span><span id="FST-273"><a href="#FST-273"><span class="linenos"> 273</span></a>
</span><span id="FST-274"><a href="#FST-274"><span class="linenos"> 274</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="FST-275"><a href="#FST-275"><span class="linenos"> 275</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
</span><span id="FST-276"><a href="#FST-276"><span class="linenos"> 276</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_arguments</span><span class="p">()</span>
</span><span id="FST-277"><a href="#FST-277"><span class="linenos"> 277</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">comprehension</span><span class="p">):</span>
</span><span id="FST-278"><a href="#FST-278"><span class="linenos"> 278</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_comprehension</span><span class="p">()</span>
</span><span id="FST-279"><a href="#FST-279"><span class="linenos"> 279</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">withitem</span><span class="p">):</span>
</span><span id="FST-280"><a href="#FST-280"><span class="linenos"> 280</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_withitem</span><span class="p">()</span>
</span><span id="FST-281"><a href="#FST-281"><span class="linenos"> 281</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">match_case</span><span class="p">):</span>
</span><span id="FST-282"><a href="#FST-282"><span class="linenos"> 282</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_match_case</span><span class="p">()</span>
</span><span id="FST-283"><a href="#FST-283"><span class="linenos"> 283</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">cmpop</span><span class="p">)):</span>
</span><span id="FST-284"><a href="#FST-284"><span class="linenos"> 284</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_operator</span><span class="p">()</span>
</span><span id="FST-285"><a href="#FST-285"><span class="linenos"> 285</span></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST-286"><a href="#FST-286"><span class="linenos"> 286</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="FST-287"><a href="#FST-287"><span class="linenos"> 287</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST-288"><a href="#FST-288"><span class="linenos"> 288</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST-289"><a href="#FST-289"><span class="linenos"> 289</span></a>
</span><span id="FST-290"><a href="#FST-290"><span class="linenos"> 290</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-291"><a href="#FST-291"><span class="linenos"> 291</span></a>            <span class="n">col</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">b2c</span><span class="p">(</span><span class="n">col_offset</span><span class="p">)</span>
</span><span id="FST-292"><a href="#FST-292"><span class="linenos"> 292</span></a>            <span class="n">end_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">end_ln</span><span class="p">]</span><span class="o">.</span><span class="n">b2c</span><span class="p">(</span><span class="n">end_col_offset</span><span class="p">)</span>
</span><span id="FST-293"><a href="#FST-293"><span class="linenos"> 293</span></a>            <span class="n">loc</span>     <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">)</span>
</span><span id="FST-294"><a href="#FST-294"><span class="linenos"> 294</span></a>
</span><span id="FST-295"><a href="#FST-295"><span class="linenos"> 295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc</span>
</span><span id="FST-296"><a href="#FST-296"><span class="linenos"> 296</span></a>
</span><span id="FST-297"><a href="#FST-297"><span class="linenos"> 297</span></a>        <span class="k">return</span> <span class="n">loc</span>
</span><span id="FST-298"><a href="#FST-298"><span class="linenos"> 298</span></a>
</span><span id="FST-299"><a href="#FST-299"><span class="linenos"> 299</span></a>    <span class="nd">@property</span>
</span><span id="FST-300"><a href="#FST-300"><span class="linenos"> 300</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bloc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-301"><a href="#FST-301"><span class="linenos"> 301</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Bounding location of node, including any preceding decorators. Not all nodes have locations but any node</span>
</span><span id="FST-302"><a href="#FST-302"><span class="linenos"> 302</span></a><span class="sd">        which has a `loc` will have a `bloc`. Will be same as `loc` for all nodes except those that have decorators, in</span>
</span><span id="FST-303"><a href="#FST-303"><span class="linenos"> 303</span></a><span class="sd">        which case it will start at the first decorator.&quot;&quot;&quot;</span>
</span><span id="FST-304"><a href="#FST-304"><span class="linenos"> 304</span></a>
</span><span id="FST-305"><a href="#FST-305"><span class="linenos"> 305</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST-306"><a href="#FST-306"><span class="linenos"> 306</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;bloc&#39;</span><span class="p">]</span>
</span><span id="FST-307"><a href="#FST-307"><span class="linenos"> 307</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="FST-308"><a href="#FST-308"><span class="linenos"> 308</span></a>            <span class="k">pass</span>
</span><span id="FST-309"><a href="#FST-309"><span class="linenos"> 309</span></a>
</span><span id="FST-310"><a href="#FST-310"><span class="linenos"> 310</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">bloc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">decos</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;decorator_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
</span><span id="FST-311"><a href="#FST-311"><span class="linenos"> 311</span></a>            <span class="n">bloc</span> <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="n">decos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">ln</span><span class="p">,</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># column of deco &#39;@&#39; will be same as our column</span>
</span><span id="FST-312"><a href="#FST-312"><span class="linenos"> 312</span></a>
</span><span id="FST-313"><a href="#FST-313"><span class="linenos"> 313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;bloc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bloc</span>
</span><span id="FST-314"><a href="#FST-314"><span class="linenos"> 314</span></a>
</span><span id="FST-315"><a href="#FST-315"><span class="linenos"> 315</span></a>        <span class="k">return</span> <span class="n">bloc</span>
</span><span id="FST-316"><a href="#FST-316"><span class="linenos"> 316</span></a>
</span><span id="FST-317"><a href="#FST-317"><span class="linenos"> 317</span></a>    <span class="nd">@property</span>
</span><span id="FST-318"><a href="#FST-318"><span class="linenos"> 318</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="FST-319"><a href="#FST-319"><span class="linenos"> 319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the first line of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST-320"><a href="#FST-320"><span class="linenos"> 320</span></a>
</span><span id="FST-321"><a href="#FST-321"><span class="linenos"> 321</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FST-322"><a href="#FST-322"><span class="linenos"> 322</span></a>
</span><span id="FST-323"><a href="#FST-323"><span class="linenos"> 323</span></a>    <span class="nd">@property</span>
</span><span id="FST-324"><a href="#FST-324"><span class="linenos"> 324</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># char index</span>
</span><span id="FST-325"><a href="#FST-325"><span class="linenos"> 325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;CHARACTER index of the start of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST-326"><a href="#FST-326"><span class="linenos"> 326</span></a>
</span><span id="FST-327"><a href="#FST-327"><span class="linenos"> 327</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FST-328"><a href="#FST-328"><span class="linenos"> 328</span></a>
</span><span id="FST-329"><a href="#FST-329"><span class="linenos"> 329</span></a>    <span class="nd">@property</span>
</span><span id="FST-330"><a href="#FST-330"><span class="linenos"> 330</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_ln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 0 based</span>
</span><span id="FST-331"><a href="#FST-331"><span class="linenos"> 331</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the LAST LINE of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST-332"><a href="#FST-332"><span class="linenos"> 332</span></a>
</span><span id="FST-333"><a href="#FST-333"><span class="linenos"> 333</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="FST-334"><a href="#FST-334"><span class="linenos"> 334</span></a>
</span><span id="FST-335"><a href="#FST-335"><span class="linenos"> 335</span></a>    <span class="nd">@property</span>
</span><span id="FST-336"><a href="#FST-336"><span class="linenos"> 336</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># char index</span>
</span><span id="FST-337"><a href="#FST-337"><span class="linenos"> 337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;CHARACTER index one past the end of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST-338"><a href="#FST-338"><span class="linenos"> 338</span></a>
</span><span id="FST-339"><a href="#FST-339"><span class="linenos"> 339</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="FST-340"><a href="#FST-340"><span class="linenos"> 340</span></a>
</span><span id="FST-341"><a href="#FST-341"><span class="linenos"> 341</span></a>    <span class="nd">@property</span>
</span><span id="FST-342"><a href="#FST-342"><span class="linenos"> 342</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># bounding location including @decorators</span>
</span><span id="FST-343"><a href="#FST-343"><span class="linenos"> 343</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the first line of this node or the first decorator if present (0 based). The corresponding</span>
</span><span id="FST-344"><a href="#FST-344"><span class="linenos"> 344</span></a><span class="sd">        `bcol`, `bend_ln` and `bend_col` are just aliases for the normal values.&quot;&quot;&quot;</span>
</span><span id="FST-345"><a href="#FST-345"><span class="linenos"> 345</span></a>
</span><span id="FST-346"><a href="#FST-346"><span class="linenos"> 346</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FST-347"><a href="#FST-347"><span class="linenos"> 347</span></a>
</span><span id="FST-348"><a href="#FST-348"><span class="linenos"> 348</span></a>    <span class="n">bcol</span>     <span class="o">=</span> <span class="n">col</span>  <span class="c1"># for symmetry</span>
</span><span id="FST-349"><a href="#FST-349"><span class="linenos"> 349</span></a>    <span class="n">bend_ln</span>  <span class="o">=</span> <span class="n">end_ln</span>
</span><span id="FST-350"><a href="#FST-350"><span class="linenos"> 350</span></a>    <span class="n">bend_col</span> <span class="o">=</span> <span class="n">end_col</span>
</span><span id="FST-351"><a href="#FST-351"><span class="linenos"> 351</span></a>
</span><span id="FST-352"><a href="#FST-352"><span class="linenos"> 352</span></a>    <span class="nd">@property</span>
</span><span id="FST-353"><a href="#FST-353"><span class="linenos"> 353</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lineno</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 1 based</span>
</span><span id="FST-354"><a href="#FST-354"><span class="linenos"> 354</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style Line number of the first line of this node (1 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="FST-355"><a href="#FST-355"><span class="linenos"> 355</span></a>
</span><span id="FST-356"><a href="#FST-356"><span class="linenos"> 356</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="FST-357"><a href="#FST-357"><span class="linenos"> 357</span></a>
</span><span id="FST-358"><a href="#FST-358"><span class="linenos"> 358</span></a>    <span class="nd">@property</span>
</span><span id="FST-359"><a href="#FST-359"><span class="linenos"> 359</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">col_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># byte index</span>
</span><span id="FST-360"><a href="#FST-360"><span class="linenos"> 360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style BYTE index of the start of this node (0 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="FST-361"><a href="#FST-361"><span class="linenos"> 361</span></a>
</span><span id="FST-362"><a href="#FST-362"><span class="linenos"> 362</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">c2b</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST-363"><a href="#FST-363"><span class="linenos"> 363</span></a>
</span><span id="FST-364"><a href="#FST-364"><span class="linenos"> 364</span></a>    <span class="nd">@property</span>
</span><span id="FST-365"><a href="#FST-365"><span class="linenos"> 365</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_lineno</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 1 based</span>
</span><span id="FST-366"><a href="#FST-366"><span class="linenos"> 366</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style Line number of the LAST LINE of this node (1 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="FST-367"><a href="#FST-367"><span class="linenos"> 367</span></a>
</span><span id="FST-368"><a href="#FST-368"><span class="linenos"> 368</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="FST-369"><a href="#FST-369"><span class="linenos"> 369</span></a>
</span><span id="FST-370"><a href="#FST-370"><span class="linenos"> 370</span></a>    <span class="nd">@property</span>
</span><span id="FST-371"><a href="#FST-371"><span class="linenos"> 371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_col_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># byte index</span>
</span><span id="FST-372"><a href="#FST-372"><span class="linenos"> 372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style BYTE index one past the end of this node (0 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="FST-373"><a href="#FST-373"><span class="linenos"> 373</span></a>
</span><span id="FST-374"><a href="#FST-374"><span class="linenos"> 374</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">c2b</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="FST-375"><a href="#FST-375"><span class="linenos"> 375</span></a>
</span><span id="FST-376"><a href="#FST-376"><span class="linenos"> 376</span></a>    <span class="nd">@property</span>
</span><span id="FST-377"><a href="#FST-377"><span class="linenos"> 377</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_mod</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-378"><a href="#FST-378"><span class="linenos"> 378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `mod`.&quot;&quot;&quot;</span>
</span><span id="FST-379"><a href="#FST-379"><span class="linenos"> 379</span></a>
</span><span id="FST-380"><a href="#FST-380"><span class="linenos"> 380</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</span><span id="FST-381"><a href="#FST-381"><span class="linenos"> 381</span></a>
</span><span id="FST-382"><a href="#FST-382"><span class="linenos"> 382</span></a>    <span class="nd">@property</span>
</span><span id="FST-383"><a href="#FST-383"><span class="linenos"> 383</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_stmtish</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-384"><a href="#FST-384"><span class="linenos"> 384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `stmt`, `ExceptHandler` or `match_case`.&quot;&quot;&quot;</span>
</span><span id="FST-385"><a href="#FST-385"><span class="linenos"> 385</span></a>
</span><span id="FST-386"><a href="#FST-386"><span class="linenos"> 386</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">STMTISH</span><span class="p">)</span>
</span><span id="FST-387"><a href="#FST-387"><span class="linenos"> 387</span></a>
</span><span id="FST-388"><a href="#FST-388"><span class="linenos"> 388</span></a>    <span class="nd">@property</span>
</span><span id="FST-389"><a href="#FST-389"><span class="linenos"> 389</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-390"><a href="#FST-390"><span class="linenos"> 390</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `stmt`.&quot;&quot;&quot;</span>
</span><span id="FST-391"><a href="#FST-391"><span class="linenos"> 391</span></a>
</span><span id="FST-392"><a href="#FST-392"><span class="linenos"> 392</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">stmt</span><span class="p">)</span>
</span><span id="FST-393"><a href="#FST-393"><span class="linenos"> 393</span></a>
</span><span id="FST-394"><a href="#FST-394"><span class="linenos"> 394</span></a>    <span class="nd">@property</span>
</span><span id="FST-395"><a href="#FST-395"><span class="linenos"> 395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-396"><a href="#FST-396"><span class="linenos"> 396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a block. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef`, `For`,</span>
</span><span id="FST-397"><a href="#FST-397"><span class="linenos"> 397</span></a><span class="sd">        `AsyncFor`, `While`, `If`, `With`, `AsyncWith`, `Match`, `Try`, `TryStar`, `ExceptHandler`, `match_case` or</span>
</span><span id="FST-398"><a href="#FST-398"><span class="linenos"> 398</span></a><span class="sd">        `mod`.&quot;&quot;&quot;</span>
</span><span id="FST-399"><a href="#FST-399"><span class="linenos"> 399</span></a>
</span><span id="FST-400"><a href="#FST-400"><span class="linenos"> 400</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">BLOCK_OR_MOD</span><span class="p">)</span>
</span><span id="FST-401"><a href="#FST-401"><span class="linenos"> 401</span></a>
</span><span id="FST-402"><a href="#FST-402"><span class="linenos"> 402</span></a>    <span class="nd">@property</span>
</span><span id="FST-403"><a href="#FST-403"><span class="linenos"> 403</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-404"><a href="#FST-404"><span class="linenos"> 404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a scope. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef`, `Lambda`,</span>
</span><span id="FST-405"><a href="#FST-405"><span class="linenos"> 405</span></a><span class="sd">        `ListComp`, `SetComp`, `DictComp`, `GeneratorExp` or `mod`.&quot;&quot;&quot;</span>
</span><span id="FST-406"><a href="#FST-406"><span class="linenos"> 406</span></a>
</span><span id="FST-407"><a href="#FST-407"><span class="linenos"> 407</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">SCOPE_OR_MOD</span><span class="p">)</span>
</span><span id="FST-408"><a href="#FST-408"><span class="linenos"> 408</span></a>
</span><span id="FST-409"><a href="#FST-409"><span class="linenos"> 409</span></a>    <span class="nd">@property</span>
</span><span id="FST-410"><a href="#FST-410"><span class="linenos"> 410</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_named_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-411"><a href="#FST-411"><span class="linenos"> 411</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a named scope. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef` or `mod`.&quot;&quot;&quot;</span>
</span><span id="FST-412"><a href="#FST-412"><span class="linenos"> 412</span></a>
</span><span id="FST-413"><a href="#FST-413"><span class="linenos"> 413</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">NAMED_SCOPE_OR_MOD</span><span class="p">)</span>
</span><span id="FST-414"><a href="#FST-414"><span class="linenos"> 414</span></a>
</span><span id="FST-415"><a href="#FST-415"><span class="linenos"> 415</span></a>    <span class="nd">@property</span>
</span><span id="FST-416"><a href="#FST-416"><span class="linenos"> 416</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_anon_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-417"><a href="#FST-417"><span class="linenos"> 417</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens an anonymous scope. Types include `Lambda`, `ListComp`, `SetComp`, `DictComp` or</span>
</span><span id="FST-418"><a href="#FST-418"><span class="linenos"> 418</span></a><span class="sd">        `GeneratorExp`.&quot;&quot;&quot;</span>
</span><span id="FST-419"><a href="#FST-419"><span class="linenos"> 419</span></a>
</span><span id="FST-420"><a href="#FST-420"><span class="linenos"> 420</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">ANONYMOUS_SCOPE</span><span class="p">)</span>
</span><span id="FST-421"><a href="#FST-421"><span class="linenos"> 421</span></a>
</span><span id="FST-422"><a href="#FST-422"><span class="linenos"> 422</span></a>    <span class="nd">@property</span>
</span><span id="FST-423"><a href="#FST-423"><span class="linenos"> 423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-424"><a href="#FST-424"><span class="linenos"> 424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether self is a `Slice` or a `Tuple` which directly contains any `Slice`.</span>
</span><span id="FST-425"><a href="#FST-425"><span class="linenos"> 425</span></a>
</span><span id="FST-426"><a href="#FST-426"><span class="linenos"> 426</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-427"><a href="#FST-427"><span class="linenos"> 427</span></a><span class="sd">        ```py</span>
</span><span id="FST-428"><a href="#FST-428"><span class="linenos"> 428</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;, &#39;expr_slice&#39;).is_slice</span>
</span><span id="FST-429"><a href="#FST-429"><span class="linenos"> 429</span></a><span class="sd">        True</span>
</span><span id="FST-430"><a href="#FST-430"><span class="linenos"> 430</span></a>
</span><span id="FST-431"><a href="#FST-431"><span class="linenos"> 431</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, d:e&#39;, &#39;expr_slice&#39;).is_slice  # Tuple contains at least one Slice</span>
</span><span id="FST-432"><a href="#FST-432"><span class="linenos"> 432</span></a><span class="sd">        True</span>
</span><span id="FST-433"><a href="#FST-433"><span class="linenos"> 433</span></a>
</span><span id="FST-434"><a href="#FST-434"><span class="linenos"> 434</span></a><span class="sd">        &gt;&gt;&gt; # b is in the .slice field but is not a Slice or Slice Tuple</span>
</span><span id="FST-435"><a href="#FST-435"><span class="linenos"> 435</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b]&#39;).slice.is_slice</span>
</span><span id="FST-436"><a href="#FST-436"><span class="linenos"> 436</span></a><span class="sd">        False</span>
</span><span id="FST-437"><a href="#FST-437"><span class="linenos"> 437</span></a><span class="sd">        ```</span>
</span><span id="FST-438"><a href="#FST-438"><span class="linenos"> 438</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-439"><a href="#FST-439"><span class="linenos"> 439</span></a>
</span><span id="FST-440"><a href="#FST-440"><span class="linenos"> 440</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST-441"><a href="#FST-441"><span class="linenos"> 441</span></a>                                                  <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">elts</span><span class="p">))</span>
</span><span id="FST-442"><a href="#FST-442"><span class="linenos"> 442</span></a>
</span><span id="FST-443"><a href="#FST-443"><span class="linenos"> 443</span></a>    <span class="nd">@property</span>
</span><span id="FST-444"><a href="#FST-444"><span class="linenos"> 444</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_augop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-445"><a href="#FST-445"><span class="linenos"> 445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an augmented `operator` or not, or not an `operator` at all.</span>
</span><span id="FST-446"><a href="#FST-446"><span class="linenos"> 446</span></a>
</span><span id="FST-447"><a href="#FST-447"><span class="linenos"> 447</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-448"><a href="#FST-448"><span class="linenos"> 448</span></a><span class="sd">        - `True` if is augmented `operator`, `False` if non-augmented `operator` and `None` if is not `operator` at all.</span>
</span><span id="FST-449"><a href="#FST-449"><span class="linenos"> 449</span></a>
</span><span id="FST-450"><a href="#FST-450"><span class="linenos"> 450</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-451"><a href="#FST-451"><span class="linenos"> 451</span></a><span class="sd">        ```py</span>
</span><span id="FST-452"><a href="#FST-452"><span class="linenos"> 452</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;+&#39;).is_augop</span>
</span><span id="FST-453"><a href="#FST-453"><span class="linenos"> 453</span></a><span class="sd">        False</span>
</span><span id="FST-454"><a href="#FST-454"><span class="linenos"> 454</span></a>
</span><span id="FST-455"><a href="#FST-455"><span class="linenos"> 455</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;+=&#39;).is_augop</span>
</span><span id="FST-456"><a href="#FST-456"><span class="linenos"> 456</span></a><span class="sd">        True</span>
</span><span id="FST-457"><a href="#FST-457"><span class="linenos"> 457</span></a>
</span><span id="FST-458"><a href="#FST-458"><span class="linenos"> 458</span></a><span class="sd">        &gt;&gt;&gt; repr(FST(&#39;~&#39;).is_augop)</span>
</span><span id="FST-459"><a href="#FST-459"><span class="linenos"> 459</span></a><span class="sd">        &#39;None&#39;</span>
</span><span id="FST-460"><a href="#FST-460"><span class="linenos"> 460</span></a><span class="sd">        ```</span>
</span><span id="FST-461"><a href="#FST-461"><span class="linenos"> 461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-462"><a href="#FST-462"><span class="linenos"> 462</span></a>
</span><span id="FST-463"><a href="#FST-463"><span class="linenos"> 463</span></a>        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">operator</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">in</span> <span class="n">OPSTR2CLS_AUG</span>
</span><span id="FST-464"><a href="#FST-464"><span class="linenos"> 464</span></a>
</span><span id="FST-465"><a href="#FST-465"><span class="linenos"> 465</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="FST-466"><a href="#FST-466"><span class="linenos"> 466</span></a>    <span class="c1"># Management</span>
</span><span id="FST-467"><a href="#FST-467"><span class="linenos"> 467</span></a>
</span><span id="FST-468"><a href="#FST-468"><span class="linenos"> 468</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">:</span>
</span><span id="FST-469"><a href="#FST-469"><span class="linenos"> 469</span></a>        <span class="n">tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repr_tail</span><span class="p">()</span>
</span><span id="FST-470"><a href="#FST-470"><span class="linenos"> 470</span></a>        <span class="n">head</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="n">tail</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="FST-471"><a href="#FST-471"><span class="linenos"> 471</span></a>
</span><span id="FST-472"><a href="#FST-472"><span class="linenos"> 472</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_REPR_SRC_LINES</span><span class="p">:</span>
</span><span id="FST-473"><a href="#FST-473"><span class="linenos"> 473</span></a>            <span class="k">return</span> <span class="n">head</span>
</span><span id="FST-474"><a href="#FST-474"><span class="linenos"> 474</span></a>
</span><span id="FST-475"><a href="#FST-475"><span class="linenos"> 475</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST-476"><a href="#FST-476"><span class="linenos"> 476</span></a>            <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST-477"><a href="#FST-477"><span class="linenos"> 477</span></a>
</span><span id="FST-478"><a href="#FST-478"><span class="linenos"> 478</span></a>            <span class="k">if</span> <span class="n">end_ln</span> <span class="o">-</span> <span class="n">ln</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">_REPR_SRC_LINES</span><span class="p">:</span>
</span><span id="FST-479"><a href="#FST-479"><span class="linenos"> 479</span></a>                <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span> <span class="p">:</span> <span class="n">end_ln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="FST-480"><a href="#FST-480"><span class="linenos"> 480</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST-481"><a href="#FST-481"><span class="linenos"> 481</span></a>                <span class="n">ls</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span> <span class="p">:</span> <span class="n">ln</span> <span class="o">+</span> <span class="p">((</span><span class="n">_REPR_SRC_LINES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;...&#39;</span><span class="p">]</span> <span class="o">+</span>
</span><span id="FST-482"><a href="#FST-482"><span class="linenos"> 482</span></a>                      <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">end_ln</span> <span class="o">-</span> <span class="p">((</span><span class="n">_REPR_SRC_LINES</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="p">:</span> <span class="n">end_ln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="FST-483"><a href="#FST-483"><span class="linenos"> 483</span></a>
</span><span id="FST-484"><a href="#FST-484"><span class="linenos"> 484</span></a>            <span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="n">end_col</span><span class="p">]</span>
</span><span id="FST-485"><a href="#FST-485"><span class="linenos"> 485</span></a>            <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">col</span> <span class="o">+</span> <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">col</span><span class="p">:]</span>
</span><span id="FST-486"><a href="#FST-486"><span class="linenos"> 486</span></a>
</span><span id="FST-487"><a href="#FST-487"><span class="linenos"> 487</span></a>            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">head</span><span class="p">]</span> <span class="o">+</span> <span class="n">ls</span><span class="p">)</span>
</span><span id="FST-488"><a href="#FST-488"><span class="linenos"> 488</span></a>
</span><span id="FST-489"><a href="#FST-489"><span class="linenos"> 489</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="FST-490"><a href="#FST-490"><span class="linenos"> 490</span></a>            <span class="k">pass</span>
</span><span id="FST-491"><a href="#FST-491"><span class="linenos"> 491</span></a>
</span><span id="FST-492"><a href="#FST-492"><span class="linenos"> 492</span></a>        <span class="k">return</span> <span class="n">head</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">???&#39;</span>
</span><span id="FST-493"><a href="#FST-493"><span class="linenos"> 493</span></a>
</span><span id="FST-494"><a href="#FST-494"><span class="linenos"> 494</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="FST-495"><a href="#FST-495"><span class="linenos"> 495</span></a>                <span class="n">ast_or_src</span><span class="p">:</span> <span class="n">AST</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST-496"><a href="#FST-496"><span class="linenos"> 496</span></a>                <span class="n">mode_or_lines_or_parent</span><span class="p">:</span> <span class="n">FST</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mode</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST-497"><a href="#FST-497"><span class="linenos"> 497</span></a>                <span class="n">pfield</span><span class="p">:</span> <span class="n">astfield</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST-498"><a href="#FST-498"><span class="linenos"> 498</span></a>                <span class="o">/</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="FST-499"><a href="#FST-499"><span class="linenos"> 499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new individual `FST` node or full tree. The main way to use this constructor is as a shortcut for</span>
</span><span id="FST-500"><a href="#FST-500"><span class="linenos"> 500</span></a><span class="sd">        `FST.fromsrc()` or `FST.fromast()`, the usage is:</span>
</span><span id="FST-501"><a href="#FST-501"><span class="linenos"> 501</span></a>
</span><span id="FST-502"><a href="#FST-502"><span class="linenos"> 502</span></a><span class="sd">        **`FST(ast_or_src, mode=None)`**</span>
</span><span id="FST-503"><a href="#FST-503"><span class="linenos"> 503</span></a>
</span><span id="FST-504"><a href="#FST-504"><span class="linenos"> 504</span></a><span class="sd">        This will create an `FST` from either an `AST` or source code in the form of a string or list of lines. The</span>
</span><span id="FST-505"><a href="#FST-505"><span class="linenos"> 505</span></a><span class="sd">        first parameter can be `None` instead of an `AST` or source to indicate a blank new module of one of the three</span>
</span><span id="FST-506"><a href="#FST-506"><span class="linenos"> 506</span></a><span class="sd">        types `&#39;exec&#39;`, `&#39;eval&#39;` or `&#39;single&#39;`. Otherwise if there is `source` or an `AST` then `mode` specifies how it</span>
</span><span id="FST-507"><a href="#FST-507"><span class="linenos"> 507</span></a><span class="sd">        will be parsed / reparsed and it can take any of the values from `fst.misc.Mode`.</span>
</span><span id="FST-508"><a href="#FST-508"><span class="linenos"> 508</span></a>
</span><span id="FST-509"><a href="#FST-509"><span class="linenos"> 509</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-510"><a href="#FST-510"><span class="linenos"> 510</span></a><span class="sd">        - `ast_or_src`: Source code, an `AST` node or `None`.</span>
</span><span id="FST-511"><a href="#FST-511"><span class="linenos"> 511</span></a><span class="sd">        - `mode`: See `fst.misc.Mode`. If this is `None` then if `ast_or_src` is an `AST` the mode defaults to the</span>
</span><span id="FST-512"><a href="#FST-512"><span class="linenos"> 512</span></a><span class="sd">            type of the `AST`. Otherwise if the `ast_or_src` is actual source code then `mode` used is `&#39;all&#39;` to allow</span>
</span><span id="FST-513"><a href="#FST-513"><span class="linenos"> 513</span></a><span class="sd">            parsing anything. And if `ast_or_src` is `None` then `mode` must be provided and be one of `&#39;exec&#39;`,</span>
</span><span id="FST-514"><a href="#FST-514"><span class="linenos"> 514</span></a><span class="sd">            `&#39;eval&#39;` or `&#39;single&#39;`.</span>
</span><span id="FST-515"><a href="#FST-515"><span class="linenos"> 515</span></a>
</span><span id="FST-516"><a href="#FST-516"><span class="linenos"> 516</span></a><span class="sd">        The other forms of this function are meant for internal use and their parameters are below:</span>
</span><span id="FST-517"><a href="#FST-517"><span class="linenos"> 517</span></a>
</span><span id="FST-518"><a href="#FST-518"><span class="linenos"> 518</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-519"><a href="#FST-519"><span class="linenos"> 519</span></a><span class="sd">        - `ast_or_src`: `AST` node for `FST` or source code in the form of a `str` or a list of lines. If an `AST` then</span>
</span><span id="FST-520"><a href="#FST-520"><span class="linenos"> 520</span></a><span class="sd">            will be processed differently depending on if creating child node, top level node or using this as a</span>
</span><span id="FST-521"><a href="#FST-521"><span class="linenos"> 521</span></a><span class="sd">            shortcut for a full `fromsrc()` or `fromast()`.</span>
</span><span id="FST-522"><a href="#FST-522"><span class="linenos"> 522</span></a><span class="sd">        - `mode_or_lines_or_parent`: Parent node for this child node or lines for a root node creating a new tree. If</span>
</span><span id="FST-523"><a href="#FST-523"><span class="linenos"> 523</span></a><span class="sd">            `pfield` is `None` and this is a shortcut to create a full tree from an `AST` node or source provided in</span>
</span><span id="FST-524"><a href="#FST-524"><span class="linenos"> 524</span></a><span class="sd">            `ast_or_src`.</span>
</span><span id="FST-525"><a href="#FST-525"><span class="linenos"> 525</span></a><span class="sd">        - `pfield`: `astfield` indication position in parent of this node. If provided then creating a simple child node</span>
</span><span id="FST-526"><a href="#FST-526"><span class="linenos"> 526</span></a><span class="sd">            and it is created with the `self.parent` set to `mode_or_lines_or_parent` node and `self.pfield` set to</span>
</span><span id="FST-527"><a href="#FST-527"><span class="linenos"> 527</span></a><span class="sd">            this. If `None` then it means the creation of a full new `FST` tree and this is the root node with</span>
</span><span id="FST-528"><a href="#FST-528"><span class="linenos"> 528</span></a><span class="sd">            `mode_or_lines_or_parent` providing the source.</span>
</span><span id="FST-529"><a href="#FST-529"><span class="linenos"> 529</span></a><span class="sd">        - `kwargs`: Contextual parameters:</span>
</span><span id="FST-530"><a href="#FST-530"><span class="linenos"> 530</span></a><span class="sd">            - `from_`: If this is provided then it must be an `FST` node from which this node is being created. This</span>
</span><span id="FST-531"><a href="#FST-531"><span class="linenos"> 531</span></a><span class="sd">                allows to copy parse parameters and already determined default indentation.</span>
</span><span id="FST-532"><a href="#FST-532"><span class="linenos"> 532</span></a><span class="sd">            - `parse_params`: A `dict` with values for &#39;filename&#39;, &#39;type_comments&#39; and &#39;feature_version&#39; which will be</span>
</span><span id="FST-533"><a href="#FST-533"><span class="linenos"> 533</span></a><span class="sd">                used for any `AST` reparse done on this tree. Only valid when creating a root node.</span>
</span><span id="FST-534"><a href="#FST-534"><span class="linenos"> 534</span></a><span class="sd">            - `indent`: Indentation string to use as default indentation. If not provided and not gotten from `from_`</span>
</span><span id="FST-535"><a href="#FST-535"><span class="linenos"> 535</span></a><span class="sd">                then indentation will be inferred from source. Only valid when creating a root node.</span>
</span><span id="FST-536"><a href="#FST-536"><span class="linenos"> 536</span></a><span class="sd">            - `filename`, `type_comments` and `feature_version`: If creating from an `AST` or source only then these are</span>
</span><span id="FST-537"><a href="#FST-537"><span class="linenos"> 537</span></a><span class="sd">                the parameteres passed to the respective `.new()`, `.fromsrc()` or `.fromast()` functions. Only valid</span>
</span><span id="FST-538"><a href="#FST-538"><span class="linenos"> 538</span></a><span class="sd">                when `mode_or_lines_or_parent` and `pfield` are `None`.</span>
</span><span id="FST-539"><a href="#FST-539"><span class="linenos"> 539</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-540"><a href="#FST-540"><span class="linenos"> 540</span></a>
</span><span id="FST-541"><a href="#FST-541"><span class="linenos"> 541</span></a>        <span class="k">if</span> <span class="n">pfield</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># top level shortcut</span>
</span><span id="FST-542"><a href="#FST-542"><span class="linenos"> 542</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;type_comments&#39;</span><span class="p">,</span> <span class="s1">&#39;feature_version&#39;</span><span class="p">)</span>
</span><span id="FST-543"><a href="#FST-543"><span class="linenos"> 543</span></a>                      <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">k</span><span class="p">}</span>  <span class="c1"># k used as sentinel</span>
</span><span id="FST-544"><a href="#FST-544"><span class="linenos"> 544</span></a>            <span class="n">indent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST-545"><a href="#FST-545"><span class="linenos"> 545</span></a>
</span><span id="FST-546"><a href="#FST-546"><span class="linenos"> 546</span></a>            <span class="k">if</span> <span class="n">from_</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;from_&#39;</span><span class="p">):</span> <span class="c1"># copy parse params from source tree</span>
</span><span id="FST-547"><a href="#FST-547"><span class="linenos"> 547</span></a>                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">from_</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">parse_params</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">}</span>
</span><span id="FST-548"><a href="#FST-548"><span class="linenos"> 548</span></a>                <span class="n">indent</span> <span class="o">=</span> <span class="n">from_</span><span class="o">.</span><span class="n">indent</span>
</span><span id="FST-549"><a href="#FST-549"><span class="linenos"> 549</span></a>
</span><span id="FST-550"><a href="#FST-550"><span class="linenos"> 550</span></a>            <span class="k">if</span> <span class="n">ast_or_src</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-551"><a href="#FST-551"><span class="linenos"> 551</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span> <span class="k">if</span> <span class="n">mode_or_lines_or_parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="FST-552"><a href="#FST-552"><span class="linenos"> 552</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="FST-553"><a href="#FST-553"><span class="linenos"> 553</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">fromast</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="FST-554"><a href="#FST-554"><span class="linenos"> 554</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST-555"><a href="#FST-555"><span class="linenos"> 555</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">fromsrc</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span> <span class="k">if</span> <span class="n">mode_or_lines_or_parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span>
</span><span id="FST-556"><a href="#FST-556"><span class="linenos"> 556</span></a>                                <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="FST-557"><a href="#FST-557"><span class="linenos"> 557</span></a>
</span><span id="FST-558"><a href="#FST-558"><span class="linenos"> 558</span></a>            <span class="k">if</span> <span class="n">indent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-559"><a href="#FST-559"><span class="linenos"> 559</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span>
</span><span id="FST-560"><a href="#FST-560"><span class="linenos"> 560</span></a>
</span><span id="FST-561"><a href="#FST-561"><span class="linenos"> 561</span></a>            <span class="k">return</span> <span class="n">f</span>
</span><span id="FST-562"><a href="#FST-562"><span class="linenos"> 562</span></a>
</span><span id="FST-563"><a href="#FST-563"><span class="linenos"> 563</span></a>        <span class="c1"># creating actual node</span>
</span><span id="FST-564"><a href="#FST-564"><span class="linenos"> 564</span></a>
</span><span id="FST-565"><a href="#FST-565"><span class="linenos"> 565</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># reuse FST node assigned to AST node (because otherwise it isn&#39;t valid anyway)</span>
</span><span id="FST-566"><a href="#FST-566"><span class="linenos"> 566</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_touch</span><span class="p">()</span>
</span><span id="FST-567"><a href="#FST-567"><span class="linenos"> 567</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-568"><a href="#FST-568"><span class="linenos"> 568</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">ast_or_src</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="FST-569"><a href="#FST-569"><span class="linenos"> 569</span></a>
</span><span id="FST-570"><a href="#FST-570"><span class="linenos"> 570</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span>       <span class="o">=</span> <span class="n">ast_or_src</span>  <span class="c1"># we don&#39;t assume `self.a` is `ast_or_src` if `.f` exists</span>
</span><span id="FST-571"><a href="#FST-571"><span class="linenos"> 571</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span>  <span class="o">=</span> <span class="n">pfield</span>
</span><span id="FST-572"><a href="#FST-572"><span class="linenos"> 572</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>  <span class="o">=</span> <span class="p">{}</span>
</span><span id="FST-573"><a href="#FST-573"><span class="linenos"> 573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_serial</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FST-574"><a href="#FST-574"><span class="linenos"> 574</span></a>
</span><span id="FST-575"><a href="#FST-575"><span class="linenos"> 575</span></a>        <span class="k">if</span> <span class="n">pfield</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-576"><a href="#FST-576"><span class="linenos"> 576</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">mode_or_lines_or_parent</span>
</span><span id="FST-577"><a href="#FST-577"><span class="linenos"> 577</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span>   <span class="o">=</span> <span class="n">mode_or_lines_or_parent</span><span class="o">.</span><span class="n">root</span>
</span><span id="FST-578"><a href="#FST-578"><span class="linenos"> 578</span></a>
</span><span id="FST-579"><a href="#FST-579"><span class="linenos"> 579</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-580"><a href="#FST-580"><span class="linenos"> 580</span></a>
</span><span id="FST-581"><a href="#FST-581"><span class="linenos"> 581</span></a>        <span class="c1"># ROOT</span>
</span><span id="FST-582"><a href="#FST-582"><span class="linenos"> 582</span></a>
</span><span id="FST-583"><a href="#FST-583"><span class="linenos"> 583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST-584"><a href="#FST-584"><span class="linenos"> 584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span>   <span class="o">=</span> <span class="bp">self</span>
</span><span id="FST-585"><a href="#FST-585"><span class="linenos"> 585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span> <span class="o">=</span> <span class="p">([</span><span class="n">bistr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">mode_or_lines_or_parent</span><span class="p">]</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lcopy&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">else</span>
</span><span id="FST-586"><a href="#FST-586"><span class="linenos"> 586</span></a>                       <span class="n">mode_or_lines_or_parent</span><span class="p">)</span>
</span><span id="FST-587"><a href="#FST-587"><span class="linenos"> 587</span></a>
</span><span id="FST-588"><a href="#FST-588"><span class="linenos"> 588</span></a>        <span class="k">if</span> <span class="n">from_</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;from_&#39;</span><span class="p">):</span>  <span class="c1"># copy params from source tree</span>
</span><span id="FST-589"><a href="#FST-589"><span class="linenos"> 589</span></a>            <span class="n">from_root</span>         <span class="o">=</span> <span class="n">from_</span><span class="o">.</span><span class="n">root</span>
</span><span id="FST-590"><a href="#FST-590"><span class="linenos"> 590</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_params&#39;</span><span class="p">,</span> <span class="n">from_root</span><span class="o">.</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST-591"><a href="#FST-591"><span class="linenos"> 591</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">indent</span>       <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">,</span> <span class="n">from_root</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>
</span><span id="FST-592"><a href="#FST-592"><span class="linenos"> 592</span></a>
</span><span id="FST-593"><a href="#FST-593"><span class="linenos"> 593</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-594"><a href="#FST-594"><span class="linenos"> 594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_params&#39;</span><span class="p">,</span> <span class="n">_DEFAULT_PARSE_PARAMS</span><span class="p">)</span>
</span><span id="FST-595"><a href="#FST-595"><span class="linenos"> 595</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">indent</span>       <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;?&#39;</span>
</span><span id="FST-596"><a href="#FST-596"><span class="linenos"> 596</span></a>                                  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">Module</span><span class="p">)</span> <span class="k">else</span>
</span><span id="FST-597"><a href="#FST-597"><span class="linenos"> 597</span></a>                                  <span class="n">_DEFAULT_INDENT</span><span class="p">)</span>
</span><span id="FST-598"><a href="#FST-598"><span class="linenos"> 598</span></a>                                 <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span>
</span><span id="FST-599"><a href="#FST-599"><span class="linenos"> 599</span></a>                                 <span class="n">indent</span><span class="p">)</span>
</span><span id="FST-600"><a href="#FST-600"><span class="linenos"> 600</span></a>
</span><span id="FST-601"><a href="#FST-601"><span class="linenos"> 601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_make_fst_tree</span><span class="p">()</span>
</span><span id="FST-602"><a href="#FST-602"><span class="linenos"> 602</span></a>
</span><span id="FST-603"><a href="#FST-603"><span class="linenos"> 603</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>  <span class="c1"># infer indentation from source, just use first indentation found for performance, don&#39;t try to find most common or anything like that</span>
</span><span id="FST-604"><a href="#FST-604"><span class="linenos"> 604</span></a>            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ast_or_src</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
</span><span id="FST-605"><a href="#FST-605"><span class="linenos"> 605</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">AsyncFunctionDef</span><span class="p">,</span> <span class="n">ClassDef</span><span class="p">,</span> <span class="n">With</span><span class="p">,</span> <span class="n">AsyncWith</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span>
</span><span id="FST-606"><a href="#FST-606"><span class="linenos"> 606</span></a>                                  <span class="n">match_case</span><span class="p">)):</span>  <span class="c1"># we check ExceptHandler and match_case because they may be supported as standalone parsed elements eventually</span>
</span><span id="FST-607"><a href="#FST-607"><span class="linenos"> 607</span></a>                    <span class="n">indent</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
</span><span id="FST-608"><a href="#FST-608"><span class="linenos"> 608</span></a>
</span><span id="FST-609"><a href="#FST-609"><span class="linenos"> 609</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">For</span><span class="p">,</span> <span class="n">AsyncFor</span><span class="p">,</span> <span class="n">While</span><span class="p">,</span> <span class="n">If</span><span class="p">)):</span>
</span><span id="FST-610"><a href="#FST-610"><span class="linenos"> 610</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">orelse</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">orelse</span><span class="p">):</span>
</span><span id="FST-611"><a href="#FST-611"><span class="linenos"> 611</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()):</span>  <span class="c1"># because can be &#39;elif&#39;</span>
</span><span id="FST-612"><a href="#FST-612"><span class="linenos"> 612</span></a>                            <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
</span><span id="FST-613"><a href="#FST-613"><span class="linenos"> 613</span></a>
</span><span id="FST-614"><a href="#FST-614"><span class="linenos"> 614</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">Try</span><span class="p">,</span> <span class="n">TryStar</span><span class="p">)):</span>
</span><span id="FST-615"><a href="#FST-615"><span class="linenos"> 615</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST-616"><a href="#FST-616"><span class="linenos"> 616</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">orelse</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">orelse</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST-617"><a href="#FST-617"><span class="linenos"> 617</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">finalbody</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">finalbody</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">finalbody</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST-618"><a href="#FST-618"><span class="linenos"> 618</span></a>                                <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
</span><span id="FST-619"><a href="#FST-619"><span class="linenos"> 619</span></a>                                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">handler</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">!=</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST-620"><a href="#FST-620"><span class="linenos"> 620</span></a>                                        <span class="k">break</span>
</span><span id="FST-621"><a href="#FST-621"><span class="linenos"> 621</span></a>
</span><span id="FST-622"><a href="#FST-622"><span class="linenos"> 622</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Match</span><span class="p">):</span>
</span><span id="FST-623"><a href="#FST-623"><span class="linenos"> 623</span></a>                    <span class="n">indent</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
</span><span id="FST-624"><a href="#FST-624"><span class="linenos"> 624</span></a>
</span><span id="FST-625"><a href="#FST-625"><span class="linenos"> 625</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FST-626"><a href="#FST-626"><span class="linenos"> 626</span></a>                    <span class="k">continue</span>
</span><span id="FST-627"><a href="#FST-627"><span class="linenos"> 627</span></a>
</span><span id="FST-628"><a href="#FST-628"><span class="linenos"> 628</span></a>                <span class="k">if</span> <span class="n">indent</span> <span class="o">!=</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST-629"><a href="#FST-629"><span class="linenos"> 629</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span>
</span><span id="FST-630"><a href="#FST-630"><span class="linenos"> 630</span></a>
</span><span id="FST-631"><a href="#FST-631"><span class="linenos"> 631</span></a>                    <span class="k">break</span>
</span><span id="FST-632"><a href="#FST-632"><span class="linenos"> 632</span></a>
</span><span id="FST-633"><a href="#FST-633"><span class="linenos"> 633</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST-634"><a href="#FST-634"><span class="linenos"> 634</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">_DEFAULT_INDENT</span>
</span><span id="FST-635"><a href="#FST-635"><span class="linenos"> 635</span></a>
</span><span id="FST-636"><a href="#FST-636"><span class="linenos"> 636</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-637"><a href="#FST-637"><span class="linenos"> 637</span></a>
</span><span id="FST-638"><a href="#FST-638"><span class="linenos"> 638</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST-639"><a href="#FST-639"><span class="linenos"> 639</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="FST-640"><a href="#FST-640"><span class="linenos"> 640</span></a>            <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST-641"><a href="#FST-641"><span class="linenos"> 641</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new empty `FST` tree with the top level node dictated by the `mode` parameter.</span>
</span><span id="FST-642"><a href="#FST-642"><span class="linenos"> 642</span></a>
</span><span id="FST-643"><a href="#FST-643"><span class="linenos"> 643</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-644"><a href="#FST-644"><span class="linenos"> 644</span></a><span class="sd">        - `mode`: `ast.parse()` parameter, can only be `&#39;exec&#39;`, `&#39;eval&#39;` or `&#39;single&#39;` here.</span>
</span><span id="FST-645"><a href="#FST-645"><span class="linenos"> 645</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="FST-646"><a href="#FST-646"><span class="linenos"> 646</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="FST-647"><a href="#FST-647"><span class="linenos"> 647</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="FST-648"><a href="#FST-648"><span class="linenos"> 648</span></a>
</span><span id="FST-649"><a href="#FST-649"><span class="linenos"> 649</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-650"><a href="#FST-650"><span class="linenos"> 650</span></a><span class="sd">        - `FST`: The new empty top level `FST` node.</span>
</span><span id="FST-651"><a href="#FST-651"><span class="linenos"> 651</span></a>
</span><span id="FST-652"><a href="#FST-652"><span class="linenos"> 652</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-653"><a href="#FST-653"><span class="linenos"> 653</span></a><span class="sd">        ```py</span>
</span><span id="FST-654"><a href="#FST-654"><span class="linenos"> 654</span></a><span class="sd">        &gt;&gt;&gt; FST.new()</span>
</span><span id="FST-655"><a href="#FST-655"><span class="linenos"> 655</span></a><span class="sd">        &lt;Module ROOT 0,0..0,0&gt;</span>
</span><span id="FST-656"><a href="#FST-656"><span class="linenos"> 656</span></a>
</span><span id="FST-657"><a href="#FST-657"><span class="linenos"> 657</span></a><span class="sd">        &gt;&gt;&gt; FST.new(mode=&#39;single&#39;)</span>
</span><span id="FST-658"><a href="#FST-658"><span class="linenos"> 658</span></a><span class="sd">        &lt;Interactive ROOT 0,0..0,0&gt;</span>
</span><span id="FST-659"><a href="#FST-659"><span class="linenos"> 659</span></a>
</span><span id="FST-660"><a href="#FST-660"><span class="linenos"> 660</span></a><span class="sd">        &gt;&gt;&gt; FST.new(mode=&#39;eval&#39;)</span>
</span><span id="FST-661"><a href="#FST-661"><span class="linenos"> 661</span></a><span class="sd">        &lt;Expression ROOT 0,0..0,4&gt;</span>
</span><span id="FST-662"><a href="#FST-662"><span class="linenos"> 662</span></a>
</span><span id="FST-663"><a href="#FST-663"><span class="linenos"> 663</span></a><span class="sd">        &gt;&gt;&gt; _.dump()</span>
</span><span id="FST-664"><a href="#FST-664"><span class="linenos"> 664</span></a><span class="sd">        Expression - ROOT 0,0..0,4</span>
</span><span id="FST-665"><a href="#FST-665"><span class="linenos"> 665</span></a><span class="sd">          .body Constant None - 0,0..0,4</span>
</span><span id="FST-666"><a href="#FST-666"><span class="linenos"> 666</span></a>
</span><span id="FST-667"><a href="#FST-667"><span class="linenos"> 667</span></a><span class="sd">        &gt;&gt;&gt; _.src</span>
</span><span id="FST-668"><a href="#FST-668"><span class="linenos"> 668</span></a><span class="sd">        &#39;None&#39;</span>
</span><span id="FST-669"><a href="#FST-669"><span class="linenos"> 669</span></a><span class="sd">        ```</span>
</span><span id="FST-670"><a href="#FST-670"><span class="linenos"> 670</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-671"><a href="#FST-671"><span class="linenos"> 671</span></a>
</span><span id="FST-672"><a href="#FST-672"><span class="linenos"> 672</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="FST-673"><a href="#FST-673"><span class="linenos"> 673</span></a>
</span><span id="FST-674"><a href="#FST-674"><span class="linenos"> 674</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;exec&#39;</span><span class="p">:</span>
</span><span id="FST-675"><a href="#FST-675"><span class="linenos"> 675</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Module</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="p">[],</span> <span class="n">type_ignores</span><span class="o">=</span><span class="p">[])</span>
</span><span id="FST-676"><a href="#FST-676"><span class="linenos"> 676</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST-677"><a href="#FST-677"><span class="linenos"> 677</span></a>
</span><span id="FST-678"><a href="#FST-678"><span class="linenos"> 678</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;eval&#39;</span><span class="p">:</span>
</span><span id="FST-679"><a href="#FST-679"><span class="linenos"> 679</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lineno</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_lineno</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end_col_offset</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</span><span id="FST-680"><a href="#FST-680"><span class="linenos"> 680</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
</span><span id="FST-681"><a href="#FST-681"><span class="linenos"> 681</span></a>
</span><span id="FST-682"><a href="#FST-682"><span class="linenos"> 682</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
</span><span id="FST-683"><a href="#FST-683"><span class="linenos"> 683</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Interactive</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="p">[])</span>
</span><span id="FST-684"><a href="#FST-684"><span class="linenos"> 684</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST-685"><a href="#FST-685"><span class="linenos"> 685</span></a>
</span><span id="FST-686"><a href="#FST-686"><span class="linenos"> 686</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-687"><a href="#FST-687"><span class="linenos"> 687</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid mode &#39;</span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&#39; for blank FST&quot;</span><span class="p">)</span>
</span><span id="FST-688"><a href="#FST-688"><span class="linenos"> 688</span></a>
</span><span id="FST-689"><a href="#FST-689"><span class="linenos"> 689</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">src</span><span class="p">)],</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">,</span> <span class="n">lcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FST-690"><a href="#FST-690"><span class="linenos"> 690</span></a>
</span><span id="FST-691"><a href="#FST-691"><span class="linenos"> 691</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST-692"><a href="#FST-692"><span class="linenos"> 692</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fromsrc</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">],</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">=</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="FST-693"><a href="#FST-693"><span class="linenos"> 693</span></a>                <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST-694"><a href="#FST-694"><span class="linenos"> 694</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse and create a new `FST` tree from source, preserving the original source and locations.</span>
</span><span id="FST-695"><a href="#FST-695"><span class="linenos"> 695</span></a>
</span><span id="FST-696"><a href="#FST-696"><span class="linenos"> 696</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-697"><a href="#FST-697"><span class="linenos"> 697</span></a><span class="sd">        - `src`: The source to parse as a single `str` or list of individual line strings (without newlines).</span>
</span><span id="FST-698"><a href="#FST-698"><span class="linenos"> 698</span></a><span class="sd">        - `mode`: Parse mode, extended `ast.parse()` parameter, See `fst.misc.Mode`.</span>
</span><span id="FST-699"><a href="#FST-699"><span class="linenos"> 699</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="FST-700"><a href="#FST-700"><span class="linenos"> 700</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="FST-701"><a href="#FST-701"><span class="linenos"> 701</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="FST-702"><a href="#FST-702"><span class="linenos"> 702</span></a>
</span><span id="FST-703"><a href="#FST-703"><span class="linenos"> 703</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-704"><a href="#FST-704"><span class="linenos"> 704</span></a><span class="sd">        - `FST`: The parsed tree with `.f` attributes added to each `AST` node for `FST` access.</span>
</span><span id="FST-705"><a href="#FST-705"><span class="linenos"> 705</span></a>
</span><span id="FST-706"><a href="#FST-706"><span class="linenos"> 706</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-707"><a href="#FST-707"><span class="linenos"> 707</span></a><span class="sd">        ```py</span>
</span><span id="FST-708"><a href="#FST-708"><span class="linenos"> 708</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;).dump()</span>
</span><span id="FST-709"><a href="#FST-709"><span class="linenos"> 709</span></a><span class="sd">        Module - ROOT 0,0..0,3</span>
</span><span id="FST-710"><a href="#FST-710"><span class="linenos"> 710</span></a><span class="sd">          .body[1]</span>
</span><span id="FST-711"><a href="#FST-711"><span class="linenos"> 711</span></a><span class="sd">          0] Expr - 0,0..0,3</span>
</span><span id="FST-712"><a href="#FST-712"><span class="linenos"> 712</span></a><span class="sd">            .value Name &#39;var&#39; Load - 0,0..0,3</span>
</span><span id="FST-713"><a href="#FST-713"><span class="linenos"> 713</span></a>
</span><span id="FST-714"><a href="#FST-714"><span class="linenos"> 714</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;, mode=&#39;stmt&#39;).dump()</span>
</span><span id="FST-715"><a href="#FST-715"><span class="linenos"> 715</span></a><span class="sd">        Expr - ROOT 0,0..0,3</span>
</span><span id="FST-716"><a href="#FST-716"><span class="linenos"> 716</span></a><span class="sd">          .value Name &#39;var&#39; Load - 0,0..0,3</span>
</span><span id="FST-717"><a href="#FST-717"><span class="linenos"> 717</span></a>
</span><span id="FST-718"><a href="#FST-718"><span class="linenos"> 718</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;, mode=&#39;expr&#39;).dump()</span>
</span><span id="FST-719"><a href="#FST-719"><span class="linenos"> 719</span></a><span class="sd">        Name &#39;var&#39; Load - ROOT 0,0..0,3</span>
</span><span id="FST-720"><a href="#FST-720"><span class="linenos"> 720</span></a>
</span><span id="FST-721"><a href="#FST-721"><span class="linenos"> 721</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;except Exception: pass&#39;, &#39;stmtish&#39;).dump()</span>
</span><span id="FST-722"><a href="#FST-722"><span class="linenos"> 722</span></a><span class="sd">        ExceptHandler - ROOT 0,0..0,22</span>
</span><span id="FST-723"><a href="#FST-723"><span class="linenos"> 723</span></a><span class="sd">          .type Name &#39;Exception&#39; Load - 0,7..0,16</span>
</span><span id="FST-724"><a href="#FST-724"><span class="linenos"> 724</span></a><span class="sd">          .body[1]</span>
</span><span id="FST-725"><a href="#FST-725"><span class="linenos"> 725</span></a><span class="sd">          0] Pass - 0,18..0,22</span>
</span><span id="FST-726"><a href="#FST-726"><span class="linenos"> 726</span></a>
</span><span id="FST-727"><a href="#FST-727"><span class="linenos"> 727</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;case f(a=1): pass&#39;, &#39;stmtish&#39;).dump()</span>
</span><span id="FST-728"><a href="#FST-728"><span class="linenos"> 728</span></a><span class="sd">        match_case - ROOT 0,0..0,17</span>
</span><span id="FST-729"><a href="#FST-729"><span class="linenos"> 729</span></a><span class="sd">          .pattern MatchClass - 0,5..0,11</span>
</span><span id="FST-730"><a href="#FST-730"><span class="linenos"> 730</span></a><span class="sd">            .cls Name &#39;f&#39; Load - 0,5..0,6</span>
</span><span id="FST-731"><a href="#FST-731"><span class="linenos"> 731</span></a><span class="sd">            .kwd_attrs[1]</span>
</span><span id="FST-732"><a href="#FST-732"><span class="linenos"> 732</span></a><span class="sd">            0] &#39;a&#39;</span>
</span><span id="FST-733"><a href="#FST-733"><span class="linenos"> 733</span></a><span class="sd">            .kwd_patterns[1]</span>
</span><span id="FST-734"><a href="#FST-734"><span class="linenos"> 734</span></a><span class="sd">            0] MatchValue - 0,9..0,10</span>
</span><span id="FST-735"><a href="#FST-735"><span class="linenos"> 735</span></a><span class="sd">              .value Constant 1 - 0,9..0,10</span>
</span><span id="FST-736"><a href="#FST-736"><span class="linenos"> 736</span></a><span class="sd">          .body[1]</span>
</span><span id="FST-737"><a href="#FST-737"><span class="linenos"> 737</span></a><span class="sd">          0] Pass - 0,13..0,17</span>
</span><span id="FST-738"><a href="#FST-738"><span class="linenos"> 738</span></a>
</span><span id="FST-739"><a href="#FST-739"><span class="linenos"> 739</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;a:b&#39;, Slice).dump()</span>
</span><span id="FST-740"><a href="#FST-740"><span class="linenos"> 740</span></a><span class="sd">        Slice - ROOT 0,0..0,3</span>
</span><span id="FST-741"><a href="#FST-741"><span class="linenos"> 741</span></a><span class="sd">          .lower Name &#39;a&#39; Load - 0,0..0,1</span>
</span><span id="FST-742"><a href="#FST-742"><span class="linenos"> 742</span></a><span class="sd">          .upper Name &#39;b&#39; Load - 0,2..0,3</span>
</span><span id="FST-743"><a href="#FST-743"><span class="linenos"> 743</span></a><span class="sd">        ```</span>
</span><span id="FST-744"><a href="#FST-744"><span class="linenos"> 744</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-745"><a href="#FST-745"><span class="linenos"> 745</span></a>
</span><span id="FST-746"><a href="#FST-746"><span class="linenos"> 746</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FST-747"><a href="#FST-747"><span class="linenos"> 747</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST-748"><a href="#FST-748"><span class="linenos"> 748</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-749"><a href="#FST-749"><span class="linenos"> 749</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">src</span>
</span><span id="FST-750"><a href="#FST-750"><span class="linenos"> 750</span></a>            <span class="n">src</span>   <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span><span id="FST-751"><a href="#FST-751"><span class="linenos"> 751</span></a>
</span><span id="FST-752"><a href="#FST-752"><span class="linenos"> 752</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="FST-753"><a href="#FST-753"><span class="linenos"> 753</span></a>        <span class="n">ast</span>          <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST-754"><a href="#FST-754"><span class="linenos"> 754</span></a>
</span><span id="FST-755"><a href="#FST-755"><span class="linenos"> 755</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST-756"><a href="#FST-756"><span class="linenos"> 756</span></a>
</span><span id="FST-757"><a href="#FST-757"><span class="linenos"> 757</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST-758"><a href="#FST-758"><span class="linenos"> 758</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fromast</span><span class="p">(</span><span class="n">ast</span><span class="p">:</span> <span class="n">AST</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="FST-759"><a href="#FST-759"><span class="linenos"> 759</span></a>                <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST-760"><a href="#FST-760"><span class="linenos"> 760</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Unparse and reparse an `AST` for new `FST` (the reparse is necessary to make sure locations are correct).</span>
</span><span id="FST-761"><a href="#FST-761"><span class="linenos"> 761</span></a>
</span><span id="FST-762"><a href="#FST-762"><span class="linenos"> 762</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-763"><a href="#FST-763"><span class="linenos"> 763</span></a><span class="sd">        - `ast`: The root `AST` node.</span>
</span><span id="FST-764"><a href="#FST-764"><span class="linenos"> 764</span></a><span class="sd">        - `mode`: Parse mode, extended `ast.parse()` parameter, see `fst.misc.Mode`. Two special values are added:</span>
</span><span id="FST-765"><a href="#FST-765"><span class="linenos"> 765</span></a><span class="sd">            - `None`: This will attempt to reparse to the same node type as was passed in. This is the default and all</span>
</span><span id="FST-766"><a href="#FST-766"><span class="linenos"> 766</span></a><span class="sd">                other values should be considered overrides for special cases.</span>
</span><span id="FST-767"><a href="#FST-767"><span class="linenos"> 767</span></a><span class="sd">            - `False`: This will skip the reparse and just `ast.unparse()` the `AST` to generate source for the `FST`.</span>
</span><span id="FST-768"><a href="#FST-768"><span class="linenos"> 768</span></a><span class="sd">                Use this only if you are absolutely certain that the `AST` unparsed source will correspond with the</span>
</span><span id="FST-769"><a href="#FST-769"><span class="linenos"> 769</span></a><span class="sd">                locations already present in the `AST`. This is almost never the case unless the `AST` was</span>
</span><span id="FST-770"><a href="#FST-770"><span class="linenos"> 770</span></a><span class="sd">                `ast.parse()`d from an explicitly `ast.unparse()`d `AST`.</span>
</span><span id="FST-771"><a href="#FST-771"><span class="linenos"> 771</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="FST-772"><a href="#FST-772"><span class="linenos"> 772</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="FST-773"><a href="#FST-773"><span class="linenos"> 773</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="FST-774"><a href="#FST-774"><span class="linenos"> 774</span></a><span class="sd">        - `ctx`: Whether to make sure that the `ctx` field of the reparsed `AST` matches or not. `False` for</span>
</span><span id="FST-775"><a href="#FST-775"><span class="linenos"> 775</span></a><span class="sd">            convenience, `True` if you&#39;re feeling pedantic.</span>
</span><span id="FST-776"><a href="#FST-776"><span class="linenos"> 776</span></a>
</span><span id="FST-777"><a href="#FST-777"><span class="linenos"> 777</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-778"><a href="#FST-778"><span class="linenos"> 778</span></a><span class="sd">        - `FST`: The augmented tree with `.f` attributes added to each `AST` node for `FST` access.</span>
</span><span id="FST-779"><a href="#FST-779"><span class="linenos"> 779</span></a>
</span><span id="FST-780"><a href="#FST-780"><span class="linenos"> 780</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-781"><a href="#FST-781"><span class="linenos"> 781</span></a><span class="sd">        ```py</span>
</span><span id="FST-782"><a href="#FST-782"><span class="linenos"> 782</span></a><span class="sd">        &gt;&gt;&gt; import ast</span>
</span><span id="FST-783"><a href="#FST-783"><span class="linenos"> 783</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(Assign(targets=[Name(id=&#39;var&#39;)],</span>
</span><span id="FST-784"><a href="#FST-784"><span class="linenos"> 784</span></a><span class="sd">        ...                    value=Constant(value=123))).dump(&#39;stmt&#39;)</span>
</span><span id="FST-785"><a href="#FST-785"><span class="linenos"> 785</span></a><span class="sd">        0: var = 123</span>
</span><span id="FST-786"><a href="#FST-786"><span class="linenos"> 786</span></a><span class="sd">        Assign - ROOT 0,0..0,9</span>
</span><span id="FST-787"><a href="#FST-787"><span class="linenos"> 787</span></a><span class="sd">          .targets[1]</span>
</span><span id="FST-788"><a href="#FST-788"><span class="linenos"> 788</span></a><span class="sd">          0] Name &#39;var&#39; Store - 0,0..0,3</span>
</span><span id="FST-789"><a href="#FST-789"><span class="linenos"> 789</span></a><span class="sd">          .value Constant 123 - 0,6..0,9</span>
</span><span id="FST-790"><a href="#FST-790"><span class="linenos"> 790</span></a>
</span><span id="FST-791"><a href="#FST-791"><span class="linenos"> 791</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(ast.parse(&#39;if 1:\n    j = 5&#39;)).dump(&#39;stmt&#39;)</span>
</span><span id="FST-792"><a href="#FST-792"><span class="linenos"> 792</span></a><span class="sd">        Module - ROOT 0,0..1,9</span>
</span><span id="FST-793"><a href="#FST-793"><span class="linenos"> 793</span></a><span class="sd">          .body[1]</span>
</span><span id="FST-794"><a href="#FST-794"><span class="linenos"> 794</span></a><span class="sd">        0: if 1:</span>
</span><span id="FST-795"><a href="#FST-795"><span class="linenos"> 795</span></a><span class="sd">          0] If - 0,0..1,9</span>
</span><span id="FST-796"><a href="#FST-796"><span class="linenos"> 796</span></a><span class="sd">            .test Constant 1 - 0,3..0,4</span>
</span><span id="FST-797"><a href="#FST-797"><span class="linenos"> 797</span></a><span class="sd">            .body[1]</span>
</span><span id="FST-798"><a href="#FST-798"><span class="linenos"> 798</span></a><span class="sd">        1:     j = 5</span>
</span><span id="FST-799"><a href="#FST-799"><span class="linenos"> 799</span></a><span class="sd">            0] Assign - 1,4..1,9</span>
</span><span id="FST-800"><a href="#FST-800"><span class="linenos"> 800</span></a><span class="sd">              .targets[1]</span>
</span><span id="FST-801"><a href="#FST-801"><span class="linenos"> 801</span></a><span class="sd">              0] Name &#39;j&#39; Store - 1,4..1,5</span>
</span><span id="FST-802"><a href="#FST-802"><span class="linenos"> 802</span></a><span class="sd">              .value Constant 5 - 1,8..1,9</span>
</span><span id="FST-803"><a href="#FST-803"><span class="linenos"> 803</span></a>
</span><span id="FST-804"><a href="#FST-804"><span class="linenos"> 804</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(Slice(lower=Constant(value=1), step=Name(id=&#39;step&#39;))).dump(&#39;all&#39;)</span>
</span><span id="FST-805"><a href="#FST-805"><span class="linenos"> 805</span></a><span class="sd">        0: 1::step</span>
</span><span id="FST-806"><a href="#FST-806"><span class="linenos"> 806</span></a><span class="sd">        Slice - ROOT 0,0..0,7</span>
</span><span id="FST-807"><a href="#FST-807"><span class="linenos"> 807</span></a><span class="sd">        0: 1</span>
</span><span id="FST-808"><a href="#FST-808"><span class="linenos"> 808</span></a><span class="sd">          .lower Constant 1 - 0,0..0,1</span>
</span><span id="FST-809"><a href="#FST-809"><span class="linenos"> 809</span></a><span class="sd">        0:    step</span>
</span><span id="FST-810"><a href="#FST-810"><span class="linenos"> 810</span></a><span class="sd">          .step Name &#39;step&#39; Load - 0,3..0,7</span>
</span><span id="FST-811"><a href="#FST-811"><span class="linenos"> 811</span></a><span class="sd">        ```</span>
</span><span id="FST-812"><a href="#FST-812"><span class="linenos"> 812</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-813"><a href="#FST-813"><span class="linenos"> 813</span></a>
</span><span id="FST-814"><a href="#FST-814"><span class="linenos"> 814</span></a>        <span class="k">if</span> <span class="n">type_comments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-815"><a href="#FST-815"><span class="linenos"> 815</span></a>            <span class="n">type_comments</span> <span class="o">=</span> <span class="n">has_type_comments</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="FST-816"><a href="#FST-816"><span class="linenos"> 816</span></a>
</span><span id="FST-817"><a href="#FST-817"><span class="linenos"> 817</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="FST-818"><a href="#FST-818"><span class="linenos"> 818</span></a>        <span class="n">src</span>          <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_unparse</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="FST-819"><a href="#FST-819"><span class="linenos"> 819</span></a>        <span class="n">lines</span>        <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST-820"><a href="#FST-820"><span class="linenos"> 820</span></a>
</span><span id="FST-821"><a href="#FST-821"><span class="linenos"> 821</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="FST-822"><a href="#FST-822"><span class="linenos"> 822</span></a>            <span class="n">org</span> <span class="o">=</span> <span class="n">ast</span>
</span><span id="FST-823"><a href="#FST-823"><span class="linenos"> 823</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span> <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode</span><span class="p">,</span> <span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST-824"><a href="#FST-824"><span class="linenos"> 824</span></a>
</span><span id="FST-825"><a href="#FST-825"><span class="linenos"> 825</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="FST-826"><a href="#FST-826"><span class="linenos"> 826</span></a>                <span class="n">compare_asts</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">raise_</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="FST-827"><a href="#FST-827"><span class="linenos"> 827</span></a>            <span class="k">except</span> <span class="n">WalkFail</span><span class="p">:</span>
</span><span id="FST-828"><a href="#FST-828"><span class="linenos"> 828</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;could not reparse ast identically&#39;</span><span class="p">)</span>
</span><span id="FST-829"><a href="#FST-829"><span class="linenos"> 829</span></a>
</span><span id="FST-830"><a href="#FST-830"><span class="linenos"> 830</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s1">&#39;    &#39;</span><span class="p">)</span>
</span><span id="FST-831"><a href="#FST-831"><span class="linenos"> 831</span></a>
</span><span id="FST-832"><a href="#FST-832"><span class="linenos"> 832</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST-833"><a href="#FST-833"><span class="linenos"> 833</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="FST-834"><a href="#FST-834"><span class="linenos"> 834</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a dictionary of ALL options. These are the same `options` that can be passed to operations and this</span>
</span><span id="FST-835"><a href="#FST-835"><span class="linenos"> 835</span></a><span class="sd">        function returns their global defaults which are used when those options are not passed to operations or if they</span>
</span><span id="FST-836"><a href="#FST-836"><span class="linenos"> 836</span></a><span class="sd">        are passed with a value of `None`.</span>
</span><span id="FST-837"><a href="#FST-837"><span class="linenos"> 837</span></a>
</span><span id="FST-838"><a href="#FST-838"><span class="linenos"> 838</span></a><span class="sd">        When these options are missing or `None` in a call to an operation, then the default option as specified here is</span>
</span><span id="FST-839"><a href="#FST-839"><span class="linenos"> 839</span></a><span class="sd">        used.</span>
</span><span id="FST-840"><a href="#FST-840"><span class="linenos"> 840</span></a>
</span><span id="FST-841"><a href="#FST-841"><span class="linenos"> 841</span></a><span class="sd">        **Options:**</span>
</span><span id="FST-842"><a href="#FST-842"><span class="linenos"> 842</span></a><span class="sd">        - `pars`: How parentheses are handled, can be `False`, `True` or `&#39;auto&#39;`. This is for individual puts, for</span>
</span><span id="FST-843"><a href="#FST-843"><span class="linenos"> 843</span></a><span class="sd">            slices parentheses are always unchanged. Raw puts generally do not have parentheses added or removed</span>
</span><span id="FST-844"><a href="#FST-844"><span class="linenos"> 844</span></a><span class="sd">            automatically, except removed from the destination node if putting to a node instead of a pure location.</span>
</span><span id="FST-845"><a href="#FST-845"><span class="linenos"> 845</span></a><span class="sd">            - `False`: Parentheses are not MODIFIED, doesn&#39;t mean remove all parentheses. Not copied with nodes or</span>
</span><span id="FST-846"><a href="#FST-846"><span class="linenos"> 846</span></a><span class="sd">                removed on put from source or destination.</span>
</span><span id="FST-847"><a href="#FST-847"><span class="linenos"> 847</span></a><span class="sd">            - `True`: Parentheses are copied with nodes, added to copies if needed and not present, removed from</span>
</span><span id="FST-848"><a href="#FST-848"><span class="linenos"> 848</span></a><span class="sd">                destination on put if not needed there (but not source).</span>
</span><span id="FST-849"><a href="#FST-849"><span class="linenos"> 849</span></a><span class="sd">            - `&#39;auto&#39;`: Same as `True` except they are not returned with a copy and possibly removed from source</span>
</span><span id="FST-850"><a href="#FST-850"><span class="linenos"> 850</span></a><span class="sd">                on put if not needed (removed from destination first if needed and present on both).</span>
</span><span id="FST-851"><a href="#FST-851"><span class="linenos"> 851</span></a><span class="sd">        - `raw`: When to do raw source operations. This may result in more nodes changed than just the targeted one(s).</span>
</span><span id="FST-852"><a href="#FST-852"><span class="linenos"> 852</span></a><span class="sd">            - `False`: Do not do raw source operations.</span>
</span><span id="FST-853"><a href="#FST-853"><span class="linenos"> 853</span></a><span class="sd">            - `True`: Only do raw source operations.</span>
</span><span id="FST-854"><a href="#FST-854"><span class="linenos"> 854</span></a><span class="sd">            - `&#39;auto&#39;`: Only do raw source operations if the normal operation fails in a way that raw might not.</span>
</span><span id="FST-855"><a href="#FST-855"><span class="linenos"> 855</span></a><span class="sd">        - `elif_`: How to handle lone `If` statements as the only statements in an `If` statement `orelse` field.</span>
</span><span id="FST-856"><a href="#FST-856"><span class="linenos"> 856</span></a><span class="sd">            - `True`: If putting a single `If` statement to an `orelse` field of a parent `If` statement then</span>
</span><span id="FST-857"><a href="#FST-857"><span class="linenos"> 857</span></a><span class="sd">                put it as an `elif`.</span>
</span><span id="FST-858"><a href="#FST-858"><span class="linenos"> 858</span></a><span class="sd">            - `False`: Always put as a standalone `If` statement.</span>
</span><span id="FST-859"><a href="#FST-859"><span class="linenos"> 859</span></a><span class="sd">        - `docstr`: Which docstrings are indentable / dedentable.</span>
</span><span id="FST-860"><a href="#FST-860"><span class="linenos"> 860</span></a><span class="sd">            - `False`: None.</span>
</span><span id="FST-861"><a href="#FST-861"><span class="linenos"> 861</span></a><span class="sd">            - `True`: All `Expr` multiline strings (as they serve no coding purpose).</span>
</span><span id="FST-862"><a href="#FST-862"><span class="linenos"> 862</span></a><span class="sd">            - `&#39;strict&#39;`: Only multiline strings in expected docstring positions (functions and classes).</span>
</span><span id="FST-863"><a href="#FST-863"><span class="linenos"> 863</span></a><span class="sd">        - `empty_set`: Empty set source during a slice put (considered to have no elements).</span>
</span><span id="FST-864"><a href="#FST-864"><span class="linenos"> 864</span></a><span class="sd">            - `False`: Nothing is considered an empty set and an empty set slice put is only possible using a non-set</span>
</span><span id="FST-865"><a href="#FST-865"><span class="linenos"> 865</span></a><span class="sd">                type of empty sequence (tuple or list).</span>
</span><span id="FST-866"><a href="#FST-866"><span class="linenos"> 866</span></a><span class="sd">            - `True`: `set()` call and `{*()}`, `{*[]}` and `{*{}}` starred sequences are considered empty.</span>
</span><span id="FST-867"><a href="#FST-867"><span class="linenos"> 867</span></a><span class="sd">            - `&#39;seq&#39;`: Only starred sequences `{*()}`, `{*[]}` and `{*{}}` are considered empty.</span>
</span><span id="FST-868"><a href="#FST-868"><span class="linenos"> 868</span></a><span class="sd">            - `&#39;call&#39;`: Only `set()` call is considered empty.</span>
</span><span id="FST-869"><a href="#FST-869"><span class="linenos"> 869</span></a><span class="sd">        - `pep8space`: Preceding and trailing empty lines for function and class definitions.</span>
</span><span id="FST-870"><a href="#FST-870"><span class="linenos"> 870</span></a><span class="sd">            - `False`: No empty lines.</span>
</span><span id="FST-871"><a href="#FST-871"><span class="linenos"> 871</span></a><span class="sd">            - `True`: Two empty lines at module scope and one empty line in other scopes.</span>
</span><span id="FST-872"><a href="#FST-872"><span class="linenos"> 872</span></a><span class="sd">            - `1`: One empty line in all scopes.</span>
</span><span id="FST-873"><a href="#FST-873"><span class="linenos"> 873</span></a><span class="sd">        - `precomms`: Preceding comments.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="FST-874"><a href="#FST-874"><span class="linenos"> 874</span></a><span class="sd">            - `False`: No preceding comments.</span>
</span><span id="FST-875"><a href="#FST-875"><span class="linenos"> 875</span></a><span class="sd">            - `True`: Single contiguous comment block immediately preceding position.</span>
</span><span id="FST-876"><a href="#FST-876"><span class="linenos"> 876</span></a><span class="sd">            - `&#39;all&#39;`: Comment blocks (possibly separated by empty lines) preceding position.</span>
</span><span id="FST-877"><a href="#FST-877"><span class="linenos"> 877</span></a><span class="sd">        - `postcomms`: Trailing comments.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="FST-878"><a href="#FST-878"><span class="linenos"> 878</span></a><span class="sd">            - `False`: No trailing comments.</span>
</span><span id="FST-879"><a href="#FST-879"><span class="linenos"> 879</span></a><span class="sd">            - `True`: Only comment trailing on line of position, nothing past that on its own lines.</span>
</span><span id="FST-880"><a href="#FST-880"><span class="linenos"> 880</span></a><span class="sd">            - `&#39;block&#39;`: Single contiguous comment block following position.</span>
</span><span id="FST-881"><a href="#FST-881"><span class="linenos"> 881</span></a><span class="sd">            - `&#39;all&#39;`: Comment blocks (possibly separated by empty lines) following position.</span>
</span><span id="FST-882"><a href="#FST-882"><span class="linenos"> 882</span></a><span class="sd">        - `prespace`: Preceding empty lines (max of this and `pep8space` used).  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="FST-883"><a href="#FST-883"><span class="linenos"> 883</span></a><span class="sd">            - `False`: No empty lines.</span>
</span><span id="FST-884"><a href="#FST-884"><span class="linenos"> 884</span></a><span class="sd">            - `True`: All empty lines.</span>
</span><span id="FST-885"><a href="#FST-885"><span class="linenos"> 885</span></a><span class="sd">            - `int`: A maximum number of empty lines.</span>
</span><span id="FST-886"><a href="#FST-886"><span class="linenos"> 886</span></a><span class="sd">        - `postspace`: Same as `prespace` except for trailing empty lines.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="FST-887"><a href="#FST-887"><span class="linenos"> 887</span></a>
</span><span id="FST-888"><a href="#FST-888"><span class="linenos"> 888</span></a><span class="sd">        **Note:**</span>
</span><span id="FST-889"><a href="#FST-889"><span class="linenos"> 889</span></a><span class="sd">        `pars` behavior (see Examples for more):</span>
</span><span id="FST-890"><a href="#FST-890"><span class="linenos"> 890</span></a><span class="sd">        ```</span>
</span><span id="FST-891"><a href="#FST-891"><span class="linenos"> 891</span></a><span class="sd">                                                                  False      True    &#39;auto&#39;</span>
</span><span id="FST-892"><a href="#FST-892"><span class="linenos"> 892</span></a><span class="sd">        Copy pars from source on copy / cut:                         no       yes        no</span>
</span><span id="FST-893"><a href="#FST-893"><span class="linenos"> 893</span></a><span class="sd">        Add pars needed for parsability to copy:                     no       yes       yes</span>
</span><span id="FST-894"><a href="#FST-894"><span class="linenos"> 894</span></a><span class="sd">        Remove unneeded pars from destination on put:                no       yes       yes</span>
</span><span id="FST-895"><a href="#FST-895"><span class="linenos"> 895</span></a><span class="sd">        Remove unneeded pars from source on put:                     no        no       yes</span>
</span><span id="FST-896"><a href="#FST-896"><span class="linenos"> 896</span></a><span class="sd">        Add pars needed for parse / precedence to source on put:     no       yes       yes</span>
</span><span id="FST-897"><a href="#FST-897"><span class="linenos"> 897</span></a><span class="sd">        ```</span>
</span><span id="FST-898"><a href="#FST-898"><span class="linenos"> 898</span></a>
</span><span id="FST-899"><a href="#FST-899"><span class="linenos"> 899</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-900"><a href="#FST-900"><span class="linenos"> 900</span></a><span class="sd">        - `{option: value, ...}`: Dictionary of all global default options.</span>
</span><span id="FST-901"><a href="#FST-901"><span class="linenos"> 901</span></a>
</span><span id="FST-902"><a href="#FST-902"><span class="linenos"> 902</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-903"><a href="#FST-903"><span class="linenos"> 903</span></a><span class="sd">        ```py</span>
</span><span id="FST-904"><a href="#FST-904"><span class="linenos"> 904</span></a><span class="sd">        &gt;&gt;&gt; from pprint import pp</span>
</span><span id="FST-905"><a href="#FST-905"><span class="linenos"> 905</span></a><span class="sd">        &gt;&gt;&gt; pp(FST.get_options())</span>
</span><span id="FST-906"><a href="#FST-906"><span class="linenos"> 906</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;,</span>
</span><span id="FST-907"><a href="#FST-907"><span class="linenos"> 907</span></a><span class="sd">         &#39;raw&#39;: False,</span>
</span><span id="FST-908"><a href="#FST-908"><span class="linenos"> 908</span></a><span class="sd">         &#39;elif_&#39;: True,</span>
</span><span id="FST-909"><a href="#FST-909"><span class="linenos"> 909</span></a><span class="sd">         &#39;docstr&#39;: True,</span>
</span><span id="FST-910"><a href="#FST-910"><span class="linenos"> 910</span></a><span class="sd">         &#39;empty_set&#39;: True,</span>
</span><span id="FST-911"><a href="#FST-911"><span class="linenos"> 911</span></a><span class="sd">         &#39;pep8space&#39;: True,</span>
</span><span id="FST-912"><a href="#FST-912"><span class="linenos"> 912</span></a><span class="sd">         &#39;precomms&#39;: True,</span>
</span><span id="FST-913"><a href="#FST-913"><span class="linenos"> 913</span></a><span class="sd">         &#39;postcomms&#39;: True,</span>
</span><span id="FST-914"><a href="#FST-914"><span class="linenos"> 914</span></a><span class="sd">         &#39;prespace&#39;: False,</span>
</span><span id="FST-915"><a href="#FST-915"><span class="linenos"> 915</span></a><span class="sd">         &#39;postspace&#39;: False}</span>
</span><span id="FST-916"><a href="#FST-916"><span class="linenos"> 916</span></a><span class="sd">        ```</span>
</span><span id="FST-917"><a href="#FST-917"><span class="linenos"> 917</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-918"><a href="#FST-918"><span class="linenos"> 918</span></a>
</span><span id="FST-919"><a href="#FST-919"><span class="linenos"> 919</span></a>        <span class="k">return</span> <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="FST-920"><a href="#FST-920"><span class="linenos"> 920</span></a>
</span><span id="FST-921"><a href="#FST-921"><span class="linenos"> 921</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST-922"><a href="#FST-922"><span class="linenos"> 922</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_option</span><span class="p">(</span><span class="n">option</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span><span id="FST-923"><a href="#FST-923"><span class="linenos"> 923</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a single option from `options` dict or global default if option not in dict or is `None` there. For a</span>
</span><span id="FST-924"><a href="#FST-924"><span class="linenos"> 924</span></a><span class="sd">        list of options used see `get_options()`.</span>
</span><span id="FST-925"><a href="#FST-925"><span class="linenos"> 925</span></a>
</span><span id="FST-926"><a href="#FST-926"><span class="linenos"> 926</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-927"><a href="#FST-927"><span class="linenos"> 927</span></a><span class="sd">        - `option`: Name of option to get, see `get_options()`.</span>
</span><span id="FST-928"><a href="#FST-928"><span class="linenos"> 928</span></a><span class="sd">        - `options`: Dictionary which may or may not contain the requested option.</span>
</span><span id="FST-929"><a href="#FST-929"><span class="linenos"> 929</span></a>
</span><span id="FST-930"><a href="#FST-930"><span class="linenos"> 930</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-931"><a href="#FST-931"><span class="linenos"> 931</span></a><span class="sd">        - `Any`: The `option` value from the passed `options` dict, if passed and not `None` there, else the global</span>
</span><span id="FST-932"><a href="#FST-932"><span class="linenos"> 932</span></a><span class="sd">            default value for `option`.</span>
</span><span id="FST-933"><a href="#FST-933"><span class="linenos"> 933</span></a>
</span><span id="FST-934"><a href="#FST-934"><span class="linenos"> 934</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-935"><a href="#FST-935"><span class="linenos"> 935</span></a><span class="sd">        ```py</span>
</span><span id="FST-936"><a href="#FST-936"><span class="linenos"> 936</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="FST-937"><a href="#FST-937"><span class="linenos"> 937</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="FST-938"><a href="#FST-938"><span class="linenos"> 938</span></a>
</span><span id="FST-939"><a href="#FST-939"><span class="linenos"> 939</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;, {&#39;pars&#39;: True})</span>
</span><span id="FST-940"><a href="#FST-940"><span class="linenos"> 940</span></a><span class="sd">        True</span>
</span><span id="FST-941"><a href="#FST-941"><span class="linenos"> 941</span></a>
</span><span id="FST-942"><a href="#FST-942"><span class="linenos"> 942</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;, {&#39;pars&#39;: None})</span>
</span><span id="FST-943"><a href="#FST-943"><span class="linenos"> 943</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="FST-944"><a href="#FST-944"><span class="linenos"> 944</span></a><span class="sd">        ```</span>
</span><span id="FST-945"><a href="#FST-945"><span class="linenos"> 945</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-946"><a href="#FST-946"><span class="linenos"> 946</span></a>
</span><span id="FST-947"><a href="#FST-947"><span class="linenos"> 947</span></a>        <span class="k">return</span> <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">:=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">o</span>
</span><span id="FST-948"><a href="#FST-948"><span class="linenos"> 948</span></a>
</span><span id="FST-949"><a href="#FST-949"><span class="linenos"> 949</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST-950"><a href="#FST-950"><span class="linenos"> 950</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="FST-951"><a href="#FST-951"><span class="linenos"> 951</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set global defaults for `options` parameters.</span>
</span><span id="FST-952"><a href="#FST-952"><span class="linenos"> 952</span></a>
</span><span id="FST-953"><a href="#FST-953"><span class="linenos"> 953</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-954"><a href="#FST-954"><span class="linenos"> 954</span></a><span class="sd">        - `options`: Names / values of parameters to set. These can also be passed to various methods to override the</span>
</span><span id="FST-955"><a href="#FST-955"><span class="linenos"> 955</span></a><span class="sd">            defaults set here for those individual operations, see `get_options()`.</span>
</span><span id="FST-956"><a href="#FST-956"><span class="linenos"> 956</span></a>
</span><span id="FST-957"><a href="#FST-957"><span class="linenos"> 957</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-958"><a href="#FST-958"><span class="linenos"> 958</span></a><span class="sd">        - `options`: `dict` of previous values of changed parameters, reset with `set_options(**options)`.</span>
</span><span id="FST-959"><a href="#FST-959"><span class="linenos"> 959</span></a>
</span><span id="FST-960"><a href="#FST-960"><span class="linenos"> 960</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-961"><a href="#FST-961"><span class="linenos"> 961</span></a><span class="sd">        ```py</span>
</span><span id="FST-962"><a href="#FST-962"><span class="linenos"> 962</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="FST-963"><a href="#FST-963"><span class="linenos"> 963</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="FST-964"><a href="#FST-964"><span class="linenos"> 964</span></a>
</span><span id="FST-965"><a href="#FST-965"><span class="linenos"> 965</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(pars=False)</span>
</span><span id="FST-966"><a href="#FST-966"><span class="linenos"> 966</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;}</span>
</span><span id="FST-967"><a href="#FST-967"><span class="linenos"> 967</span></a>
</span><span id="FST-968"><a href="#FST-968"><span class="linenos"> 968</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="FST-969"><a href="#FST-969"><span class="linenos"> 969</span></a><span class="sd">        False</span>
</span><span id="FST-970"><a href="#FST-970"><span class="linenos"> 970</span></a>
</span><span id="FST-971"><a href="#FST-971"><span class="linenos"> 971</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(**{&#39;pars&#39;: &#39;auto&#39;})</span>
</span><span id="FST-972"><a href="#FST-972"><span class="linenos"> 972</span></a><span class="sd">        {&#39;pars&#39;: False}</span>
</span><span id="FST-973"><a href="#FST-973"><span class="linenos"> 973</span></a>
</span><span id="FST-974"><a href="#FST-974"><span class="linenos"> 974</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="FST-975"><a href="#FST-975"><span class="linenos"> 975</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="FST-976"><a href="#FST-976"><span class="linenos"> 976</span></a>
</span><span id="FST-977"><a href="#FST-977"><span class="linenos"> 977</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(pars=True, raw=True, docstr=False)</span>
</span><span id="FST-978"><a href="#FST-978"><span class="linenos"> 978</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;, &#39;raw&#39;: False, &#39;docstr&#39;: True}</span>
</span><span id="FST-979"><a href="#FST-979"><span class="linenos"> 979</span></a><span class="sd">        ```</span>
</span><span id="FST-980"><a href="#FST-980"><span class="linenos"> 980</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-981"><a href="#FST-981"><span class="linenos"> 981</span></a>
</span><span id="FST-982"><a href="#FST-982"><span class="linenos"> 982</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="n">o</span><span class="p">:</span> <span class="n">_OPTIONS</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">options</span><span class="p">}</span>
</span><span id="FST-983"><a href="#FST-983"><span class="linenos"> 983</span></a>
</span><span id="FST-984"><a href="#FST-984"><span class="linenos"> 984</span></a>        <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-985"><a href="#FST-985"><span class="linenos"> 985</span></a>
</span><span id="FST-986"><a href="#FST-986"><span class="linenos"> 986</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="FST-987"><a href="#FST-987"><span class="linenos"> 987</span></a>
</span><span id="FST-988"><a href="#FST-988"><span class="linenos"> 988</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST-989"><a href="#FST-989"><span class="linenos"> 989</span></a>    <span class="nd">@contextmanager</span>
</span><span id="FST-990"><a href="#FST-990"><span class="linenos"> 990</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">):</span>
</span><span id="FST-991"><a href="#FST-991"><span class="linenos"> 991</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Context manager to temporarily set global options defaults for a group of operations.</span>
</span><span id="FST-992"><a href="#FST-992"><span class="linenos"> 992</span></a>
</span><span id="FST-993"><a href="#FST-993"><span class="linenos"> 993</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-994"><a href="#FST-994"><span class="linenos"> 994</span></a><span class="sd">        - `options`: Names / values of options to set temporarily, see `get_options()`.</span>
</span><span id="FST-995"><a href="#FST-995"><span class="linenos"> 995</span></a>
</span><span id="FST-996"><a href="#FST-996"><span class="linenos"> 996</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-997"><a href="#FST-997"><span class="linenos"> 997</span></a><span class="sd">        ```py</span>
</span><span id="FST-998"><a href="#FST-998"><span class="linenos"> 998</span></a><span class="sd">        &gt;&gt;&gt; print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="FST-999"><a href="#FST-999"><span class="linenos"> 999</span></a><span class="sd">        auto</span>
</span><span id="FST-1000"><a href="#FST-1000"><span class="linenos">1000</span></a>
</span><span id="FST-1001"><a href="#FST-1001"><span class="linenos">1001</span></a><span class="sd">        &gt;&gt;&gt; with FST.options(pars=False):</span>
</span><span id="FST-1002"><a href="#FST-1002"><span class="linenos">1002</span></a><span class="sd">        ...     print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="FST-1003"><a href="#FST-1003"><span class="linenos">1003</span></a><span class="sd">        False</span>
</span><span id="FST-1004"><a href="#FST-1004"><span class="linenos">1004</span></a>
</span><span id="FST-1005"><a href="#FST-1005"><span class="linenos">1005</span></a><span class="sd">        &gt;&gt;&gt; print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="FST-1006"><a href="#FST-1006"><span class="linenos">1006</span></a><span class="sd">        auto</span>
</span><span id="FST-1007"><a href="#FST-1007"><span class="linenos">1007</span></a><span class="sd">        ```</span>
</span><span id="FST-1008"><a href="#FST-1008"><span class="linenos">1008</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1009"><a href="#FST-1009"><span class="linenos">1009</span></a>
</span><span id="FST-1010"><a href="#FST-1010"><span class="linenos">1010</span></a>        <span class="n">old_options</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1011"><a href="#FST-1011"><span class="linenos">1011</span></a>
</span><span id="FST-1012"><a href="#FST-1012"><span class="linenos">1012</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST-1013"><a href="#FST-1013"><span class="linenos">1013</span></a>            <span class="k">yield</span> <span class="n">old_options</span>
</span><span id="FST-1014"><a href="#FST-1014"><span class="linenos">1014</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="FST-1015"><a href="#FST-1015"><span class="linenos">1015</span></a>            <span class="n">FST</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">old_options</span><span class="p">)</span>
</span><span id="FST-1016"><a href="#FST-1016"><span class="linenos">1016</span></a>
</span><span id="FST-1017"><a href="#FST-1017"><span class="linenos">1017</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="FST-1018"><a href="#FST-1018"><span class="linenos">1018</span></a>             <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="n">TextIO</span> <span class="o">=</span> <span class="nb">print</span><span class="p">,</span> <span class="n">eol</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST-1019"><a href="#FST-1019"><span class="linenos">1019</span></a>             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1020"><a href="#FST-1020"><span class="linenos">1020</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Dump a representation of the tree to stdout or other `TextIO` or return as a `str` or `list` of lines, or</span>
</span><span id="FST-1021"><a href="#FST-1021"><span class="linenos">1021</span></a><span class="sd">        call a provided function once with each line of the output.</span>
</span><span id="FST-1022"><a href="#FST-1022"><span class="linenos">1022</span></a>
</span><span id="FST-1023"><a href="#FST-1023"><span class="linenos">1023</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1024"><a href="#FST-1024"><span class="linenos">1024</span></a><span class="sd">        - `src`: `&#39;stmt&#39;` means output statement source lines (including `ExceptHandler` and `match_case`), `&#39;all&#39;`</span>
</span><span id="FST-1025"><a href="#FST-1025"><span class="linenos">1025</span></a><span class="sd">            means output source for each individual and node and `None` does not output any source. Can also be a string</span>
</span><span id="FST-1026"><a href="#FST-1026"><span class="linenos">1026</span></a><span class="sd">            for shortcut specification of source and flags by first letter: `&#39;s&#39;` means `src=&#39;stmt&#39;`, `&#39;a&#39;` means</span>
</span><span id="FST-1027"><a href="#FST-1027"><span class="linenos">1027</span></a><span class="sd">            `src=&#39;all&#39;`, `&#39;f&#39;` means `full=True` and `&#39;e&#39;` means `expand=True`, so `&#39;sfe&#39;` would be a full expanded dump</span>
</span><span id="FST-1028"><a href="#FST-1028"><span class="linenos">1028</span></a><span class="sd">            showing statement source lines.</span>
</span><span id="FST-1029"><a href="#FST-1029"><span class="linenos">1029</span></a><span class="sd">        - `full`: If `True` then will list all fields in nodes including empty ones, otherwise will exclude most empty</span>
</span><span id="FST-1030"><a href="#FST-1030"><span class="linenos">1030</span></a><span class="sd">            fields.</span>
</span><span id="FST-1031"><a href="#FST-1031"><span class="linenos">1031</span></a><span class="sd">        - `expand`: If `True` then the output is a nice compact representation. If `False` then it is ugly and wasteful.</span>
</span><span id="FST-1032"><a href="#FST-1032"><span class="linenos">1032</span></a><span class="sd">        - `indent`: The average airspeed of an unladen swallow (European).</span>
</span><span id="FST-1033"><a href="#FST-1033"><span class="linenos">1033</span></a><span class="sd">        - `out`: `print` means print to stdout, `list` returns a list of lines and `str` returns a whole string.</span>
</span><span id="FST-1034"><a href="#FST-1034"><span class="linenos">1034</span></a><span class="sd">            `TextIO` will cann the `write` method for each line of output. Otherwise a `Callable[[str], None]` which is</span>
</span><span id="FST-1035"><a href="#FST-1035"><span class="linenos">1035</span></a><span class="sd">            called for each line of output individually.</span>
</span><span id="FST-1036"><a href="#FST-1036"><span class="linenos">1036</span></a><span class="sd">        - `eol`: What to put at the end of each text line, `None` means newline for `TextIO` out and nothing for other.</span>
</span><span id="FST-1037"><a href="#FST-1037"><span class="linenos">1037</span></a>
</span><span id="FST-1038"><a href="#FST-1038"><span class="linenos">1038</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1039"><a href="#FST-1039"><span class="linenos">1039</span></a><span class="sd">        - `str | list[str]`: If those were requested with `out=str` or `out=list` else `None` and the output is send one</span>
</span><span id="FST-1040"><a href="#FST-1040"><span class="linenos">1040</span></a><span class="sd">            line at a time to `linefunc`, which by default is `print`.</span>
</span><span id="FST-1041"><a href="#FST-1041"><span class="linenos">1041</span></a><span class="sd">        - `None`: Otherwise.</span>
</span><span id="FST-1042"><a href="#FST-1042"><span class="linenos">1042</span></a>
</span><span id="FST-1043"><a href="#FST-1043"><span class="linenos">1043</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1044"><a href="#FST-1044"><span class="linenos">1044</span></a><span class="sd">        ```py</span>
</span><span id="FST-1045"><a href="#FST-1045"><span class="linenos">1045</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;&#39;&#39;</span>
</span><span id="FST-1046"><a href="#FST-1046"><span class="linenos">1046</span></a><span class="sd">        ... if 1:</span>
</span><span id="FST-1047"><a href="#FST-1047"><span class="linenos">1047</span></a><span class="sd">        ...     call(a[i], **b)</span>
</span><span id="FST-1048"><a href="#FST-1048"><span class="linenos">1048</span></a><span class="sd">        ... &#39;&#39;&#39;.strip())</span>
</span><span id="FST-1049"><a href="#FST-1049"><span class="linenos">1049</span></a>
</span><span id="FST-1050"><a href="#FST-1050"><span class="linenos">1050</span></a><span class="sd">        &gt;&gt;&gt; f.dump()</span>
</span><span id="FST-1051"><a href="#FST-1051"><span class="linenos">1051</span></a><span class="sd">        If - ROOT 0,0..1,19</span>
</span><span id="FST-1052"><a href="#FST-1052"><span class="linenos">1052</span></a><span class="sd">          .test Constant 1 - 0,3..0,4</span>
</span><span id="FST-1053"><a href="#FST-1053"><span class="linenos">1053</span></a><span class="sd">          .body[1]</span>
</span><span id="FST-1054"><a href="#FST-1054"><span class="linenos">1054</span></a><span class="sd">          0] Expr - 1,4..1,19</span>
</span><span id="FST-1055"><a href="#FST-1055"><span class="linenos">1055</span></a><span class="sd">            .value Call - 1,4..1,19</span>
</span><span id="FST-1056"><a href="#FST-1056"><span class="linenos">1056</span></a><span class="sd">              .func Name &#39;call&#39; Load - 1,4..1,8</span>
</span><span id="FST-1057"><a href="#FST-1057"><span class="linenos">1057</span></a><span class="sd">              .args[1]</span>
</span><span id="FST-1058"><a href="#FST-1058"><span class="linenos">1058</span></a><span class="sd">              0] Subscript - 1,9..1,13</span>
</span><span id="FST-1059"><a href="#FST-1059"><span class="linenos">1059</span></a><span class="sd">                .value Name &#39;a&#39; Load - 1,9..1,10</span>
</span><span id="FST-1060"><a href="#FST-1060"><span class="linenos">1060</span></a><span class="sd">                .slice Name &#39;i&#39; Load - 1,11..1,12</span>
</span><span id="FST-1061"><a href="#FST-1061"><span class="linenos">1061</span></a><span class="sd">                .ctx Load</span>
</span><span id="FST-1062"><a href="#FST-1062"><span class="linenos">1062</span></a><span class="sd">              .keywords[1]</span>
</span><span id="FST-1063"><a href="#FST-1063"><span class="linenos">1063</span></a><span class="sd">              0] keyword - 1,15..1,18</span>
</span><span id="FST-1064"><a href="#FST-1064"><span class="linenos">1064</span></a><span class="sd">                .value Name &#39;b&#39; Load - 1,17..1,18</span>
</span><span id="FST-1065"><a href="#FST-1065"><span class="linenos">1065</span></a>
</span><span id="FST-1066"><a href="#FST-1066"><span class="linenos">1066</span></a><span class="sd">        &gt;&gt;&gt; f.dump(src=&#39;all&#39;, indent=4)</span>
</span><span id="FST-1067"><a href="#FST-1067"><span class="linenos">1067</span></a><span class="sd">        0: if 1:</span>
</span><span id="FST-1068"><a href="#FST-1068"><span class="linenos">1068</span></a><span class="sd">        If - ROOT 0,0..1,19</span>
</span><span id="FST-1069"><a href="#FST-1069"><span class="linenos">1069</span></a><span class="sd">        0:    1</span>
</span><span id="FST-1070"><a href="#FST-1070"><span class="linenos">1070</span></a><span class="sd">            .test Constant 1 - 0,3..0,4</span>
</span><span id="FST-1071"><a href="#FST-1071"><span class="linenos">1071</span></a><span class="sd">            .body[1]</span>
</span><span id="FST-1072"><a href="#FST-1072"><span class="linenos">1072</span></a><span class="sd">        1:     call(a[i], **b)</span>
</span><span id="FST-1073"><a href="#FST-1073"><span class="linenos">1073</span></a><span class="sd">            0] Expr - 1,4..1,19</span>
</span><span id="FST-1074"><a href="#FST-1074"><span class="linenos">1074</span></a><span class="sd">                .value Call - 1,4..1,19</span>
</span><span id="FST-1075"><a href="#FST-1075"><span class="linenos">1075</span></a><span class="sd">        1:     call</span>
</span><span id="FST-1076"><a href="#FST-1076"><span class="linenos">1076</span></a><span class="sd">                    .func Name &#39;call&#39; Load - 1,4..1,8</span>
</span><span id="FST-1077"><a href="#FST-1077"><span class="linenos">1077</span></a><span class="sd">                    .args[1]</span>
</span><span id="FST-1078"><a href="#FST-1078"><span class="linenos">1078</span></a><span class="sd">        1:          a[i]</span>
</span><span id="FST-1079"><a href="#FST-1079"><span class="linenos">1079</span></a><span class="sd">                    0] Subscript - 1,9..1,13</span>
</span><span id="FST-1080"><a href="#FST-1080"><span class="linenos">1080</span></a><span class="sd">        1:          a</span>
</span><span id="FST-1081"><a href="#FST-1081"><span class="linenos">1081</span></a><span class="sd">                        .value Name &#39;a&#39; Load - 1,9..1,10</span>
</span><span id="FST-1082"><a href="#FST-1082"><span class="linenos">1082</span></a><span class="sd">        1:            i</span>
</span><span id="FST-1083"><a href="#FST-1083"><span class="linenos">1083</span></a><span class="sd">                        .slice Name &#39;i&#39; Load - 1,11..1,12</span>
</span><span id="FST-1084"><a href="#FST-1084"><span class="linenos">1084</span></a><span class="sd">                        .ctx Load</span>
</span><span id="FST-1085"><a href="#FST-1085"><span class="linenos">1085</span></a><span class="sd">                    .keywords[1]</span>
</span><span id="FST-1086"><a href="#FST-1086"><span class="linenos">1086</span></a><span class="sd">        1:                **b</span>
</span><span id="FST-1087"><a href="#FST-1087"><span class="linenos">1087</span></a><span class="sd">                    0] keyword - 1,15..1,18</span>
</span><span id="FST-1088"><a href="#FST-1088"><span class="linenos">1088</span></a><span class="sd">        1:                  b</span>
</span><span id="FST-1089"><a href="#FST-1089"><span class="linenos">1089</span></a><span class="sd">                        .value Name &#39;b&#39; Load - 1,17..1,18</span>
</span><span id="FST-1090"><a href="#FST-1090"><span class="linenos">1090</span></a>
</span><span id="FST-1091"><a href="#FST-1091"><span class="linenos">1091</span></a><span class="sd">        &gt;&gt;&gt; f.dump(out=str)[:64]</span>
</span><span id="FST-1092"><a href="#FST-1092"><span class="linenos">1092</span></a><span class="sd">        &#39;If - ROOT 0,0..1,19\n  .test Constant 1 - 0,3..0,4\n  .body[1]\n  0&#39;</span>
</span><span id="FST-1093"><a href="#FST-1093"><span class="linenos">1093</span></a>
</span><span id="FST-1094"><a href="#FST-1094"><span class="linenos">1094</span></a><span class="sd">        &gt;&gt;&gt; for l in f.dump(&#39;stmt&#39;, out=list):</span>
</span><span id="FST-1095"><a href="#FST-1095"><span class="linenos">1095</span></a><span class="sd">        ...     print(repr(l))</span>
</span><span id="FST-1096"><a href="#FST-1096"><span class="linenos">1096</span></a><span class="sd">        &#39;0: if 1:&#39;</span>
</span><span id="FST-1097"><a href="#FST-1097"><span class="linenos">1097</span></a><span class="sd">        &#39;If - ROOT 0,0..1,19&#39;</span>
</span><span id="FST-1098"><a href="#FST-1098"><span class="linenos">1098</span></a><span class="sd">        &#39;  .test Constant 1 - 0,3..0,4&#39;</span>
</span><span id="FST-1099"><a href="#FST-1099"><span class="linenos">1099</span></a><span class="sd">        &#39;  .body[1]&#39;</span>
</span><span id="FST-1100"><a href="#FST-1100"><span class="linenos">1100</span></a><span class="sd">        &#39;1:     call(a[i], **b)&#39;</span>
</span><span id="FST-1101"><a href="#FST-1101"><span class="linenos">1101</span></a><span class="sd">        &#39;  0] Expr - 1,4..1,19&#39;</span>
</span><span id="FST-1102"><a href="#FST-1102"><span class="linenos">1102</span></a><span class="sd">        &#39;    .value Call - 1,4..1,19&#39;</span>
</span><span id="FST-1103"><a href="#FST-1103"><span class="linenos">1103</span></a><span class="sd">        &quot;      .func Name &#39;call&#39; Load - 1,4..1,8&quot;</span>
</span><span id="FST-1104"><a href="#FST-1104"><span class="linenos">1104</span></a><span class="sd">        &#39;      .args[1]&#39;</span>
</span><span id="FST-1105"><a href="#FST-1105"><span class="linenos">1105</span></a><span class="sd">        &#39;      0] Subscript - 1,9..1,13&#39;</span>
</span><span id="FST-1106"><a href="#FST-1106"><span class="linenos">1106</span></a><span class="sd">        &quot;        .value Name &#39;a&#39; Load - 1,9..1,10&quot;</span>
</span><span id="FST-1107"><a href="#FST-1107"><span class="linenos">1107</span></a><span class="sd">        &quot;        .slice Name &#39;i&#39; Load - 1,11..1,12&quot;</span>
</span><span id="FST-1108"><a href="#FST-1108"><span class="linenos">1108</span></a><span class="sd">        &#39;        .ctx Load&#39;</span>
</span><span id="FST-1109"><a href="#FST-1109"><span class="linenos">1109</span></a><span class="sd">        &#39;      .keywords[1]&#39;</span>
</span><span id="FST-1110"><a href="#FST-1110"><span class="linenos">1110</span></a><span class="sd">        &#39;      0] keyword - 1,15..1,18&#39;</span>
</span><span id="FST-1111"><a href="#FST-1111"><span class="linenos">1111</span></a><span class="sd">        &quot;        .value Name &#39;b&#39; Load - 1,17..1,18&quot;</span>
</span><span id="FST-1112"><a href="#FST-1112"><span class="linenos">1112</span></a><span class="sd">        ```</span>
</span><span id="FST-1113"><a href="#FST-1113"><span class="linenos">1113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1114"><a href="#FST-1114"><span class="linenos">1114</span></a>
</span><span id="FST-1115"><a href="#FST-1115"><span class="linenos">1115</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FST-1116"><a href="#FST-1116"><span class="linenos">1116</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">src</span> <span class="o">:=</span> <span class="n">src</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="FST-1117"><a href="#FST-1117"><span class="linenos">1117</span></a>                <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="FST-1118"><a href="#FST-1118"><span class="linenos">1118</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid character(s) in &#39;src&#39; string&quot;</span><span class="p">)</span>
</span><span id="FST-1119"><a href="#FST-1119"><span class="linenos">1119</span></a>
</span><span id="FST-1120"><a href="#FST-1120"><span class="linenos">1120</span></a>                <span class="n">full</span>   <span class="o">=</span> <span class="s1">&#39;f&#39;</span> <span class="ow">in</span> <span class="n">src</span>
</span><span id="FST-1121"><a href="#FST-1121"><span class="linenos">1121</span></a>                <span class="n">expand</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span> <span class="ow">in</span> <span class="n">src</span>
</span><span id="FST-1122"><a href="#FST-1122"><span class="linenos">1122</span></a>                <span class="n">src</span>    <span class="o">=</span> <span class="s1">&#39;all&#39;</span> <span class="k">if</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">src</span> <span class="k">else</span> <span class="s1">&#39;stmt&#39;</span> <span class="k">if</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">src</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="FST-1123"><a href="#FST-1123"><span class="linenos">1123</span></a>
</span><span id="FST-1124"><a href="#FST-1124"><span class="linenos">1124</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="FST-1125"><a href="#FST-1125"><span class="linenos">1125</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">write</span>
</span><span id="FST-1126"><a href="#FST-1126"><span class="linenos">1126</span></a>
</span><span id="FST-1127"><a href="#FST-1127"><span class="linenos">1127</span></a>            <span class="k">if</span> <span class="n">eol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1128"><a href="#FST-1128"><span class="linenos">1128</span></a>                <span class="n">eol</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="FST-1129"><a href="#FST-1129"><span class="linenos">1129</span></a>
</span><span id="FST-1130"><a href="#FST-1130"><span class="linenos">1130</span></a>        <span class="k">elif</span> <span class="n">eol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1131"><a href="#FST-1131"><span class="linenos">1131</span></a>            <span class="n">eol</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST-1132"><a href="#FST-1132"><span class="linenos">1132</span></a>
</span><span id="FST-1133"><a href="#FST-1133"><span class="linenos">1133</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="n">nspace</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="n">expand</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="n">eol</span><span class="o">=</span><span class="n">eol</span><span class="p">)</span>
</span><span id="FST-1134"><a href="#FST-1134"><span class="linenos">1134</span></a>
</span><span id="FST-1135"><a href="#FST-1135"><span class="linenos">1135</span></a>        <span class="k">if</span> <span class="n">out</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST-1136"><a href="#FST-1136"><span class="linenos">1136</span></a>            <span class="n">lines</span>       <span class="o">=</span> <span class="p">[]</span>
</span><span id="FST-1137"><a href="#FST-1137"><span class="linenos">1137</span></a>            <span class="n">st</span><span class="o">.</span><span class="n">linefunc</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">append</span>
</span><span id="FST-1138"><a href="#FST-1138"><span class="linenos">1138</span></a>
</span><span id="FST-1139"><a href="#FST-1139"><span class="linenos">1139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</span><span id="FST-1140"><a href="#FST-1140"><span class="linenos">1140</span></a>
</span><span id="FST-1141"><a href="#FST-1141"><span class="linenos">1141</span></a>            <span class="k">return</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span><span id="FST-1142"><a href="#FST-1142"><span class="linenos">1142</span></a>
</span><span id="FST-1143"><a href="#FST-1143"><span class="linenos">1143</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">linefunc</span> <span class="o">=</span> <span class="n">out</span>
</span><span id="FST-1144"><a href="#FST-1144"><span class="linenos">1144</span></a>
</span><span id="FST-1145"><a href="#FST-1145"><span class="linenos">1145</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</span><span id="FST-1146"><a href="#FST-1146"><span class="linenos">1146</span></a>
</span><span id="FST-1147"><a href="#FST-1147"><span class="linenos">1147</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reparse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">locs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FST-1148"><a href="#FST-1148"><span class="linenos">1148</span></a>               <span class="n">raise_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Self</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="FST-1149"><a href="#FST-1149"><span class="linenos">1149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sanity check. Walk the tree and make sure all `AST`s have corresponding `FST` nodes with valid parent / child</span>
</span><span id="FST-1150"><a href="#FST-1150"><span class="linenos">1150</span></a><span class="sd">        links, then (optionally) reparse source and make sure parsed tree matches currently stored tree (locations and</span>
</span><span id="FST-1151"><a href="#FST-1151"><span class="linenos">1151</span></a><span class="sd">        everything). The reparse can only be carried out on root nodes but the link validation can be done on any level.</span>
</span><span id="FST-1152"><a href="#FST-1152"><span class="linenos">1152</span></a>
</span><span id="FST-1153"><a href="#FST-1153"><span class="linenos">1153</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1154"><a href="#FST-1154"><span class="linenos">1154</span></a><span class="sd">        - `mode`: Parse mode to use, otherwise if `None` then use the top level AST node type for the mode. Depending on</span>
</span><span id="FST-1155"><a href="#FST-1155"><span class="linenos">1155</span></a><span class="sd">            how this is set will determine whether the verification is checking if is parsable by python (`&#39;exec&#39;` for</span>
</span><span id="FST-1156"><a href="#FST-1156"><span class="linenos">1156</span></a><span class="sd">            example), or if the node itself is just in a valid state (where `None` is good). See `fst.misc.Mode`.</span>
</span><span id="FST-1157"><a href="#FST-1157"><span class="linenos">1157</span></a><span class="sd">        - `reparse`: Whether to reparse the source and compare ASTs (including location). Otherwise the check is limited</span>
</span><span id="FST-1158"><a href="#FST-1158"><span class="linenos">1158</span></a><span class="sd">            to a structure check that all children have `FST` nodes which are all liked correctly to their parents.</span>
</span><span id="FST-1159"><a href="#FST-1159"><span class="linenos">1159</span></a><span class="sd">            `reparse=True` only allowed on root node.</span>
</span><span id="FST-1160"><a href="#FST-1160"><span class="linenos">1160</span></a><span class="sd">        - `locs`: Whether to compare locations after reparse or not.</span>
</span><span id="FST-1161"><a href="#FST-1161"><span class="linenos">1161</span></a><span class="sd">        - `ctx`: Whether to compare `ctx` nodes after reparse or not.</span>
</span><span id="FST-1162"><a href="#FST-1162"><span class="linenos">1162</span></a><span class="sd">        - `raise_`: Whether to raise an exception on verify failed or return `None`.</span>
</span><span id="FST-1163"><a href="#FST-1163"><span class="linenos">1163</span></a>
</span><span id="FST-1164"><a href="#FST-1164"><span class="linenos">1164</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1165"><a href="#FST-1165"><span class="linenos">1165</span></a><span class="sd">        - `None` on failure to verify (if not `raise_`), otherwise `self`.</span>
</span><span id="FST-1166"><a href="#FST-1166"><span class="linenos">1166</span></a>
</span><span id="FST-1167"><a href="#FST-1167"><span class="linenos">1167</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1168"><a href="#FST-1168"><span class="linenos">1168</span></a><span class="sd">        ```py</span>
</span><span id="FST-1169"><a href="#FST-1169"><span class="linenos">1169</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;var = 123&#39;).verify()</span>
</span><span id="FST-1170"><a href="#FST-1170"><span class="linenos">1170</span></a><span class="sd">        &lt;Assign ROOT 0,0..0,9&gt;</span>
</span><span id="FST-1171"><a href="#FST-1171"><span class="linenos">1171</span></a>
</span><span id="FST-1172"><a href="#FST-1172"><span class="linenos">1172</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;).verify()</span>
</span><span id="FST-1173"><a href="#FST-1173"><span class="linenos">1173</span></a><span class="sd">        &lt;Slice ROOT 0,0..0,5&gt;</span>
</span><span id="FST-1174"><a href="#FST-1174"><span class="linenos">1174</span></a>
</span><span id="FST-1175"><a href="#FST-1175"><span class="linenos">1175</span></a><span class="sd">        &gt;&gt;&gt; bool(FST(&#39;a:b:c&#39;).verify(&#39;exec&#39;, raise_=False))</span>
</span><span id="FST-1176"><a href="#FST-1176"><span class="linenos">1176</span></a><span class="sd">        False</span>
</span><span id="FST-1177"><a href="#FST-1177"><span class="linenos">1177</span></a><span class="sd">        ```</span>
</span><span id="FST-1178"><a href="#FST-1178"><span class="linenos">1178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1179"><a href="#FST-1179"><span class="linenos">1179</span></a>
</span><span id="FST-1180"><a href="#FST-1180"><span class="linenos">1180</span></a>        <span class="c1"># validate tree links</span>
</span><span id="FST-1181"><a href="#FST-1181"><span class="linenos">1181</span></a>
</span><span id="FST-1182"><a href="#FST-1182"><span class="linenos">1182</span></a>        <span class="n">ast</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-1183"><a href="#FST-1183"><span class="linenos">1183</span></a>        <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ast</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)]</span>  <span class="c1"># [(AST, parent FST, pfield), ...]</span>
</span><span id="FST-1184"><a href="#FST-1184"><span class="linenos">1184</span></a>
</span><span id="FST-1185"><a href="#FST-1185"><span class="linenos">1185</span></a>        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
</span><span id="FST-1186"><a href="#FST-1186"><span class="linenos">1186</span></a>            <span class="n">a</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">pfield</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="FST-1187"><a href="#FST-1187"><span class="linenos">1187</span></a>
</span><span id="FST-1188"><a href="#FST-1188"><span class="linenos">1188</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">parent</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">pfield</span> <span class="o">!=</span> <span class="n">pfield</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
</span><span id="FST-1189"><a href="#FST-1189"><span class="linenos">1189</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">raise_</span><span class="p">:</span>
</span><span id="FST-1190"><a href="#FST-1190"><span class="linenos">1190</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-1191"><a href="#FST-1191"><span class="linenos">1191</span></a>
</span><span id="FST-1192"><a href="#FST-1192"><span class="linenos">1192</span></a>                <span class="n">path</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">pfield</span><span class="p">]</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ast</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="FST-1193"><a href="#FST-1193"><span class="linenos">1193</span></a>                <span class="n">path</span>   <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">af</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">af</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">af</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">for</span> <span class="n">af</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
</span><span id="FST-1194"><a href="#FST-1194"><span class="linenos">1194</span></a>                <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;, no AST.f node&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span> <span class="k">else</span> <span class="s1">&#39;, bad parent&#39;</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">parent</span> <span class="k">else</span> <span class="s1">&#39;, bad pfield&#39;</span>
</span><span id="FST-1195"><a href="#FST-1195"><span class="linenos">1195</span></a>
</span><span id="FST-1196"><a href="#FST-1196"><span class="linenos">1196</span></a>                <span class="k">raise</span> <span class="n">WalkFail</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;invalid child </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> at </span><span class="si">{</span><span class="n">path</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;self&quot;</span><span class="si">}{</span><span class="n">reason</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST-1197"><a href="#FST-1197"><span class="linenos">1197</span></a>
</span><span id="FST-1198"><a href="#FST-1198"><span class="linenos">1198</span></a>            <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">iter_fields</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
</span><span id="FST-1199"><a href="#FST-1199"><span class="linenos">1199</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="FST-1200"><a href="#FST-1200"><span class="linenos">1200</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">)))</span>
</span><span id="FST-1201"><a href="#FST-1201"><span class="linenos">1201</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST-1202"><a href="#FST-1202"><span class="linenos">1202</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">child</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">AST</span><span class="p">))</span>
</span><span id="FST-1203"><a href="#FST-1203"><span class="linenos">1203</span></a>
</span><span id="FST-1204"><a href="#FST-1204"><span class="linenos">1204</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">reparse</span><span class="p">:</span>
</span><span id="FST-1205"><a href="#FST-1205"><span class="linenos">1205</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-1206"><a href="#FST-1206"><span class="linenos">1206</span></a>
</span><span id="FST-1207"><a href="#FST-1207"><span class="linenos">1207</span></a>        <span class="c1"># reparse</span>
</span><span id="FST-1208"><a href="#FST-1208"><span class="linenos">1208</span></a>
</span><span id="FST-1209"><a href="#FST-1209"><span class="linenos">1209</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="FST-1210"><a href="#FST-1210"><span class="linenos">1210</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;verify with reparse can only be called on root node&#39;</span><span class="p">)</span>
</span><span id="FST-1211"><a href="#FST-1211"><span class="linenos">1211</span></a>
</span><span id="FST-1212"><a href="#FST-1212"><span class="linenos">1212</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span>
</span><span id="FST-1213"><a href="#FST-1213"><span class="linenos">1213</span></a>
</span><span id="FST-1214"><a href="#FST-1214"><span class="linenos">1214</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST-1215"><a href="#FST-1215"><span class="linenos">1215</span></a>            <span class="n">astp</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="n">mode</span> <span class="ow">or</span> <span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST-1216"><a href="#FST-1216"><span class="linenos">1216</span></a>
</span><span id="FST-1217"><a href="#FST-1217"><span class="linenos">1217</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="n">NodeError</span><span class="p">):</span>
</span><span id="FST-1218"><a href="#FST-1218"><span class="linenos">1218</span></a>            <span class="k">if</span> <span class="n">raise_</span><span class="p">:</span>
</span><span id="FST-1219"><a href="#FST-1219"><span class="linenos">1219</span></a>                <span class="k">raise</span>
</span><span id="FST-1220"><a href="#FST-1220"><span class="linenos">1220</span></a>
</span><span id="FST-1221"><a href="#FST-1221"><span class="linenos">1221</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-1222"><a href="#FST-1222"><span class="linenos">1222</span></a>
</span><span id="FST-1223"><a href="#FST-1223"><span class="linenos">1223</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">compare_asts</span><span class="p">(</span><span class="n">astp</span><span class="p">,</span> <span class="n">ast</span><span class="p">,</span> <span class="n">locs</span><span class="o">=</span><span class="n">locs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">parse_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type_comments&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
</span><span id="FST-1224"><a href="#FST-1224"><span class="linenos">1224</span></a>                            <span class="n">raise_</span><span class="o">=</span><span class="n">raise_</span><span class="p">):</span>
</span><span id="FST-1225"><a href="#FST-1225"><span class="linenos">1225</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-1226"><a href="#FST-1226"><span class="linenos">1226</span></a>
</span><span id="FST-1227"><a href="#FST-1227"><span class="linenos">1227</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-1228"><a href="#FST-1228"><span class="linenos">1228</span></a>
</span><span id="FST-1229"><a href="#FST-1229"><span class="linenos">1229</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="FST-1230"><a href="#FST-1230"><span class="linenos">1230</span></a>    <span class="c1"># Reconcile</span>
</span><span id="FST-1231"><a href="#FST-1231"><span class="linenos">1231</span></a>
</span><span id="FST-1232"><a href="#FST-1232"><span class="linenos">1232</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mark</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>  <span class="c1"># placeholder for pydoc, otherwise it puts these at the end of the class</span>
</span><span id="FST-1233"><a href="#FST-1233"><span class="linenos">1233</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reconcile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-1234"><a href="#FST-1234"><span class="linenos">1234</span></a>
</span><span id="FST-1235"><a href="#FST-1235"><span class="linenos">1235</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_reconcile</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="FST-1236"><a href="#FST-1236"><span class="linenos">1236</span></a>        <span class="n">mark</span><span class="p">,</span>
</span><span id="FST-1237"><a href="#FST-1237"><span class="linenos">1237</span></a>        <span class="n">reconcile</span><span class="p">,</span>
</span><span id="FST-1238"><a href="#FST-1238"><span class="linenos">1238</span></a>    <span class="p">)</span>
</span><span id="FST-1239"><a href="#FST-1239"><span class="linenos">1239</span></a>
</span><span id="FST-1240"><a href="#FST-1240"><span class="linenos">1240</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="FST-1241"><a href="#FST-1241"><span class="linenos">1241</span></a>    <span class="c1"># High level</span>
</span><span id="FST-1242"><a href="#FST-1242"><span class="linenos">1242</span></a>
</span><span id="FST-1243"><a href="#FST-1243"><span class="linenos">1243</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST-1244"><a href="#FST-1244"><span class="linenos">1244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy this node to a new top-level tree, dedenting and fixing as necessary.</span>
</span><span id="FST-1245"><a href="#FST-1245"><span class="linenos">1245</span></a>
</span><span id="FST-1246"><a href="#FST-1246"><span class="linenos">1246</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1247"><a href="#FST-1247"><span class="linenos">1247</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST-1248"><a href="#FST-1248"><span class="linenos">1248</span></a>
</span><span id="FST-1249"><a href="#FST-1249"><span class="linenos">1249</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1250"><a href="#FST-1250"><span class="linenos">1250</span></a><span class="sd">        - `FST`: Copied node.</span>
</span><span id="FST-1251"><a href="#FST-1251"><span class="linenos">1251</span></a>
</span><span id="FST-1252"><a href="#FST-1252"><span class="linenos">1252</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1253"><a href="#FST-1253"><span class="linenos">1253</span></a><span class="sd">        ```py</span>
</span><span id="FST-1254"><a href="#FST-1254"><span class="linenos">1254</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).elts[1].copy().src</span>
</span><span id="FST-1255"><a href="#FST-1255"><span class="linenos">1255</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="FST-1256"><a href="#FST-1256"><span class="linenos">1256</span></a><span class="sd">        ```</span>
</span><span id="FST-1257"><a href="#FST-1257"><span class="linenos">1257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1258"><a href="#FST-1258"><span class="linenos">1258</span></a>
</span><span id="FST-1259"><a href="#FST-1259"><span class="linenos">1259</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST-1260"><a href="#FST-1260"><span class="linenos">1260</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_get_one</span><span class="p">((</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1261"><a href="#FST-1261"><span class="linenos">1261</span></a>
</span><span id="FST-1262"><a href="#FST-1262"><span class="linenos">1262</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">copy_ast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">[:],</span> <span class="n">from_</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">lcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FST-1263"><a href="#FST-1263"><span class="linenos">1263</span></a>
</span><span id="FST-1264"><a href="#FST-1264"><span class="linenos">1264</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST-1265"><a href="#FST-1265"><span class="linenos">1265</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cut out this node to a new top-level tree (if possible), dedenting and fixing as necessary. Cannot cut root</span>
</span><span id="FST-1266"><a href="#FST-1266"><span class="linenos">1266</span></a><span class="sd">        node.</span>
</span><span id="FST-1267"><a href="#FST-1267"><span class="linenos">1267</span></a>
</span><span id="FST-1268"><a href="#FST-1268"><span class="linenos">1268</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1269"><a href="#FST-1269"><span class="linenos">1269</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST-1270"><a href="#FST-1270"><span class="linenos">1270</span></a>
</span><span id="FST-1271"><a href="#FST-1271"><span class="linenos">1271</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1272"><a href="#FST-1272"><span class="linenos">1272</span></a><span class="sd">        - `FST`: Cut node.</span>
</span><span id="FST-1273"><a href="#FST-1273"><span class="linenos">1273</span></a>
</span><span id="FST-1274"><a href="#FST-1274"><span class="linenos">1274</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1275"><a href="#FST-1275"><span class="linenos">1275</span></a><span class="sd">        ```py</span>
</span><span id="FST-1276"><a href="#FST-1276"><span class="linenos">1276</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).elts[1].cut().src</span>
</span><span id="FST-1277"><a href="#FST-1277"><span class="linenos">1277</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="FST-1278"><a href="#FST-1278"><span class="linenos">1278</span></a>
</span><span id="FST-1279"><a href="#FST-1279"><span class="linenos">1279</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST-1280"><a href="#FST-1280"><span class="linenos">1280</span></a><span class="sd">        &#39;[0, 2, 3]&#39;</span>
</span><span id="FST-1281"><a href="#FST-1281"><span class="linenos">1281</span></a><span class="sd">        ```</span>
</span><span id="FST-1282"><a href="#FST-1282"><span class="linenos">1282</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1283"><a href="#FST-1283"><span class="linenos">1283</span></a>
</span><span id="FST-1284"><a href="#FST-1284"><span class="linenos">1284</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST-1285"><a href="#FST-1285"><span class="linenos">1285</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_get_one</span><span class="p">((</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1286"><a href="#FST-1286"><span class="linenos">1286</span></a>
</span><span id="FST-1287"><a href="#FST-1287"><span class="linenos">1287</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cannot cut root node&#39;</span><span class="p">)</span>
</span><span id="FST-1288"><a href="#FST-1288"><span class="linenos">1288</span></a>
</span><span id="FST-1289"><a href="#FST-1289"><span class="linenos">1289</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># -&gt; replaced Self or None if deleted</span>
</span><span id="FST-1290"><a href="#FST-1290"><span class="linenos">1290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace or delete (if `code=None`, if possible) this node. Returns the new node for `self`, not the old</span>
</span><span id="FST-1291"><a href="#FST-1291"><span class="linenos">1291</span></a><span class="sd">        replaced node, or `None` if was deleted or raw replaced and the old node disappeared. Cannot delete root node.</span>
</span><span id="FST-1292"><a href="#FST-1292"><span class="linenos">1292</span></a><span class="sd">        CAN replace root node, in which case the accessing `FST` node remains the same but the top-level `AST` and</span>
</span><span id="FST-1293"><a href="#FST-1293"><span class="linenos">1293</span></a><span class="sd">        source change.</span>
</span><span id="FST-1294"><a href="#FST-1294"><span class="linenos">1294</span></a>
</span><span id="FST-1295"><a href="#FST-1295"><span class="linenos">1295</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1296"><a href="#FST-1296"><span class="linenos">1296</span></a><span class="sd">        - `code`: `FST`, `AST` or source `str` or `list[str]` to put at this location. `None` to delete this node.</span>
</span><span id="FST-1297"><a href="#FST-1297"><span class="linenos">1297</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST-1298"><a href="#FST-1298"><span class="linenos">1298</span></a><span class="sd">            - `to`: Special option which only applies replacing in `raw` mode (either through `True` or `&#39;auto&#39;`).</span>
</span><span id="FST-1299"><a href="#FST-1299"><span class="linenos">1299</span></a><span class="sd">                Instead of replacing just this node, will replace the entire span from this node to the node specified</span>
</span><span id="FST-1300"><a href="#FST-1300"><span class="linenos">1300</span></a><span class="sd">                in `to` with the `code` passed.</span>
</span><span id="FST-1301"><a href="#FST-1301"><span class="linenos">1301</span></a>
</span><span id="FST-1302"><a href="#FST-1302"><span class="linenos">1302</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1303"><a href="#FST-1303"><span class="linenos">1303</span></a><span class="sd">        - `FST | None`: Returns the new node if successfully replaced or `None` if deleted.</span>
</span><span id="FST-1304"><a href="#FST-1304"><span class="linenos">1304</span></a>
</span><span id="FST-1305"><a href="#FST-1305"><span class="linenos">1305</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1306"><a href="#FST-1306"><span class="linenos">1306</span></a><span class="sd">        ```py</span>
</span><span id="FST-1307"><a href="#FST-1307"><span class="linenos">1307</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).elts[1].replace(&#39;4&#39;).root.src</span>
</span><span id="FST-1308"><a href="#FST-1308"><span class="linenos">1308</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="FST-1309"><a href="#FST-1309"><span class="linenos">1309</span></a>
</span><span id="FST-1310"><a href="#FST-1310"><span class="linenos">1310</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;def f(a, /, b, *c, **d) -&gt; int: pass&#39;)</span>
</span><span id="FST-1311"><a href="#FST-1311"><span class="linenos">1311</span></a><span class="sd">        &gt;&gt;&gt; f.args.posonlyargs[0].replace(&#39;)&#39;, to=f.returns, raw=True)  # raw reparse</span>
</span><span id="FST-1312"><a href="#FST-1312"><span class="linenos">1312</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST-1313"><a href="#FST-1313"><span class="linenos">1313</span></a><span class="sd">        &#39;def f(): pass&#39;</span>
</span><span id="FST-1314"><a href="#FST-1314"><span class="linenos">1314</span></a><span class="sd">        ```</span>
</span><span id="FST-1315"><a href="#FST-1315"><span class="linenos">1315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1316"><a href="#FST-1316"><span class="linenos">1316</span></a>
</span><span id="FST-1317"><a href="#FST-1317"><span class="linenos">1317</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST-1318"><a href="#FST-1318"><span class="linenos">1318</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="p">(</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1319"><a href="#FST-1319"><span class="linenos">1319</span></a>
</span><span id="FST-1320"><a href="#FST-1320"><span class="linenos">1320</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1321"><a href="#FST-1321"><span class="linenos">1321</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cannot delete root node&#39;</span><span class="p">)</span>
</span><span id="FST-1322"><a href="#FST-1322"><span class="linenos">1322</span></a>        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">):</span>
</span><span id="FST-1323"><a href="#FST-1323"><span class="linenos">1323</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot replace root node using a &#39;to&#39; parameter&quot;</span><span class="p">)</span>
</span><span id="FST-1324"><a href="#FST-1324"><span class="linenos">1324</span></a>
</span><span id="FST-1325"><a href="#FST-1325"><span class="linenos">1325</span></a>        <span class="n">code</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_code_as_all</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST-1326"><a href="#FST-1326"><span class="linenos">1326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST-1327"><a href="#FST-1327"><span class="linenos">1327</span></a>
</span><span id="FST-1328"><a href="#FST-1328"><span class="linenos">1328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_ast</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="FST-1329"><a href="#FST-1329"><span class="linenos">1329</span></a>
</span><span id="FST-1330"><a href="#FST-1330"><span class="linenos">1330</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-1331"><a href="#FST-1331"><span class="linenos">1331</span></a>
</span><span id="FST-1332"><a href="#FST-1332"><span class="linenos">1332</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
</span><span id="FST-1333"><a href="#FST-1333"><span class="linenos">1333</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete this node if possible, equivalent to `replace(None, ...)`. Cannot delete root node.</span>
</span><span id="FST-1334"><a href="#FST-1334"><span class="linenos">1334</span></a>
</span><span id="FST-1335"><a href="#FST-1335"><span class="linenos">1335</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1336"><a href="#FST-1336"><span class="linenos">1336</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST-1337"><a href="#FST-1337"><span class="linenos">1337</span></a>
</span><span id="FST-1338"><a href="#FST-1338"><span class="linenos">1338</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1339"><a href="#FST-1339"><span class="linenos">1339</span></a><span class="sd">        ```py</span>
</span><span id="FST-1340"><a href="#FST-1340"><span class="linenos">1340</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).elts[1].remove(); f.src</span>
</span><span id="FST-1341"><a href="#FST-1341"><span class="linenos">1341</span></a><span class="sd">        &#39;[0, 2, 3]&#39;</span>
</span><span id="FST-1342"><a href="#FST-1342"><span class="linenos">1342</span></a><span class="sd">        ```</span>
</span><span id="FST-1343"><a href="#FST-1343"><span class="linenos">1343</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1344"><a href="#FST-1344"><span class="linenos">1344</span></a>
</span><span id="FST-1345"><a href="#FST-1345"><span class="linenos">1345</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST-1346"><a href="#FST-1346"><span class="linenos">1346</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">(</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1347"><a href="#FST-1347"><span class="linenos">1347</span></a>
</span><span id="FST-1348"><a href="#FST-1348"><span class="linenos">1348</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot delete root node&#39;</span><span class="p">)</span>
</span><span id="FST-1349"><a href="#FST-1349"><span class="linenos">1349</span></a>
</span><span id="FST-1350"><a href="#FST-1350"><span class="linenos">1350</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FST-1351"><a href="#FST-1351"><span class="linenos">1351</span></a>            <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="n">constant</span><span class="p">:</span>
</span><span id="FST-1352"><a href="#FST-1352"><span class="linenos">1352</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copy or cut an individual child node or a slice of child nodes from `self` if possible. This function can do</span>
</span><span id="FST-1353"><a href="#FST-1353"><span class="linenos">1353</span></a><span class="sd">        everything that `get_slice()` can.</span>
</span><span id="FST-1354"><a href="#FST-1354"><span class="linenos">1354</span></a>
</span><span id="FST-1355"><a href="#FST-1355"><span class="linenos">1355</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1356"><a href="#FST-1356"><span class="linenos">1356</span></a><span class="sd">        - `idx`: The index of the child node to get if the field being gotten from contains multiple elements or the</span>
</span><span id="FST-1357"><a href="#FST-1357"><span class="linenos">1357</span></a><span class="sd">            start of the slice to get if getting a slice (by specifying `stop`). If the field being gotten from is</span>
</span><span id="FST-1358"><a href="#FST-1358"><span class="linenos">1358</span></a><span class="sd">            an individual element then this should be `None`. If `stop` is specified and getting a slice then a `None`</span>
</span><span id="FST-1359"><a href="#FST-1359"><span class="linenos">1359</span></a><span class="sd">            here means copy from the start of the list.</span>
</span><span id="FST-1360"><a href="#FST-1360"><span class="linenos">1360</span></a><span class="sd">        - `stop`: The end index (exclusive) of the child node to get if getting a slice from a field that contains</span>
</span><span id="FST-1361"><a href="#FST-1361"><span class="linenos">1361</span></a><span class="sd">            multiple elements. This should be one past the last element to get (like python list indexing). If this is</span>
</span><span id="FST-1362"><a href="#FST-1362"><span class="linenos">1362</span></a><span class="sd">            `False` then it indicates that a single element is being requested and not a slice. If this is `None` then</span>
</span><span id="FST-1363"><a href="#FST-1363"><span class="linenos">1363</span></a><span class="sd">            it indicates a slice operation to the end of the list (like python `a[start:]`).</span>
</span><span id="FST-1364"><a href="#FST-1364"><span class="linenos">1364</span></a><span class="sd">        - `field`: The name of the field to get the element(s) from, which can be an individual element like a `value`</span>
</span><span id="FST-1365"><a href="#FST-1365"><span class="linenos">1365</span></a><span class="sd">            or a list like `body`. If this is `None` then the default field for the node type is used. Most node types</span>
</span><span id="FST-1366"><a href="#FST-1366"><span class="linenos">1366</span></a><span class="sd">            have a common-sense default field, e.g. `body` for all block statements, `value` for things like `Return`</span>
</span><span id="FST-1367"><a href="#FST-1367"><span class="linenos">1367</span></a><span class="sd">            and `Yield`. `Dict`, `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="FST-1368"><a href="#FST-1368"><span class="linenos">1368</span></a><span class="sd">        - `cut`: Whether to cut out the child node (if possible) or not (just copy).</span>
</span><span id="FST-1369"><a href="#FST-1369"><span class="linenos">1369</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST-1370"><a href="#FST-1370"><span class="linenos">1370</span></a>
</span><span id="FST-1371"><a href="#FST-1371"><span class="linenos">1371</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `idx` or `stop` parameter. If passed in</span>
</span><span id="FST-1372"><a href="#FST-1372"><span class="linenos">1372</span></a><span class="sd">        `idx` then the field is assumed individual and if passed in `stop` then it is a list and an individual element</span>
</span><span id="FST-1373"><a href="#FST-1373"><span class="linenos">1373</span></a><span class="sd">        is being gotten from `idx` and not a slice.</span>
</span><span id="FST-1374"><a href="#FST-1374"><span class="linenos">1374</span></a>
</span><span id="FST-1375"><a href="#FST-1375"><span class="linenos">1375</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1376"><a href="#FST-1376"><span class="linenos">1376</span></a><span class="sd">        - `FST`: When getting an actual node (most situations).</span>
</span><span id="FST-1377"><a href="#FST-1377"><span class="linenos">1377</span></a><span class="sd">        - `str`: When getting am identifier, like from `Name.id`.</span>
</span><span id="FST-1378"><a href="#FST-1378"><span class="linenos">1378</span></a><span class="sd">        - `constant`: When getting a constant (`fst.astutil.constant`), like from `MatchSingleton.value`.</span>
</span><span id="FST-1379"><a href="#FST-1379"><span class="linenos">1379</span></a>
</span><span id="FST-1380"><a href="#FST-1380"><span class="linenos">1380</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1381"><a href="#FST-1381"><span class="linenos">1381</span></a><span class="sd">        ```py</span>
</span><span id="FST-1382"><a href="#FST-1382"><span class="linenos">1382</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(1).src</span>
</span><span id="FST-1383"><a href="#FST-1383"><span class="linenos">1383</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="FST-1384"><a href="#FST-1384"><span class="linenos">1384</span></a>
</span><span id="FST-1385"><a href="#FST-1385"><span class="linenos">1385</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get(1, 3).src</span>
</span><span id="FST-1386"><a href="#FST-1386"><span class="linenos">1386</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST-1387"><a href="#FST-1387"><span class="linenos">1387</span></a>
</span><span id="FST-1388"><a href="#FST-1388"><span class="linenos">1388</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST-1389"><a href="#FST-1389"><span class="linenos">1389</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="FST-1390"><a href="#FST-1390"><span class="linenos">1390</span></a>
</span><span id="FST-1391"><a href="#FST-1391"><span class="linenos">1391</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get(1, 3, cut=True).src</span>
</span><span id="FST-1392"><a href="#FST-1392"><span class="linenos">1392</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST-1393"><a href="#FST-1393"><span class="linenos">1393</span></a>
</span><span id="FST-1394"><a href="#FST-1394"><span class="linenos">1394</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST-1395"><a href="#FST-1395"><span class="linenos">1395</span></a><span class="sd">        &#39;[0, 3]&#39;</span>
</span><span id="FST-1396"><a href="#FST-1396"><span class="linenos">1396</span></a>
</span><span id="FST-1397"><a href="#FST-1397"><span class="linenos">1397</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(None, 3).src</span>
</span><span id="FST-1398"><a href="#FST-1398"><span class="linenos">1398</span></a><span class="sd">        &#39;[0, 1, 2]&#39;</span>
</span><span id="FST-1399"><a href="#FST-1399"><span class="linenos">1399</span></a>
</span><span id="FST-1400"><a href="#FST-1400"><span class="linenos">1400</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(-3, None).src</span>
</span><span id="FST-1401"><a href="#FST-1401"><span class="linenos">1401</span></a><span class="sd">        &#39;[1, 2, 3]&#39;</span>
</span><span id="FST-1402"><a href="#FST-1402"><span class="linenos">1402</span></a>
</span><span id="FST-1403"><a href="#FST-1403"><span class="linenos">1403</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2&#39;).get(0).src</span>
</span><span id="FST-1404"><a href="#FST-1404"><span class="linenos">1404</span></a><span class="sd">        &#39;i = 1&#39;</span>
</span><span id="FST-1405"><a href="#FST-1405"><span class="linenos">1405</span></a>
</span><span id="FST-1406"><a href="#FST-1406"><span class="linenos">1406</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2&#39;).get(&#39;orelse&#39;).src</span>
</span><span id="FST-1407"><a href="#FST-1407"><span class="linenos">1407</span></a><span class="sd">        &#39;j = 2&#39;</span>
</span><span id="FST-1408"><a href="#FST-1408"><span class="linenos">1408</span></a>
</span><span id="FST-1409"><a href="#FST-1409"><span class="linenos">1409</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2; k = 3&#39;).get(1, &#39;orelse&#39;).src</span>
</span><span id="FST-1410"><a href="#FST-1410"><span class="linenos">1410</span></a><span class="sd">        &#39;k = 3&#39;</span>
</span><span id="FST-1411"><a href="#FST-1411"><span class="linenos">1411</span></a>
</span><span id="FST-1412"><a href="#FST-1412"><span class="linenos">1412</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2; k = 3; l = 4; m = 5&#39;).get(1, 3, &#39;orelse&#39;).src</span>
</span><span id="FST-1413"><a href="#FST-1413"><span class="linenos">1413</span></a><span class="sd">        &#39;k = 3; l = 4&#39;</span>
</span><span id="FST-1414"><a href="#FST-1414"><span class="linenos">1414</span></a>
</span><span id="FST-1415"><a href="#FST-1415"><span class="linenos">1415</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;return 1&#39;).get().src  # default field is &#39;value&#39;</span>
</span><span id="FST-1416"><a href="#FST-1416"><span class="linenos">1416</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="FST-1417"><a href="#FST-1417"><span class="linenos">1417</span></a>
</span><span id="FST-1418"><a href="#FST-1418"><span class="linenos">1418</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get().src  # &#39;elts&#39; slice copy is made</span>
</span><span id="FST-1419"><a href="#FST-1419"><span class="linenos">1419</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="FST-1420"><a href="#FST-1420"><span class="linenos">1420</span></a><span class="sd">        ```</span>
</span><span id="FST-1421"><a href="#FST-1421"><span class="linenos">1421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1422"><a href="#FST-1422"><span class="linenos">1422</span></a>
</span><span id="FST-1423"><a href="#FST-1423"><span class="linenos">1423</span></a>        <span class="n">ast</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-1424"><a href="#FST-1424"><span class="linenos">1424</span></a>        <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="FST-1425"><a href="#FST-1425"><span class="linenos">1425</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>     <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="FST-1426"><a href="#FST-1426"><span class="linenos">1426</span></a>
</span><span id="FST-1427"><a href="#FST-1427"><span class="linenos">1427</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST-1428"><a href="#FST-1428"><span class="linenos">1428</span></a>            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="FST-1429"><a href="#FST-1429"><span class="linenos">1429</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1430"><a href="#FST-1430"><span class="linenos">1430</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1431"><a href="#FST-1431"><span class="linenos">1431</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1432"><a href="#FST-1432"><span class="linenos">1432</span></a>
</span><span id="FST-1433"><a href="#FST-1433"><span class="linenos">1433</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span>
</span><span id="FST-1434"><a href="#FST-1434"><span class="linenos">1434</span></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot get() non-slice from index &#39;end&#39;&quot;</span><span class="p">)</span>
</span><span id="FST-1435"><a href="#FST-1435"><span class="linenos">1435</span></a>
</span><span id="FST-1436"><a href="#FST-1436"><span class="linenos">1436</span></a>        <span class="k">elif</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1437"><a href="#FST-1437"><span class="linenos">1437</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">field_</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1"> does not take an index&#39;</span><span class="p">)</span>
</span><span id="FST-1438"><a href="#FST-1438"><span class="linenos">1438</span></a>
</span><span id="FST-1439"><a href="#FST-1439"><span class="linenos">1439</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_one</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1440"><a href="#FST-1440"><span class="linenos">1440</span></a>
</span><span id="FST-1441"><a href="#FST-1441"><span class="linenos">1441</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="n">constant</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST-1442"><a href="#FST-1442"><span class="linenos">1442</span></a>            <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FST-1443"><a href="#FST-1443"><span class="linenos">1443</span></a>            <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="FST-1444"><a href="#FST-1444"><span class="linenos">1444</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put an individual node or a slice of nodes to `self` if possible. This function can do everything that</span>
</span><span id="FST-1445"><a href="#FST-1445"><span class="linenos">1445</span></a><span class="sd">        `put_slice()` can. The node is passed as an existing top-level `FST`, `AST`, string or list of string lines. If</span>
</span><span id="FST-1446"><a href="#FST-1446"><span class="linenos">1446</span></a><span class="sd">        passed as an `FST` then it should be considered &quot;consumed&quot; after this function returns and is no logner valid,</span>
</span><span id="FST-1447"><a href="#FST-1447"><span class="linenos">1447</span></a><span class="sd">        even on failure. `AST` is copied.</span>
</span><span id="FST-1448"><a href="#FST-1448"><span class="linenos">1448</span></a>
</span><span id="FST-1449"><a href="#FST-1449"><span class="linenos">1449</span></a><span class="sd">        **WARNING!** The original `self` node may be invalidated during the operation if using raw mode (either</span>
</span><span id="FST-1450"><a href="#FST-1450"><span class="linenos">1450</span></a><span class="sd">        specifically or as a fallback), so make sure to swap it out for the return value of this function if you will</span>
</span><span id="FST-1451"><a href="#FST-1451"><span class="linenos">1451</span></a><span class="sd">        keep using the variable you called this method on. It will be changed accordingly in the tree but any other</span>
</span><span id="FST-1452"><a href="#FST-1452"><span class="linenos">1452</span></a><span class="sd">        outside references to the node may become invalid.</span>
</span><span id="FST-1453"><a href="#FST-1453"><span class="linenos">1453</span></a>
</span><span id="FST-1454"><a href="#FST-1454"><span class="linenos">1454</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1455"><a href="#FST-1455"><span class="linenos">1455</span></a><span class="sd">        - `code`: The node to put as an `FST` (must be root node), `AST`, a string or list of line strings. If putting</span>
</span><span id="FST-1456"><a href="#FST-1456"><span class="linenos">1456</span></a><span class="sd">            to an identifier field then this should be a string and it will be taken literally (no parsing). If putting</span>
</span><span id="FST-1457"><a href="#FST-1457"><span class="linenos">1457</span></a><span class="sd">            to a constant likew `MatchSingleton.value` or `Constant.value` then this should be an appropriate primitive</span>
</span><span id="FST-1458"><a href="#FST-1458"><span class="linenos">1458</span></a><span class="sd">            constant value.</span>
</span><span id="FST-1459"><a href="#FST-1459"><span class="linenos">1459</span></a><span class="sd">        - `idx`: The index of the field node to put to if the field being put to contains multiple elements or the start</span>
</span><span id="FST-1460"><a href="#FST-1460"><span class="linenos">1460</span></a><span class="sd">            of the slice to put if putting a slice (by specifying `stop`). If the field being put to is an individual</span>
</span><span id="FST-1461"><a href="#FST-1461"><span class="linenos">1461</span></a><span class="sd">            element then this should be `None`. If `stop` is specified and putting a slice then a `None` here means put</span>
</span><span id="FST-1462"><a href="#FST-1462"><span class="linenos">1462</span></a><span class="sd">            starting from the beginning of the list.</span>
</span><span id="FST-1463"><a href="#FST-1463"><span class="linenos">1463</span></a><span class="sd">        - `stop`: The end index (exclusive) of the field node to put to if putting a slice to a field that contains</span>
</span><span id="FST-1464"><a href="#FST-1464"><span class="linenos">1464</span></a><span class="sd">            multiple elements. This should be one past the last element to put (like python list indexing). If this is</span>
</span><span id="FST-1465"><a href="#FST-1465"><span class="linenos">1465</span></a><span class="sd">            `False` then it indicates that a single element is being put and not a slice. If this is `None` then it</span>
</span><span id="FST-1466"><a href="#FST-1466"><span class="linenos">1466</span></a><span class="sd">            indicates a slice operation to the end of the list (like python `a[start:]`).</span>
</span><span id="FST-1467"><a href="#FST-1467"><span class="linenos">1467</span></a><span class="sd">        - `field`: The name of the field to put the element(s) to, which can be an individual element like a `value` or</span>
</span><span id="FST-1468"><a href="#FST-1468"><span class="linenos">1468</span></a><span class="sd">            a list like `body`. If this is `None` then the default field for the node type is used. Most node types have</span>
</span><span id="FST-1469"><a href="#FST-1469"><span class="linenos">1469</span></a><span class="sd">            a common-sense default field, e.g. `body` for all block statements, `value` for things like `Return` and</span>
</span><span id="FST-1470"><a href="#FST-1470"><span class="linenos">1470</span></a><span class="sd">            `Yield`. `Dict`, `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="FST-1471"><a href="#FST-1471"><span class="linenos">1471</span></a><span class="sd">        - `one`: Only has meaning if putting a slice, and in this case `True` specifies that the source should be  put</span>
</span><span id="FST-1472"><a href="#FST-1472"><span class="linenos">1472</span></a><span class="sd">            as a single element to the range specified even if it is a valid slice. `False` indicates a true slice</span>
</span><span id="FST-1473"><a href="#FST-1473"><span class="linenos">1473</span></a><span class="sd">            operation replacing the range with the slice passed, which must in this case be a compatible slice type.</span>
</span><span id="FST-1474"><a href="#FST-1474"><span class="linenos">1474</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST-1475"><a href="#FST-1475"><span class="linenos">1475</span></a><span class="sd">            - `to`: Special option which only applies when putting a single element in `raw` mode (either through `True`</span>
</span><span id="FST-1476"><a href="#FST-1476"><span class="linenos">1476</span></a><span class="sd">                or `&#39;auto&#39;`). Instead of replacing just the target node, will replace the entire span from the target</span>
</span><span id="FST-1477"><a href="#FST-1477"><span class="linenos">1477</span></a><span class="sd">                node to the node specified in `to` with the `code` passed.</span>
</span><span id="FST-1478"><a href="#FST-1478"><span class="linenos">1478</span></a>
</span><span id="FST-1479"><a href="#FST-1479"><span class="linenos">1479</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `idx` or `stop` parameter. If passed in</span>
</span><span id="FST-1480"><a href="#FST-1480"><span class="linenos">1480</span></a><span class="sd">        `idx` then the field is assumed individual and if passed in `stop` then it is a list and an individual element</span>
</span><span id="FST-1481"><a href="#FST-1481"><span class="linenos">1481</span></a><span class="sd">        is being gotten from `idx` and not a slice.</span>
</span><span id="FST-1482"><a href="#FST-1482"><span class="linenos">1482</span></a>
</span><span id="FST-1483"><a href="#FST-1483"><span class="linenos">1483</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1484"><a href="#FST-1484"><span class="linenos">1484</span></a><span class="sd">        - `self`</span>
</span><span id="FST-1485"><a href="#FST-1485"><span class="linenos">1485</span></a>
</span><span id="FST-1486"><a href="#FST-1486"><span class="linenos">1486</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1487"><a href="#FST-1487"><span class="linenos">1487</span></a><span class="sd">        ```py</span>
</span><span id="FST-1488"><a href="#FST-1488"><span class="linenos">1488</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4&#39;, 1).src</span>
</span><span id="FST-1489"><a href="#FST-1489"><span class="linenos">1489</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="FST-1490"><a href="#FST-1490"><span class="linenos">1490</span></a>
</span><span id="FST-1491"><a href="#FST-1491"><span class="linenos">1491</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3).src</span>
</span><span id="FST-1492"><a href="#FST-1492"><span class="linenos">1492</span></a><span class="sd">        &#39;[0, (4, 5), 3]&#39;</span>
</span><span id="FST-1493"><a href="#FST-1493"><span class="linenos">1493</span></a>
</span><span id="FST-1494"><a href="#FST-1494"><span class="linenos">1494</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3, one=False).src</span>
</span><span id="FST-1495"><a href="#FST-1495"><span class="linenos">1495</span></a><span class="sd">        &#39;[0, 4, 5, 3]&#39;</span>
</span><span id="FST-1496"><a href="#FST-1496"><span class="linenos">1496</span></a>
</span><span id="FST-1497"><a href="#FST-1497"><span class="linenos">1497</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, None, 3).src</span>
</span><span id="FST-1498"><a href="#FST-1498"><span class="linenos">1498</span></a><span class="sd">        &#39;[(4, 5), 3]&#39;</span>
</span><span id="FST-1499"><a href="#FST-1499"><span class="linenos">1499</span></a>
</span><span id="FST-1500"><a href="#FST-1500"><span class="linenos">1500</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).put(&#39;4, 5&#39;, -3, None, one=False).src</span>
</span><span id="FST-1501"><a href="#FST-1501"><span class="linenos">1501</span></a><span class="sd">        &#39;[0, 4, 5]&#39;</span>
</span><span id="FST-1502"><a href="#FST-1502"><span class="linenos">1502</span></a>
</span><span id="FST-1503"><a href="#FST-1503"><span class="linenos">1503</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0).src)</span>
</span><span id="FST-1504"><a href="#FST-1504"><span class="linenos">1504</span></a><span class="sd">        if 1:</span>
</span><span id="FST-1505"><a href="#FST-1505"><span class="linenos">1505</span></a><span class="sd">            z = -1</span>
</span><span id="FST-1506"><a href="#FST-1506"><span class="linenos">1506</span></a><span class="sd">        else: j = 2</span>
</span><span id="FST-1507"><a href="#FST-1507"><span class="linenos">1507</span></a>
</span><span id="FST-1508"><a href="#FST-1508"><span class="linenos">1508</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0, &#39;orelse&#39;).src.rstrip())</span>
</span><span id="FST-1509"><a href="#FST-1509"><span class="linenos">1509</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST-1510"><a href="#FST-1510"><span class="linenos">1510</span></a><span class="sd">        else:</span>
</span><span id="FST-1511"><a href="#FST-1511"><span class="linenos">1511</span></a><span class="sd">            z = -1</span>
</span><span id="FST-1512"><a href="#FST-1512"><span class="linenos">1512</span></a>
</span><span id="FST-1513"><a href="#FST-1513"><span class="linenos">1513</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;)</span>
</span><span id="FST-1514"><a href="#FST-1514"><span class="linenos">1514</span></a><span class="sd">        ...       .put(&#39;z = -1\ny = -2\nx = -3&#39;, &#39;orelse&#39;, one=False).src.rstrip())</span>
</span><span id="FST-1515"><a href="#FST-1515"><span class="linenos">1515</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST-1516"><a href="#FST-1516"><span class="linenos">1516</span></a><span class="sd">        else:</span>
</span><span id="FST-1517"><a href="#FST-1517"><span class="linenos">1517</span></a><span class="sd">            z = -1</span>
</span><span id="FST-1518"><a href="#FST-1518"><span class="linenos">1518</span></a><span class="sd">            y = -2</span>
</span><span id="FST-1519"><a href="#FST-1519"><span class="linenos">1519</span></a><span class="sd">            x = -3</span>
</span><span id="FST-1520"><a href="#FST-1520"><span class="linenos">1520</span></a>
</span><span id="FST-1521"><a href="#FST-1521"><span class="linenos">1521</span></a><span class="sd">        &gt;&gt;&gt; print((f := FST(&#39;if 1: i = 1\nelse: j = 2&#39;))</span>
</span><span id="FST-1522"><a href="#FST-1522"><span class="linenos">1522</span></a><span class="sd">        ...       .put(&#39;z = -1&#39;, 0, raw=True, to=f.orelse[0]).root.src)</span>
</span><span id="FST-1523"><a href="#FST-1523"><span class="linenos">1523</span></a><span class="sd">        if 1: z = -1</span>
</span><span id="FST-1524"><a href="#FST-1524"><span class="linenos">1524</span></a><span class="sd">        ```</span>
</span><span id="FST-1525"><a href="#FST-1525"><span class="linenos">1525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1526"><a href="#FST-1526"><span class="linenos">1526</span></a>
</span><span id="FST-1527"><a href="#FST-1527"><span class="linenos">1527</span></a>        <span class="n">ast</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-1528"><a href="#FST-1528"><span class="linenos">1528</span></a>        <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="FST-1529"><a href="#FST-1529"><span class="linenos">1529</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>     <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="FST-1530"><a href="#FST-1530"><span class="linenos">1530</span></a>
</span><span id="FST-1531"><a href="#FST-1531"><span class="linenos">1531</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST-1532"><a href="#FST-1532"><span class="linenos">1532</span></a>            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="FST-1533"><a href="#FST-1533"><span class="linenos">1533</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1534"><a href="#FST-1534"><span class="linenos">1534</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1535"><a href="#FST-1535"><span class="linenos">1535</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1536"><a href="#FST-1536"><span class="linenos">1536</span></a>
</span><span id="FST-1537"><a href="#FST-1537"><span class="linenos">1537</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span>
</span><span id="FST-1538"><a href="#FST-1538"><span class="linenos">1538</span></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot put() non-slice to index &#39;end&#39;&quot;</span><span class="p">)</span>
</span><span id="FST-1539"><a href="#FST-1539"><span class="linenos">1539</span></a>
</span><span id="FST-1540"><a href="#FST-1540"><span class="linenos">1540</span></a>        <span class="k">elif</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1541"><a href="#FST-1541"><span class="linenos">1541</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">field_</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1"> does not take an index&#39;</span><span class="p">)</span>
</span><span id="FST-1542"><a href="#FST-1542"><span class="linenos">1542</span></a>
</span><span id="FST-1543"><a href="#FST-1543"><span class="linenos">1543</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">one</span><span class="p">:</span>
</span><span id="FST-1544"><a href="#FST-1544"><span class="linenos">1544</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot use &#39;one=False&#39; in non-slice put()&quot;</span><span class="p">)</span>
</span><span id="FST-1545"><a href="#FST-1545"><span class="linenos">1545</span></a>
</span><span id="FST-1546"><a href="#FST-1546"><span class="linenos">1546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1547"><a href="#FST-1547"><span class="linenos">1547</span></a>
</span><span id="FST-1548"><a href="#FST-1548"><span class="linenos">1548</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">repath</span><span class="p">()</span>
</span><span id="FST-1549"><a href="#FST-1549"><span class="linenos">1549</span></a>
</span><span id="FST-1550"><a href="#FST-1550"><span class="linenos">1550</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST-1551"><a href="#FST-1551"><span class="linenos">1551</span></a>                  <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST-1552"><a href="#FST-1552"><span class="linenos">1552</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copy or cut a slice of child nodes from `self` if possible.</span>
</span><span id="FST-1553"><a href="#FST-1553"><span class="linenos">1553</span></a>
</span><span id="FST-1554"><a href="#FST-1554"><span class="linenos">1554</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1555"><a href="#FST-1555"><span class="linenos">1555</span></a><span class="sd">        - `start`: The start of the slice to get, or `None` for the beginning of the entire range.</span>
</span><span id="FST-1556"><a href="#FST-1556"><span class="linenos">1556</span></a><span class="sd">        - `stop`: The end index (exclusive) of the slice to get. This should be one past the last element to get (like</span>
</span><span id="FST-1557"><a href="#FST-1557"><span class="linenos">1557</span></a><span class="sd">            python list indexing). If this is `None` then it indicates a slice operation to the end of the list (like</span>
</span><span id="FST-1558"><a href="#FST-1558"><span class="linenos">1558</span></a><span class="sd">            python `a[start:]`).</span>
</span><span id="FST-1559"><a href="#FST-1559"><span class="linenos">1559</span></a><span class="sd">        - `field`: The name of the field to get the elements from, which can be an individual element like a `value` or</span>
</span><span id="FST-1560"><a href="#FST-1560"><span class="linenos">1560</span></a><span class="sd">            a list like `body`. If this is `None` then the default field for the node type is used. Most node types</span>
</span><span id="FST-1561"><a href="#FST-1561"><span class="linenos">1561</span></a><span class="sd">            have a common-sense default field, e.g. `body` for all block statements, `elts` for things like `List` and</span>
</span><span id="FST-1562"><a href="#FST-1562"><span class="linenos">1562</span></a><span class="sd">            `Tuple`. `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="FST-1563"><a href="#FST-1563"><span class="linenos">1563</span></a><span class="sd">        - `cut`: Whether to cut out the slice or not (just copy).</span>
</span><span id="FST-1564"><a href="#FST-1564"><span class="linenos">1564</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST-1565"><a href="#FST-1565"><span class="linenos">1565</span></a>
</span><span id="FST-1566"><a href="#FST-1566"><span class="linenos">1566</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `start` or `stop` parameter. If passed in</span>
</span><span id="FST-1567"><a href="#FST-1567"><span class="linenos">1567</span></a><span class="sd">        `start` then the slice is assumed to be the entire range, and if passed in `stop` then the slice goes from</span>
</span><span id="FST-1568"><a href="#FST-1568"><span class="linenos">1568</span></a><span class="sd">        `start` to the end of the range.</span>
</span><span id="FST-1569"><a href="#FST-1569"><span class="linenos">1569</span></a>
</span><span id="FST-1570"><a href="#FST-1570"><span class="linenos">1570</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1571"><a href="#FST-1571"><span class="linenos">1571</span></a><span class="sd">        - `FST`: Slice node of nodes gotten.</span>
</span><span id="FST-1572"><a href="#FST-1572"><span class="linenos">1572</span></a>
</span><span id="FST-1573"><a href="#FST-1573"><span class="linenos">1573</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1574"><a href="#FST-1574"><span class="linenos">1574</span></a><span class="sd">        ```py</span>
</span><span id="FST-1575"><a href="#FST-1575"><span class="linenos">1575</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get_slice(1).src</span>
</span><span id="FST-1576"><a href="#FST-1576"><span class="linenos">1576</span></a><span class="sd">        &#39;[1, 2, 3]&#39;</span>
</span><span id="FST-1577"><a href="#FST-1577"><span class="linenos">1577</span></a>
</span><span id="FST-1578"><a href="#FST-1578"><span class="linenos">1578</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get_slice(None, -1).src</span>
</span><span id="FST-1579"><a href="#FST-1579"><span class="linenos">1579</span></a><span class="sd">        &#39;[0, 1, 2]&#39;</span>
</span><span id="FST-1580"><a href="#FST-1580"><span class="linenos">1580</span></a>
</span><span id="FST-1581"><a href="#FST-1581"><span class="linenos">1581</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get_slice(1, 3, cut=True).src</span>
</span><span id="FST-1582"><a href="#FST-1582"><span class="linenos">1582</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST-1583"><a href="#FST-1583"><span class="linenos">1583</span></a>
</span><span id="FST-1584"><a href="#FST-1584"><span class="linenos">1584</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST-1585"><a href="#FST-1585"><span class="linenos">1585</span></a><span class="sd">        &#39;[0, 3]&#39;</span>
</span><span id="FST-1586"><a href="#FST-1586"><span class="linenos">1586</span></a>
</span><span id="FST-1587"><a href="#FST-1587"><span class="linenos">1587</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;if 1: i = 1\nelse: j = 2; k = 3; l = 4; m = 5&#39;)</span>
</span><span id="FST-1588"><a href="#FST-1588"><span class="linenos">1588</span></a><span class="sd">        &gt;&gt;&gt; s = f.get_slice(1, 3, &#39;orelse&#39;, cut=True)</span>
</span><span id="FST-1589"><a href="#FST-1589"><span class="linenos">1589</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="FST-1590"><a href="#FST-1590"><span class="linenos">1590</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST-1591"><a href="#FST-1591"><span class="linenos">1591</span></a><span class="sd">        else: j = 2; m = 5</span>
</span><span id="FST-1592"><a href="#FST-1592"><span class="linenos">1592</span></a>
</span><span id="FST-1593"><a href="#FST-1593"><span class="linenos">1593</span></a><span class="sd">        &gt;&gt;&gt; print(s.src)</span>
</span><span id="FST-1594"><a href="#FST-1594"><span class="linenos">1594</span></a><span class="sd">        k = 3; l = 4</span>
</span><span id="FST-1595"><a href="#FST-1595"><span class="linenos">1595</span></a><span class="sd">        ```</span>
</span><span id="FST-1596"><a href="#FST-1596"><span class="linenos">1596</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1597"><a href="#FST-1597"><span class="linenos">1597</span></a>
</span><span id="FST-1598"><a href="#FST-1598"><span class="linenos">1598</span></a>        <span class="n">ast</span>                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-1599"><a href="#FST-1599"><span class="linenos">1599</span></a>        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="FST-1600"><a href="#FST-1600"><span class="linenos">1600</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>       <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="FST-1601"><a href="#FST-1601"><span class="linenos">1601</span></a>
</span><span id="FST-1602"><a href="#FST-1602"><span class="linenos">1602</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST-1603"><a href="#FST-1603"><span class="linenos">1603</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot get slice from non-list field </span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST-1604"><a href="#FST-1604"><span class="linenos">1604</span></a>
</span><span id="FST-1605"><a href="#FST-1605"><span class="linenos">1605</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1606"><a href="#FST-1606"><span class="linenos">1606</span></a>
</span><span id="FST-1607"><a href="#FST-1607"><span class="linenos">1607</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST-1608"><a href="#FST-1608"><span class="linenos">1608</span></a>                  <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="FST-1609"><a href="#FST-1609"><span class="linenos">1609</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put a slice of nodes to `self` if possible.  The node is passed as an existing top-level `FST`, `AST`, string</span>
</span><span id="FST-1610"><a href="#FST-1610"><span class="linenos">1610</span></a><span class="sd">        or list of string lines. If passed as an `FST` then it should be considered &quot;consumed&quot; after this function</span>
</span><span id="FST-1611"><a href="#FST-1611"><span class="linenos">1611</span></a><span class="sd">        returns and is no logner valid, even on failure. `AST` is copied.</span>
</span><span id="FST-1612"><a href="#FST-1612"><span class="linenos">1612</span></a>
</span><span id="FST-1613"><a href="#FST-1613"><span class="linenos">1613</span></a><span class="sd">        **WARNING!** The original `self` node may be invalidated during the operation if using raw mode (either</span>
</span><span id="FST-1614"><a href="#FST-1614"><span class="linenos">1614</span></a><span class="sd">        specifically or as a fallback), so make sure to swap it out for the return value of this function if you will</span>
</span><span id="FST-1615"><a href="#FST-1615"><span class="linenos">1615</span></a><span class="sd">        keep using the variable you called this method on. It will be changed accordingly in the tree but any other</span>
</span><span id="FST-1616"><a href="#FST-1616"><span class="linenos">1616</span></a><span class="sd">        outside references to the node may become invalid.</span>
</span><span id="FST-1617"><a href="#FST-1617"><span class="linenos">1617</span></a>
</span><span id="FST-1618"><a href="#FST-1618"><span class="linenos">1618</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1619"><a href="#FST-1619"><span class="linenos">1619</span></a><span class="sd">        - `code`: The slice to put as an `FST` (must be root node), `AST`, a string or list of line strings.</span>
</span><span id="FST-1620"><a href="#FST-1620"><span class="linenos">1620</span></a><span class="sd">        - `start`: The start of the slice to put, or `None` for the beginning of the entire range.</span>
</span><span id="FST-1621"><a href="#FST-1621"><span class="linenos">1621</span></a><span class="sd">        - `stop`: The end index (exclusive) of the slice. This should be one past the last element to put (like python</span>
</span><span id="FST-1622"><a href="#FST-1622"><span class="linenos">1622</span></a><span class="sd">            list indexing). If this is `None` then it indicates a slice operation to the end of the list (like python</span>
</span><span id="FST-1623"><a href="#FST-1623"><span class="linenos">1623</span></a><span class="sd">            `a[start:]`).</span>
</span><span id="FST-1624"><a href="#FST-1624"><span class="linenos">1624</span></a><span class="sd">        - `field`: The name of the field to put the elements to. If this is `None` then the default field for the node</span>
</span><span id="FST-1625"><a href="#FST-1625"><span class="linenos">1625</span></a><span class="sd">            type is used. Most node types have a common-sense default field, e.g. `body` for all block statements,</span>
</span><span id="FST-1626"><a href="#FST-1626"><span class="linenos">1626</span></a><span class="sd">            `elts` for things like `List` and `Tuple`. `MatchMapping` and `Compare` nodes have special-case handling for</span>
</span><span id="FST-1627"><a href="#FST-1627"><span class="linenos">1627</span></a><span class="sd">            a `None` field.</span>
</span><span id="FST-1628"><a href="#FST-1628"><span class="linenos">1628</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST-1629"><a href="#FST-1629"><span class="linenos">1629</span></a>
</span><span id="FST-1630"><a href="#FST-1630"><span class="linenos">1630</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `start` or `stop` parameter. If passed in</span>
</span><span id="FST-1631"><a href="#FST-1631"><span class="linenos">1631</span></a><span class="sd">        `start` then the slice is assumed to be the entire range, and if passed in `stop` then the slice goes from</span>
</span><span id="FST-1632"><a href="#FST-1632"><span class="linenos">1632</span></a><span class="sd">        `start` to the end of the range.</span>
</span><span id="FST-1633"><a href="#FST-1633"><span class="linenos">1633</span></a>
</span><span id="FST-1634"><a href="#FST-1634"><span class="linenos">1634</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1635"><a href="#FST-1635"><span class="linenos">1635</span></a><span class="sd">        - `self`</span>
</span><span id="FST-1636"><a href="#FST-1636"><span class="linenos">1636</span></a>
</span><span id="FST-1637"><a href="#FST-1637"><span class="linenos">1637</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1638"><a href="#FST-1638"><span class="linenos">1638</span></a><span class="sd">        ```py</span>
</span><span id="FST-1639"><a href="#FST-1639"><span class="linenos">1639</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4&#39;, 1).src</span>
</span><span id="FST-1640"><a href="#FST-1640"><span class="linenos">1640</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="FST-1641"><a href="#FST-1641"><span class="linenos">1641</span></a>
</span><span id="FST-1642"><a href="#FST-1642"><span class="linenos">1642</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3).src</span>
</span><span id="FST-1643"><a href="#FST-1643"><span class="linenos">1643</span></a><span class="sd">        &#39;[0, (4, 5), 3]&#39;</span>
</span><span id="FST-1644"><a href="#FST-1644"><span class="linenos">1644</span></a>
</span><span id="FST-1645"><a href="#FST-1645"><span class="linenos">1645</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3, one=False).src</span>
</span><span id="FST-1646"><a href="#FST-1646"><span class="linenos">1646</span></a><span class="sd">        &#39;[0, 4, 5, 3]&#39;</span>
</span><span id="FST-1647"><a href="#FST-1647"><span class="linenos">1647</span></a>
</span><span id="FST-1648"><a href="#FST-1648"><span class="linenos">1648</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, None, 3).src</span>
</span><span id="FST-1649"><a href="#FST-1649"><span class="linenos">1649</span></a><span class="sd">        &#39;[(4, 5), 3]&#39;</span>
</span><span id="FST-1650"><a href="#FST-1650"><span class="linenos">1650</span></a>
</span><span id="FST-1651"><a href="#FST-1651"><span class="linenos">1651</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).put(&#39;4, 5&#39;, -3, None, one=False).src</span>
</span><span id="FST-1652"><a href="#FST-1652"><span class="linenos">1652</span></a><span class="sd">        &#39;[0, 4, 5]&#39;</span>
</span><span id="FST-1653"><a href="#FST-1653"><span class="linenos">1653</span></a>
</span><span id="FST-1654"><a href="#FST-1654"><span class="linenos">1654</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0).src)</span>
</span><span id="FST-1655"><a href="#FST-1655"><span class="linenos">1655</span></a><span class="sd">        if 1:</span>
</span><span id="FST-1656"><a href="#FST-1656"><span class="linenos">1656</span></a><span class="sd">            z = -1</span>
</span><span id="FST-1657"><a href="#FST-1657"><span class="linenos">1657</span></a><span class="sd">        else: j = 2</span>
</span><span id="FST-1658"><a href="#FST-1658"><span class="linenos">1658</span></a>
</span><span id="FST-1659"><a href="#FST-1659"><span class="linenos">1659</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0, &#39;orelse&#39;).src.rstrip())</span>
</span><span id="FST-1660"><a href="#FST-1660"><span class="linenos">1660</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST-1661"><a href="#FST-1661"><span class="linenos">1661</span></a><span class="sd">        else:</span>
</span><span id="FST-1662"><a href="#FST-1662"><span class="linenos">1662</span></a><span class="sd">            z = -1</span>
</span><span id="FST-1663"><a href="#FST-1663"><span class="linenos">1663</span></a>
</span><span id="FST-1664"><a href="#FST-1664"><span class="linenos">1664</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;)</span>
</span><span id="FST-1665"><a href="#FST-1665"><span class="linenos">1665</span></a><span class="sd">        ...       .put(&#39;z = -1\ny = -2\nx = -3&#39;, &#39;orelse&#39;, one=False).src.rstrip())</span>
</span><span id="FST-1666"><a href="#FST-1666"><span class="linenos">1666</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST-1667"><a href="#FST-1667"><span class="linenos">1667</span></a><span class="sd">        else:</span>
</span><span id="FST-1668"><a href="#FST-1668"><span class="linenos">1668</span></a><span class="sd">            z = -1</span>
</span><span id="FST-1669"><a href="#FST-1669"><span class="linenos">1669</span></a><span class="sd">            y = -2</span>
</span><span id="FST-1670"><a href="#FST-1670"><span class="linenos">1670</span></a><span class="sd">            x = -3</span>
</span><span id="FST-1671"><a href="#FST-1671"><span class="linenos">1671</span></a>
</span><span id="FST-1672"><a href="#FST-1672"><span class="linenos">1672</span></a><span class="sd">        &gt;&gt;&gt; print((f := FST(&#39;if 1: i = 1\nelse: j = 2&#39;))</span>
</span><span id="FST-1673"><a href="#FST-1673"><span class="linenos">1673</span></a><span class="sd">        ...       .put(&#39;z = -1&#39;, 0, raw=True, to=f.orelse[0]).root.src)</span>
</span><span id="FST-1674"><a href="#FST-1674"><span class="linenos">1674</span></a><span class="sd">        if 1: z = -1</span>
</span><span id="FST-1675"><a href="#FST-1675"><span class="linenos">1675</span></a><span class="sd">        ```</span>
</span><span id="FST-1676"><a href="#FST-1676"><span class="linenos">1676</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1677"><a href="#FST-1677"><span class="linenos">1677</span></a>
</span><span id="FST-1678"><a href="#FST-1678"><span class="linenos">1678</span></a>        <span class="n">ast</span>                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-1679"><a href="#FST-1679"><span class="linenos">1679</span></a>        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="FST-1680"><a href="#FST-1680"><span class="linenos">1680</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>       <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="FST-1681"><a href="#FST-1681"><span class="linenos">1681</span></a>
</span><span id="FST-1682"><a href="#FST-1682"><span class="linenos">1682</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST-1683"><a href="#FST-1683"><span class="linenos">1683</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot put slice to non-list field </span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST-1684"><a href="#FST-1684"><span class="linenos">1684</span></a>
</span><span id="FST-1685"><a href="#FST-1685"><span class="linenos">1685</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST-1686"><a href="#FST-1686"><span class="linenos">1686</span></a>
</span><span id="FST-1687"><a href="#FST-1687"><span class="linenos">1687</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_src</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">as_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FST-1688"><a href="#FST-1688"><span class="linenos">1688</span></a>                <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]:</span>
</span><span id="FST-1689"><a href="#FST-1689"><span class="linenos">1689</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get source at location, without dedenting or any other modification, returned as a string or individual</span>
</span><span id="FST-1690"><a href="#FST-1690"><span class="linenos">1690</span></a><span class="sd">        lines. The first and last lines are cropped to start `col` and `end_col`.</span>
</span><span id="FST-1691"><a href="#FST-1691"><span class="linenos">1691</span></a>
</span><span id="FST-1692"><a href="#FST-1692"><span class="linenos">1692</span></a><span class="sd">        Can call on any node in tree to access source for the whole tree.</span>
</span><span id="FST-1693"><a href="#FST-1693"><span class="linenos">1693</span></a>
</span><span id="FST-1694"><a href="#FST-1694"><span class="linenos">1694</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1695"><a href="#FST-1695"><span class="linenos">1695</span></a><span class="sd">        - `ln`: Start line of span to get (0 based).</span>
</span><span id="FST-1696"><a href="#FST-1696"><span class="linenos">1696</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="FST-1697"><a href="#FST-1697"><span class="linenos">1697</span></a><span class="sd">        - `end_ln`: End line of span to get (0 based, inclusive).</span>
</span><span id="FST-1698"><a href="#FST-1698"><span class="linenos">1698</span></a><span class="sd">        - `end_col`: End column (character, exclusive) on end line.</span>
</span><span id="FST-1699"><a href="#FST-1699"><span class="linenos">1699</span></a><span class="sd">        - `as_lines`: If `False` then source is returned as a single string with embedded newlines. If `True` then</span>
</span><span id="FST-1700"><a href="#FST-1700"><span class="linenos">1700</span></a><span class="sd">            source is returned as a list of line strings (without newlines).</span>
</span><span id="FST-1701"><a href="#FST-1701"><span class="linenos">1701</span></a>
</span><span id="FST-1702"><a href="#FST-1702"><span class="linenos">1702</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1703"><a href="#FST-1703"><span class="linenos">1703</span></a><span class="sd">        - `str | list[str]`: A single string or a list of lines if `as_lines=True`. If lines then there are no trailing</span>
</span><span id="FST-1704"><a href="#FST-1704"><span class="linenos">1704</span></a><span class="sd">            newlines in the individual line strings.</span>
</span><span id="FST-1705"><a href="#FST-1705"><span class="linenos">1705</span></a>
</span><span id="FST-1706"><a href="#FST-1706"><span class="linenos">1706</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1707"><a href="#FST-1707"><span class="linenos">1707</span></a><span class="sd">        ```py</span>
</span><span id="FST-1708"><a href="#FST-1708"><span class="linenos">1708</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 2&#39;).get_src(0, 3, 1, 5)</span>
</span><span id="FST-1709"><a href="#FST-1709"><span class="linenos">1709</span></a><span class="sd">        &#39;1:\n  i =&#39;</span>
</span><span id="FST-1710"><a href="#FST-1710"><span class="linenos">1710</span></a>
</span><span id="FST-1711"><a href="#FST-1711"><span class="linenos">1711</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 2&#39;).get_src(0, 3, 1, 5, as_lines=True)</span>
</span><span id="FST-1712"><a href="#FST-1712"><span class="linenos">1712</span></a><span class="sd">        [&#39;1:&#39;, &#39;  i =&#39;]</span>
</span><span id="FST-1713"><a href="#FST-1713"><span class="linenos">1713</span></a>
</span><span id="FST-1714"><a href="#FST-1714"><span class="linenos">1714</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;if 1:\n  i = 2&#39;)).get_src(*f.body[0].bloc)</span>
</span><span id="FST-1715"><a href="#FST-1715"><span class="linenos">1715</span></a><span class="sd">        &#39;i = 2&#39;</span>
</span><span id="FST-1716"><a href="#FST-1716"><span class="linenos">1716</span></a><span class="sd">        ```</span>
</span><span id="FST-1717"><a href="#FST-1717"><span class="linenos">1717</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1718"><a href="#FST-1718"><span class="linenos">1718</span></a>
</span><span id="FST-1719"><a href="#FST-1719"><span class="linenos">1719</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST-1720"><a href="#FST-1720"><span class="linenos">1720</span></a>
</span><span id="FST-1721"><a href="#FST-1721"><span class="linenos">1721</span></a>        <span class="k">if</span> <span class="n">as_lines</span><span class="p">:</span>
</span><span id="FST-1722"><a href="#FST-1722"><span class="linenos">1722</span></a>            <span class="k">return</span> <span class="p">([</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">end_col</span><span class="p">])]</span>  <span class="c1"># no real reason for bistr, just to be consistent and minor optimization if passed back into put_src()</span>
</span><span id="FST-1723"><a href="#FST-1723"><span class="linenos">1723</span></a>                    <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="k">else</span>
</span><span id="FST-1724"><a href="#FST-1724"><span class="linenos">1724</span></a>                    <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span><span class="p">:])]</span> <span class="o">+</span> <span class="n">ls</span><span class="p">[</span><span class="n">ln</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">end_ln</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">end_ln</span><span class="p">][:</span><span class="n">end_col</span><span class="p">])])</span>
</span><span id="FST-1725"><a href="#FST-1725"><span class="linenos">1725</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-1726"><a href="#FST-1726"><span class="linenos">1726</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">end_col</span><span class="p">]</span>
</span><span id="FST-1727"><a href="#FST-1727"><span class="linenos">1727</span></a>                    <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="k">else</span>
</span><span id="FST-1728"><a href="#FST-1728"><span class="linenos">1728</span></a>                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span><span class="p">:]]</span> <span class="o">+</span> <span class="n">ls</span><span class="p">[</span><span class="n">ln</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">end_ln</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">ls</span><span class="p">[</span><span class="n">end_ln</span><span class="p">][:</span><span class="n">end_col</span><span class="p">]]))</span>
</span><span id="FST-1729"><a href="#FST-1729"><span class="linenos">1729</span></a>
</span><span id="FST-1730"><a href="#FST-1730"><span class="linenos">1730</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put_src</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="FST-1731"><a href="#FST-1731"><span class="linenos">1731</span></a>                <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1732"><a href="#FST-1732"><span class="linenos">1732</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put source and reparse. There are no rules on what is put, it is simply put and parse is attempted. If the</span>
</span><span id="FST-1733"><a href="#FST-1733"><span class="linenos">1733</span></a><span class="sd">        `code` is passed as an `AST` then it is unparsed to a string and that string is put into the location. If `FST`</span>
</span><span id="FST-1734"><a href="#FST-1734"><span class="linenos">1734</span></a><span class="sd">        then the exact source of the `FST` is put. If passed as a string or lines then that is put directly.</span>
</span><span id="FST-1735"><a href="#FST-1735"><span class="linenos">1735</span></a>
</span><span id="FST-1736"><a href="#FST-1736"><span class="linenos">1736</span></a><span class="sd">        The reparse that is triggered is of at least a statement level node or a statement block header, and can be</span>
</span><span id="FST-1737"><a href="#FST-1737"><span class="linenos">1737</span></a><span class="sd">        multiple statements if the location spans those or even statements outside of the location if the reparse</span>
</span><span id="FST-1738"><a href="#FST-1738"><span class="linenos">1738</span></a><span class="sd">        affects things like `elif`. `FST` nodes in the region of the put or even outside of it can become invalid. The</span>
</span><span id="FST-1739"><a href="#FST-1739"><span class="linenos">1739</span></a><span class="sd">        only `FST` node guaranteed not to change is the root node (identity, the `AST` it holds can change).</span>
</span><span id="FST-1740"><a href="#FST-1740"><span class="linenos">1740</span></a>
</span><span id="FST-1741"><a href="#FST-1741"><span class="linenos">1741</span></a><span class="sd">        When putting source raw by location like this there are no automatic modifications made to the source or</span>
</span><span id="FST-1742"><a href="#FST-1742"><span class="linenos">1742</span></a><span class="sd">        destination. No parenthesization, prefixes or suffixes or indentation, the source is just put and parsed so you</span>
</span><span id="FST-1743"><a href="#FST-1743"><span class="linenos">1743</span></a><span class="sd">        are responsible for the correct indentation and precedence.</span>
</span><span id="FST-1744"><a href="#FST-1744"><span class="linenos">1744</span></a>
</span><span id="FST-1745"><a href="#FST-1745"><span class="linenos">1745</span></a><span class="sd">        After put and successful reparse the location of the put is examined and an appropriate node is returned which</span>
</span><span id="FST-1746"><a href="#FST-1746"><span class="linenos">1746</span></a><span class="sd">        fits best for a node which may have been added or replaced. It is possible that `None` is returned if no good</span>
</span><span id="FST-1747"><a href="#FST-1747"><span class="linenos">1747</span></a><span class="sd">        candidate is found (since this can be used to delete or merge nodes).</span>
</span><span id="FST-1748"><a href="#FST-1748"><span class="linenos">1748</span></a>
</span><span id="FST-1749"><a href="#FST-1749"><span class="linenos">1749</span></a><span class="sd">        Can call on any node in tree to modify source for the whole tree.</span>
</span><span id="FST-1750"><a href="#FST-1750"><span class="linenos">1750</span></a>
</span><span id="FST-1751"><a href="#FST-1751"><span class="linenos">1751</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1752"><a href="#FST-1752"><span class="linenos">1752</span></a><span class="sd">        - `code`: The code to put as an `FST` (must be root node), `AST`, a string or list of line strings.</span>
</span><span id="FST-1753"><a href="#FST-1753"><span class="linenos">1753</span></a><span class="sd">        - `ln`: Start line of span to put (0 based).</span>
</span><span id="FST-1754"><a href="#FST-1754"><span class="linenos">1754</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="FST-1755"><a href="#FST-1755"><span class="linenos">1755</span></a><span class="sd">        - `end_ln`: End line of span to put (0 based, inclusive).</span>
</span><span id="FST-1756"><a href="#FST-1756"><span class="linenos">1756</span></a><span class="sd">        - `end_col`: End column (character, exclusive) on end line.</span>
</span><span id="FST-1757"><a href="#FST-1757"><span class="linenos">1757</span></a><span class="sd">        - `exact`: This specifies how the node check after a successful reparse is done. `True` means allow return of</span>
</span><span id="FST-1758"><a href="#FST-1758"><span class="linenos">1758</span></a><span class="sd">            node which matches location exactly. Otherwise if `False`, the location must be inside the node but cannot</span>
</span><span id="FST-1759"><a href="#FST-1759"><span class="linenos">1759</span></a><span class="sd">            be touching BOTH ends of the node. This basically determines whether you can get the exact node of the</span>
</span><span id="FST-1760"><a href="#FST-1760"><span class="linenos">1760</span></a><span class="sd">            location or its parent. If passed as `None` then the check is even more restricted.</span>
</span><span id="FST-1761"><a href="#FST-1761"><span class="linenos">1761</span></a>
</span><span id="FST-1762"><a href="#FST-1762"><span class="linenos">1762</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1763"><a href="#FST-1763"><span class="linenos">1763</span></a><span class="sd">        - `FST | None`: FIRST highest level node contained entirely within replacement source location (there may be</span>
</span><span id="FST-1764"><a href="#FST-1764"><span class="linenos">1764</span></a><span class="sd">            others following), or `None` if no such candidate and `exact=None`. If no candidate and `exact` is `True`</span>
</span><span id="FST-1765"><a href="#FST-1765"><span class="linenos">1765</span></a><span class="sd">            or `False` then will attempt to return a node which encloses the location using `find_loc(..., exact)`.</span>
</span><span id="FST-1766"><a href="#FST-1766"><span class="linenos">1766</span></a>
</span><span id="FST-1767"><a href="#FST-1767"><span class="linenos">1767</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1768"><a href="#FST-1768"><span class="linenos">1768</span></a><span class="sd">        ```py</span>
</span><span id="FST-1769"><a href="#FST-1769"><span class="linenos">1769</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).put_src(&#39;2&#39;, 0, 4, 0, 5).root.src</span>
</span><span id="FST-1770"><a href="#FST-1770"><span class="linenos">1770</span></a><span class="sd">        &#39;i = 2&#39;</span>
</span><span id="FST-1771"><a href="#FST-1771"><span class="linenos">1771</span></a>
</span><span id="FST-1772"><a href="#FST-1772"><span class="linenos">1772</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).put_src(&#39;+= 3&#39;, 0, 2, 0, 5).root.src</span>
</span><span id="FST-1773"><a href="#FST-1773"><span class="linenos">1773</span></a><span class="sd">        &#39;i += 3&#39;</span>
</span><span id="FST-1774"><a href="#FST-1774"><span class="linenos">1774</span></a>
</span><span id="FST-1775"><a href="#FST-1775"><span class="linenos">1775</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{a: b, c: d, e: f}&#39;).put_src(&#39;**&#39;, 0, 7, 0, 10).root.src</span>
</span><span id="FST-1776"><a href="#FST-1776"><span class="linenos">1776</span></a><span class="sd">        &#39;{a: b, **d, e: f}&#39;</span>
</span><span id="FST-1777"><a href="#FST-1777"><span class="linenos">1777</span></a>
</span><span id="FST-1778"><a href="#FST-1778"><span class="linenos">1778</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;i = 1&#39;)</span>
</span><span id="FST-1779"><a href="#FST-1779"><span class="linenos">1779</span></a><span class="sd">        &gt;&gt;&gt; g = f.targets[0]</span>
</span><span id="FST-1780"><a href="#FST-1780"><span class="linenos">1780</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a))</span>
</span><span id="FST-1781"><a href="#FST-1781"><span class="linenos">1781</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt;</span>
</span><span id="FST-1782"><a href="#FST-1782"><span class="linenos">1782</span></a>
</span><span id="FST-1783"><a href="#FST-1783"><span class="linenos">1783</span></a><span class="sd">        &gt;&gt;&gt; f.put_src(&#39;4&#39;, 0, 4, 0, 5).src</span>
</span><span id="FST-1784"><a href="#FST-1784"><span class="linenos">1784</span></a><span class="sd">        &#39;4&#39;</span>
</span><span id="FST-1785"><a href="#FST-1785"><span class="linenos">1785</span></a>
</span><span id="FST-1786"><a href="#FST-1786"><span class="linenos">1786</span></a><span class="sd">        &gt;&gt;&gt; print(g.a)</span>
</span><span id="FST-1787"><a href="#FST-1787"><span class="linenos">1787</span></a><span class="sd">        None</span>
</span><span id="FST-1788"><a href="#FST-1788"><span class="linenos">1788</span></a>
</span><span id="FST-1789"><a href="#FST-1789"><span class="linenos">1789</span></a><span class="sd">        &gt;&gt;&gt; print(type(f.targets[0].a))</span>
</span><span id="FST-1790"><a href="#FST-1790"><span class="linenos">1790</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt;</span>
</span><span id="FST-1791"><a href="#FST-1791"><span class="linenos">1791</span></a>
</span><span id="FST-1792"><a href="#FST-1792"><span class="linenos">1792</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;&#39;&#39;</span>
</span><span id="FST-1793"><a href="#FST-1793"><span class="linenos">1793</span></a><span class="sd">        ... if a:</span>
</span><span id="FST-1794"><a href="#FST-1794"><span class="linenos">1794</span></a><span class="sd">        ...   i = 2</span>
</span><span id="FST-1795"><a href="#FST-1795"><span class="linenos">1795</span></a><span class="sd">        ... elif b:</span>
</span><span id="FST-1796"><a href="#FST-1796"><span class="linenos">1796</span></a><span class="sd">        ...   j = 3</span>
</span><span id="FST-1797"><a href="#FST-1797"><span class="linenos">1797</span></a><span class="sd">        ... &#39;&#39;&#39;.strip())</span>
</span><span id="FST-1798"><a href="#FST-1798"><span class="linenos">1798</span></a>
</span><span id="FST-1799"><a href="#FST-1799"><span class="linenos">1799</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="FST-1800"><a href="#FST-1800"><span class="linenos">1800</span></a><span class="sd">        if a:</span>
</span><span id="FST-1801"><a href="#FST-1801"><span class="linenos">1801</span></a><span class="sd">          i = 2</span>
</span><span id="FST-1802"><a href="#FST-1802"><span class="linenos">1802</span></a><span class="sd">        elif b:</span>
</span><span id="FST-1803"><a href="#FST-1803"><span class="linenos">1803</span></a><span class="sd">          j = 3</span>
</span><span id="FST-1804"><a href="#FST-1804"><span class="linenos">1804</span></a>
</span><span id="FST-1805"><a href="#FST-1805"><span class="linenos">1805</span></a><span class="sd">        &gt;&gt;&gt; f.put_src(&#39;&#39;&#39;</span>
</span><span id="FST-1806"><a href="#FST-1806"><span class="linenos">1806</span></a><span class="sd">        ... else:</span>
</span><span id="FST-1807"><a href="#FST-1807"><span class="linenos">1807</span></a><span class="sd">        ...   if b:</span>
</span><span id="FST-1808"><a href="#FST-1808"><span class="linenos">1808</span></a><span class="sd">        ...     k = 4</span>
</span><span id="FST-1809"><a href="#FST-1809"><span class="linenos">1809</span></a><span class="sd">        ... &#39;&#39;&#39;.strip(), *f.orelse[0].loc[:2], *f.loc[2:])</span>
</span><span id="FST-1810"><a href="#FST-1810"><span class="linenos">1810</span></a><span class="sd">        &lt;If 3,2..4,9&gt;</span>
</span><span id="FST-1811"><a href="#FST-1811"><span class="linenos">1811</span></a>
</span><span id="FST-1812"><a href="#FST-1812"><span class="linenos">1812</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="FST-1813"><a href="#FST-1813"><span class="linenos">1813</span></a><span class="sd">        if a:</span>
</span><span id="FST-1814"><a href="#FST-1814"><span class="linenos">1814</span></a><span class="sd">          i = 2</span>
</span><span id="FST-1815"><a href="#FST-1815"><span class="linenos">1815</span></a><span class="sd">        else:</span>
</span><span id="FST-1816"><a href="#FST-1816"><span class="linenos">1816</span></a><span class="sd">          if b:</span>
</span><span id="FST-1817"><a href="#FST-1817"><span class="linenos">1817</span></a><span class="sd">            k = 4</span>
</span><span id="FST-1818"><a href="#FST-1818"><span class="linenos">1818</span></a><span class="sd">        ```</span>
</span><span id="FST-1819"><a href="#FST-1819"><span class="linenos">1819</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1820"><a href="#FST-1820"><span class="linenos">1820</span></a>
</span><span id="FST-1821"><a href="#FST-1821"><span class="linenos">1821</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
</span><span id="FST-1822"><a href="#FST-1822"><span class="linenos">1822</span></a>
</span><span id="FST-1823"><a href="#FST-1823"><span class="linenos">1823</span></a>        <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_reparse_raw</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">exact</span><span class="p">)</span>
</span><span id="FST-1824"><a href="#FST-1824"><span class="linenos">1824</span></a>
</span><span id="FST-1825"><a href="#FST-1825"><span class="linenos">1825</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1826"><a href="#FST-1826"><span class="linenos">1826</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the location of enclosing GROUPING parentheses if present. Will balance parentheses if `self` is an</span>
</span><span id="FST-1827"><a href="#FST-1827"><span class="linenos">1827</span></a><span class="sd">        element of a tuple and not return the parentheses of the tuple. Likwise will not normally return the parentheses</span>
</span><span id="FST-1828"><a href="#FST-1828"><span class="linenos">1828</span></a><span class="sd">        of an enclosing `arguments` parent or class bases list (unless `shared=None`, but that is mostly for internal</span>
</span><span id="FST-1829"><a href="#FST-1829"><span class="linenos">1829</span></a><span class="sd">        use).</span>
</span><span id="FST-1830"><a href="#FST-1830"><span class="linenos">1830</span></a>
</span><span id="FST-1831"><a href="#FST-1831"><span class="linenos">1831</span></a><span class="sd">        Only normally works on (and makes sense for) `expr` or `pattern` nodes, otherwise returns `self.bloc` and count</span>
</span><span id="FST-1832"><a href="#FST-1832"><span class="linenos">1832</span></a><span class="sd">        of 0. Also handles special case of a single generator expression argument to a function sharing parameters with</span>
</span><span id="FST-1833"><a href="#FST-1833"><span class="linenos">1833</span></a><span class="sd">        the call arguments, in which case a count of -1 and the location of the `GeneratorExp` without its enclosing</span>
</span><span id="FST-1834"><a href="#FST-1834"><span class="linenos">1834</span></a><span class="sd">        parentheses may be returned, if this is enabled with `shared=False`.</span>
</span><span id="FST-1835"><a href="#FST-1835"><span class="linenos">1835</span></a>
</span><span id="FST-1836"><a href="#FST-1836"><span class="linenos">1836</span></a><span class="sd">        This function is cached so feel free to call as often as is needed.</span>
</span><span id="FST-1837"><a href="#FST-1837"><span class="linenos">1837</span></a>
</span><span id="FST-1838"><a href="#FST-1838"><span class="linenos">1838</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1839"><a href="#FST-1839"><span class="linenos">1839</span></a><span class="sd">        - `shared`: If `True` then will include parentheses of a single call argument generator expression if they are</span>
</span><span id="FST-1840"><a href="#FST-1840"><span class="linenos">1840</span></a><span class="sd">            shared with the call arguments enclosing parentheses with a count of 0. If `False` then does not return</span>
</span><span id="FST-1841"><a href="#FST-1841"><span class="linenos">1841</span></a><span class="sd">            these and returns a count of -1, and thus the location is not a full valid `GeneratorExp` location. If</span>
</span><span id="FST-1842"><a href="#FST-1842"><span class="linenos">1842</span></a><span class="sd">            `None` then returns ANY directly enclosing parentheses, whether they belong to this node or not.</span>
</span><span id="FST-1843"><a href="#FST-1843"><span class="linenos">1843</span></a>
</span><span id="FST-1844"><a href="#FST-1844"><span class="linenos">1844</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1845"><a href="#FST-1845"><span class="linenos">1845</span></a><span class="sd">        - `fstloc | None`: Location of enclosing parentheses if present else `self.bloc` (which can be `None`). Negative</span>
</span><span id="FST-1846"><a href="#FST-1846"><span class="linenos">1846</span></a><span class="sd">            parentheses count (from shared parens solo call arg generator expression) can also be checked in the case of</span>
</span><span id="FST-1847"><a href="#FST-1847"><span class="linenos">1847</span></a><span class="sd">            `shared=False` via `fst.pars() &gt; fst.bloc`. If only loc is returned, it will be an `fstloc` which will</span>
</span><span id="FST-1848"><a href="#FST-1848"><span class="linenos">1848</span></a><span class="sd">            still have the count of parentheses in an attribute `.n`.</span>
</span><span id="FST-1849"><a href="#FST-1849"><span class="linenos">1849</span></a>
</span><span id="FST-1850"><a href="#FST-1850"><span class="linenos">1850</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1851"><a href="#FST-1851"><span class="linenos">1851</span></a><span class="sd">        ```py</span>
</span><span id="FST-1852"><a href="#FST-1852"><span class="linenos">1852</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).pars()</span>
</span><span id="FST-1853"><a href="#FST-1853"><span class="linenos">1853</span></a><span class="sd">        fstlocns(0, 0, 0, 1, n=0)</span>
</span><span id="FST-1854"><a href="#FST-1854"><span class="linenos">1854</span></a>
</span><span id="FST-1855"><a href="#FST-1855"><span class="linenos">1855</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(i)&#39;).pars()</span>
</span><span id="FST-1856"><a href="#FST-1856"><span class="linenos">1856</span></a><span class="sd">        fstlocns(0, 0, 0, 3, n=1)</span>
</span><span id="FST-1857"><a href="#FST-1857"><span class="linenos">1857</span></a>
</span><span id="FST-1858"><a href="#FST-1858"><span class="linenos">1858</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((i))&#39;).pars()</span>
</span><span id="FST-1859"><a href="#FST-1859"><span class="linenos">1859</span></a><span class="sd">        fstlocns(0, 0, 0, 5, n=2)</span>
</span><span id="FST-1860"><a href="#FST-1860"><span class="linenos">1860</span></a>
</span><span id="FST-1861"><a href="#FST-1861"><span class="linenos">1861</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).pars()  # tuple pars are not considered grouping pars</span>
</span><span id="FST-1862"><a href="#FST-1862"><span class="linenos">1862</span></a><span class="sd">        fstlocns(0, 0, 0, 6, n=0)</span>
</span><span id="FST-1863"><a href="#FST-1863"><span class="linenos">1863</span></a>
</span><span id="FST-1864"><a href="#FST-1864"><span class="linenos">1864</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((1, 2))&#39;).pars()</span>
</span><span id="FST-1865"><a href="#FST-1865"><span class="linenos">1865</span></a><span class="sd">        fstlocns(0, 0, 0, 8, n=1)</span>
</span><span id="FST-1866"><a href="#FST-1866"><span class="linenos">1866</span></a>
</span><span id="FST-1867"><a href="#FST-1867"><span class="linenos">1867</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].pars()  # any node, not just root</span>
</span><span id="FST-1868"><a href="#FST-1868"><span class="linenos">1868</span></a><span class="sd">        fstlocns(0, 5, 0, 6, n=0)</span>
</span><span id="FST-1869"><a href="#FST-1869"><span class="linenos">1869</span></a>
</span><span id="FST-1870"><a href="#FST-1870"><span class="linenos">1870</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((a))&#39;).args[0].pars()</span>
</span><span id="FST-1871"><a href="#FST-1871"><span class="linenos">1871</span></a><span class="sd">        fstlocns(0, 5, 0, 8, n=1)</span>
</span><span id="FST-1872"><a href="#FST-1872"><span class="linenos">1872</span></a>
</span><span id="FST-1873"><a href="#FST-1873"><span class="linenos">1873</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in j)&#39;).args[0].pars()</span>
</span><span id="FST-1874"><a href="#FST-1874"><span class="linenos">1874</span></a><span class="sd">        fstlocns(0, 4, 0, 18, n=0)</span>
</span><span id="FST-1875"><a href="#FST-1875"><span class="linenos">1875</span></a>
</span><span id="FST-1876"><a href="#FST-1876"><span class="linenos">1876</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in j)&#39;).args[0].pars(shared=False)  # exclude shared pars</span>
</span><span id="FST-1877"><a href="#FST-1877"><span class="linenos">1877</span></a><span class="sd">        fstlocns(0, 5, 0, 17, n=-1)</span>
</span><span id="FST-1878"><a href="#FST-1878"><span class="linenos">1878</span></a>
</span><span id="FST-1879"><a href="#FST-1879"><span class="linenos">1879</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in j))&#39;).args[0].pars(shared=False)</span>
</span><span id="FST-1880"><a href="#FST-1880"><span class="linenos">1880</span></a><span class="sd">        fstlocns(0, 5, 0, 19, n=0)</span>
</span><span id="FST-1881"><a href="#FST-1881"><span class="linenos">1881</span></a><span class="sd">        ```</span>
</span><span id="FST-1882"><a href="#FST-1882"><span class="linenos">1882</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1883"><a href="#FST-1883"><span class="linenos">1883</span></a>
</span><span id="FST-1884"><a href="#FST-1884"><span class="linenos">1884</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;pars_</span><span class="si">{</span><span class="kc">None</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nb">bool</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="FST-1885"><a href="#FST-1885"><span class="linenos">1885</span></a>
</span><span id="FST-1886"><a href="#FST-1886"><span class="linenos">1886</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST-1887"><a href="#FST-1887"><span class="linenos">1887</span></a>            <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="FST-1888"><a href="#FST-1888"><span class="linenos">1888</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="FST-1889"><a href="#FST-1889"><span class="linenos">1889</span></a>            <span class="k">pass</span>
</span><span id="FST-1890"><a href="#FST-1890"><span class="linenos">1890</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-1891"><a href="#FST-1891"><span class="linenos">1891</span></a>            <span class="k">return</span> <span class="n">cached</span>
</span><span id="FST-1892"><a href="#FST-1892"><span class="linenos">1892</span></a>
</span><span id="FST-1893"><a href="#FST-1893"><span class="linenos">1893</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span> <span class="ow">and</span> <span class="n">shared</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-1894"><a href="#FST-1894"><span class="linenos">1894</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="FST-1895"><a href="#FST-1895"><span class="linenos">1895</span></a>
</span><span id="FST-1896"><a href="#FST-1896"><span class="linenos">1896</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="FST-1897"><a href="#FST-1897"><span class="linenos">1897</span></a>
</span><span id="FST-1898"><a href="#FST-1898"><span class="linenos">1898</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span>
</span><span id="FST-1899"><a href="#FST-1899"><span class="linenos">1899</span></a>
</span><span id="FST-1900"><a href="#FST-1900"><span class="linenos">1900</span></a>        <span class="n">rpars</span> <span class="o">=</span> <span class="n">_next_pars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_bound</span><span class="p">())</span>
</span><span id="FST-1901"><a href="#FST-1901"><span class="linenos">1901</span></a>
</span><span id="FST-1902"><a href="#FST-1902"><span class="linenos">1902</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lrpars</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpars</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># no pars on right</span>
</span><span id="FST-1903"><a href="#FST-1903"><span class="linenos">1903</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">shared</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_call_arg_genexp</span><span class="p">():</span>
</span><span id="FST-1904"><a href="#FST-1904"><span class="linenos">1904</span></a>                <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="FST-1905"><a href="#FST-1905"><span class="linenos">1905</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST-1906"><a href="#FST-1906"><span class="linenos">1906</span></a>                <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="FST-1907"><a href="#FST-1907"><span class="linenos">1907</span></a>
</span><span id="FST-1908"><a href="#FST-1908"><span class="linenos">1908</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span>
</span><span id="FST-1909"><a href="#FST-1909"><span class="linenos">1909</span></a>
</span><span id="FST-1910"><a href="#FST-1910"><span class="linenos">1910</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="FST-1911"><a href="#FST-1911"><span class="linenos">1911</span></a>
</span><span id="FST-1912"><a href="#FST-1912"><span class="linenos">1912</span></a>        <span class="n">lpars</span> <span class="o">=</span> <span class="n">_prev_pars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_prev_bound</span><span class="p">(),</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</span><span id="FST-1913"><a href="#FST-1913"><span class="linenos">1913</span></a>
</span><span id="FST-1914"><a href="#FST-1914"><span class="linenos">1914</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">llpars</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lpars</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># no pars on left</span>
</span><span id="FST-1915"><a href="#FST-1915"><span class="linenos">1915</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="FST-1916"><a href="#FST-1916"><span class="linenos">1916</span></a>
</span><span id="FST-1917"><a href="#FST-1917"><span class="linenos">1917</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="FST-1918"><a href="#FST-1918"><span class="linenos">1918</span></a>
</span><span id="FST-1919"><a href="#FST-1919"><span class="linenos">1919</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">llpars</span> <span class="o">&lt;=</span> <span class="n">lrpars</span> <span class="ow">and</span> <span class="n">shared</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
</span><span id="FST-1920"><a href="#FST-1920"><span class="linenos">1920</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_solo_call_arg</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_class_base</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_matchcls_pat</span><span class="p">())</span>
</span><span id="FST-1921"><a href="#FST-1921"><span class="linenos">1921</span></a>        <span class="p">):</span>
</span><span id="FST-1922"><a href="#FST-1922"><span class="linenos">1922</span></a>            <span class="n">llpars</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="FST-1923"><a href="#FST-1923"><span class="linenos">1923</span></a>
</span><span id="FST-1924"><a href="#FST-1924"><span class="linenos">1924</span></a>        <span class="k">if</span> <span class="n">llpars</span> <span class="o">!=</span> <span class="n">lrpars</span><span class="p">:</span>  <span class="c1"># unbalanced pars so we know we can safely use the lower count</span>
</span><span id="FST-1925"><a href="#FST-1925"><span class="linenos">1925</span></a>            <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="o">*</span><span class="n">lpars</span><span class="p">[</span><span class="n">npars</span> <span class="o">:=</span> <span class="nb">min</span><span class="p">(</span><span class="n">llpars</span><span class="p">,</span> <span class="n">lrpars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="o">*</span><span class="n">rpars</span><span class="p">[</span><span class="n">npars</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="n">npars</span><span class="p">)</span>
</span><span id="FST-1926"><a href="#FST-1926"><span class="linenos">1926</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-1927"><a href="#FST-1927"><span class="linenos">1927</span></a>            <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="o">*</span><span class="n">lpars</span><span class="p">[</span><span class="n">npars</span> <span class="o">:=</span> <span class="n">llpars</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="o">*</span><span class="n">rpars</span><span class="p">[</span><span class="n">npars</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="n">npars</span><span class="p">)</span>
</span><span id="FST-1928"><a href="#FST-1928"><span class="linenos">1928</span></a>
</span><span id="FST-1929"><a href="#FST-1929"><span class="linenos">1929</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span>
</span><span id="FST-1930"><a href="#FST-1930"><span class="linenos">1930</span></a>
</span><span id="FST-1931"><a href="#FST-1931"><span class="linenos">1931</span></a>        <span class="k">return</span> <span class="n">locn</span>
</span><span id="FST-1932"><a href="#FST-1932"><span class="linenos">1932</span></a>
</span><span id="FST-1933"><a href="#FST-1933"><span class="linenos">1933</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">whole</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="FST-1934"><a href="#FST-1934"><span class="linenos">1934</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parenthesize node if it MAY need it. Will not parenthesize atoms which are always enclosed like `List`, or</span>
</span><span id="FST-1935"><a href="#FST-1935"><span class="linenos">1935</span></a><span class="sd">        nodes which are not `is_parenthesizable()`, unless `force=True`. Will add parentheses to unparenthesized `Tuple`</span>
</span><span id="FST-1936"><a href="#FST-1936"><span class="linenos">1936</span></a><span class="sd">        and brackets to unbracketed `MatchSequence` adjusting the node location. If dealing with a `Starred` then the</span>
</span><span id="FST-1937"><a href="#FST-1937"><span class="linenos">1937</span></a><span class="sd">        parentheses are applied to the child.</span>
</span><span id="FST-1938"><a href="#FST-1938"><span class="linenos">1938</span></a>
</span><span id="FST-1939"><a href="#FST-1939"><span class="linenos">1939</span></a><span class="sd">        **WARNING!** This function doesn&#39;t do any higher level syntactic validation. So if you parenthesize something</span>
</span><span id="FST-1940"><a href="#FST-1940"><span class="linenos">1940</span></a><span class="sd">        that shouldn&#39;t be parenthesized, and you wind up poking an eye out, that&#39;s on you.</span>
</span><span id="FST-1941"><a href="#FST-1941"><span class="linenos">1941</span></a>
</span><span id="FST-1942"><a href="#FST-1942"><span class="linenos">1942</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-1943"><a href="#FST-1943"><span class="linenos">1943</span></a><span class="sd">        - `force`: If `True` then will add another layer of parentheses regardless if any already present.</span>
</span><span id="FST-1944"><a href="#FST-1944"><span class="linenos">1944</span></a><span class="sd">        - `whole`: If at root then parenthesize whole source instead of just node, if `False` then only node.</span>
</span><span id="FST-1945"><a href="#FST-1945"><span class="linenos">1945</span></a>
</span><span id="FST-1946"><a href="#FST-1946"><span class="linenos">1946</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-1947"><a href="#FST-1947"><span class="linenos">1947</span></a><span class="sd">        - `self`</span>
</span><span id="FST-1948"><a href="#FST-1948"><span class="linenos">1948</span></a>
</span><span id="FST-1949"><a href="#FST-1949"><span class="linenos">1949</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-1950"><a href="#FST-1950"><span class="linenos">1950</span></a><span class="sd">        ```py</span>
</span><span id="FST-1951"><a href="#FST-1951"><span class="linenos">1951</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).par().src</span>
</span><span id="FST-1952"><a href="#FST-1952"><span class="linenos">1952</span></a><span class="sd">        &#39;(a + b)&#39;</span>
</span><span id="FST-1953"><a href="#FST-1953"><span class="linenos">1953</span></a>
</span><span id="FST-1954"><a href="#FST-1954"><span class="linenos">1954</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).par().src  # already parenthesized, so nothing done</span>
</span><span id="FST-1955"><a href="#FST-1955"><span class="linenos">1955</span></a><span class="sd">        &#39;(a + b)&#39;</span>
</span><span id="FST-1956"><a href="#FST-1956"><span class="linenos">1956</span></a>
</span><span id="FST-1957"><a href="#FST-1957"><span class="linenos">1957</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).par(force=True).src  # force it</span>
</span><span id="FST-1958"><a href="#FST-1958"><span class="linenos">1958</span></a><span class="sd">        &#39;((a + b))&#39;</span>
</span><span id="FST-1959"><a href="#FST-1959"><span class="linenos">1959</span></a>
</span><span id="FST-1960"><a href="#FST-1960"><span class="linenos">1960</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;).par().src  # parenthesize tuple</span>
</span><span id="FST-1961"><a href="#FST-1961"><span class="linenos">1961</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="FST-1962"><a href="#FST-1962"><span class="linenos">1962</span></a>
</span><span id="FST-1963"><a href="#FST-1963"><span class="linenos">1963</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).par().src  # an atom doesn&#39;t need parentheses</span>
</span><span id="FST-1964"><a href="#FST-1964"><span class="linenos">1964</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="FST-1965"><a href="#FST-1965"><span class="linenos">1965</span></a>
</span><span id="FST-1966"><a href="#FST-1966"><span class="linenos">1966</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).par(force=True).src  # so must be forced</span>
</span><span id="FST-1967"><a href="#FST-1967"><span class="linenos">1967</span></a><span class="sd">        &#39;(i)&#39;</span>
</span><span id="FST-1968"><a href="#FST-1968"><span class="linenos">1968</span></a>
</span><span id="FST-1969"><a href="#FST-1969"><span class="linenos">1969</span></a><span class="sd">        &gt;&gt;&gt; # parethesize MatchSequence puts brackets like ast.unparse()</span>
</span><span id="FST-1970"><a href="#FST-1970"><span class="linenos">1970</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;, &#39;pattern&#39;).par().src</span>
</span><span id="FST-1971"><a href="#FST-1971"><span class="linenos">1971</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST-1972"><a href="#FST-1972"><span class="linenos">1972</span></a>
</span><span id="FST-1973"><a href="#FST-1973"><span class="linenos">1973</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;*a or b&#39;).par().src  # par() a Starred parenthesizes its child</span>
</span><span id="FST-1974"><a href="#FST-1974"><span class="linenos">1974</span></a><span class="sd">        &#39;*(a or b)&#39;</span>
</span><span id="FST-1975"><a href="#FST-1975"><span class="linenos">1975</span></a>
</span><span id="FST-1976"><a href="#FST-1976"><span class="linenos">1976</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i = 1 + 2)&#39;).keywords[0].value.par().root.src  # not just root node</span>
</span><span id="FST-1977"><a href="#FST-1977"><span class="linenos">1977</span></a><span class="sd">        &#39;call(i = (1 + 2))&#39;</span>
</span><span id="FST-1978"><a href="#FST-1978"><span class="linenos">1978</span></a><span class="sd">        ```</span>
</span><span id="FST-1979"><a href="#FST-1979"><span class="linenos">1979</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-1980"><a href="#FST-1980"><span class="linenos">1980</span></a>
</span><span id="FST-1981"><a href="#FST-1981"><span class="linenos">1981</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
</span><span id="FST-1982"><a href="#FST-1982"><span class="linenos">1982</span></a>            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span> <span class="ow">or</span> <span class="p">(</span><span class="n">is_atom</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atom</span><span class="p">())</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;pars&#39;</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="FST-1983"><a href="#FST-1983"><span class="linenos">1983</span></a>                <span class="p">(</span><span class="n">is_atom</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">())</span>  <span class="c1"># &#39;unenclosable&#39;</span>
</span><span id="FST-1984"><a href="#FST-1984"><span class="linenos">1984</span></a>            <span class="p">):</span>
</span><span id="FST-1985"><a href="#FST-1985"><span class="linenos">1985</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-1986"><a href="#FST-1986"><span class="linenos">1986</span></a>
</span><span id="FST-1987"><a href="#FST-1987"><span class="linenos">1987</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">():</span>
</span><span id="FST-1988"><a href="#FST-1988"><span class="linenos">1988</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">):</span>
</span><span id="FST-1989"><a href="#FST-1989"><span class="linenos">1989</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_node</span><span class="p">(</span><span class="n">whole</span><span class="p">)</span>
</span><span id="FST-1990"><a href="#FST-1990"><span class="linenos">1990</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="FST-1991"><a href="#FST-1991"><span class="linenos">1991</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_node</span><span class="p">(</span><span class="n">whole</span><span class="p">,</span> <span class="s1">&#39;[]&#39;</span><span class="p">)</span>
</span><span id="FST-1992"><a href="#FST-1992"><span class="linenos">1992</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST-1993"><a href="#FST-1993"><span class="linenos">1993</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_grouping</span><span class="p">(</span><span class="n">whole</span><span class="p">)</span>
</span><span id="FST-1994"><a href="#FST-1994"><span class="linenos">1994</span></a>
</span><span id="FST-1995"><a href="#FST-1995"><span class="linenos">1995</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-1996"><a href="#FST-1996"><span class="linenos">1996</span></a>
</span><span id="FST-1997"><a href="#FST-1997"><span class="linenos">1997</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unpar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intrinsic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">shared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="FST-1998"><a href="#FST-1998"><span class="linenos">1998</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove all parentheses from node if present. Normally removes just grouping parentheses but can also remove</span>
</span><span id="FST-1999"><a href="#FST-1999"><span class="linenos">1999</span></a><span class="sd">        `Tuple` parentheses and `MatchSequence` parentheses or brackets if `intrinsic=True`. If dealing with a `Starred`</span>
</span><span id="FST-2000"><a href="#FST-2000"><span class="linenos">2000</span></a><span class="sd">        then the parentheses are checked in and removed from the child. If `shared=None` then will also remove</span>
</span><span id="FST-2001"><a href="#FST-2001"><span class="linenos">2001</span></a><span class="sd">        parentheses which do not belong to this node but enclose it directly.</span>
</span><span id="FST-2002"><a href="#FST-2002"><span class="linenos">2002</span></a>
</span><span id="FST-2003"><a href="#FST-2003"><span class="linenos">2003</span></a><span class="sd">        **WARNING!** This function doesn&#39;t do any higher level syntactic validation. So if you unparenthesize something</span>
</span><span id="FST-2004"><a href="#FST-2004"><span class="linenos">2004</span></a><span class="sd">        that shouldn&#39;t be unparenthesized, and you wind up poking an eye out, that&#39;s on you.</span>
</span><span id="FST-2005"><a href="#FST-2005"><span class="linenos">2005</span></a>
</span><span id="FST-2006"><a href="#FST-2006"><span class="linenos">2006</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2007"><a href="#FST-2007"><span class="linenos">2007</span></a><span class="sd">        - `intrinsic`: If `True` then will remove parentheses from a parenthesized `Tuple` and parentheses / brackets</span>
</span><span id="FST-2008"><a href="#FST-2008"><span class="linenos">2008</span></a><span class="sd">            from parenthesized / bracketed `MatchSequence`, otherwise only removes grouping parentheses if present.</span>
</span><span id="FST-2009"><a href="#FST-2009"><span class="linenos">2009</span></a><span class="sd">        - `shared`: Whether to allow merge of parentheses of single call argument generator expression with `Call`</span>
</span><span id="FST-2010"><a href="#FST-2010"><span class="linenos">2010</span></a><span class="sd">            parentheses or not. If `None` then will attempt to unparenthesize any enclosing parentheses, whether they</span>
</span><span id="FST-2011"><a href="#FST-2011"><span class="linenos">2011</span></a><span class="sd">            belong to this node or not (meant for internal use).</span>
</span><span id="FST-2012"><a href="#FST-2012"><span class="linenos">2012</span></a>
</span><span id="FST-2013"><a href="#FST-2013"><span class="linenos">2013</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2014"><a href="#FST-2014"><span class="linenos">2014</span></a><span class="sd">        - `self`</span>
</span><span id="FST-2015"><a href="#FST-2015"><span class="linenos">2015</span></a>
</span><span id="FST-2016"><a href="#FST-2016"><span class="linenos">2016</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2017"><a href="#FST-2017"><span class="linenos">2017</span></a><span class="sd">        ```py</span>
</span><span id="FST-2018"><a href="#FST-2018"><span class="linenos">2018</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).unpar().src  # nothing done if no pars</span>
</span><span id="FST-2019"><a href="#FST-2019"><span class="linenos">2019</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="FST-2020"><a href="#FST-2020"><span class="linenos">2020</span></a>
</span><span id="FST-2021"><a href="#FST-2021"><span class="linenos">2021</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).unpar().src</span>
</span><span id="FST-2022"><a href="#FST-2022"><span class="linenos">2022</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="FST-2023"><a href="#FST-2023"><span class="linenos">2023</span></a>
</span><span id="FST-2024"><a href="#FST-2024"><span class="linenos">2024</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((a + b))&#39;).unpar().src  # removes all</span>
</span><span id="FST-2025"><a href="#FST-2025"><span class="linenos">2025</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="FST-2026"><a href="#FST-2026"><span class="linenos">2026</span></a>
</span><span id="FST-2027"><a href="#FST-2027"><span class="linenos">2027</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).unpar().src  # but not from tuple</span>
</span><span id="FST-2028"><a href="#FST-2028"><span class="linenos">2028</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="FST-2029"><a href="#FST-2029"><span class="linenos">2029</span></a>
</span><span id="FST-2030"><a href="#FST-2030"><span class="linenos">2030</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).unpar(intrinsic=True).src  # unless explicitly specified</span>
</span><span id="FST-2031"><a href="#FST-2031"><span class="linenos">2031</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="FST-2032"><a href="#FST-2032"><span class="linenos">2032</span></a>
</span><span id="FST-2033"><a href="#FST-2033"><span class="linenos">2033</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(((1, 2)))&#39;).unpar().src</span>
</span><span id="FST-2034"><a href="#FST-2034"><span class="linenos">2034</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="FST-2035"><a href="#FST-2035"><span class="linenos">2035</span></a>
</span><span id="FST-2036"><a href="#FST-2036"><span class="linenos">2036</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(((1, 2)))&#39;).unpar(intrinsic=True).src</span>
</span><span id="FST-2037"><a href="#FST-2037"><span class="linenos">2037</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="FST-2038"><a href="#FST-2038"><span class="linenos">2038</span></a>
</span><span id="FST-2039"><a href="#FST-2039"><span class="linenos">2039</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1, 2]&#39;, &#39;pattern&#39;).unpar().src</span>
</span><span id="FST-2040"><a href="#FST-2040"><span class="linenos">2040</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST-2041"><a href="#FST-2041"><span class="linenos">2041</span></a>
</span><span id="FST-2042"><a href="#FST-2042"><span class="linenos">2042</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1, 2]&#39;, &#39;pattern&#39;).unpar(intrinsic=True).src</span>
</span><span id="FST-2043"><a href="#FST-2043"><span class="linenos">2043</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="FST-2044"><a href="#FST-2044"><span class="linenos">2044</span></a>
</span><span id="FST-2045"><a href="#FST-2045"><span class="linenos">2045</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;*(a or b)&#39;).unpar().src  # unpar() a Starred unparenthesizes its child</span>
</span><span id="FST-2046"><a href="#FST-2046"><span class="linenos">2046</span></a><span class="sd">        &#39;*a or b&#39;</span>
</span><span id="FST-2047"><a href="#FST-2047"><span class="linenos">2047</span></a>
</span><span id="FST-2048"><a href="#FST-2048"><span class="linenos">2048</span></a><span class="sd">        &gt;&gt;&gt; # not just root node</span>
</span><span id="FST-2049"><a href="#FST-2049"><span class="linenos">2049</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i = (1 + 2))&#39;).keywords[0].value.unpar().root.src</span>
</span><span id="FST-2050"><a href="#FST-2050"><span class="linenos">2050</span></a><span class="sd">        &#39;call(i = 1 + 2)&#39;</span>
</span><span id="FST-2051"><a href="#FST-2051"><span class="linenos">2051</span></a>
</span><span id="FST-2052"><a href="#FST-2052"><span class="linenos">2052</span></a><span class="sd">        &gt;&gt;&gt; # by default allows sharing</span>
</span><span id="FST-2053"><a href="#FST-2053"><span class="linenos">2053</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(((i for i in j)))&#39;).args[0].unpar().root.src</span>
</span><span id="FST-2054"><a href="#FST-2054"><span class="linenos">2054</span></a><span class="sd">        &#39;call(i for i in j)&#39;</span>
</span><span id="FST-2055"><a href="#FST-2055"><span class="linenos">2055</span></a>
</span><span id="FST-2056"><a href="#FST-2056"><span class="linenos">2056</span></a><span class="sd">        &gt;&gt;&gt; # unless told not to</span>
</span><span id="FST-2057"><a href="#FST-2057"><span class="linenos">2057</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(((i for i in j)))&#39;).args[0].unpar(shared=False).root.src</span>
</span><span id="FST-2058"><a href="#FST-2058"><span class="linenos">2058</span></a><span class="sd">        &#39;call((i for i in j))&#39;</span>
</span><span id="FST-2059"><a href="#FST-2059"><span class="linenos">2059</span></a><span class="sd">        ```</span>
</span><span id="FST-2060"><a href="#FST-2060"><span class="linenos">2060</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2061"><a href="#FST-2061"><span class="linenos">2061</span></a>
</span><span id="FST-2062"><a href="#FST-2062"><span class="linenos">2062</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Starred</span><span class="p">):</span>
</span><span id="FST-2063"><a href="#FST-2063"><span class="linenos">2063</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="FST-2064"><a href="#FST-2064"><span class="linenos">2064</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">():</span>
</span><span id="FST-2065"><a href="#FST-2065"><span class="linenos">2065</span></a>                    <span class="n">value</span><span class="o">.</span><span class="n">_unparenthesize_grouping</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span>
</span><span id="FST-2066"><a href="#FST-2066"><span class="linenos">2066</span></a>
</span><span id="FST-2067"><a href="#FST-2067"><span class="linenos">2067</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2068"><a href="#FST-2068"><span class="linenos">2068</span></a>
</span><span id="FST-2069"><a href="#FST-2069"><span class="linenos">2069</span></a>        <span class="n">modifying</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST-2070"><a href="#FST-2070"><span class="linenos">2070</span></a>
</span><span id="FST-2071"><a href="#FST-2071"><span class="linenos">2071</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">(</span><span class="kc">None</span> <span class="k">if</span> <span class="n">shared</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="FST-2072"><a href="#FST-2072"><span class="linenos">2072</span></a>            <span class="n">modifying</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="FST-2073"><a href="#FST-2073"><span class="linenos">2073</span></a>
</span><span id="FST-2074"><a href="#FST-2074"><span class="linenos">2074</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_grouping</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span>
</span><span id="FST-2075"><a href="#FST-2075"><span class="linenos">2075</span></a>
</span><span id="FST-2076"><a href="#FST-2076"><span class="linenos">2076</span></a>        <span class="k">if</span> <span class="n">intrinsic</span><span class="p">:</span>
</span><span id="FST-2077"><a href="#FST-2077"><span class="linenos">2077</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">):</span>
</span><span id="FST-2078"><a href="#FST-2078"><span class="linenos">2078</span></a>                <span class="n">modifying</span> <span class="o">=</span> <span class="n">modifying</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="FST-2079"><a href="#FST-2079"><span class="linenos">2079</span></a>
</span><span id="FST-2080"><a href="#FST-2080"><span class="linenos">2080</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_node</span><span class="p">()</span>  <span class="c1"># ret = self._unparenthesize_node() or ret</span>
</span><span id="FST-2081"><a href="#FST-2081"><span class="linenos">2081</span></a>
</span><span id="FST-2082"><a href="#FST-2082"><span class="linenos">2082</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="FST-2083"><a href="#FST-2083"><span class="linenos">2083</span></a>                <span class="n">modifying</span> <span class="o">=</span> <span class="n">modifying</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="FST-2084"><a href="#FST-2084"><span class="linenos">2084</span></a>
</span><span id="FST-2085"><a href="#FST-2085"><span class="linenos">2085</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_node</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">)</span>  <span class="c1"># ret = self._unparenthesize_node() or ret</span>
</span><span id="FST-2086"><a href="#FST-2086"><span class="linenos">2086</span></a>
</span><span id="FST-2087"><a href="#FST-2087"><span class="linenos">2087</span></a>        <span class="k">if</span> <span class="n">modifying</span><span class="p">:</span>
</span><span id="FST-2088"><a href="#FST-2088"><span class="linenos">2088</span></a>            <span class="n">modifying</span><span class="o">.</span><span class="n">done</span><span class="p">()</span>
</span><span id="FST-2089"><a href="#FST-2089"><span class="linenos">2089</span></a>
</span><span id="FST-2090"><a href="#FST-2090"><span class="linenos">2090</span></a>        <span class="k">return</span> <span class="bp">self</span>  <span class="c1"># ret</span>
</span><span id="FST-2091"><a href="#FST-2091"><span class="linenos">2091</span></a>
</span><span id="FST-2092"><a href="#FST-2092"><span class="linenos">2092</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="FST-2093"><a href="#FST-2093"><span class="linenos">2093</span></a>    <span class="c1"># Structure stuff</span>
</span><span id="FST-2094"><a href="#FST-2094"><span class="linenos">2094</span></a>
</span><span id="FST-2095"><a href="#FST-2095"><span class="linenos">2095</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>  <span class="c1"># placeholder for pydoc, otherwise it puts these at the end of the class</span>
</span><span id="FST-2096"><a href="#FST-2096"><span class="linenos">2096</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2097"><a href="#FST-2097"><span class="linenos">2097</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">first_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2098"><a href="#FST-2098"><span class="linenos">2098</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">last_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2099"><a href="#FST-2099"><span class="linenos">2099</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">last_header_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2100"><a href="#FST-2100"><span class="linenos">2100</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2101"><a href="#FST-2101"><span class="linenos">2101</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prev_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2102"><a href="#FST-2102"><span class="linenos">2102</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">step_fwd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2103"><a href="#FST-2103"><span class="linenos">2103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">step_back</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2104"><a href="#FST-2104"><span class="linenos">2104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="FST-2105"><a href="#FST-2105"><span class="linenos">2105</span></a>
</span><span id="FST-2106"><a href="#FST-2106"><span class="linenos">2106</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_walk</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="FST-2107"><a href="#FST-2107"><span class="linenos">2107</span></a>        <span class="nb">next</span><span class="p">,</span>
</span><span id="FST-2108"><a href="#FST-2108"><span class="linenos">2108</span></a>        <span class="n">prev</span><span class="p">,</span>
</span><span id="FST-2109"><a href="#FST-2109"><span class="linenos">2109</span></a>        <span class="n">first_child</span><span class="p">,</span>
</span><span id="FST-2110"><a href="#FST-2110"><span class="linenos">2110</span></a>        <span class="n">last_child</span><span class="p">,</span>
</span><span id="FST-2111"><a href="#FST-2111"><span class="linenos">2111</span></a>        <span class="n">last_header_child</span><span class="p">,</span>
</span><span id="FST-2112"><a href="#FST-2112"><span class="linenos">2112</span></a>        <span class="n">next_child</span><span class="p">,</span>
</span><span id="FST-2113"><a href="#FST-2113"><span class="linenos">2113</span></a>        <span class="n">prev_child</span><span class="p">,</span>
</span><span id="FST-2114"><a href="#FST-2114"><span class="linenos">2114</span></a>        <span class="n">step_fwd</span><span class="p">,</span>
</span><span id="FST-2115"><a href="#FST-2115"><span class="linenos">2115</span></a>        <span class="n">step_back</span><span class="p">,</span>
</span><span id="FST-2116"><a href="#FST-2116"><span class="linenos">2116</span></a>        <span class="n">walk</span><span class="p">,</span>
</span><span id="FST-2117"><a href="#FST-2117"><span class="linenos">2117</span></a>    <span class="p">)</span>
</span><span id="FST-2118"><a href="#FST-2118"><span class="linenos">2118</span></a>
</span><span id="FST-2119"><a href="#FST-2119"><span class="linenos">2119</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FST</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="FST-2120"><a href="#FST-2120"><span class="linenos">2120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generator which yields parents all the way up to root. If `self_` is `True` then will yield `self` first.</span>
</span><span id="FST-2121"><a href="#FST-2121"><span class="linenos">2121</span></a>
</span><span id="FST-2122"><a href="#FST-2122"><span class="linenos">2122</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2123"><a href="#FST-2123"><span class="linenos">2123</span></a><span class="sd">        - `self_`: Whether to yield `self` first.</span>
</span><span id="FST-2124"><a href="#FST-2124"><span class="linenos">2124</span></a>
</span><span id="FST-2125"><a href="#FST-2125"><span class="linenos">2125</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2126"><a href="#FST-2126"><span class="linenos">2126</span></a><span class="sd">        ```py</span>
</span><span id="FST-2127"><a href="#FST-2127"><span class="linenos">2127</span></a><span class="sd">        &gt;&gt;&gt; list(FST(&#39;i = (f(), g())&#39;, &#39;exec&#39;).body[0].value.elts[0].parents())</span>
</span><span id="FST-2128"><a href="#FST-2128"><span class="linenos">2128</span></a><span class="sd">        [&lt;Tuple 0,4..0,14&gt;, &lt;Assign 0,0..0,14&gt;, &lt;Module ROOT 0,0..0,14&gt;]</span>
</span><span id="FST-2129"><a href="#FST-2129"><span class="linenos">2129</span></a>
</span><span id="FST-2130"><a href="#FST-2130"><span class="linenos">2130</span></a><span class="sd">        &gt;&gt;&gt; list(FST(&#39;i = (f(), g())&#39;, &#39;exec&#39;).body[0].value.elts[0].parents(self_=True))</span>
</span><span id="FST-2131"><a href="#FST-2131"><span class="linenos">2131</span></a><span class="sd">        [&lt;Call 0,5..0,8&gt;, &lt;Tuple 0,4..0,14&gt;, &lt;Assign 0,0..0,14&gt;, &lt;Module ROOT 0,0..0,14&gt;]</span>
</span><span id="FST-2132"><a href="#FST-2132"><span class="linenos">2132</span></a><span class="sd">        ```</span>
</span><span id="FST-2133"><a href="#FST-2133"><span class="linenos">2133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2134"><a href="#FST-2134"><span class="linenos">2134</span></a>
</span><span id="FST-2135"><a href="#FST-2135"><span class="linenos">2135</span></a>        <span class="k">if</span> <span class="n">self_</span><span class="p">:</span>
</span><span id="FST-2136"><a href="#FST-2136"><span class="linenos">2136</span></a>            <span class="k">yield</span> <span class="bp">self</span>
</span><span id="FST-2137"><a href="#FST-2137"><span class="linenos">2137</span></a>
</span><span id="FST-2138"><a href="#FST-2138"><span class="linenos">2138</span></a>        <span class="k">while</span> <span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST-2139"><a href="#FST-2139"><span class="linenos">2139</span></a>            <span class="k">yield</span> <span class="bp">self</span>
</span><span id="FST-2140"><a href="#FST-2140"><span class="linenos">2140</span></a>
</span><span id="FST-2141"><a href="#FST-2141"><span class="linenos">2141</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2142"><a href="#FST-2142"><span class="linenos">2142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The first parent which is a `stmt` or optionally `mod` node (if any). If `self_` is `True` then will check</span>
</span><span id="FST-2143"><a href="#FST-2143"><span class="linenos">2143</span></a><span class="sd">        `self` first (possibly returning `self`), otherwise only checks parents.</span>
</span><span id="FST-2144"><a href="#FST-2144"><span class="linenos">2144</span></a>
</span><span id="FST-2145"><a href="#FST-2145"><span class="linenos">2145</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2146"><a href="#FST-2146"><span class="linenos">2146</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="FST-2147"><a href="#FST-2147"><span class="linenos">2147</span></a><span class="sd">        - `mod`: Whether to return `mod` nodes if found.</span>
</span><span id="FST-2148"><a href="#FST-2148"><span class="linenos">2148</span></a>
</span><span id="FST-2149"><a href="#FST-2149"><span class="linenos">2149</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2150"><a href="#FST-2150"><span class="linenos">2150</span></a><span class="sd">        ```py</span>
</span><span id="FST-2151"><a href="#FST-2151"><span class="linenos">2151</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_stmt()</span>
</span><span id="FST-2152"><a href="#FST-2152"><span class="linenos">2152</span></a><span class="sd">        &lt;Assign 0,6..0,11&gt;</span>
</span><span id="FST-2153"><a href="#FST-2153"><span class="linenos">2153</span></a>
</span><span id="FST-2154"><a href="#FST-2154"><span class="linenos">2154</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].parent_stmt()</span>
</span><span id="FST-2155"><a href="#FST-2155"><span class="linenos">2155</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="FST-2156"><a href="#FST-2156"><span class="linenos">2156</span></a>
</span><span id="FST-2157"><a href="#FST-2157"><span class="linenos">2157</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt()</span>
</span><span id="FST-2158"><a href="#FST-2158"><span class="linenos">2158</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="FST-2159"><a href="#FST-2159"><span class="linenos">2159</span></a>
</span><span id="FST-2160"><a href="#FST-2160"><span class="linenos">2160</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt(mod=False))</span>
</span><span id="FST-2161"><a href="#FST-2161"><span class="linenos">2161</span></a><span class="sd">        None</span>
</span><span id="FST-2162"><a href="#FST-2162"><span class="linenos">2162</span></a>
</span><span id="FST-2163"><a href="#FST-2163"><span class="linenos">2163</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt(self_=True)</span>
</span><span id="FST-2164"><a href="#FST-2164"><span class="linenos">2164</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="FST-2165"><a href="#FST-2165"><span class="linenos">2165</span></a><span class="sd">        ```</span>
</span><span id="FST-2166"><a href="#FST-2166"><span class="linenos">2166</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2167"><a href="#FST-2167"><span class="linenos">2167</span></a>
</span><span id="FST-2168"><a href="#FST-2168"><span class="linenos">2168</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">ast_mod</span><span class="p">)</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">stmt</span>
</span><span id="FST-2169"><a href="#FST-2169"><span class="linenos">2169</span></a>
</span><span id="FST-2170"><a href="#FST-2170"><span class="linenos">2170</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2171"><a href="#FST-2171"><span class="linenos">2171</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2172"><a href="#FST-2172"><span class="linenos">2172</span></a>
</span><span id="FST-2173"><a href="#FST-2173"><span class="linenos">2173</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2174"><a href="#FST-2174"><span class="linenos">2174</span></a>            <span class="k">pass</span>
</span><span id="FST-2175"><a href="#FST-2175"><span class="linenos">2175</span></a>
</span><span id="FST-2176"><a href="#FST-2176"><span class="linenos">2176</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2177"><a href="#FST-2177"><span class="linenos">2177</span></a>
</span><span id="FST-2178"><a href="#FST-2178"><span class="linenos">2178</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_stmtish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2179"><a href="#FST-2179"><span class="linenos">2179</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is a `stmt`, `ExceptHandler`, `match_case` or optionally `mod` node (if any). If</span>
</span><span id="FST-2180"><a href="#FST-2180"><span class="linenos">2180</span></a><span class="sd">        `self_` is `True` then will check `self` first, otherwise only checks parents.</span>
</span><span id="FST-2181"><a href="#FST-2181"><span class="linenos">2181</span></a>
</span><span id="FST-2182"><a href="#FST-2182"><span class="linenos">2182</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2183"><a href="#FST-2183"><span class="linenos">2183</span></a><span class="sd">        ```py</span>
</span><span id="FST-2184"><a href="#FST-2184"><span class="linenos">2184</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;)</span>
</span><span id="FST-2185"><a href="#FST-2185"><span class="linenos">2185</span></a><span class="sd">        ...  .body[0].handlers[0].body[0].parent_stmtish())</span>
</span><span id="FST-2186"><a href="#FST-2186"><span class="linenos">2186</span></a><span class="sd">        &lt;ExceptHandler 1,0..1,12&gt;</span>
</span><span id="FST-2187"><a href="#FST-2187"><span class="linenos">2187</span></a>
</span><span id="FST-2188"><a href="#FST-2188"><span class="linenos">2188</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;).body[0].handlers[0].parent_stmtish()</span>
</span><span id="FST-2189"><a href="#FST-2189"><span class="linenos">2189</span></a><span class="sd">        &lt;Try 0,0..1,12&gt;</span>
</span><span id="FST-2190"><a href="#FST-2190"><span class="linenos">2190</span></a>
</span><span id="FST-2191"><a href="#FST-2191"><span class="linenos">2191</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;).body[0].parent_stmtish()</span>
</span><span id="FST-2192"><a href="#FST-2192"><span class="linenos">2192</span></a><span class="sd">        &lt;Module ROOT 0,0..1,12&gt;</span>
</span><span id="FST-2193"><a href="#FST-2193"><span class="linenos">2193</span></a>
</span><span id="FST-2194"><a href="#FST-2194"><span class="linenos">2194</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].body[0].parent_stmtish()</span>
</span><span id="FST-2195"><a href="#FST-2195"><span class="linenos">2195</span></a><span class="sd">        &lt;match_case 1,2..1,14&gt;</span>
</span><span id="FST-2196"><a href="#FST-2196"><span class="linenos">2196</span></a>
</span><span id="FST-2197"><a href="#FST-2197"><span class="linenos">2197</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].pattern.parent_stmtish()</span>
</span><span id="FST-2198"><a href="#FST-2198"><span class="linenos">2198</span></a><span class="sd">        &lt;match_case 1,2..1,14&gt;</span>
</span><span id="FST-2199"><a href="#FST-2199"><span class="linenos">2199</span></a><span class="sd">        ```</span>
</span><span id="FST-2200"><a href="#FST-2200"><span class="linenos">2200</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2201"><a href="#FST-2201"><span class="linenos">2201</span></a>
</span><span id="FST-2202"><a href="#FST-2202"><span class="linenos">2202</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">STMTISH_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">STMTISH</span>
</span><span id="FST-2203"><a href="#FST-2203"><span class="linenos">2203</span></a>
</span><span id="FST-2204"><a href="#FST-2204"><span class="linenos">2204</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2205"><a href="#FST-2205"><span class="linenos">2205</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2206"><a href="#FST-2206"><span class="linenos">2206</span></a>
</span><span id="FST-2207"><a href="#FST-2207"><span class="linenos">2207</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2208"><a href="#FST-2208"><span class="linenos">2208</span></a>            <span class="k">pass</span>
</span><span id="FST-2209"><a href="#FST-2209"><span class="linenos">2209</span></a>
</span><span id="FST-2210"><a href="#FST-2210"><span class="linenos">2210</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2211"><a href="#FST-2211"><span class="linenos">2211</span></a>
</span><span id="FST-2212"><a href="#FST-2212"><span class="linenos">2212</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2213"><a href="#FST-2213"><span class="linenos">2213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The first parent which opens a block that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="FST-2214"><a href="#FST-2214"><span class="linenos">2214</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef`, `For`, `AsyncFor`, `While`, `If`, `With`, `AsyncWith`, `Match`, `Try`,</span>
</span><span id="FST-2215"><a href="#FST-2215"><span class="linenos">2215</span></a><span class="sd">        `TryStar`, `ExceptHandler`, `match_case` or optionally `mod` node (if any). If `self_` is `True` then will check</span>
</span><span id="FST-2216"><a href="#FST-2216"><span class="linenos">2216</span></a><span class="sd">        `self` first, otherwise only checks parents.</span>
</span><span id="FST-2217"><a href="#FST-2217"><span class="linenos">2217</span></a>
</span><span id="FST-2218"><a href="#FST-2218"><span class="linenos">2218</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2219"><a href="#FST-2219"><span class="linenos">2219</span></a><span class="sd">        ```py</span>
</span><span id="FST-2220"><a href="#FST-2220"><span class="linenos">2220</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_block()</span>
</span><span id="FST-2221"><a href="#FST-2221"><span class="linenos">2221</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="FST-2222"><a href="#FST-2222"><span class="linenos">2222</span></a>
</span><span id="FST-2223"><a href="#FST-2223"><span class="linenos">2223</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_block()</span>
</span><span id="FST-2224"><a href="#FST-2224"><span class="linenos">2224</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="FST-2225"><a href="#FST-2225"><span class="linenos">2225</span></a><span class="sd">        ```</span>
</span><span id="FST-2226"><a href="#FST-2226"><span class="linenos">2226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2227"><a href="#FST-2227"><span class="linenos">2227</span></a>
</span><span id="FST-2228"><a href="#FST-2228"><span class="linenos">2228</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">BLOCK_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">BLOCK</span>
</span><span id="FST-2229"><a href="#FST-2229"><span class="linenos">2229</span></a>
</span><span id="FST-2230"><a href="#FST-2230"><span class="linenos">2230</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2231"><a href="#FST-2231"><span class="linenos">2231</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2232"><a href="#FST-2232"><span class="linenos">2232</span></a>
</span><span id="FST-2233"><a href="#FST-2233"><span class="linenos">2233</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2234"><a href="#FST-2234"><span class="linenos">2234</span></a>            <span class="k">pass</span>
</span><span id="FST-2235"><a href="#FST-2235"><span class="linenos">2235</span></a>
</span><span id="FST-2236"><a href="#FST-2236"><span class="linenos">2236</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2237"><a href="#FST-2237"><span class="linenos">2237</span></a>
</span><span id="FST-2238"><a href="#FST-2238"><span class="linenos">2238</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2239"><a href="#FST-2239"><span class="linenos">2239</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which opens a scope that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="FST-2240"><a href="#FST-2240"><span class="linenos">2240</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef`, `Lambda`, `ListComp`, `SetComp`, `DictComp`, `GeneratorExp` or optionally `mod`</span>
</span><span id="FST-2241"><a href="#FST-2241"><span class="linenos">2241</span></a><span class="sd">        node (if any). If `self_` is `True` then will check `self` first, otherwise only checks parents.</span>
</span><span id="FST-2242"><a href="#FST-2242"><span class="linenos">2242</span></a>
</span><span id="FST-2243"><a href="#FST-2243"><span class="linenos">2243</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2244"><a href="#FST-2244"><span class="linenos">2244</span></a><span class="sd">        ```py</span>
</span><span id="FST-2245"><a href="#FST-2245"><span class="linenos">2245</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_scope()</span>
</span><span id="FST-2246"><a href="#FST-2246"><span class="linenos">2246</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="FST-2247"><a href="#FST-2247"><span class="linenos">2247</span></a>
</span><span id="FST-2248"><a href="#FST-2248"><span class="linenos">2248</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f():\n  if 1: i = 1&#39;, &#39;exec&#39;)</span>
</span><span id="FST-2249"><a href="#FST-2249"><span class="linenos">2249</span></a><span class="sd">        ...  .body[0].body[0].body[0].value.parent_scope())</span>
</span><span id="FST-2250"><a href="#FST-2250"><span class="linenos">2250</span></a><span class="sd">        &lt;FunctionDef 0,0..1,13&gt;</span>
</span><span id="FST-2251"><a href="#FST-2251"><span class="linenos">2251</span></a>
</span><span id="FST-2252"><a href="#FST-2252"><span class="linenos">2252</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;lambda: None&#39;, &#39;exec&#39;).body[0].value.body.parent_scope()</span>
</span><span id="FST-2253"><a href="#FST-2253"><span class="linenos">2253</span></a><span class="sd">        &lt;Lambda 0,0..0,12&gt;</span>
</span><span id="FST-2254"><a href="#FST-2254"><span class="linenos">2254</span></a>
</span><span id="FST-2255"><a href="#FST-2255"><span class="linenos">2255</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[i for i in j]&#39;, &#39;exec&#39;).body[0].value.elt.parent_scope()</span>
</span><span id="FST-2256"><a href="#FST-2256"><span class="linenos">2256</span></a><span class="sd">        &lt;ListComp 0,0..0,14&gt;</span>
</span><span id="FST-2257"><a href="#FST-2257"><span class="linenos">2257</span></a><span class="sd">        ```</span>
</span><span id="FST-2258"><a href="#FST-2258"><span class="linenos">2258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2259"><a href="#FST-2259"><span class="linenos">2259</span></a>
</span><span id="FST-2260"><a href="#FST-2260"><span class="linenos">2260</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">SCOPE_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">SCOPE</span>
</span><span id="FST-2261"><a href="#FST-2261"><span class="linenos">2261</span></a>
</span><span id="FST-2262"><a href="#FST-2262"><span class="linenos">2262</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2263"><a href="#FST-2263"><span class="linenos">2263</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2264"><a href="#FST-2264"><span class="linenos">2264</span></a>
</span><span id="FST-2265"><a href="#FST-2265"><span class="linenos">2265</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2266"><a href="#FST-2266"><span class="linenos">2266</span></a>            <span class="k">pass</span>
</span><span id="FST-2267"><a href="#FST-2267"><span class="linenos">2267</span></a>
</span><span id="FST-2268"><a href="#FST-2268"><span class="linenos">2268</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2269"><a href="#FST-2269"><span class="linenos">2269</span></a>
</span><span id="FST-2270"><a href="#FST-2270"><span class="linenos">2270</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_named_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2271"><a href="#FST-2271"><span class="linenos">2271</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which opens a named scope that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="FST-2272"><a href="#FST-2272"><span class="linenos">2272</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef` or optionally `mod` node (if any). If `self_` is `True` then will check `self`</span>
</span><span id="FST-2273"><a href="#FST-2273"><span class="linenos">2273</span></a><span class="sd">        first, otherwise only checks parents.</span>
</span><span id="FST-2274"><a href="#FST-2274"><span class="linenos">2274</span></a>
</span><span id="FST-2275"><a href="#FST-2275"><span class="linenos">2275</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2276"><a href="#FST-2276"><span class="linenos">2276</span></a><span class="sd">        ```py</span>
</span><span id="FST-2277"><a href="#FST-2277"><span class="linenos">2277</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_named_scope()</span>
</span><span id="FST-2278"><a href="#FST-2278"><span class="linenos">2278</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="FST-2279"><a href="#FST-2279"><span class="linenos">2279</span></a>
</span><span id="FST-2280"><a href="#FST-2280"><span class="linenos">2280</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f():\n  if 1: i = 1&#39;, &#39;exec&#39;)</span>
</span><span id="FST-2281"><a href="#FST-2281"><span class="linenos">2281</span></a><span class="sd">        ...  .body[0].body[0].body[0].value.parent_named_scope())</span>
</span><span id="FST-2282"><a href="#FST-2282"><span class="linenos">2282</span></a><span class="sd">        &lt;FunctionDef 0,0..1,13&gt;</span>
</span><span id="FST-2283"><a href="#FST-2283"><span class="linenos">2283</span></a>
</span><span id="FST-2284"><a href="#FST-2284"><span class="linenos">2284</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f(): lambda: None&#39;, &#39;exec&#39;)</span>
</span><span id="FST-2285"><a href="#FST-2285"><span class="linenos">2285</span></a><span class="sd">        ...  .body[0].body[0].value.body.parent_named_scope())</span>
</span><span id="FST-2286"><a href="#FST-2286"><span class="linenos">2286</span></a><span class="sd">        &lt;FunctionDef 0,0..0,21&gt;</span>
</span><span id="FST-2287"><a href="#FST-2287"><span class="linenos">2287</span></a>
</span><span id="FST-2288"><a href="#FST-2288"><span class="linenos">2288</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;class cls: [i for i in j]&#39;, &#39;exec&#39;)</span>
</span><span id="FST-2289"><a href="#FST-2289"><span class="linenos">2289</span></a><span class="sd">        ...  .body[0].body[0].value.elt.parent_named_scope())</span>
</span><span id="FST-2290"><a href="#FST-2290"><span class="linenos">2290</span></a><span class="sd">        &lt;ClassDef 0,0..0,25&gt;</span>
</span><span id="FST-2291"><a href="#FST-2291"><span class="linenos">2291</span></a><span class="sd">        ```</span>
</span><span id="FST-2292"><a href="#FST-2292"><span class="linenos">2292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2293"><a href="#FST-2293"><span class="linenos">2293</span></a>
</span><span id="FST-2294"><a href="#FST-2294"><span class="linenos">2294</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">NAMED_SCOPE_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">NAMED_SCOPE</span>
</span><span id="FST-2295"><a href="#FST-2295"><span class="linenos">2295</span></a>
</span><span id="FST-2296"><a href="#FST-2296"><span class="linenos">2296</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2297"><a href="#FST-2297"><span class="linenos">2297</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2298"><a href="#FST-2298"><span class="linenos">2298</span></a>
</span><span id="FST-2299"><a href="#FST-2299"><span class="linenos">2299</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2300"><a href="#FST-2300"><span class="linenos">2300</span></a>            <span class="k">pass</span>
</span><span id="FST-2301"><a href="#FST-2301"><span class="linenos">2301</span></a>
</span><span id="FST-2302"><a href="#FST-2302"><span class="linenos">2302</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2303"><a href="#FST-2303"><span class="linenos">2303</span></a>
</span><span id="FST-2304"><a href="#FST-2304"><span class="linenos">2304</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_non_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2305"><a href="#FST-2305"><span class="linenos">2305</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is not an `expr`. If `self_` is `True` then will check `self` first (possibly</span>
</span><span id="FST-2306"><a href="#FST-2306"><span class="linenos">2306</span></a><span class="sd">        returning `self`), otherwise only checks parents.</span>
</span><span id="FST-2307"><a href="#FST-2307"><span class="linenos">2307</span></a>
</span><span id="FST-2308"><a href="#FST-2308"><span class="linenos">2308</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2309"><a href="#FST-2309"><span class="linenos">2309</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="FST-2310"><a href="#FST-2310"><span class="linenos">2310</span></a><span class="sd">        - `strict`: `False` means consider `comprehension`, `arguments`, `arg` and `keyword` nodes as `expr` for the</span>
</span><span id="FST-2311"><a href="#FST-2311"><span class="linenos">2311</span></a><span class="sd">            sake of the walk up since these nodes can have other `expr` parents. `True` means only `expr` nodes, which</span>
</span><span id="FST-2312"><a href="#FST-2312"><span class="linenos">2312</span></a><span class="sd">            means you could get an `arg` or `comprehension` node for example which still has `expr` parents. Also</span>
</span><span id="FST-2313"><a href="#FST-2313"><span class="linenos">2313</span></a><span class="sd">            `expr_context`, `boolop`, `operator`, `unaruop` and `cmpop` are included if `strict=False` but this only</span>
</span><span id="FST-2314"><a href="#FST-2314"><span class="linenos">2314</span></a><span class="sd">            makes sense if `self_=True` and you are calling this function on one of those.</span>
</span><span id="FST-2315"><a href="#FST-2315"><span class="linenos">2315</span></a>
</span><span id="FST-2316"><a href="#FST-2316"><span class="linenos">2316</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2317"><a href="#FST-2317"><span class="linenos">2317</span></a><span class="sd">        ```py</span>
</span><span id="FST-2318"><a href="#FST-2318"><span class="linenos">2318</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1 + a[b]&#39;).body[0].value.right.value.parent_non_expr()</span>
</span><span id="FST-2319"><a href="#FST-2319"><span class="linenos">2319</span></a><span class="sd">        &lt;Assign 0,6..0,18&gt;</span>
</span><span id="FST-2320"><a href="#FST-2320"><span class="linenos">2320</span></a>
</span><span id="FST-2321"><a href="#FST-2321"><span class="linenos">2321</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n case {a.b.c: 1}: pass&#39;)</span>
</span><span id="FST-2322"><a href="#FST-2322"><span class="linenos">2322</span></a><span class="sd">        ...  .cases[0].pattern.keys[0].value.value.parent_non_expr())</span>
</span><span id="FST-2323"><a href="#FST-2323"><span class="linenos">2323</span></a><span class="sd">        &lt;MatchMapping 1,6..1,16&gt;</span>
</span><span id="FST-2324"><a href="#FST-2324"><span class="linenos">2324</span></a>
</span><span id="FST-2325"><a href="#FST-2325"><span class="linenos">2325</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;var = call(a, b=1)&#39;).value.keywords[0].value.parent_non_expr()</span>
</span><span id="FST-2326"><a href="#FST-2326"><span class="linenos">2326</span></a><span class="sd">        &lt;Assign ROOT 0,0..0,18&gt;</span>
</span><span id="FST-2327"><a href="#FST-2327"><span class="linenos">2327</span></a>
</span><span id="FST-2328"><a href="#FST-2328"><span class="linenos">2328</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;var = call(a, b=1)&#39;)</span>
</span><span id="FST-2329"><a href="#FST-2329"><span class="linenos">2329</span></a><span class="sd">        ...  .value.keywords[0].value.parent_non_expr(strict=True))</span>
</span><span id="FST-2330"><a href="#FST-2330"><span class="linenos">2330</span></a><span class="sd">        &lt;keyword 0,14..0,17&gt;</span>
</span><span id="FST-2331"><a href="#FST-2331"><span class="linenos">2331</span></a><span class="sd">        ```</span>
</span><span id="FST-2332"><a href="#FST-2332"><span class="linenos">2332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2333"><a href="#FST-2333"><span class="linenos">2333</span></a>
</span><span id="FST-2334"><a href="#FST-2334"><span class="linenos">2334</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">expr</span> <span class="k">if</span> <span class="n">strict</span> <span class="k">else</span> <span class="n">EXPRISH_ALL</span>  <span class="c1"># ops because of maybe self_</span>
</span><span id="FST-2335"><a href="#FST-2335"><span class="linenos">2335</span></a>
</span><span id="FST-2336"><a href="#FST-2336"><span class="linenos">2336</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2337"><a href="#FST-2337"><span class="linenos">2337</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2338"><a href="#FST-2338"><span class="linenos">2338</span></a>
</span><span id="FST-2339"><a href="#FST-2339"><span class="linenos">2339</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST-2340"><a href="#FST-2340"><span class="linenos">2340</span></a>            <span class="k">pass</span>
</span><span id="FST-2341"><a href="#FST-2341"><span class="linenos">2341</span></a>
</span><span id="FST-2342"><a href="#FST-2342"><span class="linenos">2342</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2343"><a href="#FST-2343"><span class="linenos">2343</span></a>
</span><span id="FST-2344"><a href="#FST-2344"><span class="linenos">2344</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2345"><a href="#FST-2345"><span class="linenos">2345</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is a `pattern`. If `self_` is `True` then will check `self` first (possibly returning</span>
</span><span id="FST-2346"><a href="#FST-2346"><span class="linenos">2346</span></a><span class="sd">        `self`), otherwise only checks parents.</span>
</span><span id="FST-2347"><a href="#FST-2347"><span class="linenos">2347</span></a>
</span><span id="FST-2348"><a href="#FST-2348"><span class="linenos">2348</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2349"><a href="#FST-2349"><span class="linenos">2349</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="FST-2350"><a href="#FST-2350"><span class="linenos">2350</span></a>
</span><span id="FST-2351"><a href="#FST-2351"><span class="linenos">2351</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2352"><a href="#FST-2352"><span class="linenos">2352</span></a><span class="sd">        ```py</span>
</span><span id="FST-2353"><a href="#FST-2353"><span class="linenos">2353</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;case 1+1j: pass&#39;).pattern.value.left.parent_pattern().src</span>
</span><span id="FST-2354"><a href="#FST-2354"><span class="linenos">2354</span></a><span class="sd">        &#39;1+1j&#39;</span>
</span><span id="FST-2355"><a href="#FST-2355"><span class="linenos">2355</span></a>
</span><span id="FST-2356"><a href="#FST-2356"><span class="linenos">2356</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="FST-2357"><a href="#FST-2357"><span class="linenos">2357</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern(self_=True))</span>
</span><span id="FST-2358"><a href="#FST-2358"><span class="linenos">2358</span></a><span class="sd">        &lt;MatchAs 0,15..0,16&gt;</span>
</span><span id="FST-2359"><a href="#FST-2359"><span class="linenos">2359</span></a>
</span><span id="FST-2360"><a href="#FST-2360"><span class="linenos">2360</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="FST-2361"><a href="#FST-2361"><span class="linenos">2361</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern())</span>
</span><span id="FST-2362"><a href="#FST-2362"><span class="linenos">2362</span></a><span class="sd">        &lt;MatchMapping 0,9..0,17&gt;</span>
</span><span id="FST-2363"><a href="#FST-2363"><span class="linenos">2363</span></a>
</span><span id="FST-2364"><a href="#FST-2364"><span class="linenos">2364</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="FST-2365"><a href="#FST-2365"><span class="linenos">2365</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern().parent_pattern())</span>
</span><span id="FST-2366"><a href="#FST-2366"><span class="linenos">2366</span></a><span class="sd">        &lt;MatchOr 0,5..0,17&gt;</span>
</span><span id="FST-2367"><a href="#FST-2367"><span class="linenos">2367</span></a><span class="sd">        ```</span>
</span><span id="FST-2368"><a href="#FST-2368"><span class="linenos">2368</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2369"><a href="#FST-2369"><span class="linenos">2369</span></a>
</span><span id="FST-2370"><a href="#FST-2370"><span class="linenos">2370</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
</span><span id="FST-2371"><a href="#FST-2371"><span class="linenos">2371</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2372"><a href="#FST-2372"><span class="linenos">2372</span></a>
</span><span id="FST-2373"><a href="#FST-2373"><span class="linenos">2373</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
</span><span id="FST-2374"><a href="#FST-2374"><span class="linenos">2374</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">match_case</span><span class="p">,</span> <span class="n">stmt</span><span class="p">)):</span>
</span><span id="FST-2375"><a href="#FST-2375"><span class="linenos">2375</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-2376"><a href="#FST-2376"><span class="linenos">2376</span></a>
</span><span id="FST-2377"><a href="#FST-2377"><span class="linenos">2377</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2378"><a href="#FST-2378"><span class="linenos">2378</span></a>
</span><span id="FST-2379"><a href="#FST-2379"><span class="linenos">2379</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">child_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">FST</span><span class="p">,</span> <span class="n">as_str</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">astfield</span><span class="p">]</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">:</span>
</span><span id="FST-2380"><a href="#FST-2380"><span class="linenos">2380</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get path to `child` node from `self` which can later be used on a copy of this tree to get to the  same</span>
</span><span id="FST-2381"><a href="#FST-2381"><span class="linenos">2381</span></a><span class="sd">        relative child node.</span>
</span><span id="FST-2382"><a href="#FST-2382"><span class="linenos">2382</span></a>
</span><span id="FST-2383"><a href="#FST-2383"><span class="linenos">2383</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2384"><a href="#FST-2384"><span class="linenos">2384</span></a><span class="sd">        - `child`: Child node to get path to, can be `self` in which case an empty path is returned.</span>
</span><span id="FST-2385"><a href="#FST-2385"><span class="linenos">2385</span></a><span class="sd">        - `as_str`: If `True` will return the path as a python-ish string suitable for attribute access, else a list of</span>
</span><span id="FST-2386"><a href="#FST-2386"><span class="linenos">2386</span></a><span class="sd">            `astfield`s which can be used more directly.</span>
</span><span id="FST-2387"><a href="#FST-2387"><span class="linenos">2387</span></a>
</span><span id="FST-2388"><a href="#FST-2388"><span class="linenos">2388</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2389"><a href="#FST-2389"><span class="linenos">2389</span></a><span class="sd">        - `list[astfield] | str`: Path to child if exists, otherwise raises.</span>
</span><span id="FST-2390"><a href="#FST-2390"><span class="linenos">2390</span></a>
</span><span id="FST-2391"><a href="#FST-2391"><span class="linenos">2391</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2392"><a href="#FST-2392"><span class="linenos">2392</span></a><span class="sd">        ```py</span>
</span><span id="FST-2393"><a href="#FST-2393"><span class="linenos">2393</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[i for i in j]&#39;, &#39;exec&#39;)).child_path(f.body[0].value.elt)</span>
</span><span id="FST-2394"><a href="#FST-2394"><span class="linenos">2394</span></a><span class="sd">        [astfield(&#39;body&#39;, 0), astfield(&#39;value&#39;), astfield(&#39;elt&#39;)]</span>
</span><span id="FST-2395"><a href="#FST-2395"><span class="linenos">2395</span></a>
</span><span id="FST-2396"><a href="#FST-2396"><span class="linenos">2396</span></a><span class="sd">        &gt;&gt;&gt; ((f := FST(&#39;[i for i in j]&#39;, &#39;exec&#39;))</span>
</span><span id="FST-2397"><a href="#FST-2397"><span class="linenos">2397</span></a><span class="sd">        ...  .child_path(f.body[0].value.elt, as_str=True))</span>
</span><span id="FST-2398"><a href="#FST-2398"><span class="linenos">2398</span></a><span class="sd">        &#39;body[0].value.elt&#39;</span>
</span><span id="FST-2399"><a href="#FST-2399"><span class="linenos">2399</span></a>
</span><span id="FST-2400"><a href="#FST-2400"><span class="linenos">2400</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_path(f)</span>
</span><span id="FST-2401"><a href="#FST-2401"><span class="linenos">2401</span></a><span class="sd">        []</span>
</span><span id="FST-2402"><a href="#FST-2402"><span class="linenos">2402</span></a>
</span><span id="FST-2403"><a href="#FST-2403"><span class="linenos">2403</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_path(f, as_str=True)</span>
</span><span id="FST-2404"><a href="#FST-2404"><span class="linenos">2404</span></a><span class="sd">        &#39;&#39;</span>
</span><span id="FST-2405"><a href="#FST-2405"><span class="linenos">2405</span></a><span class="sd">        ```</span>
</span><span id="FST-2406"><a href="#FST-2406"><span class="linenos">2406</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2407"><a href="#FST-2407"><span class="linenos">2407</span></a>
</span><span id="FST-2408"><a href="#FST-2408"><span class="linenos">2408</span></a>        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
</span><span id="FST-2409"><a href="#FST-2409"><span class="linenos">2409</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;child is not part of same tree&#39;</span><span class="p">)</span>
</span><span id="FST-2410"><a href="#FST-2410"><span class="linenos">2410</span></a>
</span><span id="FST-2411"><a href="#FST-2411"><span class="linenos">2411</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FST-2412"><a href="#FST-2412"><span class="linenos">2412</span></a>
</span><span id="FST-2413"><a href="#FST-2413"><span class="linenos">2413</span></a>        <span class="k">while</span> <span class="n">child</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="FST-2414"><a href="#FST-2414"><span class="linenos">2414</span></a>            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span>
</span><span id="FST-2415"><a href="#FST-2415"><span class="linenos">2415</span></a>
</span><span id="FST-2416"><a href="#FST-2416"><span class="linenos">2416</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">child</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST-2417"><a href="#FST-2417"><span class="linenos">2417</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid child&#39;</span><span class="p">)</span>
</span><span id="FST-2418"><a href="#FST-2418"><span class="linenos">2418</span></a>
</span><span id="FST-2419"><a href="#FST-2419"><span class="linenos">2419</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="FST-2420"><a href="#FST-2420"><span class="linenos">2420</span></a>
</span><span id="FST-2421"><a href="#FST-2421"><span class="linenos">2421</span></a>        <span class="k">return</span> <span class="n">path</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">as_str</span> <span class="k">else</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">af</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">af</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">af</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">for</span> <span class="n">af</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
</span><span id="FST-2422"><a href="#FST-2422"><span class="linenos">2422</span></a>
</span><span id="FST-2423"><a href="#FST-2423"><span class="linenos">2423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">child_from_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">astfield</span><span class="p">]</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">last_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]:</span>
</span><span id="FST-2424"><a href="#FST-2424"><span class="linenos">2424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get child node specified by `path` if it exists. If succeeds then it doesn&#39;t mean that the child node is</span>
</span><span id="FST-2425"><a href="#FST-2425"><span class="linenos">2425</span></a><span class="sd">        guaranteed to be the same or even same type as was originally used to get the path, just that the path is valid.</span>
</span><span id="FST-2426"><a href="#FST-2426"><span class="linenos">2426</span></a><span class="sd">        For example after deleting an element from a list the item at the former element&#39;s location will be the previous</span>
</span><span id="FST-2427"><a href="#FST-2427"><span class="linenos">2427</span></a><span class="sd">        next element.</span>
</span><span id="FST-2428"><a href="#FST-2428"><span class="linenos">2428</span></a>
</span><span id="FST-2429"><a href="#FST-2429"><span class="linenos">2429</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2430"><a href="#FST-2430"><span class="linenos">2430</span></a><span class="sd">        - `path`: Path to child as a list of `astfield`s or string.</span>
</span><span id="FST-2431"><a href="#FST-2431"><span class="linenos">2431</span></a><span class="sd">        - `last_valid`: If `True` then return the last valid node along the path, will not fail, can return `self`.</span>
</span><span id="FST-2432"><a href="#FST-2432"><span class="linenos">2432</span></a>
</span><span id="FST-2433"><a href="#FST-2433"><span class="linenos">2433</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2434"><a href="#FST-2434"><span class="linenos">2434</span></a><span class="sd">        - `FST`: Child node if path is valid, otherwise `False` if path invalid. `False` and not `None` because `None`</span>
</span><span id="FST-2435"><a href="#FST-2435"><span class="linenos">2435</span></a><span class="sd">            can be in a field that can hold an `AST` but `False` can not.</span>
</span><span id="FST-2436"><a href="#FST-2436"><span class="linenos">2436</span></a>
</span><span id="FST-2437"><a href="#FST-2437"><span class="linenos">2437</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2438"><a href="#FST-2438"><span class="linenos">2438</span></a><span class="sd">        ```py</span>
</span><span id="FST-2439"><a href="#FST-2439"><span class="linenos">2439</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;[i for i in j]&#39;, &#39;exec&#39;)</span>
</span><span id="FST-2440"><a href="#FST-2440"><span class="linenos">2440</span></a><span class="sd">        &gt;&gt;&gt; f.child_from_path(f.child_path(f.body[0].value.elt)).src</span>
</span><span id="FST-2441"><a href="#FST-2441"><span class="linenos">2441</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="FST-2442"><a href="#FST-2442"><span class="linenos">2442</span></a>
</span><span id="FST-2443"><a href="#FST-2443"><span class="linenos">2443</span></a><span class="sd">        &gt;&gt;&gt; f.child_from_path(f.child_path(f.body[0].value.elt, True)).src</span>
</span><span id="FST-2444"><a href="#FST-2444"><span class="linenos">2444</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="FST-2445"><a href="#FST-2445"><span class="linenos">2445</span></a>
</span><span id="FST-2446"><a href="#FST-2446"><span class="linenos">2446</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;, &#39;exec&#39;).child_from_path(&#39;body[0].value.elts[4]&#39;)</span>
</span><span id="FST-2447"><a href="#FST-2447"><span class="linenos">2447</span></a><span class="sd">        False</span>
</span><span id="FST-2448"><a href="#FST-2448"><span class="linenos">2448</span></a>
</span><span id="FST-2449"><a href="#FST-2449"><span class="linenos">2449</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;[0, 1, 2, 3]&#39;, &#39;exec&#39;)</span>
</span><span id="FST-2450"><a href="#FST-2450"><span class="linenos">2450</span></a><span class="sd">        ...  .child_from_path(&#39;body[0].value.elts[4]&#39;, last_valid=True).src)</span>
</span><span id="FST-2451"><a href="#FST-2451"><span class="linenos">2451</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="FST-2452"><a href="#FST-2452"><span class="linenos">2452</span></a>
</span><span id="FST-2453"><a href="#FST-2453"><span class="linenos">2453</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_from_path([]) is f</span>
</span><span id="FST-2454"><a href="#FST-2454"><span class="linenos">2454</span></a><span class="sd">        True</span>
</span><span id="FST-2455"><a href="#FST-2455"><span class="linenos">2455</span></a>
</span><span id="FST-2456"><a href="#FST-2456"><span class="linenos">2456</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_from_path(&#39;&#39;) is f</span>
</span><span id="FST-2457"><a href="#FST-2457"><span class="linenos">2457</span></a><span class="sd">        True</span>
</span><span id="FST-2458"><a href="#FST-2458"><span class="linenos">2458</span></a><span class="sd">        ```</span>
</span><span id="FST-2459"><a href="#FST-2459"><span class="linenos">2459</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2460"><a href="#FST-2460"><span class="linenos">2460</span></a>
</span><span id="FST-2461"><a href="#FST-2461"><span class="linenos">2461</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FST-2462"><a href="#FST-2462"><span class="linenos">2462</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">astfield</span><span class="p">(</span><span class="n">p</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">p</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">astfield</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="FST-2463"><a href="#FST-2463"><span class="linenos">2463</span></a>                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span> <span class="k">if</span> <span class="n">path</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="FST-2464"><a href="#FST-2464"><span class="linenos">2464</span></a>
</span><span id="FST-2465"><a href="#FST-2465"><span class="linenos">2465</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
</span><span id="FST-2466"><a href="#FST-2466"><span class="linenos">2466</span></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">next</span> <span class="o">:=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_no_raise</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="FST-2467"><a href="#FST-2467"><span class="linenos">2467</span></a>                <span class="k">return</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">last_valid</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="FST-2468"><a href="#FST-2468"><span class="linenos">2468</span></a>
</span><span id="FST-2469"><a href="#FST-2469"><span class="linenos">2469</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="nb">next</span>
</span><span id="FST-2470"><a href="#FST-2470"><span class="linenos">2470</span></a>
</span><span id="FST-2471"><a href="#FST-2471"><span class="linenos">2471</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2472"><a href="#FST-2472"><span class="linenos">2472</span></a>
</span><span id="FST-2473"><a href="#FST-2473"><span class="linenos">2473</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">repath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST-2474"><a href="#FST-2474"><span class="linenos">2474</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recalculate `self` from path from root. Useful if `self` has been replaced by another node by some operation.</span>
</span><span id="FST-2475"><a href="#FST-2475"><span class="linenos">2475</span></a><span class="sd">        When nodes are deleted the corresponding `FST.a` and `AST.f` attributes are set to `None`. The `root`, `parent`</span>
</span><span id="FST-2476"><a href="#FST-2476"><span class="linenos">2476</span></a><span class="sd">        and `pfield` attributes are left so that things like this can work. Useful when a node has been deleted but you</span>
</span><span id="FST-2477"><a href="#FST-2477"><span class="linenos">2477</span></a><span class="sd">        want to know where it was and what may be there now.</span>
</span><span id="FST-2478"><a href="#FST-2478"><span class="linenos">2478</span></a>
</span><span id="FST-2479"><a href="#FST-2479"><span class="linenos">2479</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2480"><a href="#FST-2480"><span class="linenos">2480</span></a><span class="sd">        - `FST`: Possibly `self` or the node which took our place at our relative position from `root`.</span>
</span><span id="FST-2481"><a href="#FST-2481"><span class="linenos">2481</span></a>
</span><span id="FST-2482"><a href="#FST-2482"><span class="linenos">2482</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2483"><a href="#FST-2483"><span class="linenos">2483</span></a><span class="sd">        ```py</span>
</span><span id="FST-2484"><a href="#FST-2484"><span class="linenos">2484</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;[0, 1, 2, 3]&#39;)</span>
</span><span id="FST-2485"><a href="#FST-2485"><span class="linenos">2485</span></a><span class="sd">        &gt;&gt;&gt; g = f.elts[1]</span>
</span><span id="FST-2486"><a href="#FST-2486"><span class="linenos">2486</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a), g.root)</span>
</span><span id="FST-2487"><a href="#FST-2487"><span class="linenos">2487</span></a><span class="sd">        &lt;class &#39;ast.Constant&#39;&gt; &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="FST-2488"><a href="#FST-2488"><span class="linenos">2488</span></a>
</span><span id="FST-2489"><a href="#FST-2489"><span class="linenos">2489</span></a><span class="sd">        &gt;&gt;&gt; f.put(&#39;x&#39;, 1, raw=True)  # raw forces reparse at List</span>
</span><span id="FST-2490"><a href="#FST-2490"><span class="linenos">2490</span></a><span class="sd">        &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="FST-2491"><a href="#FST-2491"><span class="linenos">2491</span></a>
</span><span id="FST-2492"><a href="#FST-2492"><span class="linenos">2492</span></a><span class="sd">        &gt;&gt;&gt; print(g.a, g.root)</span>
</span><span id="FST-2493"><a href="#FST-2493"><span class="linenos">2493</span></a><span class="sd">        None &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="FST-2494"><a href="#FST-2494"><span class="linenos">2494</span></a>
</span><span id="FST-2495"><a href="#FST-2495"><span class="linenos">2495</span></a><span class="sd">        &gt;&gt;&gt; g = g.repath()</span>
</span><span id="FST-2496"><a href="#FST-2496"><span class="linenos">2496</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a), g.root)</span>
</span><span id="FST-2497"><a href="#FST-2497"><span class="linenos">2497</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt; &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="FST-2498"><a href="#FST-2498"><span class="linenos">2498</span></a><span class="sd">        ```</span>
</span><span id="FST-2499"><a href="#FST-2499"><span class="linenos">2499</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2500"><a href="#FST-2500"><span class="linenos">2500</span></a>
</span><span id="FST-2501"><a href="#FST-2501"><span class="linenos">2501</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">root</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">child_from_path</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="FST-2502"><a href="#FST-2502"><span class="linenos">2502</span></a>
</span><span id="FST-2503"><a href="#FST-2503"><span class="linenos">2503</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2504"><a href="#FST-2504"><span class="linenos">2504</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Find the lowest level node which entirely contains location (starting search at `self`). To reiterate, the</span>
</span><span id="FST-2505"><a href="#FST-2505"><span class="linenos">2505</span></a><span class="sd">        search will only find nodes at self or below, no parents.</span>
</span><span id="FST-2506"><a href="#FST-2506"><span class="linenos">2506</span></a>
</span><span id="FST-2507"><a href="#FST-2507"><span class="linenos">2507</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2508"><a href="#FST-2508"><span class="linenos">2508</span></a><span class="sd">        - `ln`: Start line of location to search for (0 based).</span>
</span><span id="FST-2509"><a href="#FST-2509"><span class="linenos">2509</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="FST-2510"><a href="#FST-2510"><span class="linenos">2510</span></a><span class="sd">        - `end_ln`: End line of location to search for (0 based, inclusive).</span>
</span><span id="FST-2511"><a href="#FST-2511"><span class="linenos">2511</span></a><span class="sd">        - `end_col`: End column (character, inclusive with `FST.end_col`, exclusive with `FST.col`) on end line.</span>
</span><span id="FST-2512"><a href="#FST-2512"><span class="linenos">2512</span></a><span class="sd">        - `exact`: Whether to allow return of exact location match with node or not. `True` means allow return of node</span>
</span><span id="FST-2513"><a href="#FST-2513"><span class="linenos">2513</span></a><span class="sd">            which matches location exactly. Otherwise the location must be inside the node but cannot be touching BOTH</span>
</span><span id="FST-2514"><a href="#FST-2514"><span class="linenos">2514</span></a><span class="sd">            ends of the node. This basically determines whether you can get the exact node of the location or its</span>
</span><span id="FST-2515"><a href="#FST-2515"><span class="linenos">2515</span></a><span class="sd">            parent.</span>
</span><span id="FST-2516"><a href="#FST-2516"><span class="linenos">2516</span></a>
</span><span id="FST-2517"><a href="#FST-2517"><span class="linenos">2517</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2518"><a href="#FST-2518"><span class="linenos">2518</span></a><span class="sd">        - `FST | None`: Node which entirely contains location, either exactly or not, or `None` if no such node.</span>
</span><span id="FST-2519"><a href="#FST-2519"><span class="linenos">2519</span></a>
</span><span id="FST-2520"><a href="#FST-2520"><span class="linenos">2520</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2521"><a href="#FST-2521"><span class="linenos">2521</span></a><span class="sd">        ```py</span>
</span><span id="FST-2522"><a href="#FST-2522"><span class="linenos">2522</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 6, 0, 7)</span>
</span><span id="FST-2523"><a href="#FST-2523"><span class="linenos">2523</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST-2524"><a href="#FST-2524"><span class="linenos">2524</span></a>
</span><span id="FST-2525"><a href="#FST-2525"><span class="linenos">2525</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 7)</span>
</span><span id="FST-2526"><a href="#FST-2526"><span class="linenos">2526</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST-2527"><a href="#FST-2527"><span class="linenos">2527</span></a>
</span><span id="FST-2528"><a href="#FST-2528"><span class="linenos">2528</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 7, exact=False)</span>
</span><span id="FST-2529"><a href="#FST-2529"><span class="linenos">2529</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="FST-2530"><a href="#FST-2530"><span class="linenos">2530</span></a>
</span><span id="FST-2531"><a href="#FST-2531"><span class="linenos">2531</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 5, 0, 7, exact=False)</span>
</span><span id="FST-2532"><a href="#FST-2532"><span class="linenos">2532</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST-2533"><a href="#FST-2533"><span class="linenos">2533</span></a>
</span><span id="FST-2534"><a href="#FST-2534"><span class="linenos">2534</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 6, exact=False)</span>
</span><span id="FST-2535"><a href="#FST-2535"><span class="linenos">2535</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST-2536"><a href="#FST-2536"><span class="linenos">2536</span></a>
</span><span id="FST-2537"><a href="#FST-2537"><span class="linenos">2537</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 3, 0, 7)</span>
</span><span id="FST-2538"><a href="#FST-2538"><span class="linenos">2538</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="FST-2539"><a href="#FST-2539"><span class="linenos">2539</span></a>
</span><span id="FST-2540"><a href="#FST-2540"><span class="linenos">2540</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 3, 0, 7, exact=False)</span>
</span><span id="FST-2541"><a href="#FST-2541"><span class="linenos">2541</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="FST-2542"><a href="#FST-2542"><span class="linenos">2542</span></a>
</span><span id="FST-2543"><a href="#FST-2543"><span class="linenos">2543</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 0, 0, 7, exact=False))</span>
</span><span id="FST-2544"><a href="#FST-2544"><span class="linenos">2544</span></a><span class="sd">        None</span>
</span><span id="FST-2545"><a href="#FST-2545"><span class="linenos">2545</span></a>
</span><span id="FST-2546"><a href="#FST-2546"><span class="linenos">2546</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val\n&#39;, &#39;exec&#39;).find_loc(0, 0, 0, 7, exact=False)</span>
</span><span id="FST-2547"><a href="#FST-2547"><span class="linenos">2547</span></a><span class="sd">        &lt;Module ROOT 0,0..1,0&gt;</span>
</span><span id="FST-2548"><a href="#FST-2548"><span class="linenos">2548</span></a><span class="sd">        ```</span>
</span><span id="FST-2549"><a href="#FST-2549"><span class="linenos">2549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2550"><a href="#FST-2550"><span class="linenos">2550</span></a>
</span><span id="FST-2551"><a href="#FST-2551"><span class="linenos">2551</span></a>        <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST-2552"><a href="#FST-2552"><span class="linenos">2552</span></a>
</span><span id="FST-2553"><a href="#FST-2553"><span class="linenos">2553</span></a>        <span class="k">if</span> <span class="p">((((</span><span class="n">same_ln</span> <span class="o">:=</span> <span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&lt;=</span> <span class="n">col</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fln</span> <span class="o">&lt;</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST-2554"><a href="#FST-2554"><span class="linenos">2554</span></a>            <span class="p">(((</span><span class="n">same_end_ln</span> <span class="o">:=</span> <span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&gt;=</span> <span class="n">end_col</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fend_ln</span> <span class="o">&gt;</span> <span class="n">end_ln</span><span class="p">)</span>
</span><span id="FST-2555"><a href="#FST-2555"><span class="linenos">2555</span></a>        <span class="p">):</span>
</span><span id="FST-2556"><a href="#FST-2556"><span class="linenos">2556</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exact</span> <span class="ow">and</span> <span class="n">same_ln</span> <span class="ow">and</span> <span class="n">same_end_ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">==</span> <span class="n">col</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">==</span> <span class="n">end_col</span><span class="p">:</span>
</span><span id="FST-2557"><a href="#FST-2557"><span class="linenos">2557</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-2558"><a href="#FST-2558"><span class="linenos">2558</span></a>
</span><span id="FST-2559"><a href="#FST-2559"><span class="linenos">2559</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST-2560"><a href="#FST-2560"><span class="linenos">2560</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-2561"><a href="#FST-2561"><span class="linenos">2561</span></a>
</span><span id="FST-2562"><a href="#FST-2562"><span class="linenos">2562</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST-2563"><a href="#FST-2563"><span class="linenos">2563</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">self_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="FST-2564"><a href="#FST-2564"><span class="linenos">2564</span></a>                <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST-2565"><a href="#FST-2565"><span class="linenos">2565</span></a>
</span><span id="FST-2566"><a href="#FST-2566"><span class="linenos">2566</span></a>                <span class="k">if</span> <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">col</span><span class="p">):</span>
</span><span id="FST-2567"><a href="#FST-2567"><span class="linenos">2567</span></a>                    <span class="k">continue</span>
</span><span id="FST-2568"><a href="#FST-2568"><span class="linenos">2568</span></a>
</span><span id="FST-2569"><a href="#FST-2569"><span class="linenos">2569</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">fln</span> <span class="o">&gt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">((</span><span class="n">same_ln</span> <span class="o">:=</span> <span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&gt;</span> <span class="n">col</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="FST-2570"><a href="#FST-2570"><span class="linenos">2570</span></a>                    <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">((</span><span class="n">same_end_ln</span> <span class="o">:=</span> <span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;</span> <span class="n">end_col</span><span class="p">)</span>
</span><span id="FST-2571"><a href="#FST-2571"><span class="linenos">2571</span></a>                <span class="p">):</span>
</span><span id="FST-2572"><a href="#FST-2572"><span class="linenos">2572</span></a>                    <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2573"><a href="#FST-2573"><span class="linenos">2573</span></a>
</span><span id="FST-2574"><a href="#FST-2574"><span class="linenos">2574</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">exact</span> <span class="ow">and</span> <span class="n">same_ln</span> <span class="ow">and</span> <span class="n">same_end_ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">==</span> <span class="n">col</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">==</span> <span class="n">end_col</span><span class="p">:</span>
</span><span id="FST-2575"><a href="#FST-2575"><span class="linenos">2575</span></a>                    <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2576"><a href="#FST-2576"><span class="linenos">2576</span></a>
</span><span id="FST-2577"><a href="#FST-2577"><span class="linenos">2577</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="FST-2578"><a href="#FST-2578"><span class="linenos">2578</span></a>
</span><span id="FST-2579"><a href="#FST-2579"><span class="linenos">2579</span></a>                <span class="k">break</span>
</span><span id="FST-2580"><a href="#FST-2580"><span class="linenos">2580</span></a>
</span><span id="FST-2581"><a href="#FST-2581"><span class="linenos">2581</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST-2582"><a href="#FST-2582"><span class="linenos">2582</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2583"><a href="#FST-2583"><span class="linenos">2583</span></a>
</span><span id="FST-2584"><a href="#FST-2584"><span class="linenos">2584</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_in_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-2585"><a href="#FST-2585"><span class="linenos">2585</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the first highest level node which is contained entirely in location (inclusive, starting search at</span>
</span><span id="FST-2586"><a href="#FST-2586"><span class="linenos">2586</span></a><span class="sd">        `self`). To reiterate, the search will only find nodes at self or below, no parents.</span>
</span><span id="FST-2587"><a href="#FST-2587"><span class="linenos">2587</span></a>
</span><span id="FST-2588"><a href="#FST-2588"><span class="linenos">2588</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2589"><a href="#FST-2589"><span class="linenos">2589</span></a><span class="sd">        - `ln`: Start line of location to search (0 based).</span>
</span><span id="FST-2590"><a href="#FST-2590"><span class="linenos">2590</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="FST-2591"><a href="#FST-2591"><span class="linenos">2591</span></a><span class="sd">        - `end_ln`: End line of location to search (0 based, inclusive).</span>
</span><span id="FST-2592"><a href="#FST-2592"><span class="linenos">2592</span></a><span class="sd">        - `end_col`: End column (character, inclusive with `FST.end_col`, exclusive with `FST.col`) on end line.</span>
</span><span id="FST-2593"><a href="#FST-2593"><span class="linenos">2593</span></a>
</span><span id="FST-2594"><a href="#FST-2594"><span class="linenos">2594</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2595"><a href="#FST-2595"><span class="linenos">2595</span></a><span class="sd">        - `FST | None`: First node which is entirely contained in the location or `None` if no such node.</span>
</span><span id="FST-2596"><a href="#FST-2596"><span class="linenos">2596</span></a>
</span><span id="FST-2597"><a href="#FST-2597"><span class="linenos">2597</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2598"><a href="#FST-2598"><span class="linenos">2598</span></a><span class="sd">        ```py</span>
</span><span id="FST-2599"><a href="#FST-2599"><span class="linenos">2599</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 0, 0, 7)</span>
</span><span id="FST-2600"><a href="#FST-2600"><span class="linenos">2600</span></a><span class="sd">        &lt;Module ROOT 0,0..0,7&gt;</span>
</span><span id="FST-2601"><a href="#FST-2601"><span class="linenos">2601</span></a>
</span><span id="FST-2602"><a href="#FST-2602"><span class="linenos">2602</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 1, 0, 7)</span>
</span><span id="FST-2603"><a href="#FST-2603"><span class="linenos">2603</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST-2604"><a href="#FST-2604"><span class="linenos">2604</span></a>
</span><span id="FST-2605"><a href="#FST-2605"><span class="linenos">2605</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 4, 0, 7)</span>
</span><span id="FST-2606"><a href="#FST-2606"><span class="linenos">2606</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST-2607"><a href="#FST-2607"><span class="linenos">2607</span></a>
</span><span id="FST-2608"><a href="#FST-2608"><span class="linenos">2608</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 5, 0, 7))</span>
</span><span id="FST-2609"><a href="#FST-2609"><span class="linenos">2609</span></a><span class="sd">        None</span>
</span><span id="FST-2610"><a href="#FST-2610"><span class="linenos">2610</span></a><span class="sd">        ```</span>
</span><span id="FST-2611"><a href="#FST-2611"><span class="linenos">2611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2612"><a href="#FST-2612"><span class="linenos">2612</span></a>
</span><span id="FST-2613"><a href="#FST-2613"><span class="linenos">2613</span></a>        <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST-2614"><a href="#FST-2614"><span class="linenos">2614</span></a>
</span><span id="FST-2615"><a href="#FST-2615"><span class="linenos">2615</span></a>        <span class="k">if</span> <span class="p">((</span><span class="n">fln</span> <span class="o">&gt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&gt;=</span> <span class="n">col</span><span class="p">))</span> <span class="ow">and</span>
</span><span id="FST-2616"><a href="#FST-2616"><span class="linenos">2616</span></a>            <span class="p">(</span><span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">end_col</span><span class="p">))</span>
</span><span id="FST-2617"><a href="#FST-2617"><span class="linenos">2617</span></a>        <span class="p">):</span>
</span><span id="FST-2618"><a href="#FST-2618"><span class="linenos">2618</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST-2619"><a href="#FST-2619"><span class="linenos">2619</span></a>
</span><span id="FST-2620"><a href="#FST-2620"><span class="linenos">2620</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST-2621"><a href="#FST-2621"><span class="linenos">2621</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">self_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="FST-2622"><a href="#FST-2622"><span class="linenos">2622</span></a>                <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST-2623"><a href="#FST-2623"><span class="linenos">2623</span></a>
</span><span id="FST-2624"><a href="#FST-2624"><span class="linenos">2624</span></a>                <span class="k">if</span> <span class="n">fln</span> <span class="o">&lt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&lt;</span> <span class="n">col</span><span class="p">):</span>
</span><span id="FST-2625"><a href="#FST-2625"><span class="linenos">2625</span></a>                    <span class="k">continue</span>
</span><span id="FST-2626"><a href="#FST-2626"><span class="linenos">2626</span></a>
</span><span id="FST-2627"><a href="#FST-2627"><span class="linenos">2627</span></a>                <span class="k">if</span> <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">end_col</span><span class="p">):</span>
</span><span id="FST-2628"><a href="#FST-2628"><span class="linenos">2628</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST-2629"><a href="#FST-2629"><span class="linenos">2629</span></a>
</span><span id="FST-2630"><a href="#FST-2630"><span class="linenos">2630</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="FST-2631"><a href="#FST-2631"><span class="linenos">2631</span></a>
</span><span id="FST-2632"><a href="#FST-2632"><span class="linenos">2632</span></a>                <span class="k">break</span>
</span><span id="FST-2633"><a href="#FST-2633"><span class="linenos">2633</span></a>
</span><span id="FST-2634"><a href="#FST-2634"><span class="linenos">2634</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST-2635"><a href="#FST-2635"><span class="linenos">2635</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-2636"><a href="#FST-2636"><span class="linenos">2636</span></a>
</span><span id="FST-2637"><a href="#FST-2637"><span class="linenos">2637</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="FST-2638"><a href="#FST-2638"><span class="linenos">2638</span></a>    <span class="c1"># Low level</span>
</span><span id="FST-2639"><a href="#FST-2639"><span class="linenos">2639</span></a>
</span><span id="FST-2640"><a href="#FST-2640"><span class="linenos">2640</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">:</span>
</span><span id="FST-2641"><a href="#FST-2641"><span class="linenos">2641</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine proper indentation of node at `stmt` (or other similar) level at or above `self`. Even if it is a</span>
</span><span id="FST-2642"><a href="#FST-2642"><span class="linenos">2642</span></a><span class="sd">        continuation or on same line as block statement. If indentation is impossible to determine because is solo</span>
</span><span id="FST-2643"><a href="#FST-2643"><span class="linenos">2643</span></a><span class="sd">        statement on same line as parent block then the current tree default indentation is added to the parent block</span>
</span><span id="FST-2644"><a href="#FST-2644"><span class="linenos">2644</span></a><span class="sd">        indentation and returned.</span>
</span><span id="FST-2645"><a href="#FST-2645"><span class="linenos">2645</span></a>
</span><span id="FST-2646"><a href="#FST-2646"><span class="linenos">2646</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2647"><a href="#FST-2647"><span class="linenos">2647</span></a><span class="sd">        - `str`: Entire indentation string for the block this node lives in (not just a single level).</span>
</span><span id="FST-2648"><a href="#FST-2648"><span class="linenos">2648</span></a>
</span><span id="FST-2649"><a href="#FST-2649"><span class="linenos">2649</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2650"><a href="#FST-2650"><span class="linenos">2650</span></a><span class="sd">        ```py</span>
</span><span id="FST-2651"><a href="#FST-2651"><span class="linenos">2651</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).get_indent()</span>
</span><span id="FST-2652"><a href="#FST-2652"><span class="linenos">2652</span></a><span class="sd">        &#39;&#39;</span>
</span><span id="FST-2653"><a href="#FST-2653"><span class="linenos">2653</span></a>
</span><span id="FST-2654"><a href="#FST-2654"><span class="linenos">2654</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="FST-2655"><a href="#FST-2655"><span class="linenos">2655</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="FST-2656"><a href="#FST-2656"><span class="linenos">2656</span></a>
</span><span id="FST-2657"><a href="#FST-2657"><span class="linenos">2657</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;).body[0].get_indent()</span>
</span><span id="FST-2658"><a href="#FST-2658"><span class="linenos">2658</span></a><span class="sd">        &#39;    &#39;</span>
</span><span id="FST-2659"><a href="#FST-2659"><span class="linenos">2659</span></a>
</span><span id="FST-2660"><a href="#FST-2660"><span class="linenos">2660</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1; j = 2&#39;).body[1].get_indent()</span>
</span><span id="FST-2661"><a href="#FST-2661"><span class="linenos">2661</span></a><span class="sd">        &#39;    &#39;</span>
</span><span id="FST-2662"><a href="#FST-2662"><span class="linenos">2662</span></a>
</span><span id="FST-2663"><a href="#FST-2663"><span class="linenos">2663</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 1\n  j = 2&#39;).body[1].get_indent()</span>
</span><span id="FST-2664"><a href="#FST-2664"><span class="linenos">2664</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="FST-2665"><a href="#FST-2665"><span class="linenos">2665</span></a>
</span><span id="FST-2666"><a href="#FST-2666"><span class="linenos">2666</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 2:\n    if 1:\n      i = 1\n      j = 2&#39;).body[0].body[1].get_indent()</span>
</span><span id="FST-2667"><a href="#FST-2667"><span class="linenos">2667</span></a><span class="sd">        &#39;      &#39;</span>
</span><span id="FST-2668"><a href="#FST-2668"><span class="linenos">2668</span></a>
</span><span id="FST-2669"><a href="#FST-2669"><span class="linenos">2669</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n\\\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="FST-2670"><a href="#FST-2670"><span class="linenos">2670</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="FST-2671"><a href="#FST-2671"><span class="linenos">2671</span></a>
</span><span id="FST-2672"><a href="#FST-2672"><span class="linenos">2672</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n \\\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="FST-2673"><a href="#FST-2673"><span class="linenos">2673</span></a><span class="sd">        &#39; &#39;</span>
</span><span id="FST-2674"><a href="#FST-2674"><span class="linenos">2674</span></a><span class="sd">        ```</span>
</span><span id="FST-2675"><a href="#FST-2675"><span class="linenos">2675</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2676"><a href="#FST-2676"><span class="linenos">2676</span></a>
</span><span id="FST-2677"><a href="#FST-2677"><span class="linenos">2677</span></a>        <span class="k">while</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">STMTISH</span><span class="p">):</span>
</span><span id="FST-2678"><a href="#FST-2678"><span class="linenos">2678</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="FST-2679"><a href="#FST-2679"><span class="linenos">2679</span></a>
</span><span id="FST-2680"><a href="#FST-2680"><span class="linenos">2680</span></a>        <span class="n">root</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
</span><span id="FST-2681"><a href="#FST-2681"><span class="linenos">2681</span></a>        <span class="n">lines</span>  <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST-2682"><a href="#FST-2682"><span class="linenos">2682</span></a>        <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST-2683"><a href="#FST-2683"><span class="linenos">2683</span></a>
</span><span id="FST-2684"><a href="#FST-2684"><span class="linenos">2684</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="FST-2685"><a href="#FST-2685"><span class="linenos">2685</span></a>            <span class="n">f</span>             <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span>
</span><span id="FST-2686"><a href="#FST-2686"><span class="linenos">2686</span></a>            <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST-2687"><a href="#FST-2687"><span class="linenos">2687</span></a>            <span class="n">prev</span>          <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">prev</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># there may not be one (&quot;try&quot; at start of module)</span>
</span><span id="FST-2688"><a href="#FST-2688"><span class="linenos">2688</span></a>            <span class="n">prev_end_ln</span>   <span class="o">=</span> <span class="n">prev</span><span class="o">.</span><span class="n">end_ln</span> <span class="k">if</span> <span class="n">prev</span> <span class="k">else</span> <span class="o">-</span><span class="mi">2</span>  <span class="c1"># -2 so it never hits it</span>
</span><span id="FST-2689"><a href="#FST-2689"><span class="linenos">2689</span></a>            <span class="n">good_line</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST-2690"><a href="#FST-2690"><span class="linenos">2690</span></a>
</span><span id="FST-2691"><a href="#FST-2691"><span class="linenos">2691</span></a>            <span class="k">while</span> <span class="n">ln</span> <span class="o">&gt;</span> <span class="n">prev_end_ln</span> <span class="ow">and</span> <span class="n">re_empty_line</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line_start</span> <span class="o">:=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
</span><span id="FST-2692"><a href="#FST-2692"><span class="linenos">2692</span></a>                <span class="n">end_col</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">preceding_ln</span> <span class="o">:=</span> <span class="n">ln</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prev_end_ln</span> <span class="k">else</span> <span class="n">prev</span><span class="o">.</span><span class="n">end_col</span>
</span><span id="FST-2693"><a href="#FST-2693"><span class="linenos">2693</span></a>
</span><span id="FST-2694"><a href="#FST-2694"><span class="linenos">2694</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">ln</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">re_line_continuation</span><span class="o">.</span><span class="n">match</span><span class="p">((</span><span class="n">l</span> <span class="o">:=</span> <span class="n">lines</span><span class="p">[</span><span class="n">preceding_ln</span><span class="p">]),</span> <span class="n">end_col</span><span class="p">):</span>
</span><span id="FST-2695"><a href="#FST-2695"><span class="linenos">2695</span></a>                    <span class="k">return</span> <span class="p">(</span><span class="n">line_start</span><span class="p">[:</span><span class="n">col</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="k">else</span> <span class="n">good_line</span><span class="p">)</span> <span class="o">+</span> <span class="n">indent</span>
</span><span id="FST-2696"><a href="#FST-2696"><span class="linenos">2696</span></a>
</span><span id="FST-2697"><a href="#FST-2697"><span class="linenos">2697</span></a>                <span class="k">if</span> <span class="n">col</span><span class="p">:</span>  <span class="c1"># we do this to skip backslashes at the start of line as those are just a noop</span>
</span><span id="FST-2698"><a href="#FST-2698"><span class="linenos">2698</span></a>                    <span class="n">good_line</span> <span class="o">=</span> <span class="n">line_start</span><span class="p">[:</span><span class="n">col</span><span class="p">]</span>
</span><span id="FST-2699"><a href="#FST-2699"><span class="linenos">2699</span></a>
</span><span id="FST-2700"><a href="#FST-2700"><span class="linenos">2700</span></a>                <span class="n">ln</span>  <span class="o">=</span> <span class="n">preceding_ln</span>
</span><span id="FST-2701"><a href="#FST-2701"><span class="linenos">2701</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># was line continuation so last char is &#39;\&#39; and rest should be empty</span>
</span><span id="FST-2702"><a href="#FST-2702"><span class="linenos">2702</span></a>
</span><span id="FST-2703"><a href="#FST-2703"><span class="linenos">2703</span></a>            <span class="n">indent</span> <span class="o">+=</span> <span class="n">root</span><span class="o">.</span><span class="n">indent</span>
</span><span id="FST-2704"><a href="#FST-2704"><span class="linenos">2704</span></a>            <span class="bp">self</span>    <span class="o">=</span> <span class="n">parent</span>
</span><span id="FST-2705"><a href="#FST-2705"><span class="linenos">2705</span></a>            <span class="n">parent</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
</span><span id="FST-2706"><a href="#FST-2706"><span class="linenos">2706</span></a>
</span><span id="FST-2707"><a href="#FST-2707"><span class="linenos">2707</span></a>        <span class="k">return</span> <span class="n">indent</span>
</span><span id="FST-2708"><a href="#FST-2708"><span class="linenos">2708</span></a>
</span><span id="FST-2709"><a href="#FST-2709"><span class="linenos">2709</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parsable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-2710"><a href="#FST-2710"><span class="linenos">2710</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether the source for this node is parsable by `FST` or not (if properly dedented for top level). This is</span>
</span><span id="FST-2711"><a href="#FST-2711"><span class="linenos">2711</span></a><span class="sd">        different from `astutil.is_parsable` because that one indicates what is parsable by the python `ast` module,</span>
</span><span id="FST-2712"><a href="#FST-2712"><span class="linenos">2712</span></a><span class="sd">        while `FST` can parse more things.</span>
</span><span id="FST-2713"><a href="#FST-2713"><span class="linenos">2713</span></a>
</span><span id="FST-2714"><a href="#FST-2714"><span class="linenos">2714</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2715"><a href="#FST-2715"><span class="linenos">2715</span></a><span class="sd">        - `bool`: Whether is parsable by `FST` from a string or not.</span>
</span><span id="FST-2716"><a href="#FST-2716"><span class="linenos">2716</span></a>
</span><span id="FST-2717"><a href="#FST-2717"><span class="linenos">2717</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2718"><a href="#FST-2718"><span class="linenos">2718</span></a><span class="sd">        ```py</span>
</span><span id="FST-2719"><a href="#FST-2719"><span class="linenos">2719</span></a><span class="sd">        &gt;&gt;&gt; from fst import astutil</span>
</span><span id="FST-2720"><a href="#FST-2720"><span class="linenos">2720</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).is_parsable()</span>
</span><span id="FST-2721"><a href="#FST-2721"><span class="linenos">2721</span></a><span class="sd">        True</span>
</span><span id="FST-2722"><a href="#FST-2722"><span class="linenos">2722</span></a>
</span><span id="FST-2723"><a href="#FST-2723"><span class="linenos">2723</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b]&#39;).slice.is_parsable()</span>
</span><span id="FST-2724"><a href="#FST-2724"><span class="linenos">2724</span></a><span class="sd">        True</span>
</span><span id="FST-2725"><a href="#FST-2725"><span class="linenos">2725</span></a>
</span><span id="FST-2726"><a href="#FST-2726"><span class="linenos">2726</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b:c]&#39;).slice.is_parsable()</span>
</span><span id="FST-2727"><a href="#FST-2727"><span class="linenos">2727</span></a><span class="sd">        True</span>
</span><span id="FST-2728"><a href="#FST-2728"><span class="linenos">2728</span></a>
</span><span id="FST-2729"><a href="#FST-2729"><span class="linenos">2729</span></a><span class="sd">        &gt;&gt;&gt; is_parsable(FST(&#39;a[b:c]&#39;).slice.a)</span>
</span><span id="FST-2730"><a href="#FST-2730"><span class="linenos">2730</span></a><span class="sd">        False</span>
</span><span id="FST-2731"><a href="#FST-2731"><span class="linenos">2731</span></a>
</span><span id="FST-2732"><a href="#FST-2732"><span class="linenos">2732</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].is_parsable()</span>
</span><span id="FST-2733"><a href="#FST-2733"><span class="linenos">2733</span></a><span class="sd">        False</span>
</span><span id="FST-2734"><a href="#FST-2734"><span class="linenos">2734</span></a>
</span><span id="FST-2735"><a href="#FST-2735"><span class="linenos">2735</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].value.is_parsable()</span>
</span><span id="FST-2736"><a href="#FST-2736"><span class="linenos">2736</span></a><span class="sd">        True</span>
</span><span id="FST-2737"><a href="#FST-2737"><span class="linenos">2737</span></a>
</span><span id="FST-2738"><a href="#FST-2738"><span class="linenos">2738</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].format_spec.is_parsable()</span>
</span><span id="FST-2739"><a href="#FST-2739"><span class="linenos">2739</span></a><span class="sd">        False</span>
</span><span id="FST-2740"><a href="#FST-2740"><span class="linenos">2740</span></a>
</span><span id="FST-2741"><a href="#FST-2741"><span class="linenos">2741</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).body[0].is_parsable()</span>
</span><span id="FST-2742"><a href="#FST-2742"><span class="linenos">2742</span></a><span class="sd">        True</span>
</span><span id="FST-2743"><a href="#FST-2743"><span class="linenos">2743</span></a>
</span><span id="FST-2744"><a href="#FST-2744"><span class="linenos">2744</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].is_parsable()</span>
</span><span id="FST-2745"><a href="#FST-2745"><span class="linenos">2745</span></a><span class="sd">        True</span>
</span><span id="FST-2746"><a href="#FST-2746"><span class="linenos">2746</span></a>
</span><span id="FST-2747"><a href="#FST-2747"><span class="linenos">2747</span></a><span class="sd">        &gt;&gt;&gt; astutil.is_parsable(FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].a)</span>
</span><span id="FST-2748"><a href="#FST-2748"><span class="linenos">2748</span></a><span class="sd">        False</span>
</span><span id="FST-2749"><a href="#FST-2749"><span class="linenos">2749</span></a>
</span><span id="FST-2750"><a href="#FST-2750"><span class="linenos">2750</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].body[0].is_parsable()</span>
</span><span id="FST-2751"><a href="#FST-2751"><span class="linenos">2751</span></a><span class="sd">        True</span>
</span><span id="FST-2752"><a href="#FST-2752"><span class="linenos">2752</span></a>
</span><span id="FST-2753"><a href="#FST-2753"><span class="linenos">2753</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].is_parsable()</span>
</span><span id="FST-2754"><a href="#FST-2754"><span class="linenos">2754</span></a><span class="sd">        True</span>
</span><span id="FST-2755"><a href="#FST-2755"><span class="linenos">2755</span></a>
</span><span id="FST-2756"><a href="#FST-2756"><span class="linenos">2756</span></a><span class="sd">        &gt;&gt;&gt; is_parsable(FST(&#39;match a:\n  case 1: pass&#39;).cases[0].a)</span>
</span><span id="FST-2757"><a href="#FST-2757"><span class="linenos">2757</span></a><span class="sd">        False</span>
</span><span id="FST-2758"><a href="#FST-2758"><span class="linenos">2758</span></a><span class="sd">        ```</span>
</span><span id="FST-2759"><a href="#FST-2759"><span class="linenos">2759</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2760"><a href="#FST-2760"><span class="linenos">2760</span></a>
</span><span id="FST-2761"><a href="#FST-2761"><span class="linenos">2761</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">:</span>
</span><span id="FST-2762"><a href="#FST-2762"><span class="linenos">2762</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-2763"><a href="#FST-2763"><span class="linenos">2763</span></a>
</span><span id="FST-2764"><a href="#FST-2764"><span class="linenos">2764</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-2765"><a href="#FST-2765"><span class="linenos">2765</span></a>
</span><span id="FST-2766"><a href="#FST-2766"><span class="linenos">2766</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">expr_context</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">,</span> <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">)):</span>
</span><span id="FST-2767"><a href="#FST-2767"><span class="linenos">2767</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-2768"><a href="#FST-2768"><span class="linenos">2768</span></a>
</span><span id="FST-2769"><a href="#FST-2769"><span class="linenos">2769</span></a>        <span class="k">elif</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST-2770"><a href="#FST-2770"><span class="linenos">2770</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">):</span>  <span class="c1"># TemplateStr doesn&#39;t go into a .format_spec, &#39;.1f&#39; type strings without quote delimiters</span>
</span><span id="FST-2771"><a href="#FST-2771"><span class="linenos">2771</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;format_spec&#39;</span><span class="p">:</span>  <span class="c1"># isinstance(parent.a, (FormattedValue, Interpolation)):</span>
</span><span id="FST-2772"><a href="#FST-2772"><span class="linenos">2772</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-2773"><a href="#FST-2773"><span class="linenos">2773</span></a>
</span><span id="FST-2774"><a href="#FST-2774"><span class="linenos">2774</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>  <span class="c1"># string parts of f-string without quote delimiters</span>
</span><span id="FST-2775"><a href="#FST-2775"><span class="linenos">2775</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;values&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">)):</span>  <span class="c1"># isinstance(ast.value, str)</span>
</span><span id="FST-2776"><a href="#FST-2776"><span class="linenos">2776</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-2777"><a href="#FST-2777"><span class="linenos">2777</span></a>
</span><span id="FST-2778"><a href="#FST-2778"><span class="linenos">2778</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-2779"><a href="#FST-2779"><span class="linenos">2779</span></a>
</span><span id="FST-2780"><a href="#FST-2780"><span class="linenos">2780</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parenthesizable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-2781"><a href="#FST-2781"><span class="linenos">2781</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is parenthesizable with grouping parentheses or now. Essentially all `expr`s and `pattern`s</span>
</span><span id="FST-2782"><a href="#FST-2782"><span class="linenos">2782</span></a><span class="sd">        except for `Slice`.</span>
</span><span id="FST-2783"><a href="#FST-2783"><span class="linenos">2783</span></a>
</span><span id="FST-2784"><a href="#FST-2784"><span class="linenos">2784</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2785"><a href="#FST-2785"><span class="linenos">2785</span></a><span class="sd">        - `bool`: Whether is syntactically legal to add grouping parentheses or not. Can always be forced.</span>
</span><span id="FST-2786"><a href="#FST-2786"><span class="linenos">2786</span></a>
</span><span id="FST-2787"><a href="#FST-2787"><span class="linenos">2787</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2788"><a href="#FST-2788"><span class="linenos">2788</span></a><span class="sd">        ```py</span>
</span><span id="FST-2789"><a href="#FST-2789"><span class="linenos">2789</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i + j&#39;).is_parenthesizable()  # expr</span>
</span><span id="FST-2790"><a href="#FST-2790"><span class="linenos">2790</span></a><span class="sd">        True</span>
</span><span id="FST-2791"><a href="#FST-2791"><span class="linenos">2791</span></a>
</span><span id="FST-2792"><a href="#FST-2792"><span class="linenos">2792</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{a.b: c, **d}&#39;, &#39;pattern&#39;).is_parenthesizable()</span>
</span><span id="FST-2793"><a href="#FST-2793"><span class="linenos">2793</span></a><span class="sd">        True</span>
</span><span id="FST-2794"><a href="#FST-2794"><span class="linenos">2794</span></a>
</span><span id="FST-2795"><a href="#FST-2795"><span class="linenos">2795</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;).is_parenthesizable()  # Slice</span>
</span><span id="FST-2796"><a href="#FST-2796"><span class="linenos">2796</span></a><span class="sd">        False</span>
</span><span id="FST-2797"><a href="#FST-2797"><span class="linenos">2797</span></a>
</span><span id="FST-2798"><a href="#FST-2798"><span class="linenos">2798</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;for i in j&#39;).is_parenthesizable()  # comprehension</span>
</span><span id="FST-2799"><a href="#FST-2799"><span class="linenos">2799</span></a><span class="sd">        False</span>
</span><span id="FST-2800"><a href="#FST-2800"><span class="linenos">2800</span></a>
</span><span id="FST-2801"><a href="#FST-2801"><span class="linenos">2801</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a: int, b=2&#39;).is_parenthesizable()  # arguments</span>
</span><span id="FST-2802"><a href="#FST-2802"><span class="linenos">2802</span></a><span class="sd">        False</span>
</span><span id="FST-2803"><a href="#FST-2803"><span class="linenos">2803</span></a>
</span><span id="FST-2804"><a href="#FST-2804"><span class="linenos">2804</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a: int&#39;, &#39;arg&#39;).is_parenthesizable()</span>
</span><span id="FST-2805"><a href="#FST-2805"><span class="linenos">2805</span></a><span class="sd">        False</span>
</span><span id="FST-2806"><a href="#FST-2806"><span class="linenos">2806</span></a>
</span><span id="FST-2807"><a href="#FST-2807"><span class="linenos">2807</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;key=&quot;word&quot;&#39;, &#39;keyword&#39;).is_parenthesizable()</span>
</span><span id="FST-2808"><a href="#FST-2808"><span class="linenos">2808</span></a><span class="sd">        False</span>
</span><span id="FST-2809"><a href="#FST-2809"><span class="linenos">2809</span></a>
</span><span id="FST-2810"><a href="#FST-2810"><span class="linenos">2810</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a as b&#39;, &#39;alias&#39;).is_parenthesizable()</span>
</span><span id="FST-2811"><a href="#FST-2811"><span class="linenos">2811</span></a><span class="sd">        False</span>
</span><span id="FST-2812"><a href="#FST-2812"><span class="linenos">2812</span></a>
</span><span id="FST-2813"><a href="#FST-2813"><span class="linenos">2813</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a as b&#39;, &#39;withitem&#39;).is_parenthesizable()</span>
</span><span id="FST-2814"><a href="#FST-2814"><span class="linenos">2814</span></a><span class="sd">        False</span>
</span><span id="FST-2815"><a href="#FST-2815"><span class="linenos">2815</span></a><span class="sd">        ```</span>
</span><span id="FST-2816"><a href="#FST-2816"><span class="linenos">2816</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2817"><a href="#FST-2817"><span class="linenos">2817</span></a>
</span><span id="FST-2818"><a href="#FST-2818"><span class="linenos">2818</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">else</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
</span><span id="FST-2819"><a href="#FST-2819"><span class="linenos">2819</span></a>
</span><span id="FST-2820"><a href="#FST-2820"><span class="linenos">2820</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">always_enclosed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;unenclosable&#39;</span><span class="p">,</span> <span class="s1">&#39;pars&#39;</span><span class="p">]:</span>
</span><span id="FST-2821"><a href="#FST-2821"><span class="linenos">2821</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is innately atomic precedence-wise like `Name`, `Constant`, `List`, etc... Or otherwise</span>
</span><span id="FST-2822"><a href="#FST-2822"><span class="linenos">2822</span></a><span class="sd">        optionally enclosed in parentheses so that it functions as a parsable atom and cannot be split up by precedence</span>
</span><span id="FST-2823"><a href="#FST-2823"><span class="linenos">2823</span></a><span class="sd">        rules when reparsed.</span>
</span><span id="FST-2824"><a href="#FST-2824"><span class="linenos">2824</span></a>
</span><span id="FST-2825"><a href="#FST-2825"><span class="linenos">2825</span></a><span class="sd">        Node types where this doesn&#39;t normally apply like `stmt` or `alias` return `True`.</span>
</span><span id="FST-2826"><a href="#FST-2826"><span class="linenos">2826</span></a>
</span><span id="FST-2827"><a href="#FST-2827"><span class="linenos">2827</span></a><span class="sd">        Being atomic precedence-wise does not guarantee parsability as an otherwise atomic node could be spread across</span>
</span><span id="FST-2828"><a href="#FST-2828"><span class="linenos">2828</span></a><span class="sd">        multiple lines without line continuations or grouping parentheses, in this case `&#39;unenclosable&#39;` is returned (if</span>
</span><span id="FST-2829"><a href="#FST-2829"><span class="linenos">2829</span></a><span class="sd">        these nodes are not excluded altogether with `always_enclosed=True`). Also see `is_enclosed()`.</span>
</span><span id="FST-2830"><a href="#FST-2830"><span class="linenos">2830</span></a>
</span><span id="FST-2831"><a href="#FST-2831"><span class="linenos">2831</span></a><span class="sd">        If this function returns `&#39;pars&#39;` then `self` is enclosed due to the grouping parentheses.</span>
</span><span id="FST-2832"><a href="#FST-2832"><span class="linenos">2832</span></a>
</span><span id="FST-2833"><a href="#FST-2833"><span class="linenos">2833</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2834"><a href="#FST-2834"><span class="linenos">2834</span></a><span class="sd">        - `pars`: Whether to check for grouping parentheses or not for node types which are not innately atomic</span>
</span><span id="FST-2835"><a href="#FST-2835"><span class="linenos">2835</span></a><span class="sd">            (`NamedExpr`, `BinOp`, `Yield`, etc...). If `True` then `(a + b)` is considered atomic, if `False` then it</span>
</span><span id="FST-2836"><a href="#FST-2836"><span class="linenos">2836</span></a><span class="sd">            is not.</span>
</span><span id="FST-2837"><a href="#FST-2837"><span class="linenos">2837</span></a><span class="sd">        - `always_enclosed`: If `True` then will only consider nodes innately atomic which are always enclosed like</span>
</span><span id="FST-2838"><a href="#FST-2838"><span class="linenos">2838</span></a><span class="sd">            `List` or parenthesized `Tuple`. Nodes which may be split up across multiple lines like `Call` or</span>
</span><span id="FST-2839"><a href="#FST-2839"><span class="linenos">2839</span></a><span class="sd">            `Attribute` will not be considered atomic and will return `False` unless `pars=True` and grouping</span>
</span><span id="FST-2840"><a href="#FST-2840"><span class="linenos">2840</span></a><span class="sd">            parentheses present, in which case `&#39;pars&#39;` is returned.</span>
</span><span id="FST-2841"><a href="#FST-2841"><span class="linenos">2841</span></a>
</span><span id="FST-2842"><a href="#FST-2842"><span class="linenos">2842</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2843"><a href="#FST-2843"><span class="linenos">2843</span></a><span class="sd">        - `True`: Is atomic and no combination of changes in the source will make it parse to a different node.</span>
</span><span id="FST-2844"><a href="#FST-2844"><span class="linenos">2844</span></a><span class="sd">        - `&#39;unenclosable&#39;`: Is atomic precedence-wise but may be made non-parsable by being spread over multiple lines.</span>
</span><span id="FST-2845"><a href="#FST-2845"><span class="linenos">2845</span></a><span class="sd">        - `&#39;pars&#39;`: Is atomic due to enclosing grouping parentheses and would not be otherwise, can not be returned for</span>
</span><span id="FST-2846"><a href="#FST-2846"><span class="linenos">2846</span></a><span class="sd">            `&#39;unenclosable&#39;` nodes if `always_enclosed=False`.</span>
</span><span id="FST-2847"><a href="#FST-2847"><span class="linenos">2847</span></a><span class="sd">        - `False`: Not atomic.</span>
</span><span id="FST-2848"><a href="#FST-2848"><span class="linenos">2848</span></a>
</span><span id="FST-2849"><a href="#FST-2849"><span class="linenos">2849</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2850"><a href="#FST-2850"><span class="linenos">2850</span></a><span class="sd">        ```py</span>
</span><span id="FST-2851"><a href="#FST-2851"><span class="linenos">2851</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a&#39;).is_atom()</span>
</span><span id="FST-2852"><a href="#FST-2852"><span class="linenos">2852</span></a><span class="sd">        True</span>
</span><span id="FST-2853"><a href="#FST-2853"><span class="linenos">2853</span></a>
</span><span id="FST-2854"><a href="#FST-2854"><span class="linenos">2854</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).is_atom()</span>
</span><span id="FST-2855"><a href="#FST-2855"><span class="linenos">2855</span></a><span class="sd">        False</span>
</span><span id="FST-2856"><a href="#FST-2856"><span class="linenos">2856</span></a>
</span><span id="FST-2857"><a href="#FST-2857"><span class="linenos">2857</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).is_atom()</span>
</span><span id="FST-2858"><a href="#FST-2858"><span class="linenos">2858</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="FST-2859"><a href="#FST-2859"><span class="linenos">2859</span></a>
</span><span id="FST-2860"><a href="#FST-2860"><span class="linenos">2860</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).is_atom(pars=False)</span>
</span><span id="FST-2861"><a href="#FST-2861"><span class="linenos">2861</span></a><span class="sd">        False</span>
</span><span id="FST-2862"><a href="#FST-2862"><span class="linenos">2862</span></a>
</span><span id="FST-2863"><a href="#FST-2863"><span class="linenos">2863</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a.b&#39;).is_atom()</span>
</span><span id="FST-2864"><a href="#FST-2864"><span class="linenos">2864</span></a><span class="sd">        &#39;unenclosable&#39;</span>
</span><span id="FST-2865"><a href="#FST-2865"><span class="linenos">2865</span></a>
</span><span id="FST-2866"><a href="#FST-2866"><span class="linenos">2866</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a.b&#39;).is_atom(always_enclosed=True)  # because of &quot;a\n.b&quot;</span>
</span><span id="FST-2867"><a href="#FST-2867"><span class="linenos">2867</span></a><span class="sd">        False</span>
</span><span id="FST-2868"><a href="#FST-2868"><span class="linenos">2868</span></a>
</span><span id="FST-2869"><a href="#FST-2869"><span class="linenos">2869</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a.b)&#39;).is_atom(always_enclosed=True)</span>
</span><span id="FST-2870"><a href="#FST-2870"><span class="linenos">2870</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="FST-2871"><a href="#FST-2871"><span class="linenos">2871</span></a>
</span><span id="FST-2872"><a href="#FST-2872"><span class="linenos">2872</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_atom(always_enclosed=True)  # because List is always enclosed</span>
</span><span id="FST-2873"><a href="#FST-2873"><span class="linenos">2873</span></a><span class="sd">        True</span>
</span><span id="FST-2874"><a href="#FST-2874"><span class="linenos">2874</span></a><span class="sd">        ```</span>
</span><span id="FST-2875"><a href="#FST-2875"><span class="linenos">2875</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2876"><a href="#FST-2876"><span class="linenos">2876</span></a>
</span><span id="FST-2877"><a href="#FST-2877"><span class="linenos">2877</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-2878"><a href="#FST-2878"><span class="linenos">2878</span></a>
</span><span id="FST-2879"><a href="#FST-2879"><span class="linenos">2879</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span>
</span><span id="FST-2880"><a href="#FST-2880"><span class="linenos">2880</span></a>                            <span class="n">MatchValue</span><span class="p">,</span> <span class="n">MatchSingleton</span><span class="p">,</span> <span class="n">MatchMapping</span><span class="p">,</span>
</span><span id="FST-2881"><a href="#FST-2881"><span class="linenos">2881</span></a>                            <span class="n">expr_context</span><span class="p">,</span> <span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span>
</span><span id="FST-2882"><a href="#FST-2882"><span class="linenos">2882</span></a>                            <span class="n">stmt</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="FST-2883"><a href="#FST-2883"><span class="linenos">2883</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-2884"><a href="#FST-2884"><span class="linenos">2884</span></a>
</span><span id="FST-2885"><a href="#FST-2885"><span class="linenos">2885</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">always_enclosed</span><span class="p">:</span>
</span><span id="FST-2886"><a href="#FST-2886"><span class="linenos">2886</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="FST-2887"><a href="#FST-2887"><span class="linenos">2887</span></a>                <span class="k">return</span> <span class="s1">&#39;unenclosable&#39;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="FST-2888"><a href="#FST-2888"><span class="linenos">2888</span></a>
</span><span id="FST-2889"><a href="#FST-2889"><span class="linenos">2889</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">Call</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">,</span> <span class="n">Constant</span><span class="p">,</span> <span class="n">Attribute</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">,</span>
</span><span id="FST-2890"><a href="#FST-2890"><span class="linenos">2890</span></a>                                <span class="n">MatchClass</span><span class="p">,</span> <span class="n">MatchStar</span><span class="p">,</span>
</span><span id="FST-2891"><a href="#FST-2891"><span class="linenos">2891</span></a>                                <span class="n">cmpop</span><span class="p">,</span> <span class="n">comprehension</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span>
</span><span id="FST-2892"><a href="#FST-2892"><span class="linenos">2892</span></a>                                <span class="n">arg</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">withitem</span><span class="p">,</span> <span class="n">type_param</span><span class="p">)):</span>
</span><span id="FST-2893"><a href="#FST-2893"><span class="linenos">2893</span></a>                <span class="k">return</span> <span class="s1">&#39;unenclosable&#39;</span>
</span><span id="FST-2894"><a href="#FST-2894"><span class="linenos">2894</span></a>
</span><span id="FST-2895"><a href="#FST-2895"><span class="linenos">2895</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">comprehension</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">type_param</span><span class="p">)):</span>  <span class="c1"># can&#39;t be parenthesized</span>
</span><span id="FST-2896"><a href="#FST-2896"><span class="linenos">2896</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-2897"><a href="#FST-2897"><span class="linenos">2897</span></a>
</span><span id="FST-2898"><a href="#FST-2898"><span class="linenos">2898</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="FST-2899"><a href="#FST-2899"><span class="linenos">2899</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>  <span class="c1"># str and bytes can be multiline implicit needing parentheses</span>
</span><span id="FST-2900"><a href="#FST-2900"><span class="linenos">2900</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-2901"><a href="#FST-2901"><span class="linenos">2901</span></a>
</span><span id="FST-2902"><a href="#FST-2902"><span class="linenos">2902</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">withitem</span><span class="p">):</span>  <span class="c1"># isn&#39;t atom on its own and can&#39;t be parenthesized directly but if only has context_expr then take on value of that if starts and ends on same lines</span>
</span><span id="FST-2903"><a href="#FST-2903"><span class="linenos">2903</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">optional_vars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">ce</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">context_expr</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()[::</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span>
</span><span id="FST-2904"><a href="#FST-2904"><span class="linenos">2904</span></a>                    <span class="n">ce</span><span class="o">.</span><span class="n">is_atom</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="n">pars</span><span class="p">,</span> <span class="n">always_enclosed</span><span class="o">=</span><span class="n">always_enclosed</span><span class="p">))</span>
</span><span id="FST-2905"><a href="#FST-2905"><span class="linenos">2905</span></a>
</span><span id="FST-2906"><a href="#FST-2906"><span class="linenos">2906</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">cmpop</span><span class="p">):</span>
</span><span id="FST-2907"><a href="#FST-2907"><span class="linenos">2907</span></a>            <span class="k">return</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">IsNot</span><span class="p">,</span> <span class="n">NotIn</span><span class="p">))</span>  <span class="c1"># could be spread across multiple lines</span>
</span><span id="FST-2908"><a href="#FST-2908"><span class="linenos">2908</span></a>
</span><span id="FST-2909"><a href="#FST-2909"><span class="linenos">2909</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># if this is False then cannot be enclosed in grouping pars because that would reparse to a parenthesized Tuple and so is inconsistent</span>
</span><span id="FST-2910"><a href="#FST-2910"><span class="linenos">2910</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="FST-2911"><a href="#FST-2911"><span class="linenos">2911</span></a>
</span><span id="FST-2912"><a href="#FST-2912"><span class="linenos">2912</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># like Tuple, cannot be enclosed in grouping pars</span>
</span><span id="FST-2913"><a href="#FST-2913"><span class="linenos">2913</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="FST-2914"><a href="#FST-2914"><span class="linenos">2914</span></a>
</span><span id="FST-2915"><a href="#FST-2915"><span class="linenos">2915</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">pattern</span><span class="p">))</span>
</span><span id="FST-2916"><a href="#FST-2916"><span class="linenos">2916</span></a>
</span><span id="FST-2917"><a href="#FST-2917"><span class="linenos">2917</span></a>        <span class="k">return</span> <span class="s1">&#39;pars&#39;</span> <span class="k">if</span> <span class="n">pars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="FST-2918"><a href="#FST-2918"><span class="linenos">2918</span></a>
</span><span id="FST-2919"><a href="#FST-2919"><span class="linenos">2919</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pars&#39;</span><span class="p">]:</span>
</span><span id="FST-2920"><a href="#FST-2920"><span class="linenos">2920</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` lives on a single line or is otherwise enclosed in some kind of delimiters `()`, `[]`, `{}` or</span>
</span><span id="FST-2921"><a href="#FST-2921"><span class="linenos">2921</span></a><span class="sd">        entirely terminated with line continuations so that it can be parsed without error due to being spread across</span>
</span><span id="FST-2922"><a href="#FST-2922"><span class="linenos">2922</span></a><span class="sd">        multiple lines. This does not mean it can&#39;t have other errors, such as a `Slice` outside of `Subscript.slice`.</span>
</span><span id="FST-2923"><a href="#FST-2923"><span class="linenos">2923</span></a>
</span><span id="FST-2924"><a href="#FST-2924"><span class="linenos">2924</span></a><span class="sd">        Node types where this doesn&#39;t normally apply like `stmt`, `ExceptHandler`, `boolop`, `expr_context`, etc...</span>
</span><span id="FST-2925"><a href="#FST-2925"><span class="linenos">2925</span></a><span class="sd">        return `True`. Node types that are not enclosed but which are never used without being enclosed by a parent like</span>
</span><span id="FST-2926"><a href="#FST-2926"><span class="linenos">2926</span></a><span class="sd">        `Slice`, `keyword` or `type_param` will also return `True`. Other node types which cannot be enclosed</span>
</span><span id="FST-2927"><a href="#FST-2927"><span class="linenos">2927</span></a><span class="sd">        individually and are not on a single line or not parenthesized and do not have line continuations but would need</span>
</span><span id="FST-2928"><a href="#FST-2928"><span class="linenos">2928</span></a><span class="sd">        a parent to enclose them like `arguments` or the `cmpop`s `is not` or `not in` will return `False`.</span>
</span><span id="FST-2929"><a href="#FST-2929"><span class="linenos">2929</span></a>
</span><span id="FST-2930"><a href="#FST-2930"><span class="linenos">2930</span></a><span class="sd">        This function does NOT check whether `self` is enclosed by some parent up the tree if it is not enclosed itself,</span>
</span><span id="FST-2931"><a href="#FST-2931"><span class="linenos">2931</span></a><span class="sd">        for that see `is_enclosed_in_parents()`.</span>
</span><span id="FST-2932"><a href="#FST-2932"><span class="linenos">2932</span></a>
</span><span id="FST-2933"><a href="#FST-2933"><span class="linenos">2933</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-2934"><a href="#FST-2934"><span class="linenos">2934</span></a><span class="sd">        - `pars`: Whether to check for grouping parentheses or not for nodes which are not enclosed or otherwise</span>
</span><span id="FST-2935"><a href="#FST-2935"><span class="linenos">2935</span></a><span class="sd">            multiline-safe. Grouping parentheses are different from tuple parentheses which are always checked.</span>
</span><span id="FST-2936"><a href="#FST-2936"><span class="linenos">2936</span></a>
</span><span id="FST-2937"><a href="#FST-2937"><span class="linenos">2937</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-2938"><a href="#FST-2938"><span class="linenos">2938</span></a><span class="sd">        - `True`: Mode is enclosed.</span>
</span><span id="FST-2939"><a href="#FST-2939"><span class="linenos">2939</span></a><span class="sd">        - `&#39;pars&#39;` Enclosed by grouping parentheses and would not be otherwise.</span>
</span><span id="FST-2940"><a href="#FST-2940"><span class="linenos">2940</span></a><span class="sd">        - `False`: Not enclosed and should be parenthesized or put into an enclosed parent for successful parse.</span>
</span><span id="FST-2941"><a href="#FST-2941"><span class="linenos">2941</span></a>
</span><span id="FST-2942"><a href="#FST-2942"><span class="linenos">2942</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-2943"><a href="#FST-2943"><span class="linenos">2943</span></a><span class="sd">        ```py</span>
</span><span id="FST-2944"><a href="#FST-2944"><span class="linenos">2944</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a&#39;).is_enclosed()</span>
</span><span id="FST-2945"><a href="#FST-2945"><span class="linenos">2945</span></a><span class="sd">        True</span>
</span><span id="FST-2946"><a href="#FST-2946"><span class="linenos">2946</span></a>
</span><span id="FST-2947"><a href="#FST-2947"><span class="linenos">2947</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + \\\n b&#39;).is_enclosed()  # because of the line continuation</span>
</span><span id="FST-2948"><a href="#FST-2948"><span class="linenos">2948</span></a><span class="sd">        True</span>
</span><span id="FST-2949"><a href="#FST-2949"><span class="linenos">2949</span></a>
</span><span id="FST-2950"><a href="#FST-2950"><span class="linenos">2950</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + \n b)&#39;).is_enclosed()</span>
</span><span id="FST-2951"><a href="#FST-2951"><span class="linenos">2951</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="FST-2952"><a href="#FST-2952"><span class="linenos">2952</span></a>
</span><span id="FST-2953"><a href="#FST-2953"><span class="linenos">2953</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + \n b&#39;).is_enclosed()</span>
</span><span id="FST-2954"><a href="#FST-2954"><span class="linenos">2954</span></a><span class="sd">        False</span>
</span><span id="FST-2955"><a href="#FST-2955"><span class="linenos">2955</span></a>
</span><span id="FST-2956"><a href="#FST-2956"><span class="linenos">2956</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[a + \n b]&#39;).elts[0].is_enclosed()</span>
</span><span id="FST-2957"><a href="#FST-2957"><span class="linenos">2957</span></a><span class="sd">        False</span>
</span><span id="FST-2958"><a href="#FST-2958"><span class="linenos">2958</span></a>
</span><span id="FST-2959"><a href="#FST-2959"><span class="linenos">2959</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[a + \n b]&#39;).elts[0].is_enclosed_in_parents()</span>
</span><span id="FST-2960"><a href="#FST-2960"><span class="linenos">2960</span></a><span class="sd">        True</span>
</span><span id="FST-2961"><a href="#FST-2961"><span class="linenos">2961</span></a>
</span><span id="FST-2962"><a href="#FST-2962"><span class="linenos">2962</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a, b): pass&#39;).args.is_enclosed()</span>
</span><span id="FST-2963"><a href="#FST-2963"><span class="linenos">2963</span></a><span class="sd">        True</span>
</span><span id="FST-2964"><a href="#FST-2964"><span class="linenos">2964</span></a>
</span><span id="FST-2965"><a href="#FST-2965"><span class="linenos">2965</span></a><span class="sd">        &gt;&gt;&gt; # because the parentheses belong to the FunctionDef</span>
</span><span id="FST-2966"><a href="#FST-2966"><span class="linenos">2966</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a,\n b): pass&#39;).args.is_enclosed()</span>
</span><span id="FST-2967"><a href="#FST-2967"><span class="linenos">2967</span></a><span class="sd">        False</span>
</span><span id="FST-2968"><a href="#FST-2968"><span class="linenos">2968</span></a>
</span><span id="FST-2969"><a href="#FST-2969"><span class="linenos">2969</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a,\n b): pass&#39;).args.is_enclosed_in_parents()</span>
</span><span id="FST-2970"><a href="#FST-2970"><span class="linenos">2970</span></a><span class="sd">        True</span>
</span><span id="FST-2971"><a href="#FST-2971"><span class="linenos">2971</span></a>
</span><span id="FST-2972"><a href="#FST-2972"><span class="linenos">2972</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a is not b)&#39;).ops[0].is_enclosed()</span>
</span><span id="FST-2973"><a href="#FST-2973"><span class="linenos">2973</span></a><span class="sd">        True</span>
</span><span id="FST-2974"><a href="#FST-2974"><span class="linenos">2974</span></a>
</span><span id="FST-2975"><a href="#FST-2975"><span class="linenos">2975</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a is \n not b)&#39;).ops[0].is_enclosed()</span>
</span><span id="FST-2976"><a href="#FST-2976"><span class="linenos">2976</span></a><span class="sd">        False</span>
</span><span id="FST-2977"><a href="#FST-2977"><span class="linenos">2977</span></a><span class="sd">        ```</span>
</span><span id="FST-2978"><a href="#FST-2978"><span class="linenos">2978</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-2979"><a href="#FST-2979"><span class="linenos">2979</span></a>
</span><span id="FST-2980"><a href="#FST-2980"><span class="linenos">2980</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-2981"><a href="#FST-2981"><span class="linenos">2981</span></a>
</span><span id="FST-2982"><a href="#FST-2982"><span class="linenos">2982</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span> <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">,</span>
</span><span id="FST-2983"><a href="#FST-2983"><span class="linenos">2983</span></a>                            <span class="n">Name</span><span class="p">,</span> <span class="n">Slice</span><span class="p">,</span>
</span><span id="FST-2984"><a href="#FST-2984"><span class="linenos">2984</span></a>                            <span class="n">MatchValue</span><span class="p">,</span> <span class="n">MatchSingleton</span><span class="p">,</span> <span class="n">MatchMapping</span><span class="p">,</span>
</span><span id="FST-2985"><a href="#FST-2985"><span class="linenos">2985</span></a>                            <span class="n">expr_context</span><span class="p">,</span> <span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">type_param</span><span class="p">,</span>
</span><span id="FST-2986"><a href="#FST-2986"><span class="linenos">2986</span></a>                            <span class="n">stmt</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="FST-2987"><a href="#FST-2987"><span class="linenos">2987</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-2988"><a href="#FST-2988"><span class="linenos">2988</span></a>
</span><span id="FST-2989"><a href="#FST-2989"><span class="linenos">2989</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">):</span>  <span class="c1"># this catches empty `arguments` mostly</span>
</span><span id="FST-2990"><a href="#FST-2990"><span class="linenos">2990</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-2991"><a href="#FST-2991"><span class="linenos">2991</span></a>
</span><span id="FST-2992"><a href="#FST-2992"><span class="linenos">2992</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="n">loc</span>
</span><span id="FST-2993"><a href="#FST-2993"><span class="linenos">2993</span></a>
</span><span id="FST-2994"><a href="#FST-2994"><span class="linenos">2994</span></a>        <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">:</span>
</span><span id="FST-2995"><a href="#FST-2995"><span class="linenos">2995</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-2996"><a href="#FST-2996"><span class="linenos">2996</span></a>
</span><span id="FST-2997"><a href="#FST-2997"><span class="linenos">2997</span></a>        <span class="k">if</span> <span class="n">pars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="FST-2998"><a href="#FST-2998"><span class="linenos">2998</span></a>            <span class="k">return</span> <span class="s1">&#39;pars&#39;</span>
</span><span id="FST-2999"><a href="#FST-2999"><span class="linenos">2999</span></a>
</span><span id="FST-3000"><a href="#FST-3000"><span class="linenos">3000</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="FST-3001"><a href="#FST-3001"><span class="linenos">3001</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
</span><span id="FST-3002"><a href="#FST-3002"><span class="linenos">3002</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3003"><a href="#FST-3003"><span class="linenos">3003</span></a>
</span><span id="FST-3004"><a href="#FST-3004"><span class="linenos">3004</span></a>            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_multiline_str_continuation_lns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">))</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="o">-</span> <span class="n">ln</span>
</span><span id="FST-3005"><a href="#FST-3005"><span class="linenos">3005</span></a>
</span><span id="FST-3006"><a href="#FST-3006"><span class="linenos">3006</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">)):</span>
</span><span id="FST-3007"><a href="#FST-3007"><span class="linenos">3007</span></a>            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_multiline_fstr_continuation_lns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">))</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="o">-</span> <span class="n">ln</span>
</span><span id="FST-3008"><a href="#FST-3008"><span class="linenos">3008</span></a>
</span><span id="FST-3009"><a href="#FST-3009"><span class="linenos">3009</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-3010"><a href="#FST-3010"><span class="linenos">3010</span></a>            <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="FST-3011"><a href="#FST-3011"><span class="linenos">3011</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3012"><a href="#FST-3012"><span class="linenos">3012</span></a>
</span><span id="FST-3013"><a href="#FST-3013"><span class="linenos">3013</span></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-3014"><a href="#FST-3014"><span class="linenos">3014</span></a>            <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="FST-3015"><a href="#FST-3015"><span class="linenos">3015</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3016"><a href="#FST-3016"><span class="linenos">3016</span></a>
</span><span id="FST-3017"><a href="#FST-3017"><span class="linenos">3017</span></a>        <span class="n">last_ln</span> <span class="o">=</span> <span class="n">ln</span>
</span><span id="FST-3018"><a href="#FST-3018"><span class="linenos">3018</span></a>        <span class="n">lines</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST-3019"><a href="#FST-3019"><span class="linenos">3019</span></a>
</span><span id="FST-3020"><a href="#FST-3020"><span class="linenos">3020</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Call</span><span class="p">):</span>
</span><span id="FST-3021"><a href="#FST-3021"><span class="linenos">3021</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">func</span><span class="p">,</span>
</span><span id="FST-3022"><a href="#FST-3022"><span class="linenos">3022</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_Call_pars</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="FST-3023"><a href="#FST-3023"><span class="linenos">3023</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">):</span>
</span><span id="FST-3024"><a href="#FST-3024"><span class="linenos">3024</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="FST-3025"><a href="#FST-3025"><span class="linenos">3025</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_Subscript_brackets</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="FST-3026"><a href="#FST-3026"><span class="linenos">3026</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">):</span>
</span><span id="FST-3027"><a href="#FST-3027"><span class="linenos">3027</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">cls</span><span class="p">,</span>
</span><span id="FST-3028"><a href="#FST-3028"><span class="linenos">3028</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_MatchClass_pars</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="FST-3029"><a href="#FST-3029"><span class="linenos">3029</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># we don&#39;t check always-enclosed statement fields here because statements will never get here</span>
</span><span id="FST-3030"><a href="#FST-3030"><span class="linenos">3030</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="n">syntax_ordered_children</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="FST-3031"><a href="#FST-3031"><span class="linenos">3031</span></a>
</span><span id="FST-3032"><a href="#FST-3032"><span class="linenos">3032</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
</span><span id="FST-3033"><a href="#FST-3033"><span class="linenos">3033</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="p">(</span><span class="n">childf</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="n">child_end_ln</span> <span class="o">:=</span> <span class="n">loc</span><span class="o">.</span><span class="n">end_ln</span><span class="p">)</span> <span class="o">==</span> <span class="n">last_ln</span><span class="p">:</span>
</span><span id="FST-3034"><a href="#FST-3034"><span class="linenos">3034</span></a>                <span class="k">continue</span>
</span><span id="FST-3035"><a href="#FST-3035"><span class="linenos">3035</span></a>
</span><span id="FST-3036"><a href="#FST-3036"><span class="linenos">3036</span></a>            <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_ln</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">ln</span><span class="p">):</span>
</span><span id="FST-3037"><a href="#FST-3037"><span class="linenos">3037</span></a>                <span class="k">if</span> <span class="n">re_line_end_cont_or_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="FST-3038"><a href="#FST-3038"><span class="linenos">3038</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-3039"><a href="#FST-3039"><span class="linenos">3039</span></a>
</span><span id="FST-3040"><a href="#FST-3040"><span class="linenos">3040</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">childf</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="FST-3041"><a href="#FST-3041"><span class="linenos">3041</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-3042"><a href="#FST-3042"><span class="linenos">3042</span></a>
</span><span id="FST-3043"><a href="#FST-3043"><span class="linenos">3043</span></a>            <span class="n">last_ln</span> <span class="o">=</span> <span class="n">child_end_ln</span>
</span><span id="FST-3044"><a href="#FST-3044"><span class="linenos">3044</span></a>
</span><span id="FST-3045"><a href="#FST-3045"><span class="linenos">3045</span></a>        <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_ln</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">):</span>  <span class="c1"># tail</span>
</span><span id="FST-3046"><a href="#FST-3046"><span class="linenos">3046</span></a>            <span class="k">if</span> <span class="n">re_line_end_cont_or_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="FST-3047"><a href="#FST-3047"><span class="linenos">3047</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-3048"><a href="#FST-3048"><span class="linenos">3048</span></a>
</span><span id="FST-3049"><a href="#FST-3049"><span class="linenos">3049</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3050"><a href="#FST-3050"><span class="linenos">3050</span></a>
</span><span id="FST-3051"><a href="#FST-3051"><span class="linenos">3051</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed_in_parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-3052"><a href="#FST-3052"><span class="linenos">3052</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is enclosed by some parent up the tree. This is different from `is_enclosed()` as it does not</span>
</span><span id="FST-3053"><a href="#FST-3053"><span class="linenos">3053</span></a><span class="sd">        check for line continuations or anyting like that, just enclosing delimiters like from `Call` or `FunctionDef`</span>
</span><span id="FST-3054"><a href="#FST-3054"><span class="linenos">3054</span></a><span class="sd">        arguments parentheses, `List` brackets, `FormattedValue`, parent grouping parentheses, etc... Statements do not</span>
</span><span id="FST-3055"><a href="#FST-3055"><span class="linenos">3055</span></a><span class="sd">        generally enclose except for a few parts of things like `FunctionDef.args` or `type_params`, `ClassDef.bases`,</span>
</span><span id="FST-3056"><a href="#FST-3056"><span class="linenos">3056</span></a><span class="sd">        etc...</span>
</span><span id="FST-3057"><a href="#FST-3057"><span class="linenos">3057</span></a>
</span><span id="FST-3058"><a href="#FST-3058"><span class="linenos">3058</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST-3059"><a href="#FST-3059"><span class="linenos">3059</span></a><span class="sd">        - `field`: This is meant to allow check for nonexistent child which would go into this field of `self`. If this</span>
</span><span id="FST-3060"><a href="#FST-3060"><span class="linenos">3060</span></a><span class="sd">            is not `None` then `self` is considered the first parent with an imaginary child being checked at `field`.</span>
</span><span id="FST-3061"><a href="#FST-3061"><span class="linenos">3061</span></a>
</span><span id="FST-3062"><a href="#FST-3062"><span class="linenos">3062</span></a><span class="sd">        **WARNING!** This will not pick up parentheses which belong to `self` and the rules for this can be confusing. E.g.</span>
</span><span id="FST-3063"><a href="#FST-3063"><span class="linenos">3063</span></a><span class="sd">        in `with (x): pass` the parentheses belong to the variable `x` while `with (x as y): pass` they belong to the</span>
</span><span id="FST-3064"><a href="#FST-3064"><span class="linenos">3064</span></a><span class="sd">        `with` because `alias`es cannot be parenthesized.</span>
</span><span id="FST-3065"><a href="#FST-3065"><span class="linenos">3065</span></a>
</span><span id="FST-3066"><a href="#FST-3066"><span class="linenos">3066</span></a><span class="sd">        Will pick up parentheses which belong to `self` if `field` is passed because in that case `self` is considered</span>
</span><span id="FST-3067"><a href="#FST-3067"><span class="linenos">3067</span></a><span class="sd">        the first parent and we are really considering the node which would live at `field`, whether it exists or not.</span>
</span><span id="FST-3068"><a href="#FST-3068"><span class="linenos">3068</span></a>
</span><span id="FST-3069"><a href="#FST-3069"><span class="linenos">3069</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3070"><a href="#FST-3070"><span class="linenos">3070</span></a><span class="sd">        ```py</span>
</span><span id="FST-3071"><a href="#FST-3071"><span class="linenos">3071</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1 + 2&#39;).left.is_enclosed_in_parents()</span>
</span><span id="FST-3072"><a href="#FST-3072"><span class="linenos">3072</span></a><span class="sd">        False</span>
</span><span id="FST-3073"><a href="#FST-3073"><span class="linenos">3073</span></a>
</span><span id="FST-3074"><a href="#FST-3074"><span class="linenos">3074</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1 + 2)&#39;).left.is_enclosed_in_parents()</span>
</span><span id="FST-3075"><a href="#FST-3075"><span class="linenos">3075</span></a><span class="sd">        True</span>
</span><span id="FST-3076"><a href="#FST-3076"><span class="linenos">3076</span></a>
</span><span id="FST-3077"><a href="#FST-3077"><span class="linenos">3077</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1 + 2)&#39;).is_enclosed_in_parents()  # because owns the parentheses</span>
</span><span id="FST-3078"><a href="#FST-3078"><span class="linenos">3078</span></a><span class="sd">        False</span>
</span><span id="FST-3079"><a href="#FST-3079"><span class="linenos">3079</span></a>
</span><span id="FST-3080"><a href="#FST-3080"><span class="linenos">3080</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1 + 2]&#39;).elts[0].left.is_enclosed_in_parents()</span>
</span><span id="FST-3081"><a href="#FST-3081"><span class="linenos">3081</span></a><span class="sd">        True</span>
</span><span id="FST-3082"><a href="#FST-3082"><span class="linenos">3082</span></a>
</span><span id="FST-3083"><a href="#FST-3083"><span class="linenos">3083</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1 + 2]&#39;).elts[0].is_enclosed_in_parents()</span>
</span><span id="FST-3084"><a href="#FST-3084"><span class="linenos">3084</span></a><span class="sd">        True</span>
</span><span id="FST-3085"><a href="#FST-3085"><span class="linenos">3085</span></a>
</span><span id="FST-3086"><a href="#FST-3086"><span class="linenos">3086</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f(1)&#39;).args[0].is_enclosed_in_parents()</span>
</span><span id="FST-3087"><a href="#FST-3087"><span class="linenos">3087</span></a><span class="sd">        True</span>
</span><span id="FST-3088"><a href="#FST-3088"><span class="linenos">3088</span></a>
</span><span id="FST-3089"><a href="#FST-3089"><span class="linenos">3089</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{1}&quot;&#39;).values[0].value.is_enclosed_in_parents()</span>
</span><span id="FST-3090"><a href="#FST-3090"><span class="linenos">3090</span></a><span class="sd">        True</span>
</span><span id="FST-3091"><a href="#FST-3091"><span class="linenos">3091</span></a>
</span><span id="FST-3092"><a href="#FST-3092"><span class="linenos">3092</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_enclosed_in_parents()</span>
</span><span id="FST-3093"><a href="#FST-3093"><span class="linenos">3093</span></a><span class="sd">        False</span>
</span><span id="FST-3094"><a href="#FST-3094"><span class="linenos">3094</span></a>
</span><span id="FST-3095"><a href="#FST-3095"><span class="linenos">3095</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_enclosed_in_parents(field=&#39;elts&#39;)</span>
</span><span id="FST-3096"><a href="#FST-3096"><span class="linenos">3096</span></a><span class="sd">        True</span>
</span><span id="FST-3097"><a href="#FST-3097"><span class="linenos">3097</span></a>
</span><span id="FST-3098"><a href="#FST-3098"><span class="linenos">3098</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;with (x): pass&#39;).items[0].is_enclosed_in_parents()</span>
</span><span id="FST-3099"><a href="#FST-3099"><span class="linenos">3099</span></a><span class="sd">        False</span>
</span><span id="FST-3100"><a href="#FST-3100"><span class="linenos">3100</span></a>
</span><span id="FST-3101"><a href="#FST-3101"><span class="linenos">3101</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;with (x as y): pass&#39;).items[0].is_enclosed_in_parents()</span>
</span><span id="FST-3102"><a href="#FST-3102"><span class="linenos">3102</span></a><span class="sd">        True</span>
</span><span id="FST-3103"><a href="#FST-3103"><span class="linenos">3103</span></a><span class="sd">        ```</span>
</span><span id="FST-3104"><a href="#FST-3104"><span class="linenos">3104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3105"><a href="#FST-3105"><span class="linenos">3105</span></a>
</span><span id="FST-3106"><a href="#FST-3106"><span class="linenos">3106</span></a>        <span class="k">if</span> <span class="n">field</span><span class="p">:</span>
</span><span id="FST-3107"><a href="#FST-3107"><span class="linenos">3107</span></a>            <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="s1">&#39;ctx&#39;</span><span class="p">:</span>  <span class="c1"># so that the `ctx` of a List is not considered enclosed</span>
</span><span id="FST-3108"><a href="#FST-3108"><span class="linenos">3108</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">nspace</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">pfield</span><span class="o">=</span><span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
</span><span id="FST-3109"><a href="#FST-3109"><span class="linenos">3109</span></a>
</span><span id="FST-3110"><a href="#FST-3110"><span class="linenos">3110</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">expr_context</span><span class="p">):</span>  <span class="c1"># so that the `ctx` of a List is not considered enclosed</span>
</span><span id="FST-3111"><a href="#FST-3111"><span class="linenos">3111</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST-3112"><a href="#FST-3112"><span class="linenos">3112</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-3113"><a href="#FST-3113"><span class="linenos">3113</span></a>
</span><span id="FST-3114"><a href="#FST-3114"><span class="linenos">3114</span></a>        <span class="k">while</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST-3115"><a href="#FST-3115"><span class="linenos">3115</span></a>            <span class="n">parenta</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST-3116"><a href="#FST-3116"><span class="linenos">3116</span></a>
</span><span id="FST-3117"><a href="#FST-3117"><span class="linenos">3117</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span>
</span><span id="FST-3118"><a href="#FST-3118"><span class="linenos">3118</span></a>                                    <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">,</span>
</span><span id="FST-3119"><a href="#FST-3119"><span class="linenos">3119</span></a>                                    <span class="n">MatchMapping</span><span class="p">)):</span>
</span><span id="FST-3120"><a href="#FST-3120"><span class="linenos">3120</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3121"><a href="#FST-3121"><span class="linenos">3121</span></a>
</span><span id="FST-3122"><a href="#FST-3122"><span class="linenos">3122</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">AsyncFunctionDef</span><span class="p">)):</span>
</span><span id="FST-3123"><a href="#FST-3123"><span class="linenos">3123</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span>
</span><span id="FST-3124"><a href="#FST-3124"><span class="linenos">3124</span></a>
</span><span id="FST-3125"><a href="#FST-3125"><span class="linenos">3125</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">ClassDef</span><span class="p">):</span>
</span><span id="FST-3126"><a href="#FST-3126"><span class="linenos">3126</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="s1">&#39;bases&#39;</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">)</span>
</span><span id="FST-3127"><a href="#FST-3127"><span class="linenos">3127</span></a>
</span><span id="FST-3128"><a href="#FST-3128"><span class="linenos">3128</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">TypeAlias</span><span class="p">):</span>
</span><span id="FST-3129"><a href="#FST-3129"><span class="linenos">3129</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;type_params&#39;</span>
</span><span id="FST-3130"><a href="#FST-3130"><span class="linenos">3130</span></a>
</span><span id="FST-3131"><a href="#FST-3131"><span class="linenos">3131</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">ImportFrom</span><span class="p">):</span>
</span><span id="FST-3132"><a href="#FST-3132"><span class="linenos">3132</span></a>                <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_is_parenthesized_ImportFrom_names</span><span class="p">()</span>  <span class="c1"># we know we are in `names`</span>
</span><span id="FST-3133"><a href="#FST-3133"><span class="linenos">3133</span></a>
</span><span id="FST-3134"><a href="#FST-3134"><span class="linenos">3134</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">With</span><span class="p">,</span> <span class="n">AsyncWith</span><span class="p">)):</span>
</span><span id="FST-3135"><a href="#FST-3135"><span class="linenos">3135</span></a>                <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_is_parenthesized_With_items</span><span class="p">()</span>  <span class="c1"># we know we are in `names`</span>
</span><span id="FST-3136"><a href="#FST-3136"><span class="linenos">3136</span></a>
</span><span id="FST-3137"><a href="#FST-3137"><span class="linenos">3137</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="FST-3138"><a href="#FST-3138"><span class="linenos">3138</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-3139"><a href="#FST-3139"><span class="linenos">3139</span></a>
</span><span id="FST-3140"><a href="#FST-3140"><span class="linenos">3140</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">Call</span><span class="p">):</span>
</span><span id="FST-3141"><a href="#FST-3141"><span class="linenos">3141</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;args&#39;</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">):</span>
</span><span id="FST-3142"><a href="#FST-3142"><span class="linenos">3142</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3143"><a href="#FST-3143"><span class="linenos">3143</span></a>
</span><span id="FST-3144"><a href="#FST-3144"><span class="linenos">3144</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">):</span>
</span><span id="FST-3145"><a href="#FST-3145"><span class="linenos">3145</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;slice&#39;</span><span class="p">:</span>
</span><span id="FST-3146"><a href="#FST-3146"><span class="linenos">3146</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3147"><a href="#FST-3147"><span class="linenos">3147</span></a>
</span><span id="FST-3148"><a href="#FST-3148"><span class="linenos">3148</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">):</span>
</span><span id="FST-3149"><a href="#FST-3149"><span class="linenos">3149</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">,</span> <span class="s1">&#39;kwd_attrs&#39;</span><span class="p">,</span> <span class="s1">&#39;kwd_patterns&#39;</span><span class="p">):</span>
</span><span id="FST-3150"><a href="#FST-3150"><span class="linenos">3150</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3151"><a href="#FST-3151"><span class="linenos">3151</span></a>
</span><span id="FST-3152"><a href="#FST-3152"><span class="linenos">3152</span></a>            <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-3153"><a href="#FST-3153"><span class="linenos">3153</span></a>                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="FST-3154"><a href="#FST-3154"><span class="linenos">3154</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3155"><a href="#FST-3155"><span class="linenos">3155</span></a>
</span><span id="FST-3156"><a href="#FST-3156"><span class="linenos">3156</span></a>            <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-3157"><a href="#FST-3157"><span class="linenos">3157</span></a>                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="FST-3158"><a href="#FST-3158"><span class="linenos">3158</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3159"><a href="#FST-3159"><span class="linenos">3159</span></a>
</span><span id="FST-3160"><a href="#FST-3160"><span class="linenos">3160</span></a>            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">pars</span><span class="p">(),</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>  <span class="c1"># could be empty args which has None for a loc</span>
</span><span id="FST-3161"><a href="#FST-3161"><span class="linenos">3161</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST-3162"><a href="#FST-3162"><span class="linenos">3162</span></a>
</span><span id="FST-3163"><a href="#FST-3163"><span class="linenos">3163</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="FST-3164"><a href="#FST-3164"><span class="linenos">3164</span></a>
</span><span id="FST-3165"><a href="#FST-3165"><span class="linenos">3165</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-3166"><a href="#FST-3166"><span class="linenos">3166</span></a>
</span><span id="FST-3167"><a href="#FST-3167"><span class="linenos">3167</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parenthesized_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-3168"><a href="#FST-3168"><span class="linenos">3168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a parenthesized `Tuple` or not, or not a `Tuple` at all.</span>
</span><span id="FST-3169"><a href="#FST-3169"><span class="linenos">3169</span></a>
</span><span id="FST-3170"><a href="#FST-3170"><span class="linenos">3170</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-3171"><a href="#FST-3171"><span class="linenos">3171</span></a><span class="sd">        - `True` if is parenthesized `Tuple`, `False` if is unparenthesized `Tuple`, `None` if is not `Tuple` at all.</span>
</span><span id="FST-3172"><a href="#FST-3172"><span class="linenos">3172</span></a>
</span><span id="FST-3173"><a href="#FST-3173"><span class="linenos">3173</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3174"><a href="#FST-3174"><span class="linenos">3174</span></a><span class="sd">        ```py</span>
</span><span id="FST-3175"><a href="#FST-3175"><span class="linenos">3175</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;).is_parenthesized_tuple()</span>
</span><span id="FST-3176"><a href="#FST-3176"><span class="linenos">3176</span></a><span class="sd">        False</span>
</span><span id="FST-3177"><a href="#FST-3177"><span class="linenos">3177</span></a>
</span><span id="FST-3178"><a href="#FST-3178"><span class="linenos">3178</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).is_parenthesized_tuple()</span>
</span><span id="FST-3179"><a href="#FST-3179"><span class="linenos">3179</span></a><span class="sd">        True</span>
</span><span id="FST-3180"><a href="#FST-3180"><span class="linenos">3180</span></a>
</span><span id="FST-3181"><a href="#FST-3181"><span class="linenos">3181</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;1&#39;).is_parenthesized_tuple())</span>
</span><span id="FST-3182"><a href="#FST-3182"><span class="linenos">3182</span></a><span class="sd">        None</span>
</span><span id="FST-3183"><a href="#FST-3183"><span class="linenos">3183</span></a><span class="sd">        ```</span>
</span><span id="FST-3184"><a href="#FST-3184"><span class="linenos">3184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3185"><a href="#FST-3185"><span class="linenos">3185</span></a>
</span><span id="FST-3186"><a href="#FST-3186"><span class="linenos">3186</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="FST-3187"><a href="#FST-3187"><span class="linenos">3187</span></a>
</span><span id="FST-3188"><a href="#FST-3188"><span class="linenos">3188</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed_matchseq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-3189"><a href="#FST-3189"><span class="linenos">3189</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is an enclosed `MatchSequence` or not, or not a `MatchSequence` at all (can be pars `()` or</span>
</span><span id="FST-3190"><a href="#FST-3190"><span class="linenos">3190</span></a><span class="sd">        brackets `[]`).</span>
</span><span id="FST-3191"><a href="#FST-3191"><span class="linenos">3191</span></a>
</span><span id="FST-3192"><a href="#FST-3192"><span class="linenos">3192</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-3193"><a href="#FST-3193"><span class="linenos">3193</span></a><span class="sd">        - `True` if is enclosed `MatchSequence`, `False` if is unparenthesized `MatchSequence`, `None` if is not</span>
</span><span id="FST-3194"><a href="#FST-3194"><span class="linenos">3194</span></a><span class="sd">            `MatchSequence` at all.</span>
</span><span id="FST-3195"><a href="#FST-3195"><span class="linenos">3195</span></a>
</span><span id="FST-3196"><a href="#FST-3196"><span class="linenos">3196</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3197"><a href="#FST-3197"><span class="linenos">3197</span></a><span class="sd">        ```py</span>
</span><span id="FST-3198"><a href="#FST-3198"><span class="linenos">3198</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1, 2: pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="FST-3199"><a href="#FST-3199"><span class="linenos">3199</span></a><span class="sd">        False</span>
</span><span id="FST-3200"><a href="#FST-3200"><span class="linenos">3200</span></a>
</span><span id="FST-3201"><a href="#FST-3201"><span class="linenos">3201</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case [1, 2]: pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="FST-3202"><a href="#FST-3202"><span class="linenos">3202</span></a><span class="sd">        True</span>
</span><span id="FST-3203"><a href="#FST-3203"><span class="linenos">3203</span></a>
</span><span id="FST-3204"><a href="#FST-3204"><span class="linenos">3204</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case (1, 2): pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="FST-3205"><a href="#FST-3205"><span class="linenos">3205</span></a><span class="sd">        True</span>
</span><span id="FST-3206"><a href="#FST-3206"><span class="linenos">3206</span></a>
</span><span id="FST-3207"><a href="#FST-3207"><span class="linenos">3207</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;match a:\n  case 1: pass&#39;).cases[0].pattern.is_enclosed_matchseq())</span>
</span><span id="FST-3208"><a href="#FST-3208"><span class="linenos">3208</span></a><span class="sd">        None</span>
</span><span id="FST-3209"><a href="#FST-3209"><span class="linenos">3209</span></a><span class="sd">        ```</span>
</span><span id="FST-3210"><a href="#FST-3210"><span class="linenos">3210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3211"><a href="#FST-3211"><span class="linenos">3211</span></a>
</span><span id="FST-3212"><a href="#FST-3212"><span class="linenos">3212</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="FST-3213"><a href="#FST-3213"><span class="linenos">3213</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-3214"><a href="#FST-3214"><span class="linenos">3214</span></a>
</span><span id="FST-3215"><a href="#FST-3215"><span class="linenos">3215</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST-3216"><a href="#FST-3216"><span class="linenos">3216</span></a>        <span class="n">lpar</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># could be end of line</span>
</span><span id="FST-3217"><a href="#FST-3217"><span class="linenos">3217</span></a>
</span><span id="FST-3218"><a href="#FST-3218"><span class="linenos">3218</span></a>        <span class="k">if</span> <span class="n">lpar</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
</span><span id="FST-3219"><a href="#FST-3219"><span class="linenos">3219</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">)</span>
</span><span id="FST-3220"><a href="#FST-3220"><span class="linenos">3220</span></a>        <span class="k">if</span> <span class="n">lpar</span> <span class="o">==</span> <span class="s1">&#39;[&#39;</span><span class="p">:</span>
</span><span id="FST-3221"><a href="#FST-3221"><span class="linenos">3221</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
</span><span id="FST-3222"><a href="#FST-3222"><span class="linenos">3222</span></a>
</span><span id="FST-3223"><a href="#FST-3223"><span class="linenos">3223</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-3224"><a href="#FST-3224"><span class="linenos">3224</span></a>
</span><span id="FST-3225"><a href="#FST-3225"><span class="linenos">3225</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty_set_call</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-3226"><a href="#FST-3226"><span class="linenos">3226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an empty `set()` call.</span>
</span><span id="FST-3227"><a href="#FST-3227"><span class="linenos">3227</span></a>
</span><span id="FST-3228"><a href="#FST-3228"><span class="linenos">3228</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3229"><a href="#FST-3229"><span class="linenos">3229</span></a><span class="sd">        ```py</span>
</span><span id="FST-3230"><a href="#FST-3230"><span class="linenos">3230</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{1}&#39;).is_empty_set_call()</span>
</span><span id="FST-3231"><a href="#FST-3231"><span class="linenos">3231</span></a><span class="sd">        False</span>
</span><span id="FST-3232"><a href="#FST-3232"><span class="linenos">3232</span></a>
</span><span id="FST-3233"><a href="#FST-3233"><span class="linenos">3233</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;set()&#39;).is_empty_set_call()</span>
</span><span id="FST-3234"><a href="#FST-3234"><span class="linenos">3234</span></a><span class="sd">        True</span>
</span><span id="FST-3235"><a href="#FST-3235"><span class="linenos">3235</span></a>
</span><span id="FST-3236"><a href="#FST-3236"><span class="linenos">3236</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;frozenset()&#39;).is_empty_set_call()</span>
</span><span id="FST-3237"><a href="#FST-3237"><span class="linenos">3237</span></a><span class="sd">        False</span>
</span><span id="FST-3238"><a href="#FST-3238"><span class="linenos">3238</span></a>
</span><span id="FST-3239"><a href="#FST-3239"><span class="linenos">3239</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{*()}&#39;).is_empty_set_call()</span>
</span><span id="FST-3240"><a href="#FST-3240"><span class="linenos">3240</span></a><span class="sd">        False</span>
</span><span id="FST-3241"><a href="#FST-3241"><span class="linenos">3241</span></a><span class="sd">        ```</span>
</span><span id="FST-3242"><a href="#FST-3242"><span class="linenos">3242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3243"><a href="#FST-3243"><span class="linenos">3243</span></a>
</span><span id="FST-3244"><a href="#FST-3244"><span class="linenos">3244</span></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span>
</span><span id="FST-3245"><a href="#FST-3245"><span class="linenos">3245</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">func</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s1">&#39;set&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">Load</span><span class="p">))</span>
</span><span id="FST-3246"><a href="#FST-3246"><span class="linenos">3246</span></a>
</span><span id="FST-3247"><a href="#FST-3247"><span class="linenos">3247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty_set_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-3248"><a href="#FST-3248"><span class="linenos">3248</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an empty `Set` from an empty `Starred` `Constant` sequence, recognized are `{*()}`, `{*[]}`</span>
</span><span id="FST-3249"><a href="#FST-3249"><span class="linenos">3249</span></a><span class="sd">        and `{*{}}`.</span>
</span><span id="FST-3250"><a href="#FST-3250"><span class="linenos">3250</span></a>
</span><span id="FST-3251"><a href="#FST-3251"><span class="linenos">3251</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3252"><a href="#FST-3252"><span class="linenos">3252</span></a><span class="sd">        ```py</span>
</span><span id="FST-3253"><a href="#FST-3253"><span class="linenos">3253</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{1}&#39;).is_empty_set_seq()</span>
</span><span id="FST-3254"><a href="#FST-3254"><span class="linenos">3254</span></a><span class="sd">        False</span>
</span><span id="FST-3255"><a href="#FST-3255"><span class="linenos">3255</span></a>
</span><span id="FST-3256"><a href="#FST-3256"><span class="linenos">3256</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{*()}&#39;).is_empty_set_seq()</span>
</span><span id="FST-3257"><a href="#FST-3257"><span class="linenos">3257</span></a><span class="sd">        True</span>
</span><span id="FST-3258"><a href="#FST-3258"><span class="linenos">3258</span></a>
</span><span id="FST-3259"><a href="#FST-3259"><span class="linenos">3259</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;set()&#39;).is_empty_set_seq()</span>
</span><span id="FST-3260"><a href="#FST-3260"><span class="linenos">3260</span></a><span class="sd">        False</span>
</span><span id="FST-3261"><a href="#FST-3261"><span class="linenos">3261</span></a><span class="sd">        ```</span>
</span><span id="FST-3262"><a href="#FST-3262"><span class="linenos">3262</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3263"><a href="#FST-3263"><span class="linenos">3263</span></a>
</span><span id="FST-3264"><a href="#FST-3264"><span class="linenos">3264</span></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Set</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">elts</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">elts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e0</span> <span class="o">:=</span> <span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Starred</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST-3265"><a href="#FST-3265"><span class="linenos">3265</span></a>                <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="n">e0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">elts</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Dict</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">keys</span><span class="p">)))</span>
</span><span id="FST-3266"><a href="#FST-3266"><span class="linenos">3266</span></a>
</span><span id="FST-3267"><a href="#FST-3267"><span class="linenos">3267</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_elif</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-3268"><a href="#FST-3268"><span class="linenos">3268</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is an `elif` or not, or not an `If` at all.</span>
</span><span id="FST-3269"><a href="#FST-3269"><span class="linenos">3269</span></a>
</span><span id="FST-3270"><a href="#FST-3270"><span class="linenos">3270</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-3271"><a href="#FST-3271"><span class="linenos">3271</span></a><span class="sd">        - `True` if is `elif` `If`, `False` if is normal `If`, `None` if is not `If` at all.</span>
</span><span id="FST-3272"><a href="#FST-3272"><span class="linenos">3272</span></a>
</span><span id="FST-3273"><a href="#FST-3273"><span class="linenos">3273</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3274"><a href="#FST-3274"><span class="linenos">3274</span></a><span class="sd">        ```py</span>
</span><span id="FST-3275"><a href="#FST-3275"><span class="linenos">3275</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: pass\nelif 2: pass&#39;).orelse[0].is_elif()</span>
</span><span id="FST-3276"><a href="#FST-3276"><span class="linenos">3276</span></a><span class="sd">        True</span>
</span><span id="FST-3277"><a href="#FST-3277"><span class="linenos">3277</span></a>
</span><span id="FST-3278"><a href="#FST-3278"><span class="linenos">3278</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: pass\nelse:\n  if 2: pass&#39;).orelse[0].is_elif()</span>
</span><span id="FST-3279"><a href="#FST-3279"><span class="linenos">3279</span></a><span class="sd">        False</span>
</span><span id="FST-3280"><a href="#FST-3280"><span class="linenos">3280</span></a>
</span><span id="FST-3281"><a href="#FST-3281"><span class="linenos">3281</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: pass\nelse:\n  i = 2&#39;).orelse[0].is_elif())</span>
</span><span id="FST-3282"><a href="#FST-3282"><span class="linenos">3282</span></a><span class="sd">        None</span>
</span><span id="FST-3283"><a href="#FST-3283"><span class="linenos">3283</span></a><span class="sd">        ```</span>
</span><span id="FST-3284"><a href="#FST-3284"><span class="linenos">3284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3285"><a href="#FST-3285"><span class="linenos">3285</span></a>
</span><span id="FST-3286"><a href="#FST-3286"><span class="linenos">3286</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span><span class="o">.</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;elif&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">col</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">If</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="FST-3287"><a href="#FST-3287"><span class="linenos">3287</span></a>
</span><span id="FST-3288"><a href="#FST-3288"><span class="linenos">3288</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_class_base</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST-3289"><a href="#FST-3289"><span class="linenos">3289</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `ClassDef` base in list without any keywords, or not a class base at all.</span>
</span><span id="FST-3290"><a href="#FST-3290"><span class="linenos">3290</span></a>
</span><span id="FST-3291"><a href="#FST-3291"><span class="linenos">3291</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST-3292"><a href="#FST-3292"><span class="linenos">3292</span></a><span class="sd">        - `True` if is solo class base, `False` if is class base, but not solo and `None` if is not class base at all.</span>
</span><span id="FST-3293"><a href="#FST-3293"><span class="linenos">3293</span></a>
</span><span id="FST-3294"><a href="#FST-3294"><span class="linenos">3294</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3295"><a href="#FST-3295"><span class="linenos">3295</span></a><span class="sd">        ```py</span>
</span><span id="FST-3296"><a href="#FST-3296"><span class="linenos">3296</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="FST-3297"><a href="#FST-3297"><span class="linenos">3297</span></a><span class="sd">        True</span>
</span><span id="FST-3298"><a href="#FST-3298"><span class="linenos">3298</span></a>
</span><span id="FST-3299"><a href="#FST-3299"><span class="linenos">3299</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1, b2): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="FST-3300"><a href="#FST-3300"><span class="linenos">3300</span></a><span class="sd">        False</span>
</span><span id="FST-3301"><a href="#FST-3301"><span class="linenos">3301</span></a>
</span><span id="FST-3302"><a href="#FST-3302"><span class="linenos">3302</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1, meta=m): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="FST-3303"><a href="#FST-3303"><span class="linenos">3303</span></a><span class="sd">        False</span>
</span><span id="FST-3304"><a href="#FST-3304"><span class="linenos">3304</span></a>
</span><span id="FST-3305"><a href="#FST-3305"><span class="linenos">3305</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;class cls(b1, meta=m): pass&#39;).keywords[0].is_solo_class_base())</span>
</span><span id="FST-3306"><a href="#FST-3306"><span class="linenos">3306</span></a><span class="sd">        None</span>
</span><span id="FST-3307"><a href="#FST-3307"><span class="linenos">3307</span></a><span class="sd">        ```</span>
</span><span id="FST-3308"><a href="#FST-3308"><span class="linenos">3308</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3309"><a href="#FST-3309"><span class="linenos">3309</span></a>
</span><span id="FST-3310"><a href="#FST-3310"><span class="linenos">3310</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;bases&#39;</span><span class="p">:</span>
</span><span id="FST-3311"><a href="#FST-3311"><span class="linenos">3311</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST-3312"><a href="#FST-3312"><span class="linenos">3312</span></a>
</span><span id="FST-3313"><a href="#FST-3313"><span class="linenos">3313</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">((</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">bases</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span>
</span><span id="FST-3314"><a href="#FST-3314"><span class="linenos">3314</span></a>
</span><span id="FST-3315"><a href="#FST-3315"><span class="linenos">3315</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_call_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-3316"><a href="#FST-3316"><span class="linenos">3316</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `Call` non-keyword argument.</span>
</span><span id="FST-3317"><a href="#FST-3317"><span class="linenos">3317</span></a>
</span><span id="FST-3318"><a href="#FST-3318"><span class="linenos">3318</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3319"><a href="#FST-3319"><span class="linenos">3319</span></a><span class="sd">        ```py</span>
</span><span id="FST-3320"><a href="#FST-3320"><span class="linenos">3320</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].is_solo_call_arg()</span>
</span><span id="FST-3321"><a href="#FST-3321"><span class="linenos">3321</span></a><span class="sd">        True</span>
</span><span id="FST-3322"><a href="#FST-3322"><span class="linenos">3322</span></a>
</span><span id="FST-3323"><a href="#FST-3323"><span class="linenos">3323</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a, b)&#39;).args[0].is_solo_call_arg()</span>
</span><span id="FST-3324"><a href="#FST-3324"><span class="linenos">3324</span></a><span class="sd">        False</span>
</span><span id="FST-3325"><a href="#FST-3325"><span class="linenos">3325</span></a>
</span><span id="FST-3326"><a href="#FST-3326"><span class="linenos">3326</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in range(3))&#39;).args[0].is_solo_call_arg()</span>
</span><span id="FST-3327"><a href="#FST-3327"><span class="linenos">3327</span></a><span class="sd">        True</span>
</span><span id="FST-3328"><a href="#FST-3328"><span class="linenos">3328</span></a><span class="sd">        ```</span>
</span><span id="FST-3329"><a href="#FST-3329"><span class="linenos">3329</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3330"><a href="#FST-3330"><span class="linenos">3330</span></a>
</span><span id="FST-3331"><a href="#FST-3331"><span class="linenos">3331</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST-3332"><a href="#FST-3332"><span class="linenos">3332</span></a>                <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FST-3333"><a href="#FST-3333"><span class="linenos">3333</span></a>
</span><span id="FST-3334"><a href="#FST-3334"><span class="linenos">3334</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_call_arg_genexp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-3335"><a href="#FST-3335"><span class="linenos">3335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is the dreaded solo call non-keyword argument generator expression in `sum(i for i in a)`.</span>
</span><span id="FST-3336"><a href="#FST-3336"><span class="linenos">3336</span></a><span class="sd">        This function doesn&#39;t say if it shares its parentheses or not, so it could still be `sum((i for i in a))` or</span>
</span><span id="FST-3337"><a href="#FST-3337"><span class="linenos">3337</span></a><span class="sd">        even `sum(((i for i in a)))`. To differentiate that see `pars(shared=False)`.</span>
</span><span id="FST-3338"><a href="#FST-3338"><span class="linenos">3338</span></a>
</span><span id="FST-3339"><a href="#FST-3339"><span class="linenos">3339</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3340"><a href="#FST-3340"><span class="linenos">3340</span></a><span class="sd">        ```py</span>
</span><span id="FST-3341"><a href="#FST-3341"><span class="linenos">3341</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in range(3))&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="FST-3342"><a href="#FST-3342"><span class="linenos">3342</span></a><span class="sd">        True</span>
</span><span id="FST-3343"><a href="#FST-3343"><span class="linenos">3343</span></a>
</span><span id="FST-3344"><a href="#FST-3344"><span class="linenos">3344</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in range(3)))&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="FST-3345"><a href="#FST-3345"><span class="linenos">3345</span></a><span class="sd">        True</span>
</span><span id="FST-3346"><a href="#FST-3346"><span class="linenos">3346</span></a>
</span><span id="FST-3347"><a href="#FST-3347"><span class="linenos">3347</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in range(3)), b)&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="FST-3348"><a href="#FST-3348"><span class="linenos">3348</span></a><span class="sd">        False</span>
</span><span id="FST-3349"><a href="#FST-3349"><span class="linenos">3349</span></a>
</span><span id="FST-3350"><a href="#FST-3350"><span class="linenos">3350</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="FST-3351"><a href="#FST-3351"><span class="linenos">3351</span></a><span class="sd">        False</span>
</span><span id="FST-3352"><a href="#FST-3352"><span class="linenos">3352</span></a><span class="sd">        ```</span>
</span><span id="FST-3353"><a href="#FST-3353"><span class="linenos">3353</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3354"><a href="#FST-3354"><span class="linenos">3354</span></a>
</span><span id="FST-3355"><a href="#FST-3355"><span class="linenos">3355</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST-3356"><a href="#FST-3356"><span class="linenos">3356</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FST-3357"><a href="#FST-3357"><span class="linenos">3357</span></a>
</span><span id="FST-3358"><a href="#FST-3358"><span class="linenos">3358</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_matchcls_pat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST-3359"><a href="#FST-3359"><span class="linenos">3359</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `MatchClass` non-keyword pattern. The solo `Constant` held by a `MatchValue`</span>
</span><span id="FST-3360"><a href="#FST-3360"><span class="linenos">3360</span></a><span class="sd">        qualifies as `True` for this check if the `MatchValue` does.</span>
</span><span id="FST-3361"><a href="#FST-3361"><span class="linenos">3361</span></a>
</span><span id="FST-3362"><a href="#FST-3362"><span class="linenos">3362</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST-3363"><a href="#FST-3363"><span class="linenos">3363</span></a><span class="sd">        ```py</span>
</span><span id="FST-3364"><a href="#FST-3364"><span class="linenos">3364</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n  case cls(a): pass&#39;)</span>
</span><span id="FST-3365"><a href="#FST-3365"><span class="linenos">3365</span></a><span class="sd">        ...  .cases[0].pattern.patterns[0].is_solo_matchcls_pat())</span>
</span><span id="FST-3366"><a href="#FST-3366"><span class="linenos">3366</span></a><span class="sd">        True</span>
</span><span id="FST-3367"><a href="#FST-3367"><span class="linenos">3367</span></a>
</span><span id="FST-3368"><a href="#FST-3368"><span class="linenos">3368</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n  case cls(a, b): pass&#39;)</span>
</span><span id="FST-3369"><a href="#FST-3369"><span class="linenos">3369</span></a><span class="sd">        ...  .cases[0].pattern.patterns[0].is_solo_matchcls_pat())</span>
</span><span id="FST-3370"><a href="#FST-3370"><span class="linenos">3370</span></a><span class="sd">        False</span>
</span><span id="FST-3371"><a href="#FST-3371"><span class="linenos">3371</span></a><span class="sd">        ```</span>
</span><span id="FST-3372"><a href="#FST-3372"><span class="linenos">3372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST-3373"><a href="#FST-3373"><span class="linenos">3373</span></a>
</span><span id="FST-3374"><a href="#FST-3374"><span class="linenos">3374</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST-3375"><a href="#FST-3375"><span class="linenos">3375</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST-3376"><a href="#FST-3376"><span class="linenos">3376</span></a>
</span><span id="FST-3377"><a href="#FST-3377"><span class="linenos">3377</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchValue</span><span class="p">):</span>
</span><span id="FST-3378"><a href="#FST-3378"><span class="linenos">3378</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="FST-3379"><a href="#FST-3379"><span class="linenos">3379</span></a>
</span><span id="FST-3380"><a href="#FST-3380"><span class="linenos">3380</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;patterns&#39;</span> <span class="ow">and</span>
</span><span id="FST-3381"><a href="#FST-3381"><span class="linenos">3381</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">kwd_patterns</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">patterns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FST-3382"><a href="#FST-3382"><span class="linenos">3382</span></a>
</span><span id="FST-3383"><a href="#FST-3383"><span class="linenos">3383</span></a>    <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>
</span><span id="FST-3384"><a href="#FST-3384"><span class="linenos">3384</span></a>    <span class="c1"># Private and other misc stuff</span>
</span><span id="FST-3385"><a href="#FST-3385"><span class="linenos">3385</span></a>
</span><span id="FST-3386"><a href="#FST-3386"><span class="linenos">3386</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_misc</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="FST-3387"><a href="#FST-3387"><span class="linenos">3387</span></a>        <span class="n">_new_empty_module</span><span class="p">,</span>
</span><span id="FST-3388"><a href="#FST-3388"><span class="linenos">3388</span></a>        <span class="n">_new_empty_tuple</span><span class="p">,</span>
</span><span id="FST-3389"><a href="#FST-3389"><span class="linenos">3389</span></a>        <span class="n">_new_empty_list</span><span class="p">,</span>
</span><span id="FST-3390"><a href="#FST-3390"><span class="linenos">3390</span></a>        <span class="n">_new_empty_dict</span><span class="p">,</span>
</span><span id="FST-3391"><a href="#FST-3391"><span class="linenos">3391</span></a>        <span class="n">_new_empty_set</span><span class="p">,</span>
</span><span id="FST-3392"><a href="#FST-3392"><span class="linenos">3392</span></a>        <span class="n">_new_empty_set_curlies</span><span class="p">,</span>
</span><span id="FST-3393"><a href="#FST-3393"><span class="linenos">3393</span></a>        <span class="n">_make_fst_tree</span><span class="p">,</span>
</span><span id="FST-3394"><a href="#FST-3394"><span class="linenos">3394</span></a>        <span class="n">_unmake_fst_tree</span><span class="p">,</span>
</span><span id="FST-3395"><a href="#FST-3395"><span class="linenos">3395</span></a>        <span class="n">_unmake_fst_parents</span><span class="p">,</span>
</span><span id="FST-3396"><a href="#FST-3396"><span class="linenos">3396</span></a>        <span class="n">_set_ast</span><span class="p">,</span>
</span><span id="FST-3397"><a href="#FST-3397"><span class="linenos">3397</span></a>        <span class="n">_set_ctx</span><span class="p">,</span>
</span><span id="FST-3398"><a href="#FST-3398"><span class="linenos">3398</span></a>        <span class="n">_repr_tail</span><span class="p">,</span>
</span><span id="FST-3399"><a href="#FST-3399"><span class="linenos">3399</span></a>        <span class="n">_dump</span><span class="p">,</span>
</span><span id="FST-3400"><a href="#FST-3400"><span class="linenos">3400</span></a>        <span class="n">_next_bound</span><span class="p">,</span>
</span><span id="FST-3401"><a href="#FST-3401"><span class="linenos">3401</span></a>        <span class="n">_prev_bound</span><span class="p">,</span>
</span><span id="FST-3402"><a href="#FST-3402"><span class="linenos">3402</span></a>        <span class="n">_next_bound_step</span><span class="p">,</span>
</span><span id="FST-3403"><a href="#FST-3403"><span class="linenos">3403</span></a>        <span class="n">_prev_bound_step</span><span class="p">,</span>
</span><span id="FST-3404"><a href="#FST-3404"><span class="linenos">3404</span></a>        <span class="n">_loc_block_header_end</span><span class="p">,</span>
</span><span id="FST-3405"><a href="#FST-3405"><span class="linenos">3405</span></a>        <span class="n">_loc_operator</span><span class="p">,</span>
</span><span id="FST-3406"><a href="#FST-3406"><span class="linenos">3406</span></a>        <span class="n">_loc_comprehension</span><span class="p">,</span>
</span><span id="FST-3407"><a href="#FST-3407"><span class="linenos">3407</span></a>        <span class="n">_loc_arguments</span><span class="p">,</span>
</span><span id="FST-3408"><a href="#FST-3408"><span class="linenos">3408</span></a>        <span class="n">_loc_arguments_empty</span><span class="p">,</span>
</span><span id="FST-3409"><a href="#FST-3409"><span class="linenos">3409</span></a>        <span class="n">_loc_lambda_args_entire</span><span class="p">,</span>
</span><span id="FST-3410"><a href="#FST-3410"><span class="linenos">3410</span></a>        <span class="n">_loc_withitem</span><span class="p">,</span>
</span><span id="FST-3411"><a href="#FST-3411"><span class="linenos">3411</span></a>        <span class="n">_loc_match_case</span><span class="p">,</span>
</span><span id="FST-3412"><a href="#FST-3412"><span class="linenos">3412</span></a>        <span class="n">_loc_Call_pars</span><span class="p">,</span>
</span><span id="FST-3413"><a href="#FST-3413"><span class="linenos">3413</span></a>        <span class="n">_loc_Subscript_brackets</span><span class="p">,</span>
</span><span id="FST-3414"><a href="#FST-3414"><span class="linenos">3414</span></a>        <span class="n">_loc_MatchClass_pars</span><span class="p">,</span>
</span><span id="FST-3415"><a href="#FST-3415"><span class="linenos">3415</span></a>        <span class="n">_loc_Global_Nonlocal_names</span><span class="p">,</span>
</span><span id="FST-3416"><a href="#FST-3416"><span class="linenos">3416</span></a>        <span class="n">_is_arguments_empty</span><span class="p">,</span>
</span><span id="FST-3417"><a href="#FST-3417"><span class="linenos">3417</span></a>        <span class="n">_is_parenthesized_ImportFrom_names</span><span class="p">,</span>
</span><span id="FST-3418"><a href="#FST-3418"><span class="linenos">3418</span></a>        <span class="n">_is_parenthesized_With_items</span><span class="p">,</span>
</span><span id="FST-3419"><a href="#FST-3419"><span class="linenos">3419</span></a>        <span class="n">_is_parenthesized_seq</span><span class="p">,</span>
</span><span id="FST-3420"><a href="#FST-3420"><span class="linenos">3420</span></a>        <span class="n">_dict_key_or_mock_loc</span><span class="p">,</span>
</span><span id="FST-3421"><a href="#FST-3421"><span class="linenos">3421</span></a>        <span class="n">_set_end_pos</span><span class="p">,</span>
</span><span id="FST-3422"><a href="#FST-3422"><span class="linenos">3422</span></a>        <span class="n">_set_block_end_from_last_child</span><span class="p">,</span>
</span><span id="FST-3423"><a href="#FST-3423"><span class="linenos">3423</span></a>        <span class="n">_maybe_add_comma</span><span class="p">,</span>
</span><span id="FST-3424"><a href="#FST-3424"><span class="linenos">3424</span></a>        <span class="n">_maybe_add_singleton_tuple_comma</span><span class="p">,</span>
</span><span id="FST-3425"><a href="#FST-3425"><span class="linenos">3425</span></a>        <span class="n">_maybe_fix_tuple</span><span class="p">,</span>
</span><span id="FST-3426"><a href="#FST-3426"><span class="linenos">3426</span></a>        <span class="n">_maybe_fix_set</span><span class="p">,</span>
</span><span id="FST-3427"><a href="#FST-3427"><span class="linenos">3427</span></a>        <span class="n">_maybe_fix_elif</span><span class="p">,</span>
</span><span id="FST-3428"><a href="#FST-3428"><span class="linenos">3428</span></a>        <span class="n">_maybe_fix_with_items</span><span class="p">,</span>
</span><span id="FST-3429"><a href="#FST-3429"><span class="linenos">3429</span></a>        <span class="n">_maybe_fix_copy</span><span class="p">,</span>
</span><span id="FST-3430"><a href="#FST-3430"><span class="linenos">3430</span></a>        <span class="n">_touch</span><span class="p">,</span>
</span><span id="FST-3431"><a href="#FST-3431"><span class="linenos">3431</span></a>        <span class="n">_sanitize</span><span class="p">,</span>
</span><span id="FST-3432"><a href="#FST-3432"><span class="linenos">3432</span></a>        <span class="n">_parenthesize_grouping</span><span class="p">,</span>
</span><span id="FST-3433"><a href="#FST-3433"><span class="linenos">3433</span></a>        <span class="n">_parenthesize_node</span><span class="p">,</span>
</span><span id="FST-3434"><a href="#FST-3434"><span class="linenos">3434</span></a>        <span class="n">_unparenthesize_grouping</span><span class="p">,</span>
</span><span id="FST-3435"><a href="#FST-3435"><span class="linenos">3435</span></a>        <span class="n">_unparenthesize_node</span><span class="p">,</span>
</span><span id="FST-3436"><a href="#FST-3436"><span class="linenos">3436</span></a>        <span class="n">_normalize_block</span><span class="p">,</span>
</span><span id="FST-3437"><a href="#FST-3437"><span class="linenos">3437</span></a>        <span class="n">_elif_to_else_if</span><span class="p">,</span>
</span><span id="FST-3438"><a href="#FST-3438"><span class="linenos">3438</span></a>        <span class="n">_reparse_docstrings</span><span class="p">,</span>
</span><span id="FST-3439"><a href="#FST-3439"><span class="linenos">3439</span></a>        <span class="n">_make_fst_and_dedent</span><span class="p">,</span>
</span><span id="FST-3440"><a href="#FST-3440"><span class="linenos">3440</span></a>        <span class="n">_get_fmtval_interp_strs</span><span class="p">,</span>
</span><span id="FST-3441"><a href="#FST-3441"><span class="linenos">3441</span></a>        <span class="n">_get_indentable_lns</span><span class="p">,</span>
</span><span id="FST-3442"><a href="#FST-3442"><span class="linenos">3442</span></a>        <span class="n">_modifying</span><span class="p">,</span>
</span><span id="FST-3443"><a href="#FST-3443"><span class="linenos">3443</span></a>        <span class="n">_touchall</span><span class="p">,</span>
</span><span id="FST-3444"><a href="#FST-3444"><span class="linenos">3444</span></a>        <span class="n">_put_src</span><span class="p">,</span>
</span><span id="FST-3445"><a href="#FST-3445"><span class="linenos">3445</span></a>        <span class="n">_offset</span><span class="p">,</span>
</span><span id="FST-3446"><a href="#FST-3446"><span class="linenos">3446</span></a>        <span class="n">_offset_lns</span><span class="p">,</span>
</span><span id="FST-3447"><a href="#FST-3447"><span class="linenos">3447</span></a>        <span class="n">_indent_lns</span><span class="p">,</span>
</span><span id="FST-3448"><a href="#FST-3448"><span class="linenos">3448</span></a>        <span class="n">_dedent_lns</span><span class="p">,</span>
</span><span id="FST-3449"><a href="#FST-3449"><span class="linenos">3449</span></a>    <span class="p">)</span>
</span><span id="FST-3450"><a href="#FST-3450"><span class="linenos">3450</span></a>
</span><span id="FST-3451"><a href="#FST-3451"><span class="linenos">3451</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_parse</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="FST-3452"><a href="#FST-3452"><span class="linenos">3452</span></a>        <span class="n">_unparse</span><span class="p">,</span>
</span><span id="FST-3453"><a href="#FST-3453"><span class="linenos">3453</span></a>        <span class="n">_parse</span><span class="p">,</span>
</span><span id="FST-3454"><a href="#FST-3454"><span class="linenos">3454</span></a>        <span class="n">_parse_all</span><span class="p">,</span>
</span><span id="FST-3455"><a href="#FST-3455"><span class="linenos">3455</span></a>        <span class="n">_parse_most</span><span class="p">,</span>
</span><span id="FST-3456"><a href="#FST-3456"><span class="linenos">3456</span></a>        <span class="n">_parse_min</span><span class="p">,</span>
</span><span id="FST-3457"><a href="#FST-3457"><span class="linenos">3457</span></a>        <span class="n">_parse_Module</span><span class="p">,</span>
</span><span id="FST-3458"><a href="#FST-3458"><span class="linenos">3458</span></a>        <span class="n">_parse_Expression</span><span class="p">,</span>
</span><span id="FST-3459"><a href="#FST-3459"><span class="linenos">3459</span></a>        <span class="n">_parse_Interactive</span><span class="p">,</span>
</span><span id="FST-3460"><a href="#FST-3460"><span class="linenos">3460</span></a>        <span class="n">_parse_stmtishs</span><span class="p">,</span>
</span><span id="FST-3461"><a href="#FST-3461"><span class="linenos">3461</span></a>        <span class="n">_parse_stmtish</span><span class="p">,</span>
</span><span id="FST-3462"><a href="#FST-3462"><span class="linenos">3462</span></a>        <span class="n">_parse_stmts</span><span class="p">,</span>
</span><span id="FST-3463"><a href="#FST-3463"><span class="linenos">3463</span></a>        <span class="n">_parse_stmt</span><span class="p">,</span>
</span><span id="FST-3464"><a href="#FST-3464"><span class="linenos">3464</span></a>        <span class="n">_parse_ExceptHandlers</span><span class="p">,</span>
</span><span id="FST-3465"><a href="#FST-3465"><span class="linenos">3465</span></a>        <span class="n">_parse_ExceptHandler</span><span class="p">,</span>
</span><span id="FST-3466"><a href="#FST-3466"><span class="linenos">3466</span></a>        <span class="n">_parse_match_cases</span><span class="p">,</span>
</span><span id="FST-3467"><a href="#FST-3467"><span class="linenos">3467</span></a>        <span class="n">_parse_match_case</span><span class="p">,</span>
</span><span id="FST-3468"><a href="#FST-3468"><span class="linenos">3468</span></a>        <span class="n">_parse_expr</span><span class="p">,</span>
</span><span id="FST-3469"><a href="#FST-3469"><span class="linenos">3469</span></a>        <span class="n">_parse_expr_slice</span><span class="p">,</span>
</span><span id="FST-3470"><a href="#FST-3470"><span class="linenos">3470</span></a>        <span class="n">_parse_expr_sliceelt</span><span class="p">,</span>
</span><span id="FST-3471"><a href="#FST-3471"><span class="linenos">3471</span></a>        <span class="n">_parse_expr_callarg</span><span class="p">,</span>
</span><span id="FST-3472"><a href="#FST-3472"><span class="linenos">3472</span></a>        <span class="n">_parse_boolop</span><span class="p">,</span>
</span><span id="FST-3473"><a href="#FST-3473"><span class="linenos">3473</span></a>        <span class="n">_parse_operator</span><span class="p">,</span>
</span><span id="FST-3474"><a href="#FST-3474"><span class="linenos">3474</span></a>        <span class="n">_parse_binop</span><span class="p">,</span>
</span><span id="FST-3475"><a href="#FST-3475"><span class="linenos">3475</span></a>        <span class="n">_parse_augop</span><span class="p">,</span>
</span><span id="FST-3476"><a href="#FST-3476"><span class="linenos">3476</span></a>        <span class="n">_parse_unaryop</span><span class="p">,</span>
</span><span id="FST-3477"><a href="#FST-3477"><span class="linenos">3477</span></a>        <span class="n">_parse_cmpop</span><span class="p">,</span>
</span><span id="FST-3478"><a href="#FST-3478"><span class="linenos">3478</span></a>        <span class="n">_parse_comprehension</span><span class="p">,</span>
</span><span id="FST-3479"><a href="#FST-3479"><span class="linenos">3479</span></a>        <span class="n">_parse_arguments</span><span class="p">,</span>
</span><span id="FST-3480"><a href="#FST-3480"><span class="linenos">3480</span></a>        <span class="n">_parse_arguments_lambda</span><span class="p">,</span>
</span><span id="FST-3481"><a href="#FST-3481"><span class="linenos">3481</span></a>        <span class="n">_parse_arg</span><span class="p">,</span>
</span><span id="FST-3482"><a href="#FST-3482"><span class="linenos">3482</span></a>        <span class="n">_parse_keyword</span><span class="p">,</span>
</span><span id="FST-3483"><a href="#FST-3483"><span class="linenos">3483</span></a>        <span class="n">_parse_alias</span><span class="p">,</span>
</span><span id="FST-3484"><a href="#FST-3484"><span class="linenos">3484</span></a>        <span class="n">_parse_alias_dotted</span><span class="p">,</span>
</span><span id="FST-3485"><a href="#FST-3485"><span class="linenos">3485</span></a>        <span class="n">_parse_alias_star</span><span class="p">,</span>
</span><span id="FST-3486"><a href="#FST-3486"><span class="linenos">3486</span></a>        <span class="n">_parse_withitem</span><span class="p">,</span>
</span><span id="FST-3487"><a href="#FST-3487"><span class="linenos">3487</span></a>        <span class="n">_parse_pattern</span><span class="p">,</span>
</span><span id="FST-3488"><a href="#FST-3488"><span class="linenos">3488</span></a>        <span class="n">_parse_type_param</span><span class="p">,</span>
</span><span id="FST-3489"><a href="#FST-3489"><span class="linenos">3489</span></a>        <span class="n">_code_as_all</span><span class="p">,</span>
</span><span id="FST-3490"><a href="#FST-3490"><span class="linenos">3490</span></a>        <span class="n">_code_as_stmtishs</span><span class="p">,</span>
</span><span id="FST-3491"><a href="#FST-3491"><span class="linenos">3491</span></a>        <span class="n">_code_as_stmts</span><span class="p">,</span>
</span><span id="FST-3492"><a href="#FST-3492"><span class="linenos">3492</span></a>        <span class="n">_code_as_ExceptHandlers</span><span class="p">,</span>
</span><span id="FST-3493"><a href="#FST-3493"><span class="linenos">3493</span></a>        <span class="n">_code_as_match_cases</span><span class="p">,</span>
</span><span id="FST-3494"><a href="#FST-3494"><span class="linenos">3494</span></a>        <span class="n">_code_as_expr</span><span class="p">,</span>
</span><span id="FST-3495"><a href="#FST-3495"><span class="linenos">3495</span></a>        <span class="n">_code_as_expr_slice</span><span class="p">,</span>
</span><span id="FST-3496"><a href="#FST-3496"><span class="linenos">3496</span></a>        <span class="n">_code_as_expr_sliceelt</span><span class="p">,</span>
</span><span id="FST-3497"><a href="#FST-3497"><span class="linenos">3497</span></a>        <span class="n">_code_as_expr_callarg</span><span class="p">,</span>
</span><span id="FST-3498"><a href="#FST-3498"><span class="linenos">3498</span></a>        <span class="n">_code_as_boolop</span><span class="p">,</span>
</span><span id="FST-3499"><a href="#FST-3499"><span class="linenos">3499</span></a>        <span class="n">_code_as_binop</span><span class="p">,</span>
</span><span id="FST-3500"><a href="#FST-3500"><span class="linenos">3500</span></a>        <span class="n">_code_as_augop</span><span class="p">,</span>
</span><span id="FST-3501"><a href="#FST-3501"><span class="linenos">3501</span></a>        <span class="n">_code_as_unaryop</span><span class="p">,</span>
</span><span id="FST-3502"><a href="#FST-3502"><span class="linenos">3502</span></a>        <span class="n">_code_as_cmpop</span><span class="p">,</span>
</span><span id="FST-3503"><a href="#FST-3503"><span class="linenos">3503</span></a>        <span class="n">_code_as_comprehension</span><span class="p">,</span>
</span><span id="FST-3504"><a href="#FST-3504"><span class="linenos">3504</span></a>        <span class="n">_code_as_arguments</span><span class="p">,</span>
</span><span id="FST-3505"><a href="#FST-3505"><span class="linenos">3505</span></a>        <span class="n">_code_as_arguments_lambda</span><span class="p">,</span>
</span><span id="FST-3506"><a href="#FST-3506"><span class="linenos">3506</span></a>        <span class="n">_code_as_arg</span><span class="p">,</span>
</span><span id="FST-3507"><a href="#FST-3507"><span class="linenos">3507</span></a>        <span class="n">_code_as_keyword</span><span class="p">,</span>
</span><span id="FST-3508"><a href="#FST-3508"><span class="linenos">3508</span></a>        <span class="n">_code_as_alias</span><span class="p">,</span>
</span><span id="FST-3509"><a href="#FST-3509"><span class="linenos">3509</span></a>        <span class="n">_code_as_alias_dotted</span><span class="p">,</span>
</span><span id="FST-3510"><a href="#FST-3510"><span class="linenos">3510</span></a>        <span class="n">_code_as_alias_star</span><span class="p">,</span>
</span><span id="FST-3511"><a href="#FST-3511"><span class="linenos">3511</span></a>        <span class="n">_code_as_withitem</span><span class="p">,</span>
</span><span id="FST-3512"><a href="#FST-3512"><span class="linenos">3512</span></a>        <span class="n">_code_as_pattern</span><span class="p">,</span>
</span><span id="FST-3513"><a href="#FST-3513"><span class="linenos">3513</span></a>        <span class="n">_code_as_type_param</span><span class="p">,</span>
</span><span id="FST-3514"><a href="#FST-3514"><span class="linenos">3514</span></a>        <span class="n">_code_as_identifier</span><span class="p">,</span>
</span><span id="FST-3515"><a href="#FST-3515"><span class="linenos">3515</span></a>        <span class="n">_code_as_identifier_dotted</span><span class="p">,</span>
</span><span id="FST-3516"><a href="#FST-3516"><span class="linenos">3516</span></a>        <span class="n">_code_as_identifier_star</span><span class="p">,</span>
</span><span id="FST-3517"><a href="#FST-3517"><span class="linenos">3517</span></a>        <span class="n">_code_as_identifier_alias</span><span class="p">,</span>
</span><span id="FST-3518"><a href="#FST-3518"><span class="linenos">3518</span></a>        <span class="n">_code_as_constant</span><span class="p">,</span>
</span><span id="FST-3519"><a href="#FST-3519"><span class="linenos">3519</span></a>    <span class="p">)</span>
</span><span id="FST-3520"><a href="#FST-3520"><span class="linenos">3520</span></a>
</span><span id="FST-3521"><a href="#FST-3521"><span class="linenos">3521</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_raw</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="FST-3522"><a href="#FST-3522"><span class="linenos">3522</span></a>        <span class="n">_reparse_raw</span><span class="p">,</span>
</span><span id="FST-3523"><a href="#FST-3523"><span class="linenos">3523</span></a>    <span class="p">)</span>
</span><span id="FST-3524"><a href="#FST-3524"><span class="linenos">3524</span></a>
</span><span id="FST-3525"><a href="#FST-3525"><span class="linenos">3525</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_slice_old</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="FST-3526"><a href="#FST-3526"><span class="linenos">3526</span></a>        <span class="n">_get_slice_tuple_list_or_set</span><span class="p">,</span>
</span><span id="FST-3527"><a href="#FST-3527"><span class="linenos">3527</span></a>        <span class="c1"># _get_slice_empty_set,</span>
</span><span id="FST-3528"><a href="#FST-3528"><span class="linenos">3528</span></a>        <span class="n">_get_slice_dict</span><span class="p">,</span>
</span><span id="FST-3529"><a href="#FST-3529"><span class="linenos">3529</span></a>        <span class="n">_get_slice_stmtish</span><span class="p">,</span>
</span><span id="FST-3530"><a href="#FST-3530"><span class="linenos">3530</span></a>        <span class="n">_put_slice_tuple_list_or_set</span><span class="p">,</span>
</span><span id="FST-3531"><a href="#FST-3531"><span class="linenos">3531</span></a>        <span class="c1"># _put_slice_empty_set,</span>
</span><span id="FST-3532"><a href="#FST-3532"><span class="linenos">3532</span></a>        <span class="n">_put_slice_dict</span><span class="p">,</span>
</span><span id="FST-3533"><a href="#FST-3533"><span class="linenos">3533</span></a>        <span class="n">_put_slice_stmtish</span><span class="p">,</span>
</span><span id="FST-3534"><a href="#FST-3534"><span class="linenos">3534</span></a>    <span class="p">)</span>
</span><span id="FST-3535"><a href="#FST-3535"><span class="linenos">3535</span></a>
</span><span id="FST-3536"><a href="#FST-3536"><span class="linenos">3536</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_slice</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="FST-3537"><a href="#FST-3537"><span class="linenos">3537</span></a>        <span class="n">_is_slice_compatible</span><span class="p">,</span>
</span><span id="FST-3538"><a href="#FST-3538"><span class="linenos">3538</span></a>        <span class="n">_get_slice</span><span class="p">,</span>
</span><span id="FST-3539"><a href="#FST-3539"><span class="linenos">3539</span></a>        <span class="n">_put_slice</span><span class="p">,</span>
</span><span id="FST-3540"><a href="#FST-3540"><span class="linenos">3540</span></a>    <span class="p">)</span>
</span><span id="FST-3541"><a href="#FST-3541"><span class="linenos">3541</span></a>
</span><span id="FST-3542"><a href="#FST-3542"><span class="linenos">3542</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.fst_one</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="FST-3543"><a href="#FST-3543"><span class="linenos">3543</span></a>        <span class="n">_get_one</span><span class="p">,</span>
</span><span id="FST-3544"><a href="#FST-3544"><span class="linenos">3544</span></a>        <span class="n">_put_one</span><span class="p">,</span>
</span><span id="FST-3545"><a href="#FST-3545"><span class="linenos">3545</span></a>    <span class="p">)</span>
</span><span id="FST-3546"><a href="#FST-3546"><span class="linenos">3546</span></a>
</span><span id="FST-3547"><a href="#FST-3547"><span class="linenos">3547</span></a>    <span class="nd">@property</span>
</span><span id="FST-3548"><a href="#FST-3548"><span class="linenos">3548</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FST-3549"><a href="#FST-3549"><span class="linenos">3549</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;@private&quot;&quot;&quot;</span>
</span><span id="FST-3550"><a href="#FST-3550"><span class="linenos">3550</span></a>
</span><span id="FST-3551"><a href="#FST-3551"><span class="linenos">3551</span></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;you probably think you&#39;re accessing an AST node &#39;.f&#39;, but you&#39;re not, &quot;</span>
</span><span id="FST-3552"><a href="#FST-3552"><span class="linenos">3552</span></a>                           <span class="sa">f</span><span class="s2">&quot;you&#39;re accessing an FST </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">.f&#39;&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class which maintains structure and formatted source code for an <code>AST</code> tree. An instance of this class is added
to each <code>AST</code> node in a tree. It provides format-preserving operations as well as ability to navigate the tree in
any direction.</p>
</div>


                            <div id="FST.__init__" class="classattr">
                                        <input id="FST.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FST</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">ast_or_src</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mode_or_lines_or_parent</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#FST">FST</a></span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;most&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtishs&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtish&#39;</span><span class="p">,</span> <span class="s1">&#39;stmts&#39;</span><span class="p">,</span> <span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;ExceptHandlers&#39;</span><span class="p">,</span> <span class="s1">&#39;ExceptHandler&#39;</span><span class="p">,</span> <span class="s1">&#39;match_cases&#39;</span><span class="p">,</span> <span class="s1">&#39;match_case&#39;</span><span class="p">,</span> <span class="s1">&#39;expr&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_slice&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_sliceelt&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_callarg&#39;</span><span class="p">,</span> <span class="s1">&#39;boolop&#39;</span><span class="p">,</span> <span class="s1">&#39;operator&#39;</span><span class="p">,</span> <span class="s1">&#39;binop&#39;</span><span class="p">,</span> <span class="s1">&#39;augop&#39;</span><span class="p">,</span> <span class="s1">&#39;unaryop&#39;</span><span class="p">,</span> <span class="s1">&#39;cmpop&#39;</span><span class="p">,</span> <span class="s1">&#39;comprehension&#39;</span><span class="p">,</span> <span class="s1">&#39;arguments&#39;</span><span class="p">,</span> <span class="s1">&#39;arguments_lambda&#39;</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="s1">&#39;keyword&#39;</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">,</span> <span class="s1">&#39;alias_dotted&#39;</span><span class="p">,</span> <span class="s1">&#39;alias_star&#39;</span><span class="p">,</span> <span class="s1">&#39;withitem&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span><span class="p">,</span> <span class="s1">&#39;type_param&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">pfield</span><span class="p">:</span> <span class="n"><a href="misc.html#astfield">fst.misc.astfield</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="FST.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.__init__-494"><a href="#FST.__init__-494"><span class="linenos">494</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="FST.__init__-495"><a href="#FST.__init__-495"><span class="linenos">495</span></a>                <span class="n">ast_or_src</span><span class="p">:</span> <span class="n">AST</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST.__init__-496"><a href="#FST.__init__-496"><span class="linenos">496</span></a>                <span class="n">mode_or_lines_or_parent</span><span class="p">:</span> <span class="n">FST</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mode</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST.__init__-497"><a href="#FST.__init__-497"><span class="linenos">497</span></a>                <span class="n">pfield</span><span class="p">:</span> <span class="n">astfield</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST.__init__-498"><a href="#FST.__init__-498"><span class="linenos">498</span></a>                <span class="o">/</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="FST.__init__-499"><a href="#FST.__init__-499"><span class="linenos">499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new individual `FST` node or full tree. The main way to use this constructor is as a shortcut for</span>
</span><span id="FST.__init__-500"><a href="#FST.__init__-500"><span class="linenos">500</span></a><span class="sd">        `FST.fromsrc()` or `FST.fromast()`, the usage is:</span>
</span><span id="FST.__init__-501"><a href="#FST.__init__-501"><span class="linenos">501</span></a>
</span><span id="FST.__init__-502"><a href="#FST.__init__-502"><span class="linenos">502</span></a><span class="sd">        **`FST(ast_or_src, mode=None)`**</span>
</span><span id="FST.__init__-503"><a href="#FST.__init__-503"><span class="linenos">503</span></a>
</span><span id="FST.__init__-504"><a href="#FST.__init__-504"><span class="linenos">504</span></a><span class="sd">        This will create an `FST` from either an `AST` or source code in the form of a string or list of lines. The</span>
</span><span id="FST.__init__-505"><a href="#FST.__init__-505"><span class="linenos">505</span></a><span class="sd">        first parameter can be `None` instead of an `AST` or source to indicate a blank new module of one of the three</span>
</span><span id="FST.__init__-506"><a href="#FST.__init__-506"><span class="linenos">506</span></a><span class="sd">        types `&#39;exec&#39;`, `&#39;eval&#39;` or `&#39;single&#39;`. Otherwise if there is `source` or an `AST` then `mode` specifies how it</span>
</span><span id="FST.__init__-507"><a href="#FST.__init__-507"><span class="linenos">507</span></a><span class="sd">        will be parsed / reparsed and it can take any of the values from `fst.misc.Mode`.</span>
</span><span id="FST.__init__-508"><a href="#FST.__init__-508"><span class="linenos">508</span></a>
</span><span id="FST.__init__-509"><a href="#FST.__init__-509"><span class="linenos">509</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.__init__-510"><a href="#FST.__init__-510"><span class="linenos">510</span></a><span class="sd">        - `ast_or_src`: Source code, an `AST` node or `None`.</span>
</span><span id="FST.__init__-511"><a href="#FST.__init__-511"><span class="linenos">511</span></a><span class="sd">        - `mode`: See `fst.misc.Mode`. If this is `None` then if `ast_or_src` is an `AST` the mode defaults to the</span>
</span><span id="FST.__init__-512"><a href="#FST.__init__-512"><span class="linenos">512</span></a><span class="sd">            type of the `AST`. Otherwise if the `ast_or_src` is actual source code then `mode` used is `&#39;all&#39;` to allow</span>
</span><span id="FST.__init__-513"><a href="#FST.__init__-513"><span class="linenos">513</span></a><span class="sd">            parsing anything. And if `ast_or_src` is `None` then `mode` must be provided and be one of `&#39;exec&#39;`,</span>
</span><span id="FST.__init__-514"><a href="#FST.__init__-514"><span class="linenos">514</span></a><span class="sd">            `&#39;eval&#39;` or `&#39;single&#39;`.</span>
</span><span id="FST.__init__-515"><a href="#FST.__init__-515"><span class="linenos">515</span></a>
</span><span id="FST.__init__-516"><a href="#FST.__init__-516"><span class="linenos">516</span></a><span class="sd">        The other forms of this function are meant for internal use and their parameters are below:</span>
</span><span id="FST.__init__-517"><a href="#FST.__init__-517"><span class="linenos">517</span></a>
</span><span id="FST.__init__-518"><a href="#FST.__init__-518"><span class="linenos">518</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.__init__-519"><a href="#FST.__init__-519"><span class="linenos">519</span></a><span class="sd">        - `ast_or_src`: `AST` node for `FST` or source code in the form of a `str` or a list of lines. If an `AST` then</span>
</span><span id="FST.__init__-520"><a href="#FST.__init__-520"><span class="linenos">520</span></a><span class="sd">            will be processed differently depending on if creating child node, top level node or using this as a</span>
</span><span id="FST.__init__-521"><a href="#FST.__init__-521"><span class="linenos">521</span></a><span class="sd">            shortcut for a full `fromsrc()` or `fromast()`.</span>
</span><span id="FST.__init__-522"><a href="#FST.__init__-522"><span class="linenos">522</span></a><span class="sd">        - `mode_or_lines_or_parent`: Parent node for this child node or lines for a root node creating a new tree. If</span>
</span><span id="FST.__init__-523"><a href="#FST.__init__-523"><span class="linenos">523</span></a><span class="sd">            `pfield` is `None` and this is a shortcut to create a full tree from an `AST` node or source provided in</span>
</span><span id="FST.__init__-524"><a href="#FST.__init__-524"><span class="linenos">524</span></a><span class="sd">            `ast_or_src`.</span>
</span><span id="FST.__init__-525"><a href="#FST.__init__-525"><span class="linenos">525</span></a><span class="sd">        - `pfield`: `astfield` indication position in parent of this node. If provided then creating a simple child node</span>
</span><span id="FST.__init__-526"><a href="#FST.__init__-526"><span class="linenos">526</span></a><span class="sd">            and it is created with the `self.parent` set to `mode_or_lines_or_parent` node and `self.pfield` set to</span>
</span><span id="FST.__init__-527"><a href="#FST.__init__-527"><span class="linenos">527</span></a><span class="sd">            this. If `None` then it means the creation of a full new `FST` tree and this is the root node with</span>
</span><span id="FST.__init__-528"><a href="#FST.__init__-528"><span class="linenos">528</span></a><span class="sd">            `mode_or_lines_or_parent` providing the source.</span>
</span><span id="FST.__init__-529"><a href="#FST.__init__-529"><span class="linenos">529</span></a><span class="sd">        - `kwargs`: Contextual parameters:</span>
</span><span id="FST.__init__-530"><a href="#FST.__init__-530"><span class="linenos">530</span></a><span class="sd">            - `from_`: If this is provided then it must be an `FST` node from which this node is being created. This</span>
</span><span id="FST.__init__-531"><a href="#FST.__init__-531"><span class="linenos">531</span></a><span class="sd">                allows to copy parse parameters and already determined default indentation.</span>
</span><span id="FST.__init__-532"><a href="#FST.__init__-532"><span class="linenos">532</span></a><span class="sd">            - `parse_params`: A `dict` with values for &#39;filename&#39;, &#39;type_comments&#39; and &#39;feature_version&#39; which will be</span>
</span><span id="FST.__init__-533"><a href="#FST.__init__-533"><span class="linenos">533</span></a><span class="sd">                used for any `AST` reparse done on this tree. Only valid when creating a root node.</span>
</span><span id="FST.__init__-534"><a href="#FST.__init__-534"><span class="linenos">534</span></a><span class="sd">            - `indent`: Indentation string to use as default indentation. If not provided and not gotten from `from_`</span>
</span><span id="FST.__init__-535"><a href="#FST.__init__-535"><span class="linenos">535</span></a><span class="sd">                then indentation will be inferred from source. Only valid when creating a root node.</span>
</span><span id="FST.__init__-536"><a href="#FST.__init__-536"><span class="linenos">536</span></a><span class="sd">            - `filename`, `type_comments` and `feature_version`: If creating from an `AST` or source only then these are</span>
</span><span id="FST.__init__-537"><a href="#FST.__init__-537"><span class="linenos">537</span></a><span class="sd">                the parameteres passed to the respective `.new()`, `.fromsrc()` or `.fromast()` functions. Only valid</span>
</span><span id="FST.__init__-538"><a href="#FST.__init__-538"><span class="linenos">538</span></a><span class="sd">                when `mode_or_lines_or_parent` and `pfield` are `None`.</span>
</span><span id="FST.__init__-539"><a href="#FST.__init__-539"><span class="linenos">539</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.__init__-540"><a href="#FST.__init__-540"><span class="linenos">540</span></a>
</span><span id="FST.__init__-541"><a href="#FST.__init__-541"><span class="linenos">541</span></a>        <span class="k">if</span> <span class="n">pfield</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># top level shortcut</span>
</span><span id="FST.__init__-542"><a href="#FST.__init__-542"><span class="linenos">542</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;type_comments&#39;</span><span class="p">,</span> <span class="s1">&#39;feature_version&#39;</span><span class="p">)</span>
</span><span id="FST.__init__-543"><a href="#FST.__init__-543"><span class="linenos">543</span></a>                      <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">k</span><span class="p">}</span>  <span class="c1"># k used as sentinel</span>
</span><span id="FST.__init__-544"><a href="#FST.__init__-544"><span class="linenos">544</span></a>            <span class="n">indent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST.__init__-545"><a href="#FST.__init__-545"><span class="linenos">545</span></a>
</span><span id="FST.__init__-546"><a href="#FST.__init__-546"><span class="linenos">546</span></a>            <span class="k">if</span> <span class="n">from_</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;from_&#39;</span><span class="p">):</span> <span class="c1"># copy parse params from source tree</span>
</span><span id="FST.__init__-547"><a href="#FST.__init__-547"><span class="linenos">547</span></a>                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">from_</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">parse_params</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">}</span>
</span><span id="FST.__init__-548"><a href="#FST.__init__-548"><span class="linenos">548</span></a>                <span class="n">indent</span> <span class="o">=</span> <span class="n">from_</span><span class="o">.</span><span class="n">indent</span>
</span><span id="FST.__init__-549"><a href="#FST.__init__-549"><span class="linenos">549</span></a>
</span><span id="FST.__init__-550"><a href="#FST.__init__-550"><span class="linenos">550</span></a>            <span class="k">if</span> <span class="n">ast_or_src</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.__init__-551"><a href="#FST.__init__-551"><span class="linenos">551</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span> <span class="k">if</span> <span class="n">mode_or_lines_or_parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="FST.__init__-552"><a href="#FST.__init__-552"><span class="linenos">552</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="FST.__init__-553"><a href="#FST.__init__-553"><span class="linenos">553</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">fromast</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="FST.__init__-554"><a href="#FST.__init__-554"><span class="linenos">554</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.__init__-555"><a href="#FST.__init__-555"><span class="linenos">555</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">fromsrc</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span> <span class="k">if</span> <span class="n">mode_or_lines_or_parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode_or_lines_or_parent</span><span class="p">,</span>
</span><span id="FST.__init__-556"><a href="#FST.__init__-556"><span class="linenos">556</span></a>                                <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="FST.__init__-557"><a href="#FST.__init__-557"><span class="linenos">557</span></a>
</span><span id="FST.__init__-558"><a href="#FST.__init__-558"><span class="linenos">558</span></a>            <span class="k">if</span> <span class="n">indent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.__init__-559"><a href="#FST.__init__-559"><span class="linenos">559</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span>
</span><span id="FST.__init__-560"><a href="#FST.__init__-560"><span class="linenos">560</span></a>
</span><span id="FST.__init__-561"><a href="#FST.__init__-561"><span class="linenos">561</span></a>            <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.__init__-562"><a href="#FST.__init__-562"><span class="linenos">562</span></a>
</span><span id="FST.__init__-563"><a href="#FST.__init__-563"><span class="linenos">563</span></a>        <span class="c1"># creating actual node</span>
</span><span id="FST.__init__-564"><a href="#FST.__init__-564"><span class="linenos">564</span></a>
</span><span id="FST.__init__-565"><a href="#FST.__init__-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># reuse FST node assigned to AST node (because otherwise it isn&#39;t valid anyway)</span>
</span><span id="FST.__init__-566"><a href="#FST.__init__-566"><span class="linenos">566</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_touch</span><span class="p">()</span>
</span><span id="FST.__init__-567"><a href="#FST.__init__-567"><span class="linenos">567</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.__init__-568"><a href="#FST.__init__-568"><span class="linenos">568</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">ast_or_src</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="FST.__init__-569"><a href="#FST.__init__-569"><span class="linenos">569</span></a>
</span><span id="FST.__init__-570"><a href="#FST.__init__-570"><span class="linenos">570</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span>       <span class="o">=</span> <span class="n">ast_or_src</span>  <span class="c1"># we don&#39;t assume `self.a` is `ast_or_src` if `.f` exists</span>
</span><span id="FST.__init__-571"><a href="#FST.__init__-571"><span class="linenos">571</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span>  <span class="o">=</span> <span class="n">pfield</span>
</span><span id="FST.__init__-572"><a href="#FST.__init__-572"><span class="linenos">572</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>  <span class="o">=</span> <span class="p">{}</span>
</span><span id="FST.__init__-573"><a href="#FST.__init__-573"><span class="linenos">573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_serial</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FST.__init__-574"><a href="#FST.__init__-574"><span class="linenos">574</span></a>
</span><span id="FST.__init__-575"><a href="#FST.__init__-575"><span class="linenos">575</span></a>        <span class="k">if</span> <span class="n">pfield</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.__init__-576"><a href="#FST.__init__-576"><span class="linenos">576</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">mode_or_lines_or_parent</span>
</span><span id="FST.__init__-577"><a href="#FST.__init__-577"><span class="linenos">577</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span>   <span class="o">=</span> <span class="n">mode_or_lines_or_parent</span><span class="o">.</span><span class="n">root</span>
</span><span id="FST.__init__-578"><a href="#FST.__init__-578"><span class="linenos">578</span></a>
</span><span id="FST.__init__-579"><a href="#FST.__init__-579"><span class="linenos">579</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.__init__-580"><a href="#FST.__init__-580"><span class="linenos">580</span></a>
</span><span id="FST.__init__-581"><a href="#FST.__init__-581"><span class="linenos">581</span></a>        <span class="c1"># ROOT</span>
</span><span id="FST.__init__-582"><a href="#FST.__init__-582"><span class="linenos">582</span></a>
</span><span id="FST.__init__-583"><a href="#FST.__init__-583"><span class="linenos">583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST.__init__-584"><a href="#FST.__init__-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span>   <span class="o">=</span> <span class="bp">self</span>
</span><span id="FST.__init__-585"><a href="#FST.__init__-585"><span class="linenos">585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span> <span class="o">=</span> <span class="p">([</span><span class="n">bistr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">mode_or_lines_or_parent</span><span class="p">]</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lcopy&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">else</span>
</span><span id="FST.__init__-586"><a href="#FST.__init__-586"><span class="linenos">586</span></a>                       <span class="n">mode_or_lines_or_parent</span><span class="p">)</span>
</span><span id="FST.__init__-587"><a href="#FST.__init__-587"><span class="linenos">587</span></a>
</span><span id="FST.__init__-588"><a href="#FST.__init__-588"><span class="linenos">588</span></a>        <span class="k">if</span> <span class="n">from_</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;from_&#39;</span><span class="p">):</span>  <span class="c1"># copy params from source tree</span>
</span><span id="FST.__init__-589"><a href="#FST.__init__-589"><span class="linenos">589</span></a>            <span class="n">from_root</span>         <span class="o">=</span> <span class="n">from_</span><span class="o">.</span><span class="n">root</span>
</span><span id="FST.__init__-590"><a href="#FST.__init__-590"><span class="linenos">590</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_params&#39;</span><span class="p">,</span> <span class="n">from_root</span><span class="o">.</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST.__init__-591"><a href="#FST.__init__-591"><span class="linenos">591</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">indent</span>       <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">,</span> <span class="n">from_root</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>
</span><span id="FST.__init__-592"><a href="#FST.__init__-592"><span class="linenos">592</span></a>
</span><span id="FST.__init__-593"><a href="#FST.__init__-593"><span class="linenos">593</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.__init__-594"><a href="#FST.__init__-594"><span class="linenos">594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_params&#39;</span><span class="p">,</span> <span class="n">_DEFAULT_PARSE_PARAMS</span><span class="p">)</span>
</span><span id="FST.__init__-595"><a href="#FST.__init__-595"><span class="linenos">595</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">indent</span>       <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;?&#39;</span>
</span><span id="FST.__init__-596"><a href="#FST.__init__-596"><span class="linenos">596</span></a>                                  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast_or_src</span><span class="p">,</span> <span class="n">Module</span><span class="p">)</span> <span class="k">else</span>
</span><span id="FST.__init__-597"><a href="#FST.__init__-597"><span class="linenos">597</span></a>                                  <span class="n">_DEFAULT_INDENT</span><span class="p">)</span>
</span><span id="FST.__init__-598"><a href="#FST.__init__-598"><span class="linenos">598</span></a>                                 <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span>
</span><span id="FST.__init__-599"><a href="#FST.__init__-599"><span class="linenos">599</span></a>                                 <span class="n">indent</span><span class="p">)</span>
</span><span id="FST.__init__-600"><a href="#FST.__init__-600"><span class="linenos">600</span></a>
</span><span id="FST.__init__-601"><a href="#FST.__init__-601"><span class="linenos">601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_make_fst_tree</span><span class="p">()</span>
</span><span id="FST.__init__-602"><a href="#FST.__init__-602"><span class="linenos">602</span></a>
</span><span id="FST.__init__-603"><a href="#FST.__init__-603"><span class="linenos">603</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>  <span class="c1"># infer indentation from source, just use first indentation found for performance, don&#39;t try to find most common or anything like that</span>
</span><span id="FST.__init__-604"><a href="#FST.__init__-604"><span class="linenos">604</span></a>            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ast_or_src</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
</span><span id="FST.__init__-605"><a href="#FST.__init__-605"><span class="linenos">605</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">AsyncFunctionDef</span><span class="p">,</span> <span class="n">ClassDef</span><span class="p">,</span> <span class="n">With</span><span class="p">,</span> <span class="n">AsyncWith</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span>
</span><span id="FST.__init__-606"><a href="#FST.__init__-606"><span class="linenos">606</span></a>                                  <span class="n">match_case</span><span class="p">)):</span>  <span class="c1"># we check ExceptHandler and match_case because they may be supported as standalone parsed elements eventually</span>
</span><span id="FST.__init__-607"><a href="#FST.__init__-607"><span class="linenos">607</span></a>                    <span class="n">indent</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
</span><span id="FST.__init__-608"><a href="#FST.__init__-608"><span class="linenos">608</span></a>
</span><span id="FST.__init__-609"><a href="#FST.__init__-609"><span class="linenos">609</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">For</span><span class="p">,</span> <span class="n">AsyncFor</span><span class="p">,</span> <span class="n">While</span><span class="p">,</span> <span class="n">If</span><span class="p">)):</span>
</span><span id="FST.__init__-610"><a href="#FST.__init__-610"><span class="linenos">610</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">orelse</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">orelse</span><span class="p">):</span>
</span><span id="FST.__init__-611"><a href="#FST.__init__-611"><span class="linenos">611</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()):</span>  <span class="c1"># because can be &#39;elif&#39;</span>
</span><span id="FST.__init__-612"><a href="#FST.__init__-612"><span class="linenos">612</span></a>                            <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
</span><span id="FST.__init__-613"><a href="#FST.__init__-613"><span class="linenos">613</span></a>
</span><span id="FST.__init__-614"><a href="#FST.__init__-614"><span class="linenos">614</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">Try</span><span class="p">,</span> <span class="n">TryStar</span><span class="p">)):</span>
</span><span id="FST.__init__-615"><a href="#FST.__init__-615"><span class="linenos">615</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST.__init__-616"><a href="#FST.__init__-616"><span class="linenos">616</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">orelse</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">orelse</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST.__init__-617"><a href="#FST.__init__-617"><span class="linenos">617</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">finalbody</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">finalbody</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">finalbody</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST.__init__-618"><a href="#FST.__init__-618"><span class="linenos">618</span></a>                                <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
</span><span id="FST.__init__-619"><a href="#FST.__init__-619"><span class="linenos">619</span></a>                                    <span class="k">if</span> <span class="p">(</span><span class="n">indent</span> <span class="o">:=</span> <span class="n">handler</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">())</span> <span class="o">!=</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST.__init__-620"><a href="#FST.__init__-620"><span class="linenos">620</span></a>                                        <span class="k">break</span>
</span><span id="FST.__init__-621"><a href="#FST.__init__-621"><span class="linenos">621</span></a>
</span><span id="FST.__init__-622"><a href="#FST.__init__-622"><span class="linenos">622</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Match</span><span class="p">):</span>
</span><span id="FST.__init__-623"><a href="#FST.__init__-623"><span class="linenos">623</span></a>                    <span class="n">indent</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
</span><span id="FST.__init__-624"><a href="#FST.__init__-624"><span class="linenos">624</span></a>
</span><span id="FST.__init__-625"><a href="#FST.__init__-625"><span class="linenos">625</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FST.__init__-626"><a href="#FST.__init__-626"><span class="linenos">626</span></a>                    <span class="k">continue</span>
</span><span id="FST.__init__-627"><a href="#FST.__init__-627"><span class="linenos">627</span></a>
</span><span id="FST.__init__-628"><a href="#FST.__init__-628"><span class="linenos">628</span></a>                <span class="k">if</span> <span class="n">indent</span> <span class="o">!=</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
</span><span id="FST.__init__-629"><a href="#FST.__init__-629"><span class="linenos">629</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span>
</span><span id="FST.__init__-630"><a href="#FST.__init__-630"><span class="linenos">630</span></a>
</span><span id="FST.__init__-631"><a href="#FST.__init__-631"><span class="linenos">631</span></a>                    <span class="k">break</span>
</span><span id="FST.__init__-632"><a href="#FST.__init__-632"><span class="linenos">632</span></a>
</span><span id="FST.__init__-633"><a href="#FST.__init__-633"><span class="linenos">633</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.__init__-634"><a href="#FST.__init__-634"><span class="linenos">634</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">_DEFAULT_INDENT</span>
</span><span id="FST.__init__-635"><a href="#FST.__init__-635"><span class="linenos">635</span></a>
</span><span id="FST.__init__-636"><a href="#FST.__init__-636"><span class="linenos">636</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Create a new individual <code><a href="#FST">FST</a></code> node or full tree. The main way to use this constructor is as a shortcut for
<code><a href="#FST.fromsrc">FST.fromsrc()</a></code> or <code><a href="#FST.fromast">FST.fromast()</a></code>, the usage is:</p>

<p><strong><code>FST(ast_or_src, mode=None)</code></strong></p>

<p>This will create an <code><a href="#FST">FST</a></code> from either an <code>AST</code> or source code in the form of a string or list of lines. The
first parameter can be <code>None</code> instead of an <code>AST</code> or source to indicate a blank new module of one of the three
types <code>'exec'</code>, <code>'eval'</code> or <code>'single'</code>. Otherwise if there is <code>source</code> or an <code>AST</code> then <code>mode</code> specifies how it
will be parsed / reparsed and it can take any of the values from <code><a href="misc.html#Mode">fst.misc.Mode</a></code>.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>ast_or_src</code>: Source code, an <code>AST</code> node or <code>None</code>.</li>
<li><code>mode</code>: See <code><a href="misc.html#Mode">fst.misc.Mode</a></code>. If this is <code>None</code> then if <code>ast_or_src</code> is an <code>AST</code> the mode defaults to the
type of the <code>AST</code>. Otherwise if the <code>ast_or_src</code> is actual source code then <code>mode</code> used is <code>'all'</code> to allow
parsing anything. And if <code>ast_or_src</code> is <code>None</code> then <code>mode</code> must be provided and be one of <code>'exec'</code>,
<code>'eval'</code> or <code>'single'</code>.</li>
</ul>

<p>The other forms of this function are meant for internal use and their parameters are below:</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>ast_or_src</code>: <code>AST</code> node for <code><a href="#FST">FST</a></code> or source code in the form of a <code>str</code> or a list of lines. If an <code>AST</code> then
will be processed differently depending on if creating child node, top level node or using this as a
shortcut for a full <code><a href="#FST.fromsrc">fromsrc()</a></code> or <code><a href="#FST.fromast">fromast()</a></code>.</li>
<li><code>mode_or_lines_or_parent</code>: Parent node for this child node or lines for a root node creating a new tree. If
<code><a href="#FST.pfield">pfield</a></code> is <code>None</code> and this is a shortcut to create a full tree from an <code>AST</code> node or source provided in
<code>ast_or_src</code>.</li>
<li><code><a href="#FST.pfield">pfield</a></code>: <code>astfield</code> indication position in parent of this node. If provided then creating a simple child node
and it is created with the <code>self.parent</code> set to <code>mode_or_lines_or_parent</code> node and <code>self.pfield</code> set to
this. If <code>None</code> then it means the creation of a full new <code><a href="#FST">FST</a></code> tree and this is the root node with
<code>mode_or_lines_or_parent</code> providing the source.</li>
<li><code>kwargs</code>: Contextual parameters:
<ul>
<li><code>from_</code>: If this is provided then it must be an <code><a href="#FST">FST</a></code> node from which this node is being created. This
allows to copy parse parameters and already determined default indentation.</li>
<li><code><a href="#FST.parse_params">parse_params</a></code>: A <code>dict</code> with values for 'filename', 'type_comments' and 'feature_version' which will be
used for any <code>AST</code> reparse done on this tree. Only valid when creating a root node.</li>
<li><code><a href="#FST.indent">indent</a></code>: Indentation string to use as default indentation. If not provided and not gotten from <code>from_</code>
then indentation will be inferred from source. Only valid when creating a root node.</li>
<li><code>filename</code>, <code>type_comments</code> and <code>feature_version</code>: If creating from an <code>AST</code> or source only then these are
the parameteres passed to the respective <code>.new()</code>, <code>.fromsrc()</code> or <code>.fromast()</code> functions. Only valid
when <code>mode_or_lines_or_parent</code> and <code><a href="#FST.pfield">pfield</a></code> are <code>None</code>.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="FST.a" class="classattr">
                                <div class="attr variable">
            <span class="name">a</span><span class="annotation">: ast.AST</span>

        
    </div>
    <a class="headerlink" href="#FST.a"></a>
    
            <div class="docstring"><p>The actual <code>AST</code> node.</p>
</div>


                            </div>
                            <div id="FST.parent" class="classattr">
                                <div class="attr variable">
            <span class="name">parent</span><span class="annotation">: <a href="#FST">FST</a> | None</span>

        
    </div>
    <a class="headerlink" href="#FST.parent"></a>
    
            <div class="docstring"><p>Parent <code><a href="#FST">FST</a></code> node, <code>None</code> in root node.</p>
</div>


                            </div>
                            <div id="FST.pfield" class="classattr">
                                <div class="attr variable">
            <span class="name">pfield</span><span class="annotation">: <a href="misc.html#astfield">fst.misc.astfield</a> | None</span>

        
    </div>
    <a class="headerlink" href="#FST.pfield"></a>
    
            <div class="docstring"><p>The <code>astfield</code> location of this node in the parent, <code>None</code> in root node.</p>
</div>


                            </div>
                            <div id="FST.root" class="classattr">
                                <div class="attr variable">
            <span class="name">root</span><span class="annotation">: <a href="#FST">FST</a></span>

        
    </div>
    <a class="headerlink" href="#FST.root"></a>
    
            <div class="docstring"><p>The root node of this tree, <code>self</code> in root node.</p>
</div>


                            </div>
                            <div id="FST.parse_params" class="classattr">
                                <div class="attr variable">
            <span class="name">parse_params</span><span class="annotation">: dict[str, typing.Any]</span>

        
    </div>
    <a class="headerlink" href="#FST.parse_params"></a>
    
            <div class="docstring"><p>The parameters to use for any <code>ast.parse()</code> that needs to be done (filename, type_comments, feature_version), root node only.</p>
</div>


                            </div>
                            <div id="FST.indent" class="classattr">
                                <div class="attr variable">
            <span class="name">indent</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#FST.indent"></a>
    
            <div class="docstring"><p>The default single level of block indentation string for this tree when not available from context, root node only.</p>
</div>


                            </div>
                            <div id="FST.lines" class="classattr">
                                        <input id="FST.lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">lines</span><span class="annotation">: list[str] | None</span>

                <label class="view-source-button" for="FST.lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.lines-205"><a href="#FST.lines-205"><span class="linenos">205</span></a>    <span class="nd">@property</span>
</span><span id="FST.lines-206"><a href="#FST.lines-206"><span class="linenos">206</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.lines-207"><a href="#FST.lines-207"><span class="linenos">207</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whole lines which contain this node, may also contain parts of enclosing nodes. If gotten at root then the</span>
</span><span id="FST.lines-208"><a href="#FST.lines-208"><span class="linenos">208</span></a><span class="sd">        entire source is returned, which may extend beyond the location of the top level node (mostly for statements</span>
</span><span id="FST.lines-209"><a href="#FST.lines-209"><span class="linenos">209</span></a><span class="sd">        which may have leading / trailing comments or empty lines).&quot;&quot;&quot;</span>
</span><span id="FST.lines-210"><a href="#FST.lines-210"><span class="linenos">210</span></a>
</span><span id="FST.lines-211"><a href="#FST.lines-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="FST.lines-212"><a href="#FST.lines-212"><span class="linenos">212</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST.lines-213"><a href="#FST.lines-213"><span class="linenos">213</span></a>        <span class="k">elif</span> <span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">:</span>
</span><span id="FST.lines-214"><a href="#FST.lines-214"><span class="linenos">214</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="o">.</span><span class="n">ln</span> <span class="p">:</span> <span class="n">loc</span><span class="o">.</span><span class="n">end_ln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="FST.lines-215"><a href="#FST.lines-215"><span class="linenos">215</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>  <span class="c1"># arguments with no loc are empty arguments</span>
</span><span id="FST.lines-216"><a href="#FST.lines-216"><span class="linenos">216</span></a>            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
</span><span id="FST.lines-217"><a href="#FST.lines-217"><span class="linenos">217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.lines-218"><a href="#FST.lines-218"><span class="linenos">218</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">:=</span> <span class="n">OPCLS2STR</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># for boolop only really, otherwise None</span>
</span></pre></div>


            <div class="docstring"><p>Whole lines which contain this node, may also contain parts of enclosing nodes. If gotten at root then the
entire source is returned, which may extend beyond the location of the top level node (mostly for statements
which may have leading / trailing comments or empty lines).</p>
</div>


                            </div>
                            <div id="FST.src" class="classattr">
                                        <input id="FST.src-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">src</span><span class="annotation">: str | None</span>

                <label class="view-source-button" for="FST.src-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.src"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.src-220"><a href="#FST.src-220"><span class="linenos">220</span></a>    <span class="nd">@property</span>
</span><span id="FST.src-221"><a href="#FST.src-221"><span class="linenos">221</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">src</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.src-222"><a href="#FST.src-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Source code of this node clipped out of as a single string, without any dedentation. Will have indentation as</span>
</span><span id="FST.src-223"><a href="#FST.src-223"><span class="linenos">223</span></a><span class="sd">        it appears in the top level source if multiple lines. If gotten at root then the entire source is returned,</span>
</span><span id="FST.src-224"><a href="#FST.src-224"><span class="linenos">224</span></a><span class="sd">        regardless of whether the actual top level node location includes it or not.&quot;&quot;&quot;</span>
</span><span id="FST.src-225"><a href="#FST.src-225"><span class="linenos">225</span></a>
</span><span id="FST.src-226"><a href="#FST.src-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="FST.src-227"><a href="#FST.src-227"><span class="linenos">227</span></a>            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span>
</span><span id="FST.src-228"><a href="#FST.src-228"><span class="linenos">228</span></a>        <span class="k">elif</span> <span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">:</span>
</span><span id="FST.src-229"><a href="#FST.src-229"><span class="linenos">229</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="o">*</span><span class="n">loc</span><span class="p">)</span>
</span><span id="FST.src-230"><a href="#FST.src-230"><span class="linenos">230</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>  <span class="c1"># arguments with no loc are empty arguments</span>
</span><span id="FST.src-231"><a href="#FST.src-231"><span class="linenos">231</span></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST.src-232"><a href="#FST.src-232"><span class="linenos">232</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.src-233"><a href="#FST.src-233"><span class="linenos">233</span></a>            <span class="k">return</span> <span class="n">OPCLS2STR</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># for boolop only really, otherwise None</span>
</span></pre></div>


            <div class="docstring"><p>Source code of this node clipped out of as a single string, without any dedentation. Will have indentation as
it appears in the top level source if multiple lines. If gotten at root then the entire source is returned,
regardless of whether the actual top level node location includes it or not.</p>
</div>


                            </div>
                            <div id="FST.is_root" class="classattr">
                                        <input id="FST.is_root-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_root</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_root-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_root"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_root-235"><a href="#FST.is_root-235"><span class="linenos">235</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_root-236"><a href="#FST.is_root-236"><span class="linenos">236</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_root-237"><a href="#FST.is_root-237"><span class="linenos">237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;`True` for the root node, `False` otherwise.&quot;&quot;&quot;</span>
</span><span id="FST.is_root-238"><a href="#FST.is_root-238"><span class="linenos">238</span></a>
</span><span id="FST.is_root-239"><a href="#FST.is_root-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p><code>True</code> for the root node, <code>False</code> otherwise.</p>
</div>


                            </div>
                            <div id="FST.has_own_loc" class="classattr">
                                        <input id="FST.has_own_loc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">has_own_loc</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.has_own_loc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.has_own_loc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.has_own_loc-241"><a href="#FST.has_own_loc-241"><span class="linenos">241</span></a>    <span class="nd">@property</span>
</span><span id="FST.has_own_loc-242"><a href="#FST.has_own_loc-242"><span class="linenos">242</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_own_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.has_own_loc-243"><a href="#FST.has_own_loc-243"><span class="linenos">243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;`True` when the node has its own location which comes directly from AST `lineno` and other location fields.</span>
</span><span id="FST.has_own_loc-244"><a href="#FST.has_own_loc-244"><span class="linenos">244</span></a><span class="sd">        Otherwise `False` if no `loc` or `loc` is calculated.&quot;&quot;&quot;</span>
</span><span id="FST.has_own_loc-245"><a href="#FST.has_own_loc-245"><span class="linenos">245</span></a>
</span><span id="FST.has_own_loc-246"><a href="#FST.has_own_loc-246"><span class="linenos">246</span></a>        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;end_col_offset&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p><code>True</code> when the node has its own location which comes directly from AST <code><a href="#FST.lineno">lineno</a></code> and other location fields.
Otherwise <code>False</code> if no <code><a href="#FST.loc">loc</a></code> or <code><a href="#FST.loc">loc</a></code> is calculated.</p>
</div>


                            </div>
                            <div id="FST.whole_loc" class="classattr">
                                        <input id="FST.whole_loc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">whole_loc</span><span class="annotation">: <a href="misc.html#fstloc">fst.misc.fstloc</a></span>

                <label class="view-source-button" for="FST.whole_loc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.whole_loc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.whole_loc-248"><a href="#FST.whole_loc-248"><span class="linenos">248</span></a>    <span class="nd">@property</span>
</span><span id="FST.whole_loc-249"><a href="#FST.whole_loc-249"><span class="linenos">249</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">whole_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span><span class="p">:</span>
</span><span id="FST.whole_loc-250"><a href="#FST.whole_loc-250"><span class="linenos">250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whole source location, from 0,0 to end of source. Works from any node (not just root).&quot;&quot;&quot;</span>
</span><span id="FST.whole_loc-251"><a href="#FST.whole_loc-251"><span class="linenos">251</span></a>
</span><span id="FST.whole_loc-252"><a href="#FST.whole_loc-252"><span class="linenos">252</span></a>        <span class="k">return</span> <span class="n">fstloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Whole source location, from 0,0 to end of source. Works from any node (not just root).</p>
</div>


                            </div>
                            <div id="FST.loc" class="classattr">
                                        <input id="FST.loc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">loc</span><span class="annotation">: <a href="misc.html#fstloc">fst.misc.fstloc</a> | None</span>

                <label class="view-source-button" for="FST.loc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.loc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.loc-254"><a href="#FST.loc-254"><span class="linenos">254</span></a>    <span class="nd">@property</span>
</span><span id="FST.loc-255"><a href="#FST.loc-255"><span class="linenos">255</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.loc-256"><a href="#FST.loc-256"><span class="linenos">256</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Zero based character indexed location of node (may not be entire location if node has decorators). Not all</span>
</span><span id="FST.loc-257"><a href="#FST.loc-257"><span class="linenos">257</span></a><span class="sd">        nodes have locations (like `expr_context`). Other nodes which normally don&#39;t have locations like `arguments` or</span>
</span><span id="FST.loc-258"><a href="#FST.loc-258"><span class="linenos">258</span></a><span class="sd">        most operators have this location calculated from their children or source. NOTE: Empty arguments do NOT have</span>
</span><span id="FST.loc-259"><a href="#FST.loc-259"><span class="linenos">259</span></a><span class="sd">        a location even though the `AST` exists.&quot;&quot;&quot;</span>
</span><span id="FST.loc-260"><a href="#FST.loc-260"><span class="linenos">260</span></a>
</span><span id="FST.loc-261"><a href="#FST.loc-261"><span class="linenos">261</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.loc-262"><a href="#FST.loc-262"><span class="linenos">262</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span>
</span><span id="FST.loc-263"><a href="#FST.loc-263"><span class="linenos">263</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="FST.loc-264"><a href="#FST.loc-264"><span class="linenos">264</span></a>            <span class="k">pass</span>
</span><span id="FST.loc-265"><a href="#FST.loc-265"><span class="linenos">265</span></a>
</span><span id="FST.loc-266"><a href="#FST.loc-266"><span class="linenos">266</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.loc-267"><a href="#FST.loc-267"><span class="linenos">267</span></a>
</span><span id="FST.loc-268"><a href="#FST.loc-268"><span class="linenos">268</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.loc-269"><a href="#FST.loc-269"><span class="linenos">269</span></a>            <span class="n">ln</span>             <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="FST.loc-270"><a href="#FST.loc-270"><span class="linenos">270</span></a>            <span class="n">col_offset</span>     <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">col_offset</span>
</span><span id="FST.loc-271"><a href="#FST.loc-271"><span class="linenos">271</span></a>            <span class="n">end_ln</span>         <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">end_lineno</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="FST.loc-272"><a href="#FST.loc-272"><span class="linenos">272</span></a>            <span class="n">end_col_offset</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">end_col_offset</span>
</span><span id="FST.loc-273"><a href="#FST.loc-273"><span class="linenos">273</span></a>
</span><span id="FST.loc-274"><a href="#FST.loc-274"><span class="linenos">274</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="FST.loc-275"><a href="#FST.loc-275"><span class="linenos">275</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
</span><span id="FST.loc-276"><a href="#FST.loc-276"><span class="linenos">276</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_arguments</span><span class="p">()</span>
</span><span id="FST.loc-277"><a href="#FST.loc-277"><span class="linenos">277</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">comprehension</span><span class="p">):</span>
</span><span id="FST.loc-278"><a href="#FST.loc-278"><span class="linenos">278</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_comprehension</span><span class="p">()</span>
</span><span id="FST.loc-279"><a href="#FST.loc-279"><span class="linenos">279</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">withitem</span><span class="p">):</span>
</span><span id="FST.loc-280"><a href="#FST.loc-280"><span class="linenos">280</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_withitem</span><span class="p">()</span>
</span><span id="FST.loc-281"><a href="#FST.loc-281"><span class="linenos">281</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">match_case</span><span class="p">):</span>
</span><span id="FST.loc-282"><a href="#FST.loc-282"><span class="linenos">282</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_match_case</span><span class="p">()</span>
</span><span id="FST.loc-283"><a href="#FST.loc-283"><span class="linenos">283</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">cmpop</span><span class="p">)):</span>
</span><span id="FST.loc-284"><a href="#FST.loc-284"><span class="linenos">284</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_operator</span><span class="p">()</span>
</span><span id="FST.loc-285"><a href="#FST.loc-285"><span class="linenos">285</span></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST.loc-286"><a href="#FST.loc-286"><span class="linenos">286</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="FST.loc-287"><a href="#FST.loc-287"><span class="linenos">287</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.loc-288"><a href="#FST.loc-288"><span class="linenos">288</span></a>                <span class="n">loc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST.loc-289"><a href="#FST.loc-289"><span class="linenos">289</span></a>
</span><span id="FST.loc-290"><a href="#FST.loc-290"><span class="linenos">290</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.loc-291"><a href="#FST.loc-291"><span class="linenos">291</span></a>            <span class="n">col</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">b2c</span><span class="p">(</span><span class="n">col_offset</span><span class="p">)</span>
</span><span id="FST.loc-292"><a href="#FST.loc-292"><span class="linenos">292</span></a>            <span class="n">end_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">end_ln</span><span class="p">]</span><span class="o">.</span><span class="n">b2c</span><span class="p">(</span><span class="n">end_col_offset</span><span class="p">)</span>
</span><span id="FST.loc-293"><a href="#FST.loc-293"><span class="linenos">293</span></a>            <span class="n">loc</span>     <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">)</span>
</span><span id="FST.loc-294"><a href="#FST.loc-294"><span class="linenos">294</span></a>
</span><span id="FST.loc-295"><a href="#FST.loc-295"><span class="linenos">295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc</span>
</span><span id="FST.loc-296"><a href="#FST.loc-296"><span class="linenos">296</span></a>
</span><span id="FST.loc-297"><a href="#FST.loc-297"><span class="linenos">297</span></a>        <span class="k">return</span> <span class="n">loc</span>
</span></pre></div>


            <div class="docstring"><p>Zero based character indexed location of node (may not be entire location if node has decorators). Not all
nodes have locations (like <code>expr_context</code>). Other nodes which normally don't have locations like <code>arguments</code> or
most operators have this location calculated from their children or source. NOTE: Empty arguments do NOT have
a location even though the <code>AST</code> exists.</p>
</div>


                            </div>
                            <div id="FST.bloc" class="classattr">
                                        <input id="FST.bloc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bloc</span><span class="annotation">: <a href="misc.html#fstloc">fst.misc.fstloc</a> | None</span>

                <label class="view-source-button" for="FST.bloc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.bloc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.bloc-299"><a href="#FST.bloc-299"><span class="linenos">299</span></a>    <span class="nd">@property</span>
</span><span id="FST.bloc-300"><a href="#FST.bloc-300"><span class="linenos">300</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bloc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.bloc-301"><a href="#FST.bloc-301"><span class="linenos">301</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Bounding location of node, including any preceding decorators. Not all nodes have locations but any node</span>
</span><span id="FST.bloc-302"><a href="#FST.bloc-302"><span class="linenos">302</span></a><span class="sd">        which has a `loc` will have a `bloc`. Will be same as `loc` for all nodes except those that have decorators, in</span>
</span><span id="FST.bloc-303"><a href="#FST.bloc-303"><span class="linenos">303</span></a><span class="sd">        which case it will start at the first decorator.&quot;&quot;&quot;</span>
</span><span id="FST.bloc-304"><a href="#FST.bloc-304"><span class="linenos">304</span></a>
</span><span id="FST.bloc-305"><a href="#FST.bloc-305"><span class="linenos">305</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.bloc-306"><a href="#FST.bloc-306"><span class="linenos">306</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;bloc&#39;</span><span class="p">]</span>
</span><span id="FST.bloc-307"><a href="#FST.bloc-307"><span class="linenos">307</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="FST.bloc-308"><a href="#FST.bloc-308"><span class="linenos">308</span></a>            <span class="k">pass</span>
</span><span id="FST.bloc-309"><a href="#FST.bloc-309"><span class="linenos">309</span></a>
</span><span id="FST.bloc-310"><a href="#FST.bloc-310"><span class="linenos">310</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">bloc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">decos</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;decorator_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
</span><span id="FST.bloc-311"><a href="#FST.bloc-311"><span class="linenos">311</span></a>            <span class="n">bloc</span> <span class="o">=</span> <span class="n">fstloc</span><span class="p">(</span><span class="n">decos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">ln</span><span class="p">,</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bloc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># column of deco &#39;@&#39; will be same as our column</span>
</span><span id="FST.bloc-312"><a href="#FST.bloc-312"><span class="linenos">312</span></a>
</span><span id="FST.bloc-313"><a href="#FST.bloc-313"><span class="linenos">313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;bloc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bloc</span>
</span><span id="FST.bloc-314"><a href="#FST.bloc-314"><span class="linenos">314</span></a>
</span><span id="FST.bloc-315"><a href="#FST.bloc-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="n">bloc</span>
</span></pre></div>


            <div class="docstring"><p>Bounding location of node, including any preceding decorators. Not all nodes have locations but any node
which has a <code><a href="#FST.loc">loc</a></code> will have a <code><a href="#FST.bloc">bloc</a></code>. Will be same as <code><a href="#FST.loc">loc</a></code> for all nodes except those that have decorators, in
which case it will start at the first decorator.</p>
</div>


                            </div>
                            <div id="FST.ln" class="classattr">
                                        <input id="FST.ln-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ln</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.ln-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.ln"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.ln-317"><a href="#FST.ln-317"><span class="linenos">317</span></a>    <span class="nd">@property</span>
</span><span id="FST.ln-318"><a href="#FST.ln-318"><span class="linenos">318</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="FST.ln-319"><a href="#FST.ln-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the first line of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST.ln-320"><a href="#FST.ln-320"><span class="linenos">320</span></a>
</span><span id="FST.ln-321"><a href="#FST.ln-321"><span class="linenos">321</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Line number of the first line of this node (0 based).</p>
</div>


                            </div>
                            <div id="FST.col" class="classattr">
                                        <input id="FST.col-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">col</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.col-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.col"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.col-323"><a href="#FST.col-323"><span class="linenos">323</span></a>    <span class="nd">@property</span>
</span><span id="FST.col-324"><a href="#FST.col-324"><span class="linenos">324</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># char index</span>
</span><span id="FST.col-325"><a href="#FST.col-325"><span class="linenos">325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;CHARACTER index of the start of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST.col-326"><a href="#FST.col-326"><span class="linenos">326</span></a>
</span><span id="FST.col-327"><a href="#FST.col-327"><span class="linenos">327</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>CHARACTER index of the start of this node (0 based).</p>
</div>


                            </div>
                            <div id="FST.end_ln" class="classattr">
                                        <input id="FST.end_ln-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">end_ln</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.end_ln-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.end_ln"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.end_ln-329"><a href="#FST.end_ln-329"><span class="linenos">329</span></a>    <span class="nd">@property</span>
</span><span id="FST.end_ln-330"><a href="#FST.end_ln-330"><span class="linenos">330</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_ln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 0 based</span>
</span><span id="FST.end_ln-331"><a href="#FST.end_ln-331"><span class="linenos">331</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the LAST LINE of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST.end_ln-332"><a href="#FST.end_ln-332"><span class="linenos">332</span></a>
</span><span id="FST.end_ln-333"><a href="#FST.end_ln-333"><span class="linenos">333</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Line number of the LAST LINE of this node (0 based).</p>
</div>


                            </div>
                            <div id="FST.end_col" class="classattr">
                                        <input id="FST.end_col-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">end_col</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.end_col-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.end_col"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.end_col-335"><a href="#FST.end_col-335"><span class="linenos">335</span></a>    <span class="nd">@property</span>
</span><span id="FST.end_col-336"><a href="#FST.end_col-336"><span class="linenos">336</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># char index</span>
</span><span id="FST.end_col-337"><a href="#FST.end_col-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;CHARACTER index one past the end of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST.end_col-338"><a href="#FST.end_col-338"><span class="linenos">338</span></a>
</span><span id="FST.end_col-339"><a href="#FST.end_col-339"><span class="linenos">339</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>CHARACTER index one past the end of this node (0 based).</p>
</div>


                            </div>
                            <div id="FST.bln" class="classattr">
                                        <input id="FST.bln-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bln</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.bln-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.bln"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.bln-341"><a href="#FST.bln-341"><span class="linenos">341</span></a>    <span class="nd">@property</span>
</span><span id="FST.bln-342"><a href="#FST.bln-342"><span class="linenos">342</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># bounding location including @decorators</span>
</span><span id="FST.bln-343"><a href="#FST.bln-343"><span class="linenos">343</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the first line of this node or the first decorator if present (0 based). The corresponding</span>
</span><span id="FST.bln-344"><a href="#FST.bln-344"><span class="linenos">344</span></a><span class="sd">        `bcol`, `bend_ln` and `bend_col` are just aliases for the normal values.&quot;&quot;&quot;</span>
</span><span id="FST.bln-345"><a href="#FST.bln-345"><span class="linenos">345</span></a>
</span><span id="FST.bln-346"><a href="#FST.bln-346"><span class="linenos">346</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Line number of the first line of this node or the first decorator if present (0 based). The corresponding
<code><a href="#FST.bcol">bcol</a></code>, <code><a href="#FST.bend_ln">bend_ln</a></code> and <code><a href="#FST.bend_col">bend_col</a></code> are just aliases for the normal values.</p>
</div>


                            </div>
                            <div id="FST.bcol" class="classattr">
                                        <input id="FST.bcol-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bcol</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.bcol-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.bcol"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.bcol-323"><a href="#FST.bcol-323"><span class="linenos">323</span></a>    <span class="nd">@property</span>
</span><span id="FST.bcol-324"><a href="#FST.bcol-324"><span class="linenos">324</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># char index</span>
</span><span id="FST.bcol-325"><a href="#FST.bcol-325"><span class="linenos">325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;CHARACTER index of the start of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST.bcol-326"><a href="#FST.bcol-326"><span class="linenos">326</span></a>
</span><span id="FST.bcol-327"><a href="#FST.bcol-327"><span class="linenos">327</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>CHARACTER index of the start of this node (0 based).</p>
</div>


                            </div>
                            <div id="FST.bend_ln" class="classattr">
                                        <input id="FST.bend_ln-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bend_ln</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.bend_ln-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.bend_ln"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.bend_ln-329"><a href="#FST.bend_ln-329"><span class="linenos">329</span></a>    <span class="nd">@property</span>
</span><span id="FST.bend_ln-330"><a href="#FST.bend_ln-330"><span class="linenos">330</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_ln</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 0 based</span>
</span><span id="FST.bend_ln-331"><a href="#FST.bend_ln-331"><span class="linenos">331</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line number of the LAST LINE of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST.bend_ln-332"><a href="#FST.bend_ln-332"><span class="linenos">332</span></a>
</span><span id="FST.bend_ln-333"><a href="#FST.bend_ln-333"><span class="linenos">333</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Line number of the LAST LINE of this node (0 based).</p>
</div>


                            </div>
                            <div id="FST.bend_col" class="classattr">
                                        <input id="FST.bend_col-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bend_col</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.bend_col-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.bend_col"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.bend_col-335"><a href="#FST.bend_col-335"><span class="linenos">335</span></a>    <span class="nd">@property</span>
</span><span id="FST.bend_col-336"><a href="#FST.bend_col-336"><span class="linenos">336</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># char index</span>
</span><span id="FST.bend_col-337"><a href="#FST.bend_col-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;CHARACTER index one past the end of this node (0 based).&quot;&quot;&quot;</span>
</span><span id="FST.bend_col-338"><a href="#FST.bend_col-338"><span class="linenos">338</span></a>
</span><span id="FST.bend_col-339"><a href="#FST.bend_col-339"><span class="linenos">339</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>CHARACTER index one past the end of this node (0 based).</p>
</div>


                            </div>
                            <div id="FST.lineno" class="classattr">
                                        <input id="FST.lineno-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">lineno</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.lineno-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.lineno"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.lineno-352"><a href="#FST.lineno-352"><span class="linenos">352</span></a>    <span class="nd">@property</span>
</span><span id="FST.lineno-353"><a href="#FST.lineno-353"><span class="linenos">353</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lineno</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 1 based</span>
</span><span id="FST.lineno-354"><a href="#FST.lineno-354"><span class="linenos">354</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style Line number of the first line of this node (1 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="FST.lineno-355"><a href="#FST.lineno-355"><span class="linenos">355</span></a>
</span><span id="FST.lineno-356"><a href="#FST.lineno-356"><span class="linenos">356</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span></pre></div>


            <div class="docstring"><p>AST-style Line number of the first line of this node (1 based), available for all nodes which have <code><a href="#FST.loc">loc</a></code>.</p>
</div>


                            </div>
                            <div id="FST.col_offset" class="classattr">
                                        <input id="FST.col_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">col_offset</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.col_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.col_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.col_offset-358"><a href="#FST.col_offset-358"><span class="linenos">358</span></a>    <span class="nd">@property</span>
</span><span id="FST.col_offset-359"><a href="#FST.col_offset-359"><span class="linenos">359</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">col_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># byte index</span>
</span><span id="FST.col_offset-360"><a href="#FST.col_offset-360"><span class="linenos">360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style BYTE index of the start of this node (0 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="FST.col_offset-361"><a href="#FST.col_offset-361"><span class="linenos">361</span></a>
</span><span id="FST.col_offset-362"><a href="#FST.col_offset-362"><span class="linenos">362</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">c2b</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>AST-style BYTE index of the start of this node (0 based), available for all nodes which have <code><a href="#FST.loc">loc</a></code>.</p>
</div>


                            </div>
                            <div id="FST.end_lineno" class="classattr">
                                        <input id="FST.end_lineno-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">end_lineno</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.end_lineno-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.end_lineno"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.end_lineno-364"><a href="#FST.end_lineno-364"><span class="linenos">364</span></a>    <span class="nd">@property</span>
</span><span id="FST.end_lineno-365"><a href="#FST.end_lineno-365"><span class="linenos">365</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_lineno</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># 1 based</span>
</span><span id="FST.end_lineno-366"><a href="#FST.end_lineno-366"><span class="linenos">366</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style Line number of the LAST LINE of this node (1 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="FST.end_lineno-367"><a href="#FST.end_lineno-367"><span class="linenos">367</span></a>
</span><span id="FST.end_lineno-368"><a href="#FST.end_lineno-368"><span class="linenos">368</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span></pre></div>


            <div class="docstring"><p>AST-style Line number of the LAST LINE of this node (1 based), available for all nodes which have <code><a href="#FST.loc">loc</a></code>.</p>
</div>


                            </div>
                            <div id="FST.end_col_offset" class="classattr">
                                        <input id="FST.end_col_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">end_col_offset</span><span class="annotation">: int</span>

                <label class="view-source-button" for="FST.end_col_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.end_col_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.end_col_offset-370"><a href="#FST.end_col_offset-370"><span class="linenos">370</span></a>    <span class="nd">@property</span>
</span><span id="FST.end_col_offset-371"><a href="#FST.end_col_offset-371"><span class="linenos">371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_col_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># byte index</span>
</span><span id="FST.end_col_offset-372"><a href="#FST.end_col_offset-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;AST-style BYTE index one past the end of this node (0 based), available for all nodes which have `loc`.&quot;&quot;&quot;</span>
</span><span id="FST.end_col_offset-373"><a href="#FST.end_col_offset-373"><span class="linenos">373</span></a>
</span><span id="FST.end_col_offset-374"><a href="#FST.end_col_offset-374"><span class="linenos">374</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">c2b</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>AST-style BYTE index one past the end of this node (0 based), available for all nodes which have <code><a href="#FST.loc">loc</a></code>.</p>
</div>


                            </div>
                            <div id="FST.is_mod" class="classattr">
                                        <input id="FST.is_mod-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_mod</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_mod-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_mod"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_mod-376"><a href="#FST.is_mod-376"><span class="linenos">376</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_mod-377"><a href="#FST.is_mod-377"><span class="linenos">377</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_mod</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_mod-378"><a href="#FST.is_mod-378"><span class="linenos">378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `mod`.&quot;&quot;&quot;</span>
</span><span id="FST.is_mod-379"><a href="#FST.is_mod-379"><span class="linenos">379</span></a>
</span><span id="FST.is_mod-380"><a href="#FST.is_mod-380"><span class="linenos">380</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Is a <code>mod</code>.</p>
</div>


                            </div>
                            <div id="FST.is_stmtish" class="classattr">
                                        <input id="FST.is_stmtish-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_stmtish</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_stmtish-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_stmtish"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_stmtish-382"><a href="#FST.is_stmtish-382"><span class="linenos">382</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_stmtish-383"><a href="#FST.is_stmtish-383"><span class="linenos">383</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_stmtish</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_stmtish-384"><a href="#FST.is_stmtish-384"><span class="linenos">384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `stmt`, `ExceptHandler` or `match_case`.&quot;&quot;&quot;</span>
</span><span id="FST.is_stmtish-385"><a href="#FST.is_stmtish-385"><span class="linenos">385</span></a>
</span><span id="FST.is_stmtish-386"><a href="#FST.is_stmtish-386"><span class="linenos">386</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">STMTISH</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Is a <code>stmt</code>, <code>ExceptHandler</code> or <code>match_case</code>.</p>
</div>


                            </div>
                            <div id="FST.is_stmt" class="classattr">
                                        <input id="FST.is_stmt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_stmt</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_stmt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_stmt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_stmt-388"><a href="#FST.is_stmt-388"><span class="linenos">388</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_stmt-389"><a href="#FST.is_stmt-389"><span class="linenos">389</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_stmt-390"><a href="#FST.is_stmt-390"><span class="linenos">390</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a `stmt`.&quot;&quot;&quot;</span>
</span><span id="FST.is_stmt-391"><a href="#FST.is_stmt-391"><span class="linenos">391</span></a>
</span><span id="FST.is_stmt-392"><a href="#FST.is_stmt-392"><span class="linenos">392</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">stmt</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Is a <code>stmt</code>.</p>
</div>


                            </div>
                            <div id="FST.is_block" class="classattr">
                                        <input id="FST.is_block-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_block</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_block-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_block"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_block-394"><a href="#FST.is_block-394"><span class="linenos">394</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_block-395"><a href="#FST.is_block-395"><span class="linenos">395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_block-396"><a href="#FST.is_block-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a block. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef`, `For`,</span>
</span><span id="FST.is_block-397"><a href="#FST.is_block-397"><span class="linenos">397</span></a><span class="sd">        `AsyncFor`, `While`, `If`, `With`, `AsyncWith`, `Match`, `Try`, `TryStar`, `ExceptHandler`, `match_case` or</span>
</span><span id="FST.is_block-398"><a href="#FST.is_block-398"><span class="linenos">398</span></a><span class="sd">        `mod`.&quot;&quot;&quot;</span>
</span><span id="FST.is_block-399"><a href="#FST.is_block-399"><span class="linenos">399</span></a>
</span><span id="FST.is_block-400"><a href="#FST.is_block-400"><span class="linenos">400</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">BLOCK_OR_MOD</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Is a node which opens a block. Types include <code>FunctionDef</code>, <code>AsyncFunctionDef</code>, <code>ClassDef</code>, <code>For</code>,
<code>AsyncFor</code>, <code>While</code>, <code>If</code>, <code>With</code>, <code>AsyncWith</code>, <code>Match</code>, <code>Try</code>, <code>TryStar</code>, <code>ExceptHandler</code>, <code>match_case</code> or
<code>mod</code>.</p>
</div>


                            </div>
                            <div id="FST.is_scope" class="classattr">
                                        <input id="FST.is_scope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_scope</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_scope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_scope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_scope-402"><a href="#FST.is_scope-402"><span class="linenos">402</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_scope-403"><a href="#FST.is_scope-403"><span class="linenos">403</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_scope-404"><a href="#FST.is_scope-404"><span class="linenos">404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a scope. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef`, `Lambda`,</span>
</span><span id="FST.is_scope-405"><a href="#FST.is_scope-405"><span class="linenos">405</span></a><span class="sd">        `ListComp`, `SetComp`, `DictComp`, `GeneratorExp` or `mod`.&quot;&quot;&quot;</span>
</span><span id="FST.is_scope-406"><a href="#FST.is_scope-406"><span class="linenos">406</span></a>
</span><span id="FST.is_scope-407"><a href="#FST.is_scope-407"><span class="linenos">407</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">SCOPE_OR_MOD</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Is a node which opens a scope. Types include <code>FunctionDef</code>, <code>AsyncFunctionDef</code>, <code>ClassDef</code>, <code>Lambda</code>,
<code>ListComp</code>, <code>SetComp</code>, <code>DictComp</code>, <code>GeneratorExp</code> or <code>mod</code>.</p>
</div>


                            </div>
                            <div id="FST.is_named_scope" class="classattr">
                                        <input id="FST.is_named_scope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_named_scope</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_named_scope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_named_scope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_named_scope-409"><a href="#FST.is_named_scope-409"><span class="linenos">409</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_named_scope-410"><a href="#FST.is_named_scope-410"><span class="linenos">410</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_named_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_named_scope-411"><a href="#FST.is_named_scope-411"><span class="linenos">411</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens a named scope. Types include `FunctionDef`, `AsyncFunctionDef`, `ClassDef` or `mod`.&quot;&quot;&quot;</span>
</span><span id="FST.is_named_scope-412"><a href="#FST.is_named_scope-412"><span class="linenos">412</span></a>
</span><span id="FST.is_named_scope-413"><a href="#FST.is_named_scope-413"><span class="linenos">413</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">NAMED_SCOPE_OR_MOD</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Is a node which opens a named scope. Types include <code>FunctionDef</code>, <code>AsyncFunctionDef</code>, <code>ClassDef</code> or <code>mod</code>.</p>
</div>


                            </div>
                            <div id="FST.is_anon_scope" class="classattr">
                                        <input id="FST.is_anon_scope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_anon_scope</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_anon_scope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_anon_scope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_anon_scope-415"><a href="#FST.is_anon_scope-415"><span class="linenos">415</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_anon_scope-416"><a href="#FST.is_anon_scope-416"><span class="linenos">416</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_anon_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_anon_scope-417"><a href="#FST.is_anon_scope-417"><span class="linenos">417</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is a node which opens an anonymous scope. Types include `Lambda`, `ListComp`, `SetComp`, `DictComp` or</span>
</span><span id="FST.is_anon_scope-418"><a href="#FST.is_anon_scope-418"><span class="linenos">418</span></a><span class="sd">        `GeneratorExp`.&quot;&quot;&quot;</span>
</span><span id="FST.is_anon_scope-419"><a href="#FST.is_anon_scope-419"><span class="linenos">419</span></a>
</span><span id="FST.is_anon_scope-420"><a href="#FST.is_anon_scope-420"><span class="linenos">420</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">ANONYMOUS_SCOPE</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Is a node which opens an anonymous scope. Types include <code>Lambda</code>, <code>ListComp</code>, <code>SetComp</code>, <code>DictComp</code> or
<code>GeneratorExp</code>.</p>
</div>


                            </div>
                            <div id="FST.is_slice" class="classattr">
                                        <input id="FST.is_slice-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_slice</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="FST.is_slice-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_slice"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_slice-422"><a href="#FST.is_slice-422"><span class="linenos">422</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_slice-423"><a href="#FST.is_slice-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_slice-424"><a href="#FST.is_slice-424"><span class="linenos">424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether self is a `Slice` or a `Tuple` which directly contains any `Slice`.</span>
</span><span id="FST.is_slice-425"><a href="#FST.is_slice-425"><span class="linenos">425</span></a>
</span><span id="FST.is_slice-426"><a href="#FST.is_slice-426"><span class="linenos">426</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_slice-427"><a href="#FST.is_slice-427"><span class="linenos">427</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_slice-428"><a href="#FST.is_slice-428"><span class="linenos">428</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;, &#39;expr_slice&#39;).is_slice</span>
</span><span id="FST.is_slice-429"><a href="#FST.is_slice-429"><span class="linenos">429</span></a><span class="sd">        True</span>
</span><span id="FST.is_slice-430"><a href="#FST.is_slice-430"><span class="linenos">430</span></a>
</span><span id="FST.is_slice-431"><a href="#FST.is_slice-431"><span class="linenos">431</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, d:e&#39;, &#39;expr_slice&#39;).is_slice  # Tuple contains at least one Slice</span>
</span><span id="FST.is_slice-432"><a href="#FST.is_slice-432"><span class="linenos">432</span></a><span class="sd">        True</span>
</span><span id="FST.is_slice-433"><a href="#FST.is_slice-433"><span class="linenos">433</span></a>
</span><span id="FST.is_slice-434"><a href="#FST.is_slice-434"><span class="linenos">434</span></a><span class="sd">        &gt;&gt;&gt; # b is in the .slice field but is not a Slice or Slice Tuple</span>
</span><span id="FST.is_slice-435"><a href="#FST.is_slice-435"><span class="linenos">435</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b]&#39;).slice.is_slice</span>
</span><span id="FST.is_slice-436"><a href="#FST.is_slice-436"><span class="linenos">436</span></a><span class="sd">        False</span>
</span><span id="FST.is_slice-437"><a href="#FST.is_slice-437"><span class="linenos">437</span></a><span class="sd">        ```</span>
</span><span id="FST.is_slice-438"><a href="#FST.is_slice-438"><span class="linenos">438</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_slice-439"><a href="#FST.is_slice-439"><span class="linenos">439</span></a>
</span><span id="FST.is_slice-440"><a href="#FST.is_slice-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST.is_slice-441"><a href="#FST.is_slice-441"><span class="linenos">441</span></a>                                                  <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">elts</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Whether self is a <code>Slice</code> or a <code>Tuple</code> which directly contains any <code>Slice</code>.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a:b:c&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_slice&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_slice</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;1, d:e&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_slice&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_slice</span>  <span class="c1"># Tuple contains at least one Slice</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="c1"># b is in the .slice field but is not a Slice or Slice Tuple</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a[b]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">is_slice</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_augop" class="classattr">
                                        <input id="FST.is_augop-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_augop</span><span class="annotation">: bool | None</span>

                <label class="view-source-button" for="FST.is_augop-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_augop"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_augop-443"><a href="#FST.is_augop-443"><span class="linenos">443</span></a>    <span class="nd">@property</span>
</span><span id="FST.is_augop-444"><a href="#FST.is_augop-444"><span class="linenos">444</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_augop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_augop-445"><a href="#FST.is_augop-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an augmented `operator` or not, or not an `operator` at all.</span>
</span><span id="FST.is_augop-446"><a href="#FST.is_augop-446"><span class="linenos">446</span></a>
</span><span id="FST.is_augop-447"><a href="#FST.is_augop-447"><span class="linenos">447</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_augop-448"><a href="#FST.is_augop-448"><span class="linenos">448</span></a><span class="sd">        - `True` if is augmented `operator`, `False` if non-augmented `operator` and `None` if is not `operator` at all.</span>
</span><span id="FST.is_augop-449"><a href="#FST.is_augop-449"><span class="linenos">449</span></a>
</span><span id="FST.is_augop-450"><a href="#FST.is_augop-450"><span class="linenos">450</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_augop-451"><a href="#FST.is_augop-451"><span class="linenos">451</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_augop-452"><a href="#FST.is_augop-452"><span class="linenos">452</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;+&#39;).is_augop</span>
</span><span id="FST.is_augop-453"><a href="#FST.is_augop-453"><span class="linenos">453</span></a><span class="sd">        False</span>
</span><span id="FST.is_augop-454"><a href="#FST.is_augop-454"><span class="linenos">454</span></a>
</span><span id="FST.is_augop-455"><a href="#FST.is_augop-455"><span class="linenos">455</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;+=&#39;).is_augop</span>
</span><span id="FST.is_augop-456"><a href="#FST.is_augop-456"><span class="linenos">456</span></a><span class="sd">        True</span>
</span><span id="FST.is_augop-457"><a href="#FST.is_augop-457"><span class="linenos">457</span></a>
</span><span id="FST.is_augop-458"><a href="#FST.is_augop-458"><span class="linenos">458</span></a><span class="sd">        &gt;&gt;&gt; repr(FST(&#39;~&#39;).is_augop)</span>
</span><span id="FST.is_augop-459"><a href="#FST.is_augop-459"><span class="linenos">459</span></a><span class="sd">        &#39;None&#39;</span>
</span><span id="FST.is_augop-460"><a href="#FST.is_augop-460"><span class="linenos">460</span></a><span class="sd">        ```</span>
</span><span id="FST.is_augop-461"><a href="#FST.is_augop-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_augop-462"><a href="#FST.is_augop-462"><span class="linenos">462</span></a>
</span><span id="FST.is_augop-463"><a href="#FST.is_augop-463"><span class="linenos">463</span></a>        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">operator</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span> <span class="ow">in</span> <span class="n">OPSTR2CLS_AUG</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is an augmented <code>operator</code> or not, or not an <code>operator</code> at all.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>True</code> if is augmented <code>operator</code>, <code>False</code> if non-augmented <code>operator</code> and <code>None</code> if is not <code>operator</code> at all.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_augop</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;+=&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_augop</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">repr</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_augop</span><span class="p">)</span>
<span class="s1">&#39;None&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.new" class="classattr">
                                        <input id="FST.new-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">new</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;exec&#39;</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span>,</span><span class="param">	<span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">feature_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.new-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.new"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.new-638"><a href="#FST.new-638"><span class="linenos">638</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST.new-639"><a href="#FST.new-639"><span class="linenos">639</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="FST.new-640"><a href="#FST.new-640"><span class="linenos">640</span></a>            <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST.new-641"><a href="#FST.new-641"><span class="linenos">641</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new empty `FST` tree with the top level node dictated by the `mode` parameter.</span>
</span><span id="FST.new-642"><a href="#FST.new-642"><span class="linenos">642</span></a>
</span><span id="FST.new-643"><a href="#FST.new-643"><span class="linenos">643</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.new-644"><a href="#FST.new-644"><span class="linenos">644</span></a><span class="sd">        - `mode`: `ast.parse()` parameter, can only be `&#39;exec&#39;`, `&#39;eval&#39;` or `&#39;single&#39;` here.</span>
</span><span id="FST.new-645"><a href="#FST.new-645"><span class="linenos">645</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="FST.new-646"><a href="#FST.new-646"><span class="linenos">646</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="FST.new-647"><a href="#FST.new-647"><span class="linenos">647</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="FST.new-648"><a href="#FST.new-648"><span class="linenos">648</span></a>
</span><span id="FST.new-649"><a href="#FST.new-649"><span class="linenos">649</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.new-650"><a href="#FST.new-650"><span class="linenos">650</span></a><span class="sd">        - `FST`: The new empty top level `FST` node.</span>
</span><span id="FST.new-651"><a href="#FST.new-651"><span class="linenos">651</span></a>
</span><span id="FST.new-652"><a href="#FST.new-652"><span class="linenos">652</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.new-653"><a href="#FST.new-653"><span class="linenos">653</span></a><span class="sd">        ```py</span>
</span><span id="FST.new-654"><a href="#FST.new-654"><span class="linenos">654</span></a><span class="sd">        &gt;&gt;&gt; FST.new()</span>
</span><span id="FST.new-655"><a href="#FST.new-655"><span class="linenos">655</span></a><span class="sd">        &lt;Module ROOT 0,0..0,0&gt;</span>
</span><span id="FST.new-656"><a href="#FST.new-656"><span class="linenos">656</span></a>
</span><span id="FST.new-657"><a href="#FST.new-657"><span class="linenos">657</span></a><span class="sd">        &gt;&gt;&gt; FST.new(mode=&#39;single&#39;)</span>
</span><span id="FST.new-658"><a href="#FST.new-658"><span class="linenos">658</span></a><span class="sd">        &lt;Interactive ROOT 0,0..0,0&gt;</span>
</span><span id="FST.new-659"><a href="#FST.new-659"><span class="linenos">659</span></a>
</span><span id="FST.new-660"><a href="#FST.new-660"><span class="linenos">660</span></a><span class="sd">        &gt;&gt;&gt; FST.new(mode=&#39;eval&#39;)</span>
</span><span id="FST.new-661"><a href="#FST.new-661"><span class="linenos">661</span></a><span class="sd">        &lt;Expression ROOT 0,0..0,4&gt;</span>
</span><span id="FST.new-662"><a href="#FST.new-662"><span class="linenos">662</span></a>
</span><span id="FST.new-663"><a href="#FST.new-663"><span class="linenos">663</span></a><span class="sd">        &gt;&gt;&gt; _.dump()</span>
</span><span id="FST.new-664"><a href="#FST.new-664"><span class="linenos">664</span></a><span class="sd">        Expression - ROOT 0,0..0,4</span>
</span><span id="FST.new-665"><a href="#FST.new-665"><span class="linenos">665</span></a><span class="sd">          .body Constant None - 0,0..0,4</span>
</span><span id="FST.new-666"><a href="#FST.new-666"><span class="linenos">666</span></a>
</span><span id="FST.new-667"><a href="#FST.new-667"><span class="linenos">667</span></a><span class="sd">        &gt;&gt;&gt; _.src</span>
</span><span id="FST.new-668"><a href="#FST.new-668"><span class="linenos">668</span></a><span class="sd">        &#39;None&#39;</span>
</span><span id="FST.new-669"><a href="#FST.new-669"><span class="linenos">669</span></a><span class="sd">        ```</span>
</span><span id="FST.new-670"><a href="#FST.new-670"><span class="linenos">670</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.new-671"><a href="#FST.new-671"><span class="linenos">671</span></a>
</span><span id="FST.new-672"><a href="#FST.new-672"><span class="linenos">672</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="FST.new-673"><a href="#FST.new-673"><span class="linenos">673</span></a>
</span><span id="FST.new-674"><a href="#FST.new-674"><span class="linenos">674</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;exec&#39;</span><span class="p">:</span>
</span><span id="FST.new-675"><a href="#FST.new-675"><span class="linenos">675</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Module</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="p">[],</span> <span class="n">type_ignores</span><span class="o">=</span><span class="p">[])</span>
</span><span id="FST.new-676"><a href="#FST.new-676"><span class="linenos">676</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST.new-677"><a href="#FST.new-677"><span class="linenos">677</span></a>
</span><span id="FST.new-678"><a href="#FST.new-678"><span class="linenos">678</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;eval&#39;</span><span class="p">:</span>
</span><span id="FST.new-679"><a href="#FST.new-679"><span class="linenos">679</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lineno</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_lineno</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end_col_offset</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</span><span id="FST.new-680"><a href="#FST.new-680"><span class="linenos">680</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
</span><span id="FST.new-681"><a href="#FST.new-681"><span class="linenos">681</span></a>
</span><span id="FST.new-682"><a href="#FST.new-682"><span class="linenos">682</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
</span><span id="FST.new-683"><a href="#FST.new-683"><span class="linenos">683</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">Interactive</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="p">[])</span>
</span><span id="FST.new-684"><a href="#FST.new-684"><span class="linenos">684</span></a>            <span class="n">src</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST.new-685"><a href="#FST.new-685"><span class="linenos">685</span></a>
</span><span id="FST.new-686"><a href="#FST.new-686"><span class="linenos">686</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.new-687"><a href="#FST.new-687"><span class="linenos">687</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid mode &#39;</span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&#39; for blank FST&quot;</span><span class="p">)</span>
</span><span id="FST.new-688"><a href="#FST.new-688"><span class="linenos">688</span></a>
</span><span id="FST.new-689"><a href="#FST.new-689"><span class="linenos">689</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">src</span><span class="p">)],</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">,</span> <span class="n">lcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a new empty <code><a href="#FST">FST</a></code> tree with the top level node dictated by the <code>mode</code> parameter.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>mode</code>: <code>ast.parse()</code> parameter, can only be <code>'exec'</code>, <code>'eval'</code> or <code>'single'</code> here.</li>
<li><code>filename</code>: <code>ast.parse()</code> parameter.</li>
<li><code>type_comments</code>: <code>ast.parse()</code> parameter.</li>
<li><code>feature_version</code>: <code>ast.parse()</code> parameter.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: The new empty top level <code><a href="#FST">FST</a></code> node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.new">FST.new</a></span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">0</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.new">FST.new</a></span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Interactive</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">0</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.new">FST.new</a></span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;eval&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Expression</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="n">Expression</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">4</span>
  <span class="o">.</span><span class="n">body</span> <span class="n">Constant</span> <span class="kc">None</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">4</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;None&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.fromsrc" class="classattr">
                                        <input id="FST.fromsrc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">fromsrc</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">src</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;most&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtishs&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtish&#39;</span><span class="p">,</span> <span class="s1">&#39;stmts&#39;</span><span class="p">,</span> <span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;ExceptHandlers&#39;</span><span class="p">,</span> <span class="s1">&#39;ExceptHandler&#39;</span><span class="p">,</span> <span class="s1">&#39;match_cases&#39;</span><span class="p">,</span> <span class="s1">&#39;match_case&#39;</span><span class="p">,</span> <span class="s1">&#39;expr&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_slice&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_sliceelt&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_callarg&#39;</span><span class="p">,</span> <span class="s1">&#39;boolop&#39;</span><span class="p">,</span> <span class="s1">&#39;operator&#39;</span><span class="p">,</span> <span class="s1">&#39;binop&#39;</span><span class="p">,</span> <span class="s1">&#39;augop&#39;</span><span class="p">,</span> <span class="s1">&#39;unaryop&#39;</span><span class="p">,</span> <span class="s1">&#39;cmpop&#39;</span><span class="p">,</span> <span class="s1">&#39;comprehension&#39;</span><span class="p">,</span> <span class="s1">&#39;arguments&#39;</span><span class="p">,</span> <span class="s1">&#39;arguments_lambda&#39;</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="s1">&#39;keyword&#39;</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">,</span> <span class="s1">&#39;alias_dotted&#39;</span><span class="p">,</span> <span class="s1">&#39;alias_star&#39;</span><span class="p">,</span> <span class="s1">&#39;withitem&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span><span class="p">,</span> <span class="s1">&#39;type_param&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;exec&#39;</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span>,</span><span class="param">	<span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">feature_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.fromsrc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.fromsrc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.fromsrc-691"><a href="#FST.fromsrc-691"><span class="linenos">691</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST.fromsrc-692"><a href="#FST.fromsrc-692"><span class="linenos">692</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fromsrc</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">],</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">=</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="FST.fromsrc-693"><a href="#FST.fromsrc-693"><span class="linenos">693</span></a>                <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST.fromsrc-694"><a href="#FST.fromsrc-694"><span class="linenos">694</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse and create a new `FST` tree from source, preserving the original source and locations.</span>
</span><span id="FST.fromsrc-695"><a href="#FST.fromsrc-695"><span class="linenos">695</span></a>
</span><span id="FST.fromsrc-696"><a href="#FST.fromsrc-696"><span class="linenos">696</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.fromsrc-697"><a href="#FST.fromsrc-697"><span class="linenos">697</span></a><span class="sd">        - `src`: The source to parse as a single `str` or list of individual line strings (without newlines).</span>
</span><span id="FST.fromsrc-698"><a href="#FST.fromsrc-698"><span class="linenos">698</span></a><span class="sd">        - `mode`: Parse mode, extended `ast.parse()` parameter, See `fst.misc.Mode`.</span>
</span><span id="FST.fromsrc-699"><a href="#FST.fromsrc-699"><span class="linenos">699</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="FST.fromsrc-700"><a href="#FST.fromsrc-700"><span class="linenos">700</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="FST.fromsrc-701"><a href="#FST.fromsrc-701"><span class="linenos">701</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="FST.fromsrc-702"><a href="#FST.fromsrc-702"><span class="linenos">702</span></a>
</span><span id="FST.fromsrc-703"><a href="#FST.fromsrc-703"><span class="linenos">703</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.fromsrc-704"><a href="#FST.fromsrc-704"><span class="linenos">704</span></a><span class="sd">        - `FST`: The parsed tree with `.f` attributes added to each `AST` node for `FST` access.</span>
</span><span id="FST.fromsrc-705"><a href="#FST.fromsrc-705"><span class="linenos">705</span></a>
</span><span id="FST.fromsrc-706"><a href="#FST.fromsrc-706"><span class="linenos">706</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.fromsrc-707"><a href="#FST.fromsrc-707"><span class="linenos">707</span></a><span class="sd">        ```py</span>
</span><span id="FST.fromsrc-708"><a href="#FST.fromsrc-708"><span class="linenos">708</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;).dump()</span>
</span><span id="FST.fromsrc-709"><a href="#FST.fromsrc-709"><span class="linenos">709</span></a><span class="sd">        Module - ROOT 0,0..0,3</span>
</span><span id="FST.fromsrc-710"><a href="#FST.fromsrc-710"><span class="linenos">710</span></a><span class="sd">          .body[1]</span>
</span><span id="FST.fromsrc-711"><a href="#FST.fromsrc-711"><span class="linenos">711</span></a><span class="sd">          0] Expr - 0,0..0,3</span>
</span><span id="FST.fromsrc-712"><a href="#FST.fromsrc-712"><span class="linenos">712</span></a><span class="sd">            .value Name &#39;var&#39; Load - 0,0..0,3</span>
</span><span id="FST.fromsrc-713"><a href="#FST.fromsrc-713"><span class="linenos">713</span></a>
</span><span id="FST.fromsrc-714"><a href="#FST.fromsrc-714"><span class="linenos">714</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;, mode=&#39;stmt&#39;).dump()</span>
</span><span id="FST.fromsrc-715"><a href="#FST.fromsrc-715"><span class="linenos">715</span></a><span class="sd">        Expr - ROOT 0,0..0,3</span>
</span><span id="FST.fromsrc-716"><a href="#FST.fromsrc-716"><span class="linenos">716</span></a><span class="sd">          .value Name &#39;var&#39; Load - 0,0..0,3</span>
</span><span id="FST.fromsrc-717"><a href="#FST.fromsrc-717"><span class="linenos">717</span></a>
</span><span id="FST.fromsrc-718"><a href="#FST.fromsrc-718"><span class="linenos">718</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;var&#39;, mode=&#39;expr&#39;).dump()</span>
</span><span id="FST.fromsrc-719"><a href="#FST.fromsrc-719"><span class="linenos">719</span></a><span class="sd">        Name &#39;var&#39; Load - ROOT 0,0..0,3</span>
</span><span id="FST.fromsrc-720"><a href="#FST.fromsrc-720"><span class="linenos">720</span></a>
</span><span id="FST.fromsrc-721"><a href="#FST.fromsrc-721"><span class="linenos">721</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;except Exception: pass&#39;, &#39;stmtish&#39;).dump()</span>
</span><span id="FST.fromsrc-722"><a href="#FST.fromsrc-722"><span class="linenos">722</span></a><span class="sd">        ExceptHandler - ROOT 0,0..0,22</span>
</span><span id="FST.fromsrc-723"><a href="#FST.fromsrc-723"><span class="linenos">723</span></a><span class="sd">          .type Name &#39;Exception&#39; Load - 0,7..0,16</span>
</span><span id="FST.fromsrc-724"><a href="#FST.fromsrc-724"><span class="linenos">724</span></a><span class="sd">          .body[1]</span>
</span><span id="FST.fromsrc-725"><a href="#FST.fromsrc-725"><span class="linenos">725</span></a><span class="sd">          0] Pass - 0,18..0,22</span>
</span><span id="FST.fromsrc-726"><a href="#FST.fromsrc-726"><span class="linenos">726</span></a>
</span><span id="FST.fromsrc-727"><a href="#FST.fromsrc-727"><span class="linenos">727</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;case f(a=1): pass&#39;, &#39;stmtish&#39;).dump()</span>
</span><span id="FST.fromsrc-728"><a href="#FST.fromsrc-728"><span class="linenos">728</span></a><span class="sd">        match_case - ROOT 0,0..0,17</span>
</span><span id="FST.fromsrc-729"><a href="#FST.fromsrc-729"><span class="linenos">729</span></a><span class="sd">          .pattern MatchClass - 0,5..0,11</span>
</span><span id="FST.fromsrc-730"><a href="#FST.fromsrc-730"><span class="linenos">730</span></a><span class="sd">            .cls Name &#39;f&#39; Load - 0,5..0,6</span>
</span><span id="FST.fromsrc-731"><a href="#FST.fromsrc-731"><span class="linenos">731</span></a><span class="sd">            .kwd_attrs[1]</span>
</span><span id="FST.fromsrc-732"><a href="#FST.fromsrc-732"><span class="linenos">732</span></a><span class="sd">            0] &#39;a&#39;</span>
</span><span id="FST.fromsrc-733"><a href="#FST.fromsrc-733"><span class="linenos">733</span></a><span class="sd">            .kwd_patterns[1]</span>
</span><span id="FST.fromsrc-734"><a href="#FST.fromsrc-734"><span class="linenos">734</span></a><span class="sd">            0] MatchValue - 0,9..0,10</span>
</span><span id="FST.fromsrc-735"><a href="#FST.fromsrc-735"><span class="linenos">735</span></a><span class="sd">              .value Constant 1 - 0,9..0,10</span>
</span><span id="FST.fromsrc-736"><a href="#FST.fromsrc-736"><span class="linenos">736</span></a><span class="sd">          .body[1]</span>
</span><span id="FST.fromsrc-737"><a href="#FST.fromsrc-737"><span class="linenos">737</span></a><span class="sd">          0] Pass - 0,13..0,17</span>
</span><span id="FST.fromsrc-738"><a href="#FST.fromsrc-738"><span class="linenos">738</span></a>
</span><span id="FST.fromsrc-739"><a href="#FST.fromsrc-739"><span class="linenos">739</span></a><span class="sd">        &gt;&gt;&gt; FST.fromsrc(&#39;a:b&#39;, Slice).dump()</span>
</span><span id="FST.fromsrc-740"><a href="#FST.fromsrc-740"><span class="linenos">740</span></a><span class="sd">        Slice - ROOT 0,0..0,3</span>
</span><span id="FST.fromsrc-741"><a href="#FST.fromsrc-741"><span class="linenos">741</span></a><span class="sd">          .lower Name &#39;a&#39; Load - 0,0..0,1</span>
</span><span id="FST.fromsrc-742"><a href="#FST.fromsrc-742"><span class="linenos">742</span></a><span class="sd">          .upper Name &#39;b&#39; Load - 0,2..0,3</span>
</span><span id="FST.fromsrc-743"><a href="#FST.fromsrc-743"><span class="linenos">743</span></a><span class="sd">        ```</span>
</span><span id="FST.fromsrc-744"><a href="#FST.fromsrc-744"><span class="linenos">744</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.fromsrc-745"><a href="#FST.fromsrc-745"><span class="linenos">745</span></a>
</span><span id="FST.fromsrc-746"><a href="#FST.fromsrc-746"><span class="linenos">746</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FST.fromsrc-747"><a href="#FST.fromsrc-747"><span class="linenos">747</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST.fromsrc-748"><a href="#FST.fromsrc-748"><span class="linenos">748</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.fromsrc-749"><a href="#FST.fromsrc-749"><span class="linenos">749</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">src</span>
</span><span id="FST.fromsrc-750"><a href="#FST.fromsrc-750"><span class="linenos">750</span></a>            <span class="n">src</span>   <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span><span id="FST.fromsrc-751"><a href="#FST.fromsrc-751"><span class="linenos">751</span></a>
</span><span id="FST.fromsrc-752"><a href="#FST.fromsrc-752"><span class="linenos">752</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="FST.fromsrc-753"><a href="#FST.fromsrc-753"><span class="linenos">753</span></a>        <span class="n">ast</span>          <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST.fromsrc-754"><a href="#FST.fromsrc-754"><span class="linenos">754</span></a>
</span><span id="FST.fromsrc-755"><a href="#FST.fromsrc-755"><span class="linenos">755</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parse and create a new <code><a href="#FST">FST</a></code> tree from source, preserving the original source and locations.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.src">src</a></code>: The source to parse as a single <code>str</code> or list of individual line strings (without newlines).</li>
<li><code>mode</code>: Parse mode, extended <code>ast.parse()</code> parameter, See <code><a href="misc.html#Mode">fst.misc.Mode</a></code>.</li>
<li><code>filename</code>: <code>ast.parse()</code> parameter.</li>
<li><code>type_comments</code>: <code>ast.parse()</code> parameter.</li>
<li><code>feature_version</code>: <code>ast.parse()</code> parameter.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: The parsed tree with <code>.f</code> attributes added to each <code>AST</code> node for <code><a href="#FST">FST</a></code> access.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromsrc">FST.fromsrc</a></span><span class="p">(</span><span class="s1">&#39;var&#39;</span><span class="p">)<a href="#dump">.dump</a></span><span class="p">()</span>
<span class="n">Module</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">3</span>
  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="mi">0</span><span class="p">]</span> <span class="n">Expr</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">3</span>
    <span class="o">.</span><span class="n">value</span> <span class="n">Name</span> <span class="s1">&#39;var&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">3</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromsrc">FST.fromsrc</a></span><span class="p">(</span><span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;stmt&#39;</span><span class="p">)<a href="#dump">.dump</a></span><span class="p">()</span>
<span class="n">Expr</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">3</span>
  <span class="o">.</span><span class="n">value</span> <span class="n">Name</span> <span class="s1">&#39;var&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">3</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromsrc">FST.fromsrc</a></span><span class="p">(</span><span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;expr&#39;</span><span class="p">)<a href="#dump">.dump</a></span><span class="p">()</span>
<span class="n">Name</span> <span class="s1">&#39;var&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">3</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromsrc">FST.fromsrc</a></span><span class="p">(</span><span class="s1">&#39;except Exception: pass&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtish&#39;</span><span class="p">)<a href="#dump">.dump</a></span><span class="p">()</span>
<span class="n">ExceptHandler</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">22</span>
  <span class="o">.</span><span class="n">type</span> <span class="n">Name</span> <span class="s1">&#39;Exception&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">7..0</span><span class="p">,</span><span class="mi">16</span>
  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="mi">0</span><span class="p">]</span> <span class="n">Pass</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">18..0</span><span class="p">,</span><span class="mi">22</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromsrc">FST.fromsrc</a></span><span class="p">(</span><span class="s1">&#39;case f(a=1): pass&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtish&#39;</span><span class="p">)<a href="#dump">.dump</a></span><span class="p">()</span>
<span class="n">match_case</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">17</span>
  <span class="o">.</span><span class="n">pattern</span> <span class="n">MatchClass</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">5..0</span><span class="p">,</span><span class="mi">11</span>
    <span class="o">.</span><span class="n">cls</span> <span class="n">Name</span> <span class="s1">&#39;f&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">5..0</span><span class="p">,</span><span class="mi">6</span>
    <span class="o">.</span><span class="n">kwd_attrs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="mi">0</span><span class="p">]</span> <span class="s1">&#39;a&#39;</span>
    <span class="o">.</span><span class="n">kwd_patterns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="mi">0</span><span class="p">]</span> <span class="n">MatchValue</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">9..0</span><span class="p">,</span><span class="mi">10</span>
      <span class="o">.</span><span class="n">value</span> <span class="n">Constant</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">9..0</span><span class="p">,</span><span class="mi">10</span>
  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="mi">0</span><span class="p">]</span> <span class="n">Pass</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">13..0</span><span class="p">,</span><span class="mi">17</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromsrc">FST.fromsrc</a></span><span class="p">(</span><span class="s1">&#39;a:b&#39;</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)<a href="#dump">.dump</a></span><span class="p">()</span>
<span class="n">Slice</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">3</span>
  <span class="o">.</span><span class="n">lower</span> <span class="n">Name</span> <span class="s1">&#39;a&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">1</span>
  <span class="o">.</span><span class="n">upper</span> <span class="n">Name</span> <span class="s1">&#39;b&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">2..0</span><span class="p">,</span><span class="mi">3</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.fromast" class="classattr">
                                        <input id="FST.fromast-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">fromast</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">ast</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span>,</span><span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;most&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtishs&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtish&#39;</span><span class="p">,</span> <span class="s1">&#39;stmts&#39;</span><span class="p">,</span> <span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;ExceptHandlers&#39;</span><span class="p">,</span> <span class="s1">&#39;ExceptHandler&#39;</span><span class="p">,</span> <span class="s1">&#39;match_cases&#39;</span><span class="p">,</span> <span class="s1">&#39;match_case&#39;</span><span class="p">,</span> <span class="s1">&#39;expr&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_slice&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_sliceelt&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_callarg&#39;</span><span class="p">,</span> <span class="s1">&#39;boolop&#39;</span><span class="p">,</span> <span class="s1">&#39;operator&#39;</span><span class="p">,</span> <span class="s1">&#39;binop&#39;</span><span class="p">,</span> <span class="s1">&#39;augop&#39;</span><span class="p">,</span> <span class="s1">&#39;unaryop&#39;</span><span class="p">,</span> <span class="s1">&#39;cmpop&#39;</span><span class="p">,</span> <span class="s1">&#39;comprehension&#39;</span><span class="p">,</span> <span class="s1">&#39;arguments&#39;</span><span class="p">,</span> <span class="s1">&#39;arguments_lambda&#39;</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="s1">&#39;keyword&#39;</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">,</span> <span class="s1">&#39;alias_dotted&#39;</span><span class="p">,</span> <span class="s1">&#39;alias_star&#39;</span><span class="p">,</span> <span class="s1">&#39;withitem&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span><span class="p">,</span> <span class="s1">&#39;type_param&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span>,</span><span class="param">	<span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">feature_version</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">ctx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.fromast-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.fromast"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.fromast-757"><a href="#FST.fromast-757"><span class="linenos">757</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST.fromast-758"><a href="#FST.fromast-758"><span class="linenos">758</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fromast</span><span class="p">(</span><span class="n">ast</span><span class="p">:</span> <span class="n">AST</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;unknown&gt;&#39;</span><span class="p">,</span>
</span><span id="FST.fromast-759"><a href="#FST.fromast-759"><span class="linenos">759</span></a>                <span class="n">type_comments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST.fromast-760"><a href="#FST.fromast-760"><span class="linenos">760</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Unparse and reparse an `AST` for new `FST` (the reparse is necessary to make sure locations are correct).</span>
</span><span id="FST.fromast-761"><a href="#FST.fromast-761"><span class="linenos">761</span></a>
</span><span id="FST.fromast-762"><a href="#FST.fromast-762"><span class="linenos">762</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.fromast-763"><a href="#FST.fromast-763"><span class="linenos">763</span></a><span class="sd">        - `ast`: The root `AST` node.</span>
</span><span id="FST.fromast-764"><a href="#FST.fromast-764"><span class="linenos">764</span></a><span class="sd">        - `mode`: Parse mode, extended `ast.parse()` parameter, see `fst.misc.Mode`. Two special values are added:</span>
</span><span id="FST.fromast-765"><a href="#FST.fromast-765"><span class="linenos">765</span></a><span class="sd">            - `None`: This will attempt to reparse to the same node type as was passed in. This is the default and all</span>
</span><span id="FST.fromast-766"><a href="#FST.fromast-766"><span class="linenos">766</span></a><span class="sd">                other values should be considered overrides for special cases.</span>
</span><span id="FST.fromast-767"><a href="#FST.fromast-767"><span class="linenos">767</span></a><span class="sd">            - `False`: This will skip the reparse and just `ast.unparse()` the `AST` to generate source for the `FST`.</span>
</span><span id="FST.fromast-768"><a href="#FST.fromast-768"><span class="linenos">768</span></a><span class="sd">                Use this only if you are absolutely certain that the `AST` unparsed source will correspond with the</span>
</span><span id="FST.fromast-769"><a href="#FST.fromast-769"><span class="linenos">769</span></a><span class="sd">                locations already present in the `AST`. This is almost never the case unless the `AST` was</span>
</span><span id="FST.fromast-770"><a href="#FST.fromast-770"><span class="linenos">770</span></a><span class="sd">                `ast.parse()`d from an explicitly `ast.unparse()`d `AST`.</span>
</span><span id="FST.fromast-771"><a href="#FST.fromast-771"><span class="linenos">771</span></a><span class="sd">        - `filename`: `ast.parse()` parameter.</span>
</span><span id="FST.fromast-772"><a href="#FST.fromast-772"><span class="linenos">772</span></a><span class="sd">        - `type_comments`: `ast.parse()` parameter.</span>
</span><span id="FST.fromast-773"><a href="#FST.fromast-773"><span class="linenos">773</span></a><span class="sd">        - `feature_version`: `ast.parse()` parameter.</span>
</span><span id="FST.fromast-774"><a href="#FST.fromast-774"><span class="linenos">774</span></a><span class="sd">        - `ctx`: Whether to make sure that the `ctx` field of the reparsed `AST` matches or not. `False` for</span>
</span><span id="FST.fromast-775"><a href="#FST.fromast-775"><span class="linenos">775</span></a><span class="sd">            convenience, `True` if you&#39;re feeling pedantic.</span>
</span><span id="FST.fromast-776"><a href="#FST.fromast-776"><span class="linenos">776</span></a>
</span><span id="FST.fromast-777"><a href="#FST.fromast-777"><span class="linenos">777</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.fromast-778"><a href="#FST.fromast-778"><span class="linenos">778</span></a><span class="sd">        - `FST`: The augmented tree with `.f` attributes added to each `AST` node for `FST` access.</span>
</span><span id="FST.fromast-779"><a href="#FST.fromast-779"><span class="linenos">779</span></a>
</span><span id="FST.fromast-780"><a href="#FST.fromast-780"><span class="linenos">780</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.fromast-781"><a href="#FST.fromast-781"><span class="linenos">781</span></a><span class="sd">        ```py</span>
</span><span id="FST.fromast-782"><a href="#FST.fromast-782"><span class="linenos">782</span></a><span class="sd">        &gt;&gt;&gt; import ast</span>
</span><span id="FST.fromast-783"><a href="#FST.fromast-783"><span class="linenos">783</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(Assign(targets=[Name(id=&#39;var&#39;)],</span>
</span><span id="FST.fromast-784"><a href="#FST.fromast-784"><span class="linenos">784</span></a><span class="sd">        ...                    value=Constant(value=123))).dump(&#39;stmt&#39;)</span>
</span><span id="FST.fromast-785"><a href="#FST.fromast-785"><span class="linenos">785</span></a><span class="sd">        0: var = 123</span>
</span><span id="FST.fromast-786"><a href="#FST.fromast-786"><span class="linenos">786</span></a><span class="sd">        Assign - ROOT 0,0..0,9</span>
</span><span id="FST.fromast-787"><a href="#FST.fromast-787"><span class="linenos">787</span></a><span class="sd">          .targets[1]</span>
</span><span id="FST.fromast-788"><a href="#FST.fromast-788"><span class="linenos">788</span></a><span class="sd">          0] Name &#39;var&#39; Store - 0,0..0,3</span>
</span><span id="FST.fromast-789"><a href="#FST.fromast-789"><span class="linenos">789</span></a><span class="sd">          .value Constant 123 - 0,6..0,9</span>
</span><span id="FST.fromast-790"><a href="#FST.fromast-790"><span class="linenos">790</span></a>
</span><span id="FST.fromast-791"><a href="#FST.fromast-791"><span class="linenos">791</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(ast.parse(&#39;if 1:\n    j = 5&#39;)).dump(&#39;stmt&#39;)</span>
</span><span id="FST.fromast-792"><a href="#FST.fromast-792"><span class="linenos">792</span></a><span class="sd">        Module - ROOT 0,0..1,9</span>
</span><span id="FST.fromast-793"><a href="#FST.fromast-793"><span class="linenos">793</span></a><span class="sd">          .body[1]</span>
</span><span id="FST.fromast-794"><a href="#FST.fromast-794"><span class="linenos">794</span></a><span class="sd">        0: if 1:</span>
</span><span id="FST.fromast-795"><a href="#FST.fromast-795"><span class="linenos">795</span></a><span class="sd">          0] If - 0,0..1,9</span>
</span><span id="FST.fromast-796"><a href="#FST.fromast-796"><span class="linenos">796</span></a><span class="sd">            .test Constant 1 - 0,3..0,4</span>
</span><span id="FST.fromast-797"><a href="#FST.fromast-797"><span class="linenos">797</span></a><span class="sd">            .body[1]</span>
</span><span id="FST.fromast-798"><a href="#FST.fromast-798"><span class="linenos">798</span></a><span class="sd">        1:     j = 5</span>
</span><span id="FST.fromast-799"><a href="#FST.fromast-799"><span class="linenos">799</span></a><span class="sd">            0] Assign - 1,4..1,9</span>
</span><span id="FST.fromast-800"><a href="#FST.fromast-800"><span class="linenos">800</span></a><span class="sd">              .targets[1]</span>
</span><span id="FST.fromast-801"><a href="#FST.fromast-801"><span class="linenos">801</span></a><span class="sd">              0] Name &#39;j&#39; Store - 1,4..1,5</span>
</span><span id="FST.fromast-802"><a href="#FST.fromast-802"><span class="linenos">802</span></a><span class="sd">              .value Constant 5 - 1,8..1,9</span>
</span><span id="FST.fromast-803"><a href="#FST.fromast-803"><span class="linenos">803</span></a>
</span><span id="FST.fromast-804"><a href="#FST.fromast-804"><span class="linenos">804</span></a><span class="sd">        &gt;&gt;&gt; FST.fromast(Slice(lower=Constant(value=1), step=Name(id=&#39;step&#39;))).dump(&#39;all&#39;)</span>
</span><span id="FST.fromast-805"><a href="#FST.fromast-805"><span class="linenos">805</span></a><span class="sd">        0: 1::step</span>
</span><span id="FST.fromast-806"><a href="#FST.fromast-806"><span class="linenos">806</span></a><span class="sd">        Slice - ROOT 0,0..0,7</span>
</span><span id="FST.fromast-807"><a href="#FST.fromast-807"><span class="linenos">807</span></a><span class="sd">        0: 1</span>
</span><span id="FST.fromast-808"><a href="#FST.fromast-808"><span class="linenos">808</span></a><span class="sd">          .lower Constant 1 - 0,0..0,1</span>
</span><span id="FST.fromast-809"><a href="#FST.fromast-809"><span class="linenos">809</span></a><span class="sd">        0:    step</span>
</span><span id="FST.fromast-810"><a href="#FST.fromast-810"><span class="linenos">810</span></a><span class="sd">          .step Name &#39;step&#39; Load - 0,3..0,7</span>
</span><span id="FST.fromast-811"><a href="#FST.fromast-811"><span class="linenos">811</span></a><span class="sd">        ```</span>
</span><span id="FST.fromast-812"><a href="#FST.fromast-812"><span class="linenos">812</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.fromast-813"><a href="#FST.fromast-813"><span class="linenos">813</span></a>
</span><span id="FST.fromast-814"><a href="#FST.fromast-814"><span class="linenos">814</span></a>        <span class="k">if</span> <span class="n">type_comments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.fromast-815"><a href="#FST.fromast-815"><span class="linenos">815</span></a>            <span class="n">type_comments</span> <span class="o">=</span> <span class="n">has_type_comments</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="FST.fromast-816"><a href="#FST.fromast-816"><span class="linenos">816</span></a>
</span><span id="FST.fromast-817"><a href="#FST.fromast-817"><span class="linenos">817</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">feature_version</span><span class="o">=</span><span class="n">feature_version</span><span class="p">)</span>
</span><span id="FST.fromast-818"><a href="#FST.fromast-818"><span class="linenos">818</span></a>        <span class="n">src</span>          <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_unparse</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="FST.fromast-819"><a href="#FST.fromast-819"><span class="linenos">819</span></a>        <span class="n">lines</span>        <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST.fromast-820"><a href="#FST.fromast-820"><span class="linenos">820</span></a>
</span><span id="FST.fromast-821"><a href="#FST.fromast-821"><span class="linenos">821</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="FST.fromast-822"><a href="#FST.fromast-822"><span class="linenos">822</span></a>            <span class="n">org</span> <span class="o">=</span> <span class="n">ast</span>
</span><span id="FST.fromast-823"><a href="#FST.fromast-823"><span class="linenos">823</span></a>            <span class="n">ast</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span> <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mode</span><span class="p">,</span> <span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST.fromast-824"><a href="#FST.fromast-824"><span class="linenos">824</span></a>
</span><span id="FST.fromast-825"><a href="#FST.fromast-825"><span class="linenos">825</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="FST.fromast-826"><a href="#FST.fromast-826"><span class="linenos">826</span></a>                <span class="n">compare_asts</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">type_comments</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">raise_</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="FST.fromast-827"><a href="#FST.fromast-827"><span class="linenos">827</span></a>            <span class="k">except</span> <span class="n">WalkFail</span><span class="p">:</span>
</span><span id="FST.fromast-828"><a href="#FST.fromast-828"><span class="linenos">828</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;could not reparse ast identically&#39;</span><span class="p">)</span>
</span><span id="FST.fromast-829"><a href="#FST.fromast-829"><span class="linenos">829</span></a>
</span><span id="FST.fromast-830"><a href="#FST.fromast-830"><span class="linenos">830</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s1">&#39;    &#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Unparse and reparse an <code>AST</code> for new <code><a href="#FST">FST</a></code> (the reparse is necessary to make sure locations are correct).</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>ast</code>: The root <code>AST</code> node.</li>
<li><code>mode</code>: Parse mode, extended <code>ast.parse()</code> parameter, see <code><a href="misc.html#Mode">fst.misc.Mode</a></code>. Two special values are added:
<ul>
<li><code>None</code>: This will attempt to reparse to the same node type as was passed in. This is the default and all
other values should be considered overrides for special cases.</li>
<li><code>False</code>: This will skip the reparse and just <code>ast.unparse()</code> the <code>AST</code> to generate source for the <code><a href="#FST">FST</a></code>.
Use this only if you are absolutely certain that the <code>AST</code> unparsed source will correspond with the
locations already present in the <code>AST</code>. This is almost never the case unless the <code>AST</code> was
<code>ast.parse()</code>d from an explicitly <code>ast.unparse()</code>d <code>AST</code>.</li>
</ul></li>
<li><code>filename</code>: <code>ast.parse()</code> parameter.</li>
<li><code>type_comments</code>: <code>ast.parse()</code> parameter.</li>
<li><code>feature_version</code>: <code>ast.parse()</code> parameter.</li>
<li><code>ctx</code>: Whether to make sure that the <code>ctx</code> field of the reparsed <code>AST</code> matches or not. <code>False</code> for
convenience, <code>True</code> if you're feeling pedantic.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: The augmented tree with <code>.f</code> attributes added to each <code>AST</code> node for <code><a href="#FST">FST</a></code> access.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">ast</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromast">FST.fromast</a></span><span class="p">(</span><span class="n">Assign</span><span class="p">(</span><span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;var&#39;</span><span class="p">)],</span>
<span class="o">...</span>                    <span class="n">value</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">123</span><span class="p">)))<a href="#dump">.dump</a></span><span class="p">(</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span>
<span class="mi">0</span><span class="p">:</span> <span class="n">var</span> <span class="o">=</span> <span class="mi">123</span>
<span class="n">Assign</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">9</span>
  <span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="mi">0</span><span class="p">]</span> <span class="n">Name</span> <span class="s1">&#39;var&#39;</span> <span class="n">Store</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">3</span>
  <span class="o">.</span><span class="n">value</span> <span class="n">Constant</span> <span class="mi">123</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">6..0</span><span class="p">,</span><span class="mi">9</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromast">FST.fromast</a></span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n</span><span class="s1">    j = 5&#39;</span><span class="p">))<a href="#dump">.dump</a></span><span class="p">(</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span>
<span class="n">Module</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">9</span>
  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">0</span><span class="p">:</span> <span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
  <span class="mi">0</span><span class="p">]</span> <span class="n">If</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">9</span>
    <span class="o">.</span><span class="n">test</span> <span class="n">Constant</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">3..0</span><span class="p">,</span><span class="mi">4</span>
    <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">1</span><span class="p">:</span>     <span class="n">j</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="mi">0</span><span class="p">]</span> <span class="n">Assign</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..1</span><span class="p">,</span><span class="mi">9</span>
      <span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="mi">0</span><span class="p">]</span> <span class="n">Name</span> <span class="s1">&#39;j&#39;</span> <span class="n">Store</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..1</span><span class="p">,</span><span class="mi">5</span>
      <span class="o">.</span><span class="n">value</span> <span class="n">Constant</span> <span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">8..1</span><span class="p">,</span><span class="mi">9</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.fromast">FST.fromast</a></span><span class="p">(</span><span class="n">Slice</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">)))<a href="#dump">.dump</a></span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">::</span><span class="n">step</span>
<span class="n">Slice</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">7</span>
<span class="mi">0</span><span class="p">:</span> <span class="mi">1</span>
  <span class="o">.</span><span class="n">lower</span> <span class="n">Constant</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">1</span>
<span class="mi">0</span><span class="p">:</span>    <span class="n">step</span>
  <span class="o">.</span><span class="n">step</span> <span class="n">Name</span> <span class="s1">&#39;step&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">3..0</span><span class="p">,</span><span class="mi">7</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.get_options" class="classattr">
                                        <input id="FST.get_options-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_options</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FST.get_options-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.get_options"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.get_options-832"><a href="#FST.get_options-832"><span class="linenos">832</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST.get_options-833"><a href="#FST.get_options-833"><span class="linenos">833</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="FST.get_options-834"><a href="#FST.get_options-834"><span class="linenos">834</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a dictionary of ALL options. These are the same `options` that can be passed to operations and this</span>
</span><span id="FST.get_options-835"><a href="#FST.get_options-835"><span class="linenos">835</span></a><span class="sd">        function returns their global defaults which are used when those options are not passed to operations or if they</span>
</span><span id="FST.get_options-836"><a href="#FST.get_options-836"><span class="linenos">836</span></a><span class="sd">        are passed with a value of `None`.</span>
</span><span id="FST.get_options-837"><a href="#FST.get_options-837"><span class="linenos">837</span></a>
</span><span id="FST.get_options-838"><a href="#FST.get_options-838"><span class="linenos">838</span></a><span class="sd">        When these options are missing or `None` in a call to an operation, then the default option as specified here is</span>
</span><span id="FST.get_options-839"><a href="#FST.get_options-839"><span class="linenos">839</span></a><span class="sd">        used.</span>
</span><span id="FST.get_options-840"><a href="#FST.get_options-840"><span class="linenos">840</span></a>
</span><span id="FST.get_options-841"><a href="#FST.get_options-841"><span class="linenos">841</span></a><span class="sd">        **Options:**</span>
</span><span id="FST.get_options-842"><a href="#FST.get_options-842"><span class="linenos">842</span></a><span class="sd">        - `pars`: How parentheses are handled, can be `False`, `True` or `&#39;auto&#39;`. This is for individual puts, for</span>
</span><span id="FST.get_options-843"><a href="#FST.get_options-843"><span class="linenos">843</span></a><span class="sd">            slices parentheses are always unchanged. Raw puts generally do not have parentheses added or removed</span>
</span><span id="FST.get_options-844"><a href="#FST.get_options-844"><span class="linenos">844</span></a><span class="sd">            automatically, except removed from the destination node if putting to a node instead of a pure location.</span>
</span><span id="FST.get_options-845"><a href="#FST.get_options-845"><span class="linenos">845</span></a><span class="sd">            - `False`: Parentheses are not MODIFIED, doesn&#39;t mean remove all parentheses. Not copied with nodes or</span>
</span><span id="FST.get_options-846"><a href="#FST.get_options-846"><span class="linenos">846</span></a><span class="sd">                removed on put from source or destination.</span>
</span><span id="FST.get_options-847"><a href="#FST.get_options-847"><span class="linenos">847</span></a><span class="sd">            - `True`: Parentheses are copied with nodes, added to copies if needed and not present, removed from</span>
</span><span id="FST.get_options-848"><a href="#FST.get_options-848"><span class="linenos">848</span></a><span class="sd">                destination on put if not needed there (but not source).</span>
</span><span id="FST.get_options-849"><a href="#FST.get_options-849"><span class="linenos">849</span></a><span class="sd">            - `&#39;auto&#39;`: Same as `True` except they are not returned with a copy and possibly removed from source</span>
</span><span id="FST.get_options-850"><a href="#FST.get_options-850"><span class="linenos">850</span></a><span class="sd">                on put if not needed (removed from destination first if needed and present on both).</span>
</span><span id="FST.get_options-851"><a href="#FST.get_options-851"><span class="linenos">851</span></a><span class="sd">        - `raw`: When to do raw source operations. This may result in more nodes changed than just the targeted one(s).</span>
</span><span id="FST.get_options-852"><a href="#FST.get_options-852"><span class="linenos">852</span></a><span class="sd">            - `False`: Do not do raw source operations.</span>
</span><span id="FST.get_options-853"><a href="#FST.get_options-853"><span class="linenos">853</span></a><span class="sd">            - `True`: Only do raw source operations.</span>
</span><span id="FST.get_options-854"><a href="#FST.get_options-854"><span class="linenos">854</span></a><span class="sd">            - `&#39;auto&#39;`: Only do raw source operations if the normal operation fails in a way that raw might not.</span>
</span><span id="FST.get_options-855"><a href="#FST.get_options-855"><span class="linenos">855</span></a><span class="sd">        - `elif_`: How to handle lone `If` statements as the only statements in an `If` statement `orelse` field.</span>
</span><span id="FST.get_options-856"><a href="#FST.get_options-856"><span class="linenos">856</span></a><span class="sd">            - `True`: If putting a single `If` statement to an `orelse` field of a parent `If` statement then</span>
</span><span id="FST.get_options-857"><a href="#FST.get_options-857"><span class="linenos">857</span></a><span class="sd">                put it as an `elif`.</span>
</span><span id="FST.get_options-858"><a href="#FST.get_options-858"><span class="linenos">858</span></a><span class="sd">            - `False`: Always put as a standalone `If` statement.</span>
</span><span id="FST.get_options-859"><a href="#FST.get_options-859"><span class="linenos">859</span></a><span class="sd">        - `docstr`: Which docstrings are indentable / dedentable.</span>
</span><span id="FST.get_options-860"><a href="#FST.get_options-860"><span class="linenos">860</span></a><span class="sd">            - `False`: None.</span>
</span><span id="FST.get_options-861"><a href="#FST.get_options-861"><span class="linenos">861</span></a><span class="sd">            - `True`: All `Expr` multiline strings (as they serve no coding purpose).</span>
</span><span id="FST.get_options-862"><a href="#FST.get_options-862"><span class="linenos">862</span></a><span class="sd">            - `&#39;strict&#39;`: Only multiline strings in expected docstring positions (functions and classes).</span>
</span><span id="FST.get_options-863"><a href="#FST.get_options-863"><span class="linenos">863</span></a><span class="sd">        - `empty_set`: Empty set source during a slice put (considered to have no elements).</span>
</span><span id="FST.get_options-864"><a href="#FST.get_options-864"><span class="linenos">864</span></a><span class="sd">            - `False`: Nothing is considered an empty set and an empty set slice put is only possible using a non-set</span>
</span><span id="FST.get_options-865"><a href="#FST.get_options-865"><span class="linenos">865</span></a><span class="sd">                type of empty sequence (tuple or list).</span>
</span><span id="FST.get_options-866"><a href="#FST.get_options-866"><span class="linenos">866</span></a><span class="sd">            - `True`: `set()` call and `{*()}`, `{*[]}` and `{*{}}` starred sequences are considered empty.</span>
</span><span id="FST.get_options-867"><a href="#FST.get_options-867"><span class="linenos">867</span></a><span class="sd">            - `&#39;seq&#39;`: Only starred sequences `{*()}`, `{*[]}` and `{*{}}` are considered empty.</span>
</span><span id="FST.get_options-868"><a href="#FST.get_options-868"><span class="linenos">868</span></a><span class="sd">            - `&#39;call&#39;`: Only `set()` call is considered empty.</span>
</span><span id="FST.get_options-869"><a href="#FST.get_options-869"><span class="linenos">869</span></a><span class="sd">        - `pep8space`: Preceding and trailing empty lines for function and class definitions.</span>
</span><span id="FST.get_options-870"><a href="#FST.get_options-870"><span class="linenos">870</span></a><span class="sd">            - `False`: No empty lines.</span>
</span><span id="FST.get_options-871"><a href="#FST.get_options-871"><span class="linenos">871</span></a><span class="sd">            - `True`: Two empty lines at module scope and one empty line in other scopes.</span>
</span><span id="FST.get_options-872"><a href="#FST.get_options-872"><span class="linenos">872</span></a><span class="sd">            - `1`: One empty line in all scopes.</span>
</span><span id="FST.get_options-873"><a href="#FST.get_options-873"><span class="linenos">873</span></a><span class="sd">        - `precomms`: Preceding comments.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="FST.get_options-874"><a href="#FST.get_options-874"><span class="linenos">874</span></a><span class="sd">            - `False`: No preceding comments.</span>
</span><span id="FST.get_options-875"><a href="#FST.get_options-875"><span class="linenos">875</span></a><span class="sd">            - `True`: Single contiguous comment block immediately preceding position.</span>
</span><span id="FST.get_options-876"><a href="#FST.get_options-876"><span class="linenos">876</span></a><span class="sd">            - `&#39;all&#39;`: Comment blocks (possibly separated by empty lines) preceding position.</span>
</span><span id="FST.get_options-877"><a href="#FST.get_options-877"><span class="linenos">877</span></a><span class="sd">        - `postcomms`: Trailing comments.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="FST.get_options-878"><a href="#FST.get_options-878"><span class="linenos">878</span></a><span class="sd">            - `False`: No trailing comments.</span>
</span><span id="FST.get_options-879"><a href="#FST.get_options-879"><span class="linenos">879</span></a><span class="sd">            - `True`: Only comment trailing on line of position, nothing past that on its own lines.</span>
</span><span id="FST.get_options-880"><a href="#FST.get_options-880"><span class="linenos">880</span></a><span class="sd">            - `&#39;block&#39;`: Single contiguous comment block following position.</span>
</span><span id="FST.get_options-881"><a href="#FST.get_options-881"><span class="linenos">881</span></a><span class="sd">            - `&#39;all&#39;`: Comment blocks (possibly separated by empty lines) following position.</span>
</span><span id="FST.get_options-882"><a href="#FST.get_options-882"><span class="linenos">882</span></a><span class="sd">        - `prespace`: Preceding empty lines (max of this and `pep8space` used).  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="FST.get_options-883"><a href="#FST.get_options-883"><span class="linenos">883</span></a><span class="sd">            - `False`: No empty lines.</span>
</span><span id="FST.get_options-884"><a href="#FST.get_options-884"><span class="linenos">884</span></a><span class="sd">            - `True`: All empty lines.</span>
</span><span id="FST.get_options-885"><a href="#FST.get_options-885"><span class="linenos">885</span></a><span class="sd">            - `int`: A maximum number of empty lines.</span>
</span><span id="FST.get_options-886"><a href="#FST.get_options-886"><span class="linenos">886</span></a><span class="sd">        - `postspace`: Same as `prespace` except for trailing empty lines.  - WILL CHANGE IN FUTURE VERSIONS!</span>
</span><span id="FST.get_options-887"><a href="#FST.get_options-887"><span class="linenos">887</span></a>
</span><span id="FST.get_options-888"><a href="#FST.get_options-888"><span class="linenos">888</span></a><span class="sd">        **Note:**</span>
</span><span id="FST.get_options-889"><a href="#FST.get_options-889"><span class="linenos">889</span></a><span class="sd">        `pars` behavior (see Examples for more):</span>
</span><span id="FST.get_options-890"><a href="#FST.get_options-890"><span class="linenos">890</span></a><span class="sd">        ```</span>
</span><span id="FST.get_options-891"><a href="#FST.get_options-891"><span class="linenos">891</span></a><span class="sd">                                                                  False      True    &#39;auto&#39;</span>
</span><span id="FST.get_options-892"><a href="#FST.get_options-892"><span class="linenos">892</span></a><span class="sd">        Copy pars from source on copy / cut:                         no       yes        no</span>
</span><span id="FST.get_options-893"><a href="#FST.get_options-893"><span class="linenos">893</span></a><span class="sd">        Add pars needed for parsability to copy:                     no       yes       yes</span>
</span><span id="FST.get_options-894"><a href="#FST.get_options-894"><span class="linenos">894</span></a><span class="sd">        Remove unneeded pars from destination on put:                no       yes       yes</span>
</span><span id="FST.get_options-895"><a href="#FST.get_options-895"><span class="linenos">895</span></a><span class="sd">        Remove unneeded pars from source on put:                     no        no       yes</span>
</span><span id="FST.get_options-896"><a href="#FST.get_options-896"><span class="linenos">896</span></a><span class="sd">        Add pars needed for parse / precedence to source on put:     no       yes       yes</span>
</span><span id="FST.get_options-897"><a href="#FST.get_options-897"><span class="linenos">897</span></a><span class="sd">        ```</span>
</span><span id="FST.get_options-898"><a href="#FST.get_options-898"><span class="linenos">898</span></a>
</span><span id="FST.get_options-899"><a href="#FST.get_options-899"><span class="linenos">899</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.get_options-900"><a href="#FST.get_options-900"><span class="linenos">900</span></a><span class="sd">        - `{option: value, ...}`: Dictionary of all global default options.</span>
</span><span id="FST.get_options-901"><a href="#FST.get_options-901"><span class="linenos">901</span></a>
</span><span id="FST.get_options-902"><a href="#FST.get_options-902"><span class="linenos">902</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.get_options-903"><a href="#FST.get_options-903"><span class="linenos">903</span></a><span class="sd">        ```py</span>
</span><span id="FST.get_options-904"><a href="#FST.get_options-904"><span class="linenos">904</span></a><span class="sd">        &gt;&gt;&gt; from pprint import pp</span>
</span><span id="FST.get_options-905"><a href="#FST.get_options-905"><span class="linenos">905</span></a><span class="sd">        &gt;&gt;&gt; pp(FST.get_options())</span>
</span><span id="FST.get_options-906"><a href="#FST.get_options-906"><span class="linenos">906</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;,</span>
</span><span id="FST.get_options-907"><a href="#FST.get_options-907"><span class="linenos">907</span></a><span class="sd">         &#39;raw&#39;: False,</span>
</span><span id="FST.get_options-908"><a href="#FST.get_options-908"><span class="linenos">908</span></a><span class="sd">         &#39;elif_&#39;: True,</span>
</span><span id="FST.get_options-909"><a href="#FST.get_options-909"><span class="linenos">909</span></a><span class="sd">         &#39;docstr&#39;: True,</span>
</span><span id="FST.get_options-910"><a href="#FST.get_options-910"><span class="linenos">910</span></a><span class="sd">         &#39;empty_set&#39;: True,</span>
</span><span id="FST.get_options-911"><a href="#FST.get_options-911"><span class="linenos">911</span></a><span class="sd">         &#39;pep8space&#39;: True,</span>
</span><span id="FST.get_options-912"><a href="#FST.get_options-912"><span class="linenos">912</span></a><span class="sd">         &#39;precomms&#39;: True,</span>
</span><span id="FST.get_options-913"><a href="#FST.get_options-913"><span class="linenos">913</span></a><span class="sd">         &#39;postcomms&#39;: True,</span>
</span><span id="FST.get_options-914"><a href="#FST.get_options-914"><span class="linenos">914</span></a><span class="sd">         &#39;prespace&#39;: False,</span>
</span><span id="FST.get_options-915"><a href="#FST.get_options-915"><span class="linenos">915</span></a><span class="sd">         &#39;postspace&#39;: False}</span>
</span><span id="FST.get_options-916"><a href="#FST.get_options-916"><span class="linenos">916</span></a><span class="sd">        ```</span>
</span><span id="FST.get_options-917"><a href="#FST.get_options-917"><span class="linenos">917</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.get_options-918"><a href="#FST.get_options-918"><span class="linenos">918</span></a>
</span><span id="FST.get_options-919"><a href="#FST.get_options-919"><span class="linenos">919</span></a>        <span class="k">return</span> <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get a dictionary of ALL options. These are the same <code><a href="#FST.options">options</a></code> that can be passed to operations and this
function returns their global defaults which are used when those options are not passed to operations or if they
are passed with a value of <code>None</code>.</p>

<p>When these options are missing or <code>None</code> in a call to an operation, then the default option as specified here is
used.</p>

<p><strong>Options:</strong></p>

<ul>
<li><code><a href="#FST.pars">pars</a></code>: How parentheses are handled, can be <code>False</code>, <code>True</code> or <code>'auto'</code>. This is for individual puts, for
slices parentheses are always unchanged. Raw puts generally do not have parentheses added or removed
automatically, except removed from the destination node if putting to a node instead of a pure location.
<ul>
<li><code>False</code>: Parentheses are not MODIFIED, doesn't mean remove all parentheses. Not copied with nodes or
removed on put from source or destination.</li>
<li><code>True</code>: Parentheses are copied with nodes, added to copies if needed and not present, removed from
destination on put if not needed there (but not source).</li>
<li><code>'auto'</code>: Same as <code>True</code> except they are not returned with a copy and possibly removed from source
on put if not needed (removed from destination first if needed and present on both).</li>
</ul></li>
<li><code>raw</code>: When to do raw source operations. This may result in more nodes changed than just the targeted one(s).
<ul>
<li><code>False</code>: Do not do raw source operations.</li>
<li><code>True</code>: Only do raw source operations.</li>
<li><code>'auto'</code>: Only do raw source operations if the normal operation fails in a way that raw might not.</li>
</ul></li>
<li><code>elif_</code>: How to handle lone <code>If</code> statements as the only statements in an <code>If</code> statement <code>orelse</code> field.
<ul>
<li><code>True</code>: If putting a single <code>If</code> statement to an <code>orelse</code> field of a parent <code>If</code> statement then
put it as an <code>elif</code>.</li>
<li><code>False</code>: Always put as a standalone <code>If</code> statement.</li>
</ul></li>
<li><code>docstr</code>: Which docstrings are indentable / dedentable.
<ul>
<li><code>False</code>: None.</li>
<li><code>True</code>: All <code>Expr</code> multiline strings (as they serve no coding purpose).</li>
<li><code>'strict'</code>: Only multiline strings in expected docstring positions (functions and classes).</li>
</ul></li>
<li><code>empty_set</code>: Empty set source during a slice put (considered to have no elements).
<ul>
<li><code>False</code>: Nothing is considered an empty set and an empty set slice put is only possible using a non-set
type of empty sequence (tuple or list).</li>
<li><code>True</code>: <code>set()</code> call and <code>{*()}</code>, <code>{*[]}</code> and <code>{*{}}</code> starred sequences are considered empty.</li>
<li><code>'seq'</code>: Only starred sequences <code>{*()}</code>, <code>{*[]}</code> and <code>{*{}}</code> are considered empty.</li>
<li><code>'call'</code>: Only <code>set()</code> call is considered empty.</li>
</ul></li>
<li><code>pep8space</code>: Preceding and trailing empty lines for function and class definitions.
<ul>
<li><code>False</code>: No empty lines.</li>
<li><code>True</code>: Two empty lines at module scope and one empty line in other scopes.</li>
<li><code>1</code>: One empty line in all scopes.</li>
</ul></li>
<li><code>precomms</code>: Preceding comments.  - WILL CHANGE IN FUTURE VERSIONS!
<ul>
<li><code>False</code>: No preceding comments.</li>
<li><code>True</code>: Single contiguous comment block immediately preceding position.</li>
<li><code>'all'</code>: Comment blocks (possibly separated by empty lines) preceding position.</li>
</ul></li>
<li><code>postcomms</code>: Trailing comments.  - WILL CHANGE IN FUTURE VERSIONS!
<ul>
<li><code>False</code>: No trailing comments.</li>
<li><code>True</code>: Only comment trailing on line of position, nothing past that on its own lines.</li>
<li><code>'block'</code>: Single contiguous comment block following position.</li>
<li><code>'all'</code>: Comment blocks (possibly separated by empty lines) following position.</li>
</ul></li>
<li><code>prespace</code>: Preceding empty lines (max of this and <code>pep8space</code> used).  - WILL CHANGE IN FUTURE VERSIONS!
<ul>
<li><code>False</code>: No empty lines.</li>
<li><code>True</code>: All empty lines.</li>
<li><code>int</code>: A maximum number of empty lines.</li>
</ul></li>
<li><code>postspace</code>: Same as <code>prespace</code> except for trailing empty lines.  - WILL CHANGE IN FUTURE VERSIONS!</li>
</ul>

<p><strong>Note:</strong>
<code><a href="#FST.pars">pars</a></code> behavior (see Examples for more):</p>

<pre><code>                                                          False      True    'auto'
Copy pars from source on copy / cut:                         no       yes        no
Add pars needed for parsability to copy:                     no       yes       yes
Remove unneeded pars from destination on put:                no       yes       yes
Remove unneeded pars from source on put:                     no        no       yes
Add pars needed for parse / precedence to source on put:     no       yes       yes
</code></pre>

<p><strong>Returns:</strong></p>

<ul>
<li><code>{option: value, ...}</code>: Dictionary of all global default options.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pp</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pp</span><span class="p">(</span><span class="n"><a href="#FST.get_options">FST.get_options</a></span><span class="p">())</span>
<span class="p">{</span><span class="s1">&#39;pars&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
 <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;elif_&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;docstr&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;empty_set&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;pep8space&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;precomms&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;postcomms&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;prespace&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;postspace&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.get_option" class="classattr">
                                        <input id="FST.get_option-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_option</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">option</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">) -> <span class="n">Any</span>:</span></span>

                <label class="view-source-button" for="FST.get_option-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.get_option"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.get_option-921"><a href="#FST.get_option-921"><span class="linenos">921</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST.get_option-922"><a href="#FST.get_option-922"><span class="linenos">922</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_option</span><span class="p">(</span><span class="n">option</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span><span id="FST.get_option-923"><a href="#FST.get_option-923"><span class="linenos">923</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a single option from `options` dict or global default if option not in dict or is `None` there. For a</span>
</span><span id="FST.get_option-924"><a href="#FST.get_option-924"><span class="linenos">924</span></a><span class="sd">        list of options used see `get_options()`.</span>
</span><span id="FST.get_option-925"><a href="#FST.get_option-925"><span class="linenos">925</span></a>
</span><span id="FST.get_option-926"><a href="#FST.get_option-926"><span class="linenos">926</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.get_option-927"><a href="#FST.get_option-927"><span class="linenos">927</span></a><span class="sd">        - `option`: Name of option to get, see `get_options()`.</span>
</span><span id="FST.get_option-928"><a href="#FST.get_option-928"><span class="linenos">928</span></a><span class="sd">        - `options`: Dictionary which may or may not contain the requested option.</span>
</span><span id="FST.get_option-929"><a href="#FST.get_option-929"><span class="linenos">929</span></a>
</span><span id="FST.get_option-930"><a href="#FST.get_option-930"><span class="linenos">930</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.get_option-931"><a href="#FST.get_option-931"><span class="linenos">931</span></a><span class="sd">        - `Any`: The `option` value from the passed `options` dict, if passed and not `None` there, else the global</span>
</span><span id="FST.get_option-932"><a href="#FST.get_option-932"><span class="linenos">932</span></a><span class="sd">            default value for `option`.</span>
</span><span id="FST.get_option-933"><a href="#FST.get_option-933"><span class="linenos">933</span></a>
</span><span id="FST.get_option-934"><a href="#FST.get_option-934"><span class="linenos">934</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.get_option-935"><a href="#FST.get_option-935"><span class="linenos">935</span></a><span class="sd">        ```py</span>
</span><span id="FST.get_option-936"><a href="#FST.get_option-936"><span class="linenos">936</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="FST.get_option-937"><a href="#FST.get_option-937"><span class="linenos">937</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="FST.get_option-938"><a href="#FST.get_option-938"><span class="linenos">938</span></a>
</span><span id="FST.get_option-939"><a href="#FST.get_option-939"><span class="linenos">939</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;, {&#39;pars&#39;: True})</span>
</span><span id="FST.get_option-940"><a href="#FST.get_option-940"><span class="linenos">940</span></a><span class="sd">        True</span>
</span><span id="FST.get_option-941"><a href="#FST.get_option-941"><span class="linenos">941</span></a>
</span><span id="FST.get_option-942"><a href="#FST.get_option-942"><span class="linenos">942</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;, {&#39;pars&#39;: None})</span>
</span><span id="FST.get_option-943"><a href="#FST.get_option-943"><span class="linenos">943</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="FST.get_option-944"><a href="#FST.get_option-944"><span class="linenos">944</span></a><span class="sd">        ```</span>
</span><span id="FST.get_option-945"><a href="#FST.get_option-945"><span class="linenos">945</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.get_option-946"><a href="#FST.get_option-946"><span class="linenos">946</span></a>
</span><span id="FST.get_option-947"><a href="#FST.get_option-947"><span class="linenos">947</span></a>        <span class="k">return</span> <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">:=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">o</span>
</span></pre></div>


            <div class="docstring"><p>Get a single option from <code><a href="#FST.options">options</a></code> dict or global default if option not in dict or is <code>None</code> there. For a
list of options used see <code><a href="#FST.get_options">get_options()</a></code>.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>option</code>: Name of option to get, see <code><a href="#FST.get_options">get_options()</a></code>.</li>
<li><code><a href="#FST.options">options</a></code>: Dictionary which may or may not contain the requested option.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>Any</code>: The <code>option</code> value from the passed <code><a href="#FST.options">options</a></code> dict, if passed and not <code>None</code> there, else the global
default value for <code>option</code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">)</span>
<span class="s1">&#39;auto&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;pars&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;pars&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>
<span class="s1">&#39;auto&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.set_options" class="classattr">
                                        <input id="FST.set_options-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">set_options</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FST.set_options-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.set_options"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.set_options-949"><a href="#FST.set_options-949"><span class="linenos">949</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST.set_options-950"><a href="#FST.set_options-950"><span class="linenos">950</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="FST.set_options-951"><a href="#FST.set_options-951"><span class="linenos">951</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set global defaults for `options` parameters.</span>
</span><span id="FST.set_options-952"><a href="#FST.set_options-952"><span class="linenos">952</span></a>
</span><span id="FST.set_options-953"><a href="#FST.set_options-953"><span class="linenos">953</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.set_options-954"><a href="#FST.set_options-954"><span class="linenos">954</span></a><span class="sd">        - `options`: Names / values of parameters to set. These can also be passed to various methods to override the</span>
</span><span id="FST.set_options-955"><a href="#FST.set_options-955"><span class="linenos">955</span></a><span class="sd">            defaults set here for those individual operations, see `get_options()`.</span>
</span><span id="FST.set_options-956"><a href="#FST.set_options-956"><span class="linenos">956</span></a>
</span><span id="FST.set_options-957"><a href="#FST.set_options-957"><span class="linenos">957</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.set_options-958"><a href="#FST.set_options-958"><span class="linenos">958</span></a><span class="sd">        - `options`: `dict` of previous values of changed parameters, reset with `set_options(**options)`.</span>
</span><span id="FST.set_options-959"><a href="#FST.set_options-959"><span class="linenos">959</span></a>
</span><span id="FST.set_options-960"><a href="#FST.set_options-960"><span class="linenos">960</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.set_options-961"><a href="#FST.set_options-961"><span class="linenos">961</span></a><span class="sd">        ```py</span>
</span><span id="FST.set_options-962"><a href="#FST.set_options-962"><span class="linenos">962</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="FST.set_options-963"><a href="#FST.set_options-963"><span class="linenos">963</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="FST.set_options-964"><a href="#FST.set_options-964"><span class="linenos">964</span></a>
</span><span id="FST.set_options-965"><a href="#FST.set_options-965"><span class="linenos">965</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(pars=False)</span>
</span><span id="FST.set_options-966"><a href="#FST.set_options-966"><span class="linenos">966</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;}</span>
</span><span id="FST.set_options-967"><a href="#FST.set_options-967"><span class="linenos">967</span></a>
</span><span id="FST.set_options-968"><a href="#FST.set_options-968"><span class="linenos">968</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="FST.set_options-969"><a href="#FST.set_options-969"><span class="linenos">969</span></a><span class="sd">        False</span>
</span><span id="FST.set_options-970"><a href="#FST.set_options-970"><span class="linenos">970</span></a>
</span><span id="FST.set_options-971"><a href="#FST.set_options-971"><span class="linenos">971</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(**{&#39;pars&#39;: &#39;auto&#39;})</span>
</span><span id="FST.set_options-972"><a href="#FST.set_options-972"><span class="linenos">972</span></a><span class="sd">        {&#39;pars&#39;: False}</span>
</span><span id="FST.set_options-973"><a href="#FST.set_options-973"><span class="linenos">973</span></a>
</span><span id="FST.set_options-974"><a href="#FST.set_options-974"><span class="linenos">974</span></a><span class="sd">        &gt;&gt;&gt; FST.get_option(&#39;pars&#39;)</span>
</span><span id="FST.set_options-975"><a href="#FST.set_options-975"><span class="linenos">975</span></a><span class="sd">        &#39;auto&#39;</span>
</span><span id="FST.set_options-976"><a href="#FST.set_options-976"><span class="linenos">976</span></a>
</span><span id="FST.set_options-977"><a href="#FST.set_options-977"><span class="linenos">977</span></a><span class="sd">        &gt;&gt;&gt; FST.set_options(pars=True, raw=True, docstr=False)</span>
</span><span id="FST.set_options-978"><a href="#FST.set_options-978"><span class="linenos">978</span></a><span class="sd">        {&#39;pars&#39;: &#39;auto&#39;, &#39;raw&#39;: False, &#39;docstr&#39;: True}</span>
</span><span id="FST.set_options-979"><a href="#FST.set_options-979"><span class="linenos">979</span></a><span class="sd">        ```</span>
</span><span id="FST.set_options-980"><a href="#FST.set_options-980"><span class="linenos">980</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.set_options-981"><a href="#FST.set_options-981"><span class="linenos">981</span></a>
</span><span id="FST.set_options-982"><a href="#FST.set_options-982"><span class="linenos">982</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="n">o</span><span class="p">:</span> <span class="n">_OPTIONS</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">options</span><span class="p">}</span>
</span><span id="FST.set_options-983"><a href="#FST.set_options-983"><span class="linenos">983</span></a>
</span><span id="FST.set_options-984"><a href="#FST.set_options-984"><span class="linenos">984</span></a>        <span class="n">_OPTIONS</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.set_options-985"><a href="#FST.set_options-985"><span class="linenos">985</span></a>
</span><span id="FST.set_options-986"><a href="#FST.set_options-986"><span class="linenos">986</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Set global defaults for <code><a href="#FST.options">options</a></code> parameters.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.options">options</a></code>: Names / values of parameters to set. These can also be passed to various methods to override the
defaults set here for those individual operations, see <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST.options">options</a></code>: <code>dict</code> of previous values of changed parameters, reset with <code>set_options(**options)</code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">)</span>
<span class="s1">&#39;auto&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.set_options">FST.set_options</a></span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;pars&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">)</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.set_options">FST.set_options</a></span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;pars&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">})</span>
<span class="p">{</span><span class="s1">&#39;pars&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">)</span>
<span class="s1">&#39;auto&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n"><a href="#FST.set_options">FST.set_options</a></span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">docstr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;pars&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;docstr&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.options" class="classattr">
                                        <input id="FST.options-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>
        <div class="decorator decorator-contextmanager">@contextmanager</div>

        <span class="def">def</span>
        <span class="name">options</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">options</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FST.options-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.options"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.options-988"><a href="#FST.options-988"><span class="linenos"> 988</span></a>    <span class="nd">@staticmethod</span>
</span><span id="FST.options-989"><a href="#FST.options-989"><span class="linenos"> 989</span></a>    <span class="nd">@contextmanager</span>
</span><span id="FST.options-990"><a href="#FST.options-990"><span class="linenos"> 990</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">):</span>
</span><span id="FST.options-991"><a href="#FST.options-991"><span class="linenos"> 991</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Context manager to temporarily set global options defaults for a group of operations.</span>
</span><span id="FST.options-992"><a href="#FST.options-992"><span class="linenos"> 992</span></a>
</span><span id="FST.options-993"><a href="#FST.options-993"><span class="linenos"> 993</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.options-994"><a href="#FST.options-994"><span class="linenos"> 994</span></a><span class="sd">        - `options`: Names / values of options to set temporarily, see `get_options()`.</span>
</span><span id="FST.options-995"><a href="#FST.options-995"><span class="linenos"> 995</span></a>
</span><span id="FST.options-996"><a href="#FST.options-996"><span class="linenos"> 996</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.options-997"><a href="#FST.options-997"><span class="linenos"> 997</span></a><span class="sd">        ```py</span>
</span><span id="FST.options-998"><a href="#FST.options-998"><span class="linenos"> 998</span></a><span class="sd">        &gt;&gt;&gt; print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="FST.options-999"><a href="#FST.options-999"><span class="linenos"> 999</span></a><span class="sd">        auto</span>
</span><span id="FST.options-1000"><a href="#FST.options-1000"><span class="linenos">1000</span></a>
</span><span id="FST.options-1001"><a href="#FST.options-1001"><span class="linenos">1001</span></a><span class="sd">        &gt;&gt;&gt; with FST.options(pars=False):</span>
</span><span id="FST.options-1002"><a href="#FST.options-1002"><span class="linenos">1002</span></a><span class="sd">        ...     print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="FST.options-1003"><a href="#FST.options-1003"><span class="linenos">1003</span></a><span class="sd">        False</span>
</span><span id="FST.options-1004"><a href="#FST.options-1004"><span class="linenos">1004</span></a>
</span><span id="FST.options-1005"><a href="#FST.options-1005"><span class="linenos">1005</span></a><span class="sd">        &gt;&gt;&gt; print(FST.get_option(&#39;pars&#39;))</span>
</span><span id="FST.options-1006"><a href="#FST.options-1006"><span class="linenos">1006</span></a><span class="sd">        auto</span>
</span><span id="FST.options-1007"><a href="#FST.options-1007"><span class="linenos">1007</span></a><span class="sd">        ```</span>
</span><span id="FST.options-1008"><a href="#FST.options-1008"><span class="linenos">1008</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.options-1009"><a href="#FST.options-1009"><span class="linenos">1009</span></a>
</span><span id="FST.options-1010"><a href="#FST.options-1010"><span class="linenos">1010</span></a>        <span class="n">old_options</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.options-1011"><a href="#FST.options-1011"><span class="linenos">1011</span></a>
</span><span id="FST.options-1012"><a href="#FST.options-1012"><span class="linenos">1012</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.options-1013"><a href="#FST.options-1013"><span class="linenos">1013</span></a>            <span class="k">yield</span> <span class="n">old_options</span>
</span><span id="FST.options-1014"><a href="#FST.options-1014"><span class="linenos">1014</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="FST.options-1015"><a href="#FST.options-1015"><span class="linenos">1015</span></a>            <span class="n">FST</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">old_options</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Context manager to temporarily set global options defaults for a group of operations.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.options">options</a></code>: Names / values of options to set temporarily, see <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">))</span>
<span class="n">auto</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n"><a href="#FST.options">FST.options</a></span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="o">...</span>     <span class="nb">print</span><span class="p">(</span><span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">))</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n"><a href="#FST.get_option">FST.get_option</a></span><span class="p">(</span><span class="s1">&#39;pars&#39;</span><span class="p">))</span>
<span class="n">auto</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.dump" class="classattr">
                                        <input id="FST.dump-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dump</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">src</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">full</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">print</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">eol</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.dump-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.dump"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.dump-1017"><a href="#FST.dump-1017"><span class="linenos">1017</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="FST.dump-1018"><a href="#FST.dump-1018"><span class="linenos">1018</span></a>             <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="n">TextIO</span> <span class="o">=</span> <span class="nb">print</span><span class="p">,</span> <span class="n">eol</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST.dump-1019"><a href="#FST.dump-1019"><span class="linenos">1019</span></a>             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.dump-1020"><a href="#FST.dump-1020"><span class="linenos">1020</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Dump a representation of the tree to stdout or other `TextIO` or return as a `str` or `list` of lines, or</span>
</span><span id="FST.dump-1021"><a href="#FST.dump-1021"><span class="linenos">1021</span></a><span class="sd">        call a provided function once with each line of the output.</span>
</span><span id="FST.dump-1022"><a href="#FST.dump-1022"><span class="linenos">1022</span></a>
</span><span id="FST.dump-1023"><a href="#FST.dump-1023"><span class="linenos">1023</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.dump-1024"><a href="#FST.dump-1024"><span class="linenos">1024</span></a><span class="sd">        - `src`: `&#39;stmt&#39;` means output statement source lines (including `ExceptHandler` and `match_case`), `&#39;all&#39;`</span>
</span><span id="FST.dump-1025"><a href="#FST.dump-1025"><span class="linenos">1025</span></a><span class="sd">            means output source for each individual and node and `None` does not output any source. Can also be a string</span>
</span><span id="FST.dump-1026"><a href="#FST.dump-1026"><span class="linenos">1026</span></a><span class="sd">            for shortcut specification of source and flags by first letter: `&#39;s&#39;` means `src=&#39;stmt&#39;`, `&#39;a&#39;` means</span>
</span><span id="FST.dump-1027"><a href="#FST.dump-1027"><span class="linenos">1027</span></a><span class="sd">            `src=&#39;all&#39;`, `&#39;f&#39;` means `full=True` and `&#39;e&#39;` means `expand=True`, so `&#39;sfe&#39;` would be a full expanded dump</span>
</span><span id="FST.dump-1028"><a href="#FST.dump-1028"><span class="linenos">1028</span></a><span class="sd">            showing statement source lines.</span>
</span><span id="FST.dump-1029"><a href="#FST.dump-1029"><span class="linenos">1029</span></a><span class="sd">        - `full`: If `True` then will list all fields in nodes including empty ones, otherwise will exclude most empty</span>
</span><span id="FST.dump-1030"><a href="#FST.dump-1030"><span class="linenos">1030</span></a><span class="sd">            fields.</span>
</span><span id="FST.dump-1031"><a href="#FST.dump-1031"><span class="linenos">1031</span></a><span class="sd">        - `expand`: If `True` then the output is a nice compact representation. If `False` then it is ugly and wasteful.</span>
</span><span id="FST.dump-1032"><a href="#FST.dump-1032"><span class="linenos">1032</span></a><span class="sd">        - `indent`: The average airspeed of an unladen swallow (European).</span>
</span><span id="FST.dump-1033"><a href="#FST.dump-1033"><span class="linenos">1033</span></a><span class="sd">        - `out`: `print` means print to stdout, `list` returns a list of lines and `str` returns a whole string.</span>
</span><span id="FST.dump-1034"><a href="#FST.dump-1034"><span class="linenos">1034</span></a><span class="sd">            `TextIO` will cann the `write` method for each line of output. Otherwise a `Callable[[str], None]` which is</span>
</span><span id="FST.dump-1035"><a href="#FST.dump-1035"><span class="linenos">1035</span></a><span class="sd">            called for each line of output individually.</span>
</span><span id="FST.dump-1036"><a href="#FST.dump-1036"><span class="linenos">1036</span></a><span class="sd">        - `eol`: What to put at the end of each text line, `None` means newline for `TextIO` out and nothing for other.</span>
</span><span id="FST.dump-1037"><a href="#FST.dump-1037"><span class="linenos">1037</span></a>
</span><span id="FST.dump-1038"><a href="#FST.dump-1038"><span class="linenos">1038</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.dump-1039"><a href="#FST.dump-1039"><span class="linenos">1039</span></a><span class="sd">        - `str | list[str]`: If those were requested with `out=str` or `out=list` else `None` and the output is send one</span>
</span><span id="FST.dump-1040"><a href="#FST.dump-1040"><span class="linenos">1040</span></a><span class="sd">            line at a time to `linefunc`, which by default is `print`.</span>
</span><span id="FST.dump-1041"><a href="#FST.dump-1041"><span class="linenos">1041</span></a><span class="sd">        - `None`: Otherwise.</span>
</span><span id="FST.dump-1042"><a href="#FST.dump-1042"><span class="linenos">1042</span></a>
</span><span id="FST.dump-1043"><a href="#FST.dump-1043"><span class="linenos">1043</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.dump-1044"><a href="#FST.dump-1044"><span class="linenos">1044</span></a><span class="sd">        ```py</span>
</span><span id="FST.dump-1045"><a href="#FST.dump-1045"><span class="linenos">1045</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;&#39;&#39;</span>
</span><span id="FST.dump-1046"><a href="#FST.dump-1046"><span class="linenos">1046</span></a><span class="sd">        ... if 1:</span>
</span><span id="FST.dump-1047"><a href="#FST.dump-1047"><span class="linenos">1047</span></a><span class="sd">        ...     call(a[i], **b)</span>
</span><span id="FST.dump-1048"><a href="#FST.dump-1048"><span class="linenos">1048</span></a><span class="sd">        ... &#39;&#39;&#39;.strip())</span>
</span><span id="FST.dump-1049"><a href="#FST.dump-1049"><span class="linenos">1049</span></a>
</span><span id="FST.dump-1050"><a href="#FST.dump-1050"><span class="linenos">1050</span></a><span class="sd">        &gt;&gt;&gt; f.dump()</span>
</span><span id="FST.dump-1051"><a href="#FST.dump-1051"><span class="linenos">1051</span></a><span class="sd">        If - ROOT 0,0..1,19</span>
</span><span id="FST.dump-1052"><a href="#FST.dump-1052"><span class="linenos">1052</span></a><span class="sd">          .test Constant 1 - 0,3..0,4</span>
</span><span id="FST.dump-1053"><a href="#FST.dump-1053"><span class="linenos">1053</span></a><span class="sd">          .body[1]</span>
</span><span id="FST.dump-1054"><a href="#FST.dump-1054"><span class="linenos">1054</span></a><span class="sd">          0] Expr - 1,4..1,19</span>
</span><span id="FST.dump-1055"><a href="#FST.dump-1055"><span class="linenos">1055</span></a><span class="sd">            .value Call - 1,4..1,19</span>
</span><span id="FST.dump-1056"><a href="#FST.dump-1056"><span class="linenos">1056</span></a><span class="sd">              .func Name &#39;call&#39; Load - 1,4..1,8</span>
</span><span id="FST.dump-1057"><a href="#FST.dump-1057"><span class="linenos">1057</span></a><span class="sd">              .args[1]</span>
</span><span id="FST.dump-1058"><a href="#FST.dump-1058"><span class="linenos">1058</span></a><span class="sd">              0] Subscript - 1,9..1,13</span>
</span><span id="FST.dump-1059"><a href="#FST.dump-1059"><span class="linenos">1059</span></a><span class="sd">                .value Name &#39;a&#39; Load - 1,9..1,10</span>
</span><span id="FST.dump-1060"><a href="#FST.dump-1060"><span class="linenos">1060</span></a><span class="sd">                .slice Name &#39;i&#39; Load - 1,11..1,12</span>
</span><span id="FST.dump-1061"><a href="#FST.dump-1061"><span class="linenos">1061</span></a><span class="sd">                .ctx Load</span>
</span><span id="FST.dump-1062"><a href="#FST.dump-1062"><span class="linenos">1062</span></a><span class="sd">              .keywords[1]</span>
</span><span id="FST.dump-1063"><a href="#FST.dump-1063"><span class="linenos">1063</span></a><span class="sd">              0] keyword - 1,15..1,18</span>
</span><span id="FST.dump-1064"><a href="#FST.dump-1064"><span class="linenos">1064</span></a><span class="sd">                .value Name &#39;b&#39; Load - 1,17..1,18</span>
</span><span id="FST.dump-1065"><a href="#FST.dump-1065"><span class="linenos">1065</span></a>
</span><span id="FST.dump-1066"><a href="#FST.dump-1066"><span class="linenos">1066</span></a><span class="sd">        &gt;&gt;&gt; f.dump(src=&#39;all&#39;, indent=4)</span>
</span><span id="FST.dump-1067"><a href="#FST.dump-1067"><span class="linenos">1067</span></a><span class="sd">        0: if 1:</span>
</span><span id="FST.dump-1068"><a href="#FST.dump-1068"><span class="linenos">1068</span></a><span class="sd">        If - ROOT 0,0..1,19</span>
</span><span id="FST.dump-1069"><a href="#FST.dump-1069"><span class="linenos">1069</span></a><span class="sd">        0:    1</span>
</span><span id="FST.dump-1070"><a href="#FST.dump-1070"><span class="linenos">1070</span></a><span class="sd">            .test Constant 1 - 0,3..0,4</span>
</span><span id="FST.dump-1071"><a href="#FST.dump-1071"><span class="linenos">1071</span></a><span class="sd">            .body[1]</span>
</span><span id="FST.dump-1072"><a href="#FST.dump-1072"><span class="linenos">1072</span></a><span class="sd">        1:     call(a[i], **b)</span>
</span><span id="FST.dump-1073"><a href="#FST.dump-1073"><span class="linenos">1073</span></a><span class="sd">            0] Expr - 1,4..1,19</span>
</span><span id="FST.dump-1074"><a href="#FST.dump-1074"><span class="linenos">1074</span></a><span class="sd">                .value Call - 1,4..1,19</span>
</span><span id="FST.dump-1075"><a href="#FST.dump-1075"><span class="linenos">1075</span></a><span class="sd">        1:     call</span>
</span><span id="FST.dump-1076"><a href="#FST.dump-1076"><span class="linenos">1076</span></a><span class="sd">                    .func Name &#39;call&#39; Load - 1,4..1,8</span>
</span><span id="FST.dump-1077"><a href="#FST.dump-1077"><span class="linenos">1077</span></a><span class="sd">                    .args[1]</span>
</span><span id="FST.dump-1078"><a href="#FST.dump-1078"><span class="linenos">1078</span></a><span class="sd">        1:          a[i]</span>
</span><span id="FST.dump-1079"><a href="#FST.dump-1079"><span class="linenos">1079</span></a><span class="sd">                    0] Subscript - 1,9..1,13</span>
</span><span id="FST.dump-1080"><a href="#FST.dump-1080"><span class="linenos">1080</span></a><span class="sd">        1:          a</span>
</span><span id="FST.dump-1081"><a href="#FST.dump-1081"><span class="linenos">1081</span></a><span class="sd">                        .value Name &#39;a&#39; Load - 1,9..1,10</span>
</span><span id="FST.dump-1082"><a href="#FST.dump-1082"><span class="linenos">1082</span></a><span class="sd">        1:            i</span>
</span><span id="FST.dump-1083"><a href="#FST.dump-1083"><span class="linenos">1083</span></a><span class="sd">                        .slice Name &#39;i&#39; Load - 1,11..1,12</span>
</span><span id="FST.dump-1084"><a href="#FST.dump-1084"><span class="linenos">1084</span></a><span class="sd">                        .ctx Load</span>
</span><span id="FST.dump-1085"><a href="#FST.dump-1085"><span class="linenos">1085</span></a><span class="sd">                    .keywords[1]</span>
</span><span id="FST.dump-1086"><a href="#FST.dump-1086"><span class="linenos">1086</span></a><span class="sd">        1:                **b</span>
</span><span id="FST.dump-1087"><a href="#FST.dump-1087"><span class="linenos">1087</span></a><span class="sd">                    0] keyword - 1,15..1,18</span>
</span><span id="FST.dump-1088"><a href="#FST.dump-1088"><span class="linenos">1088</span></a><span class="sd">        1:                  b</span>
</span><span id="FST.dump-1089"><a href="#FST.dump-1089"><span class="linenos">1089</span></a><span class="sd">                        .value Name &#39;b&#39; Load - 1,17..1,18</span>
</span><span id="FST.dump-1090"><a href="#FST.dump-1090"><span class="linenos">1090</span></a>
</span><span id="FST.dump-1091"><a href="#FST.dump-1091"><span class="linenos">1091</span></a><span class="sd">        &gt;&gt;&gt; f.dump(out=str)[:64]</span>
</span><span id="FST.dump-1092"><a href="#FST.dump-1092"><span class="linenos">1092</span></a><span class="sd">        &#39;If - ROOT 0,0..1,19\n  .test Constant 1 - 0,3..0,4\n  .body[1]\n  0&#39;</span>
</span><span id="FST.dump-1093"><a href="#FST.dump-1093"><span class="linenos">1093</span></a>
</span><span id="FST.dump-1094"><a href="#FST.dump-1094"><span class="linenos">1094</span></a><span class="sd">        &gt;&gt;&gt; for l in f.dump(&#39;stmt&#39;, out=list):</span>
</span><span id="FST.dump-1095"><a href="#FST.dump-1095"><span class="linenos">1095</span></a><span class="sd">        ...     print(repr(l))</span>
</span><span id="FST.dump-1096"><a href="#FST.dump-1096"><span class="linenos">1096</span></a><span class="sd">        &#39;0: if 1:&#39;</span>
</span><span id="FST.dump-1097"><a href="#FST.dump-1097"><span class="linenos">1097</span></a><span class="sd">        &#39;If - ROOT 0,0..1,19&#39;</span>
</span><span id="FST.dump-1098"><a href="#FST.dump-1098"><span class="linenos">1098</span></a><span class="sd">        &#39;  .test Constant 1 - 0,3..0,4&#39;</span>
</span><span id="FST.dump-1099"><a href="#FST.dump-1099"><span class="linenos">1099</span></a><span class="sd">        &#39;  .body[1]&#39;</span>
</span><span id="FST.dump-1100"><a href="#FST.dump-1100"><span class="linenos">1100</span></a><span class="sd">        &#39;1:     call(a[i], **b)&#39;</span>
</span><span id="FST.dump-1101"><a href="#FST.dump-1101"><span class="linenos">1101</span></a><span class="sd">        &#39;  0] Expr - 1,4..1,19&#39;</span>
</span><span id="FST.dump-1102"><a href="#FST.dump-1102"><span class="linenos">1102</span></a><span class="sd">        &#39;    .value Call - 1,4..1,19&#39;</span>
</span><span id="FST.dump-1103"><a href="#FST.dump-1103"><span class="linenos">1103</span></a><span class="sd">        &quot;      .func Name &#39;call&#39; Load - 1,4..1,8&quot;</span>
</span><span id="FST.dump-1104"><a href="#FST.dump-1104"><span class="linenos">1104</span></a><span class="sd">        &#39;      .args[1]&#39;</span>
</span><span id="FST.dump-1105"><a href="#FST.dump-1105"><span class="linenos">1105</span></a><span class="sd">        &#39;      0] Subscript - 1,9..1,13&#39;</span>
</span><span id="FST.dump-1106"><a href="#FST.dump-1106"><span class="linenos">1106</span></a><span class="sd">        &quot;        .value Name &#39;a&#39; Load - 1,9..1,10&quot;</span>
</span><span id="FST.dump-1107"><a href="#FST.dump-1107"><span class="linenos">1107</span></a><span class="sd">        &quot;        .slice Name &#39;i&#39; Load - 1,11..1,12&quot;</span>
</span><span id="FST.dump-1108"><a href="#FST.dump-1108"><span class="linenos">1108</span></a><span class="sd">        &#39;        .ctx Load&#39;</span>
</span><span id="FST.dump-1109"><a href="#FST.dump-1109"><span class="linenos">1109</span></a><span class="sd">        &#39;      .keywords[1]&#39;</span>
</span><span id="FST.dump-1110"><a href="#FST.dump-1110"><span class="linenos">1110</span></a><span class="sd">        &#39;      0] keyword - 1,15..1,18&#39;</span>
</span><span id="FST.dump-1111"><a href="#FST.dump-1111"><span class="linenos">1111</span></a><span class="sd">        &quot;        .value Name &#39;b&#39; Load - 1,17..1,18&quot;</span>
</span><span id="FST.dump-1112"><a href="#FST.dump-1112"><span class="linenos">1112</span></a><span class="sd">        ```</span>
</span><span id="FST.dump-1113"><a href="#FST.dump-1113"><span class="linenos">1113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.dump-1114"><a href="#FST.dump-1114"><span class="linenos">1114</span></a>
</span><span id="FST.dump-1115"><a href="#FST.dump-1115"><span class="linenos">1115</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FST.dump-1116"><a href="#FST.dump-1116"><span class="linenos">1116</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">src</span> <span class="o">:=</span> <span class="n">src</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="FST.dump-1117"><a href="#FST.dump-1117"><span class="linenos">1117</span></a>                <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="FST.dump-1118"><a href="#FST.dump-1118"><span class="linenos">1118</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid character(s) in &#39;src&#39; string&quot;</span><span class="p">)</span>
</span><span id="FST.dump-1119"><a href="#FST.dump-1119"><span class="linenos">1119</span></a>
</span><span id="FST.dump-1120"><a href="#FST.dump-1120"><span class="linenos">1120</span></a>                <span class="n">full</span>   <span class="o">=</span> <span class="s1">&#39;f&#39;</span> <span class="ow">in</span> <span class="n">src</span>
</span><span id="FST.dump-1121"><a href="#FST.dump-1121"><span class="linenos">1121</span></a>                <span class="n">expand</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span> <span class="ow">in</span> <span class="n">src</span>
</span><span id="FST.dump-1122"><a href="#FST.dump-1122"><span class="linenos">1122</span></a>                <span class="n">src</span>    <span class="o">=</span> <span class="s1">&#39;all&#39;</span> <span class="k">if</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">src</span> <span class="k">else</span> <span class="s1">&#39;stmt&#39;</span> <span class="k">if</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">src</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="FST.dump-1123"><a href="#FST.dump-1123"><span class="linenos">1123</span></a>
</span><span id="FST.dump-1124"><a href="#FST.dump-1124"><span class="linenos">1124</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="FST.dump-1125"><a href="#FST.dump-1125"><span class="linenos">1125</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">write</span>
</span><span id="FST.dump-1126"><a href="#FST.dump-1126"><span class="linenos">1126</span></a>
</span><span id="FST.dump-1127"><a href="#FST.dump-1127"><span class="linenos">1127</span></a>            <span class="k">if</span> <span class="n">eol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.dump-1128"><a href="#FST.dump-1128"><span class="linenos">1128</span></a>                <span class="n">eol</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="FST.dump-1129"><a href="#FST.dump-1129"><span class="linenos">1129</span></a>
</span><span id="FST.dump-1130"><a href="#FST.dump-1130"><span class="linenos">1130</span></a>        <span class="k">elif</span> <span class="n">eol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.dump-1131"><a href="#FST.dump-1131"><span class="linenos">1131</span></a>            <span class="n">eol</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST.dump-1132"><a href="#FST.dump-1132"><span class="linenos">1132</span></a>
</span><span id="FST.dump-1133"><a href="#FST.dump-1133"><span class="linenos">1133</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="n">nspace</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="n">expand</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="n">eol</span><span class="o">=</span><span class="n">eol</span><span class="p">)</span>
</span><span id="FST.dump-1134"><a href="#FST.dump-1134"><span class="linenos">1134</span></a>
</span><span id="FST.dump-1135"><a href="#FST.dump-1135"><span class="linenos">1135</span></a>        <span class="k">if</span> <span class="n">out</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.dump-1136"><a href="#FST.dump-1136"><span class="linenos">1136</span></a>            <span class="n">lines</span>       <span class="o">=</span> <span class="p">[]</span>
</span><span id="FST.dump-1137"><a href="#FST.dump-1137"><span class="linenos">1137</span></a>            <span class="n">st</span><span class="o">.</span><span class="n">linefunc</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">append</span>
</span><span id="FST.dump-1138"><a href="#FST.dump-1138"><span class="linenos">1138</span></a>
</span><span id="FST.dump-1139"><a href="#FST.dump-1139"><span class="linenos">1139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</span><span id="FST.dump-1140"><a href="#FST.dump-1140"><span class="linenos">1140</span></a>
</span><span id="FST.dump-1141"><a href="#FST.dump-1141"><span class="linenos">1141</span></a>            <span class="k">return</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span><span id="FST.dump-1142"><a href="#FST.dump-1142"><span class="linenos">1142</span></a>
</span><span id="FST.dump-1143"><a href="#FST.dump-1143"><span class="linenos">1143</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">linefunc</span> <span class="o">=</span> <span class="n">out</span>
</span><span id="FST.dump-1144"><a href="#FST.dump-1144"><span class="linenos">1144</span></a>
</span><span id="FST.dump-1145"><a href="#FST.dump-1145"><span class="linenos">1145</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dump</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Dump a representation of the tree to stdout or other <code>TextIO</code> or return as a <code>str</code> or <code>list</code> of lines, or
call a provided function once with each line of the output.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.src">src</a></code>: <code>'stmt'</code> means output statement source lines (including <code>ExceptHandler</code> and <code>match_case</code>), <code>'all'</code>
means output source for each individual and node and <code>None</code> does not output any source. Can also be a string
for shortcut specification of source and flags by first letter: <code>'s'</code> means <code>src='stmt'</code>, <code>'a'</code> means
<code>src='all'</code>, <code>'f'</code> means <code>full=True</code> and <code>'e'</code> means <code>expand=True</code>, so <code>'sfe'</code> would be a full expanded dump
showing statement source lines.</li>
<li><code>full</code>: If <code>True</code> then will list all fields in nodes including empty ones, otherwise will exclude most empty
fields.</li>
<li><code>expand</code>: If <code>True</code> then the output is a nice compact representation. If <code>False</code> then it is ugly and wasteful.</li>
<li><code><a href="#FST.indent">indent</a></code>: The average airspeed of an unladen swallow (European).</li>
<li><code>out</code>: <code>print</code> means print to stdout, <code>list</code> returns a list of lines and <code>str</code> returns a whole string.
<code>TextIO</code> will cann the <code>write</code> method for each line of output. Otherwise a <code>Callable[[str], None]</code> which is
called for each line of output individually.</li>
<li><code>eol</code>: What to put at the end of each text line, <code>None</code> means newline for <code>TextIO</code> out and nothing for other.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>str | list[str]</code>: If those were requested with <code>out=str</code> or <code>out=list</code> else <code>None</code> and the output is send one
line at a time to <code>linefunc</code>, which by default is <code>print</code>.</li>
<li><code>None</code>: Otherwise.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">... if 1:</span>
<span class="s1">...     call(a[i], **b)</span>
<span class="s1">... &#39;&#39;&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="n">If</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">19</span>
  <span class="o">.</span><span class="n">test</span> <span class="n">Constant</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">3..0</span><span class="p">,</span><span class="mi">4</span>
  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="mi">0</span><span class="p">]</span> <span class="n">Expr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..1</span><span class="p">,</span><span class="mi">19</span>
    <span class="o">.</span><span class="n">value</span> <span class="n">Call</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..1</span><span class="p">,</span><span class="mi">19</span>
      <span class="o">.</span><span class="n">func</span> <span class="n">Name</span> <span class="s1">&#39;call&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..1</span><span class="p">,</span><span class="mi">8</span>
      <span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="mi">0</span><span class="p">]</span> <span class="n">Subscript</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">9..1</span><span class="p">,</span><span class="mi">13</span>
        <span class="o">.</span><span class="n">value</span> <span class="n">Name</span> <span class="s1">&#39;a&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">9..1</span><span class="p">,</span><span class="mi">10</span>
        <span class="o">.</span><span class="n">slice</span> <span class="n">Name</span> <span class="s1">&#39;i&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">11..1</span><span class="p">,</span><span class="mi">12</span>
        <span class="o">.</span><span class="n">ctx</span> <span class="n">Load</span>
      <span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="mi">0</span><span class="p">]</span> <span class="n">keyword</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">15..1</span><span class="p">,</span><span class="mi">18</span>
        <span class="o">.</span><span class="n">value</span> <span class="n">Name</span> <span class="s1">&#39;b&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">17..1</span><span class="p">,</span><span class="mi">18</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="mi">0</span><span class="p">:</span> <span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
<span class="n">If</span> <span class="o">-</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">19</span>
<span class="mi">0</span><span class="p">:</span>    <span class="mi">1</span>
    <span class="o">.</span><span class="n">test</span> <span class="n">Constant</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">0</span><span class="p">,</span><span class="mf">3..0</span><span class="p">,</span><span class="mi">4</span>
    <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">1</span><span class="p">:</span>     <span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">b</span><span class="p">)</span>
    <span class="mi">0</span><span class="p">]</span> <span class="n">Expr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..1</span><span class="p">,</span><span class="mi">19</span>
        <span class="o">.</span><span class="n">value</span> <span class="n">Call</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..1</span><span class="p">,</span><span class="mi">19</span>
<span class="mi">1</span><span class="p">:</span>     <span class="n">call</span>
            <span class="o">.</span><span class="n">func</span> <span class="n">Name</span> <span class="s1">&#39;call&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..1</span><span class="p">,</span><span class="mi">8</span>
            <span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">1</span><span class="p">:</span>          <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="mi">0</span><span class="p">]</span> <span class="n">Subscript</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">9..1</span><span class="p">,</span><span class="mi">13</span>
<span class="mi">1</span><span class="p">:</span>          <span class="n">a</span>
                <span class="o">.</span><span class="n">value</span> <span class="n">Name</span> <span class="s1">&#39;a&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">9..1</span><span class="p">,</span><span class="mi">10</span>
<span class="mi">1</span><span class="p">:</span>            <span class="n">i</span>
                <span class="o">.</span><span class="n">slice</span> <span class="n">Name</span> <span class="s1">&#39;i&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">11..1</span><span class="p">,</span><span class="mi">12</span>
                <span class="o">.</span><span class="n">ctx</span> <span class="n">Load</span>
            <span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">1</span><span class="p">:</span>                <span class="o">**</span><span class="n">b</span>
            <span class="mi">0</span><span class="p">]</span> <span class="n">keyword</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">15..1</span><span class="p">,</span><span class="mi">18</span>
<span class="mi">1</span><span class="p">:</span>                  <span class="n">b</span>
                <span class="o">.</span><span class="n">value</span> <span class="n">Name</span> <span class="s1">&#39;b&#39;</span> <span class="n">Load</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mf">17..1</span><span class="p">,</span><span class="mi">18</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">out</span><span class="o">=</span><span class="nb">str</span><span class="p">)[:</span><span class="mi">64</span><span class="p">]</span>
<span class="s1">&#39;If - ROOT 0,0..1,19</span><span class="se">\n</span><span class="s1">  .test Constant 1 - 0,3..0,4</span><span class="se">\n</span><span class="s1">  .body[1]</span><span class="se">\n</span><span class="s1">  0&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="nb">list</span><span class="p">):</span>
<span class="o">...</span>     <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="s1">&#39;0: if 1:&#39;</span>
<span class="s1">&#39;If - ROOT 0,0..1,19&#39;</span>
<span class="s1">&#39;  .test Constant 1 - 0,3..0,4&#39;</span>
<span class="s1">&#39;  .body[1]&#39;</span>
<span class="s1">&#39;1:     call(a[i], **b)&#39;</span>
<span class="s1">&#39;  0] Expr - 1,4..1,19&#39;</span>
<span class="s1">&#39;    .value Call - 1,4..1,19&#39;</span>
<span class="s2">&quot;      .func Name &#39;call&#39; Load - 1,4..1,8&quot;</span>
<span class="s1">&#39;      .args[1]&#39;</span>
<span class="s1">&#39;      0] Subscript - 1,9..1,13&#39;</span>
<span class="s2">&quot;        .value Name &#39;a&#39; Load - 1,9..1,10&quot;</span>
<span class="s2">&quot;        .slice Name &#39;i&#39; Load - 1,11..1,12&quot;</span>
<span class="s1">&#39;        .ctx Load&#39;</span>
<span class="s1">&#39;      .keywords[1]&#39;</span>
<span class="s1">&#39;      0] keyword - 1,15..1,18&#39;</span>
<span class="s2">&quot;        .value Name &#39;b&#39; Load - 1,17..1,18&quot;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.verify" class="classattr">
                                        <input id="FST.verify-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">verify</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;most&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtishs&#39;</span><span class="p">,</span> <span class="s1">&#39;stmtish&#39;</span><span class="p">,</span> <span class="s1">&#39;stmts&#39;</span><span class="p">,</span> <span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;ExceptHandlers&#39;</span><span class="p">,</span> <span class="s1">&#39;ExceptHandler&#39;</span><span class="p">,</span> <span class="s1">&#39;match_cases&#39;</span><span class="p">,</span> <span class="s1">&#39;match_case&#39;</span><span class="p">,</span> <span class="s1">&#39;expr&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_slice&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_sliceelt&#39;</span><span class="p">,</span> <span class="s1">&#39;expr_callarg&#39;</span><span class="p">,</span> <span class="s1">&#39;boolop&#39;</span><span class="p">,</span> <span class="s1">&#39;operator&#39;</span><span class="p">,</span> <span class="s1">&#39;binop&#39;</span><span class="p">,</span> <span class="s1">&#39;augop&#39;</span><span class="p">,</span> <span class="s1">&#39;unaryop&#39;</span><span class="p">,</span> <span class="s1">&#39;cmpop&#39;</span><span class="p">,</span> <span class="s1">&#39;comprehension&#39;</span><span class="p">,</span> <span class="s1">&#39;arguments&#39;</span><span class="p">,</span> <span class="s1">&#39;arguments_lambda&#39;</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="s1">&#39;keyword&#39;</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">,</span> <span class="s1">&#39;alias_dotted&#39;</span><span class="p">,</span> <span class="s1">&#39;alias_star&#39;</span><span class="p">,</span> <span class="s1">&#39;withitem&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span><span class="p">,</span> <span class="s1">&#39;type_param&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">reparse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">locs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">ctx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">raise_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FST.verify-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.verify"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.verify-1147"><a href="#FST.verify-1147"><span class="linenos">1147</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reparse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">locs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FST.verify-1148"><a href="#FST.verify-1148"><span class="linenos">1148</span></a>               <span class="n">raise_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Self</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="FST.verify-1149"><a href="#FST.verify-1149"><span class="linenos">1149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sanity check. Walk the tree and make sure all `AST`s have corresponding `FST` nodes with valid parent / child</span>
</span><span id="FST.verify-1150"><a href="#FST.verify-1150"><span class="linenos">1150</span></a><span class="sd">        links, then (optionally) reparse source and make sure parsed tree matches currently stored tree (locations and</span>
</span><span id="FST.verify-1151"><a href="#FST.verify-1151"><span class="linenos">1151</span></a><span class="sd">        everything). The reparse can only be carried out on root nodes but the link validation can be done on any level.</span>
</span><span id="FST.verify-1152"><a href="#FST.verify-1152"><span class="linenos">1152</span></a>
</span><span id="FST.verify-1153"><a href="#FST.verify-1153"><span class="linenos">1153</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.verify-1154"><a href="#FST.verify-1154"><span class="linenos">1154</span></a><span class="sd">        - `mode`: Parse mode to use, otherwise if `None` then use the top level AST node type for the mode. Depending on</span>
</span><span id="FST.verify-1155"><a href="#FST.verify-1155"><span class="linenos">1155</span></a><span class="sd">            how this is set will determine whether the verification is checking if is parsable by python (`&#39;exec&#39;` for</span>
</span><span id="FST.verify-1156"><a href="#FST.verify-1156"><span class="linenos">1156</span></a><span class="sd">            example), or if the node itself is just in a valid state (where `None` is good). See `fst.misc.Mode`.</span>
</span><span id="FST.verify-1157"><a href="#FST.verify-1157"><span class="linenos">1157</span></a><span class="sd">        - `reparse`: Whether to reparse the source and compare ASTs (including location). Otherwise the check is limited</span>
</span><span id="FST.verify-1158"><a href="#FST.verify-1158"><span class="linenos">1158</span></a><span class="sd">            to a structure check that all children have `FST` nodes which are all liked correctly to their parents.</span>
</span><span id="FST.verify-1159"><a href="#FST.verify-1159"><span class="linenos">1159</span></a><span class="sd">            `reparse=True` only allowed on root node.</span>
</span><span id="FST.verify-1160"><a href="#FST.verify-1160"><span class="linenos">1160</span></a><span class="sd">        - `locs`: Whether to compare locations after reparse or not.</span>
</span><span id="FST.verify-1161"><a href="#FST.verify-1161"><span class="linenos">1161</span></a><span class="sd">        - `ctx`: Whether to compare `ctx` nodes after reparse or not.</span>
</span><span id="FST.verify-1162"><a href="#FST.verify-1162"><span class="linenos">1162</span></a><span class="sd">        - `raise_`: Whether to raise an exception on verify failed or return `None`.</span>
</span><span id="FST.verify-1163"><a href="#FST.verify-1163"><span class="linenos">1163</span></a>
</span><span id="FST.verify-1164"><a href="#FST.verify-1164"><span class="linenos">1164</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.verify-1165"><a href="#FST.verify-1165"><span class="linenos">1165</span></a><span class="sd">        - `None` on failure to verify (if not `raise_`), otherwise `self`.</span>
</span><span id="FST.verify-1166"><a href="#FST.verify-1166"><span class="linenos">1166</span></a>
</span><span id="FST.verify-1167"><a href="#FST.verify-1167"><span class="linenos">1167</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.verify-1168"><a href="#FST.verify-1168"><span class="linenos">1168</span></a><span class="sd">        ```py</span>
</span><span id="FST.verify-1169"><a href="#FST.verify-1169"><span class="linenos">1169</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;var = 123&#39;).verify()</span>
</span><span id="FST.verify-1170"><a href="#FST.verify-1170"><span class="linenos">1170</span></a><span class="sd">        &lt;Assign ROOT 0,0..0,9&gt;</span>
</span><span id="FST.verify-1171"><a href="#FST.verify-1171"><span class="linenos">1171</span></a>
</span><span id="FST.verify-1172"><a href="#FST.verify-1172"><span class="linenos">1172</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;).verify()</span>
</span><span id="FST.verify-1173"><a href="#FST.verify-1173"><span class="linenos">1173</span></a><span class="sd">        &lt;Slice ROOT 0,0..0,5&gt;</span>
</span><span id="FST.verify-1174"><a href="#FST.verify-1174"><span class="linenos">1174</span></a>
</span><span id="FST.verify-1175"><a href="#FST.verify-1175"><span class="linenos">1175</span></a><span class="sd">        &gt;&gt;&gt; bool(FST(&#39;a:b:c&#39;).verify(&#39;exec&#39;, raise_=False))</span>
</span><span id="FST.verify-1176"><a href="#FST.verify-1176"><span class="linenos">1176</span></a><span class="sd">        False</span>
</span><span id="FST.verify-1177"><a href="#FST.verify-1177"><span class="linenos">1177</span></a><span class="sd">        ```</span>
</span><span id="FST.verify-1178"><a href="#FST.verify-1178"><span class="linenos">1178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.verify-1179"><a href="#FST.verify-1179"><span class="linenos">1179</span></a>
</span><span id="FST.verify-1180"><a href="#FST.verify-1180"><span class="linenos">1180</span></a>        <span class="c1"># validate tree links</span>
</span><span id="FST.verify-1181"><a href="#FST.verify-1181"><span class="linenos">1181</span></a>
</span><span id="FST.verify-1182"><a href="#FST.verify-1182"><span class="linenos">1182</span></a>        <span class="n">ast</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.verify-1183"><a href="#FST.verify-1183"><span class="linenos">1183</span></a>        <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ast</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)]</span>  <span class="c1"># [(AST, parent FST, pfield), ...]</span>
</span><span id="FST.verify-1184"><a href="#FST.verify-1184"><span class="linenos">1184</span></a>
</span><span id="FST.verify-1185"><a href="#FST.verify-1185"><span class="linenos">1185</span></a>        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
</span><span id="FST.verify-1186"><a href="#FST.verify-1186"><span class="linenos">1186</span></a>            <span class="n">a</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">pfield</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="FST.verify-1187"><a href="#FST.verify-1187"><span class="linenos">1187</span></a>
</span><span id="FST.verify-1188"><a href="#FST.verify-1188"><span class="linenos">1188</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">parent</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">pfield</span> <span class="o">!=</span> <span class="n">pfield</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
</span><span id="FST.verify-1189"><a href="#FST.verify-1189"><span class="linenos">1189</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">raise_</span><span class="p">:</span>
</span><span id="FST.verify-1190"><a href="#FST.verify-1190"><span class="linenos">1190</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.verify-1191"><a href="#FST.verify-1191"><span class="linenos">1191</span></a>
</span><span id="FST.verify-1192"><a href="#FST.verify-1192"><span class="linenos">1192</span></a>                <span class="n">path</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">pfield</span><span class="p">]</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ast</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="FST.verify-1193"><a href="#FST.verify-1193"><span class="linenos">1193</span></a>                <span class="n">path</span>   <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">af</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">af</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">af</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">for</span> <span class="n">af</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
</span><span id="FST.verify-1194"><a href="#FST.verify-1194"><span class="linenos">1194</span></a>                <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;, no AST.f node&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span> <span class="k">else</span> <span class="s1">&#39;, bad parent&#39;</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">parent</span> <span class="k">else</span> <span class="s1">&#39;, bad pfield&#39;</span>
</span><span id="FST.verify-1195"><a href="#FST.verify-1195"><span class="linenos">1195</span></a>
</span><span id="FST.verify-1196"><a href="#FST.verify-1196"><span class="linenos">1196</span></a>                <span class="k">raise</span> <span class="n">WalkFail</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;invalid child </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> at </span><span class="si">{</span><span class="n">path</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;self&quot;</span><span class="si">}{</span><span class="n">reason</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST.verify-1197"><a href="#FST.verify-1197"><span class="linenos">1197</span></a>
</span><span id="FST.verify-1198"><a href="#FST.verify-1198"><span class="linenos">1198</span></a>            <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">iter_fields</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
</span><span id="FST.verify-1199"><a href="#FST.verify-1199"><span class="linenos">1199</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="FST.verify-1200"><a href="#FST.verify-1200"><span class="linenos">1200</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">)))</span>
</span><span id="FST.verify-1201"><a href="#FST.verify-1201"><span class="linenos">1201</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.verify-1202"><a href="#FST.verify-1202"><span class="linenos">1202</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">child</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">AST</span><span class="p">))</span>
</span><span id="FST.verify-1203"><a href="#FST.verify-1203"><span class="linenos">1203</span></a>
</span><span id="FST.verify-1204"><a href="#FST.verify-1204"><span class="linenos">1204</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">reparse</span><span class="p">:</span>
</span><span id="FST.verify-1205"><a href="#FST.verify-1205"><span class="linenos">1205</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.verify-1206"><a href="#FST.verify-1206"><span class="linenos">1206</span></a>
</span><span id="FST.verify-1207"><a href="#FST.verify-1207"><span class="linenos">1207</span></a>        <span class="c1"># reparse</span>
</span><span id="FST.verify-1208"><a href="#FST.verify-1208"><span class="linenos">1208</span></a>
</span><span id="FST.verify-1209"><a href="#FST.verify-1209"><span class="linenos">1209</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="FST.verify-1210"><a href="#FST.verify-1210"><span class="linenos">1210</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;verify with reparse can only be called on root node&#39;</span><span class="p">)</span>
</span><span id="FST.verify-1211"><a href="#FST.verify-1211"><span class="linenos">1211</span></a>
</span><span id="FST.verify-1212"><a href="#FST.verify-1212"><span class="linenos">1212</span></a>        <span class="n">parse_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span>
</span><span id="FST.verify-1213"><a href="#FST.verify-1213"><span class="linenos">1213</span></a>
</span><span id="FST.verify-1214"><a href="#FST.verify-1214"><span class="linenos">1214</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.verify-1215"><a href="#FST.verify-1215"><span class="linenos">1215</span></a>            <span class="n">astp</span> <span class="o">=</span> <span class="n">FST</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="n">mode</span> <span class="ow">or</span> <span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">parse_params</span><span class="o">=</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST.verify-1216"><a href="#FST.verify-1216"><span class="linenos">1216</span></a>
</span><span id="FST.verify-1217"><a href="#FST.verify-1217"><span class="linenos">1217</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="n">NodeError</span><span class="p">):</span>
</span><span id="FST.verify-1218"><a href="#FST.verify-1218"><span class="linenos">1218</span></a>            <span class="k">if</span> <span class="n">raise_</span><span class="p">:</span>
</span><span id="FST.verify-1219"><a href="#FST.verify-1219"><span class="linenos">1219</span></a>                <span class="k">raise</span>
</span><span id="FST.verify-1220"><a href="#FST.verify-1220"><span class="linenos">1220</span></a>
</span><span id="FST.verify-1221"><a href="#FST.verify-1221"><span class="linenos">1221</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.verify-1222"><a href="#FST.verify-1222"><span class="linenos">1222</span></a>
</span><span id="FST.verify-1223"><a href="#FST.verify-1223"><span class="linenos">1223</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">compare_asts</span><span class="p">(</span><span class="n">astp</span><span class="p">,</span> <span class="n">ast</span><span class="p">,</span> <span class="n">locs</span><span class="o">=</span><span class="n">locs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">type_comments</span><span class="o">=</span><span class="n">parse_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type_comments&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
</span><span id="FST.verify-1224"><a href="#FST.verify-1224"><span class="linenos">1224</span></a>                            <span class="n">raise_</span><span class="o">=</span><span class="n">raise_</span><span class="p">):</span>
</span><span id="FST.verify-1225"><a href="#FST.verify-1225"><span class="linenos">1225</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.verify-1226"><a href="#FST.verify-1226"><span class="linenos">1226</span></a>
</span><span id="FST.verify-1227"><a href="#FST.verify-1227"><span class="linenos">1227</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Sanity check. Walk the tree and make sure all <code>AST</code>s have corresponding <code><a href="#FST">FST</a></code> nodes with valid parent / child
links, then (optionally) reparse source and make sure parsed tree matches currently stored tree (locations and
everything). The reparse can only be carried out on root nodes but the link validation can be done on any level.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>mode</code>: Parse mode to use, otherwise if <code>None</code> then use the top level AST node type for the mode. Depending on
how this is set will determine whether the verification is checking if is parsable by python (<code>'exec'</code> for
example), or if the node itself is just in a valid state (where <code>None</code> is good). See <code><a href="misc.html#Mode">fst.misc.Mode</a></code>.</li>
<li><code>reparse</code>: Whether to reparse the source and compare ASTs (including location). Otherwise the check is limited
to a structure check that all children have <code><a href="#FST">FST</a></code> nodes which are all liked correctly to their parents.
<code>reparse=True</code> only allowed on root node.</li>
<li><code>locs</code>: Whether to compare locations after reparse or not.</li>
<li><code>ctx</code>: Whether to compare <code>ctx</code> nodes after reparse or not.</li>
<li><code>raise_</code>: Whether to raise an exception on verify failed or return <code>None</code>.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> on failure to verify (if not <code>raise_</code>), otherwise <code>self</code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;var = 123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">9</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a:b:c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Slice</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">5</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">bool</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a:b:c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="n">raise_</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.mark" class="classattr">
                                        <input id="FST.mark-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mark</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.mark-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.mark"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.mark-364"><a href="#FST.mark-364"><span class="linenos">364</span></a><span class="k">def</span><span class="w"> </span><span class="nf">mark</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">:</span>
</span><span id="FST.mark-365"><a href="#FST.mark-365"><span class="linenos">365</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an object marking the current state of this `FST` tree. Used to `reconcile()` later for non-FST operation</span>
</span><span id="FST.mark-366"><a href="#FST.mark-366"><span class="linenos">366</span></a><span class="sd">    changes made (changing `AST` nodes directly). Currently is just a copy of the original tree but may change in the</span>
</span><span id="FST.mark-367"><a href="#FST.mark-367"><span class="linenos">367</span></a><span class="sd">    future.</span>
</span><span id="FST.mark-368"><a href="#FST.mark-368"><span class="linenos">368</span></a>
</span><span id="FST.mark-369"><a href="#FST.mark-369"><span class="linenos">369</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.mark-370"><a href="#FST.mark-370"><span class="linenos">370</span></a><span class="sd">    - `FST`: A marked copy of `self` with any necessary information added for a later `reconcile()`.</span>
</span><span id="FST.mark-371"><a href="#FST.mark-371"><span class="linenos">371</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.mark-372"><a href="#FST.mark-372"><span class="linenos">372</span></a>
</span><span id="FST.mark-373"><a href="#FST.mark-373"><span class="linenos">373</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="FST.mark-374"><a href="#FST.mark-374"><span class="linenos">374</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;can only mark root nodes&#39;</span><span class="p">)</span>
</span><span id="FST.mark-375"><a href="#FST.mark-375"><span class="linenos">375</span></a>
</span><span id="FST.mark-376"><a href="#FST.mark-376"><span class="linenos">376</span></a>    <span class="n">mark</span>         <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="FST.mark-377"><a href="#FST.mark-377"><span class="linenos">377</span></a>    <span class="n">mark</span><span class="o">.</span><span class="n">_serial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serial</span>
</span><span id="FST.mark-378"><a href="#FST.mark-378"><span class="linenos">378</span></a>
</span><span id="FST.mark-379"><a href="#FST.mark-379"><span class="linenos">379</span></a>    <span class="k">return</span> <span class="n">mark</span>
</span></pre></div>


            <div class="docstring"><p>Return an object marking the current state of this <code><a href="#FST">FST</a></code> tree. Used to <code><a href="#FST.reconcile">reconcile()</a></code> later for non-FST operation
changes made (changing <code>AST</code> nodes directly). Currently is just a copy of the original tree but may change in the
future.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: A marked copy of <code>self</code> with any necessary information added for a later <code><a href="#FST.reconcile">reconcile()</a></code>.</li>
</ul>
</div>


                            </div>
                            <div id="FST.reconcile" class="classattr">
                                        <input id="FST.reconcile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reconcile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>, </span><span class="param"><span class="n">mark</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>, </span><span class="param"><span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.reconcile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.reconcile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.reconcile-381"><a href="#FST.reconcile-381"><span class="linenos">381</span></a><span class="k">def</span><span class="w"> </span><span class="nf">reconcile</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">mark</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">:</span>
</span><span id="FST.reconcile-382"><a href="#FST.reconcile-382"><span class="linenos">382</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Reconcile `self` with a previously marked version and return a new valid `FST` tree. This is meant for allowing</span>
</span><span id="FST.reconcile-383"><a href="#FST.reconcile-383"><span class="linenos">383</span></a><span class="sd">    non-FST modifications to an `FST` tree and later converting it to a valid `FST` tree to preserve as much formatting</span>
</span><span id="FST.reconcile-384"><a href="#FST.reconcile-384"><span class="linenos">384</span></a><span class="sd">    as possible and maybe continue operating in `FST` land. Only `AST` nodes from the original tree carry formatting</span>
</span><span id="FST.reconcile-385"><a href="#FST.reconcile-385"><span class="linenos">385</span></a><span class="sd">    information, so the more of those are replaced the more formatting is lost.</span>
</span><span id="FST.reconcile-386"><a href="#FST.reconcile-386"><span class="linenos">386</span></a>
</span><span id="FST.reconcile-387"><a href="#FST.reconcile-387"><span class="linenos">387</span></a><span class="sd">    **Note:** When replacing the `AST` nodes, make sure you are replacing the nodes in the parent `AST` fields, not the</span>
</span><span id="FST.reconcile-388"><a href="#FST.reconcile-388"><span class="linenos">388</span></a><span class="sd">    `.a` attribute in `FST` nodes, that won&#39;t do anything.</span>
</span><span id="FST.reconcile-389"><a href="#FST.reconcile-389"><span class="linenos">389</span></a>
</span><span id="FST.reconcile-390"><a href="#FST.reconcile-390"><span class="linenos">390</span></a><span class="sd">    **WARNING!** Just like an `ast.unparse()`, the fact that this function completes successfully does NOT mean the</span>
</span><span id="FST.reconcile-391"><a href="#FST.reconcile-391"><span class="linenos">391</span></a><span class="sd">    output is syntactically correct if you put weird nodes where they don&#39;t belong, maybe accidentally. In order to make</span>
</span><span id="FST.reconcile-392"><a href="#FST.reconcile-392"><span class="linenos">392</span></a><span class="sd">    sure the result is valid (syntactically) you should run `verify()` on the output. This still won&#39;t guarantee you</span>
</span><span id="FST.reconcile-393"><a href="#FST.reconcile-393"><span class="linenos">393</span></a><span class="sd">    have actual valid code, `def f(x, x): pass` parses ok but will cause an error if you try to compile it.</span>
</span><span id="FST.reconcile-394"><a href="#FST.reconcile-394"><span class="linenos">394</span></a>
</span><span id="FST.reconcile-395"><a href="#FST.reconcile-395"><span class="linenos">395</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.reconcile-396"><a href="#FST.reconcile-396"><span class="linenos">396</span></a><span class="sd">    - `mark`: A previously marked snapshot of `self`. This object is not consumed on use, success or failure.</span>
</span><span id="FST.reconcile-397"><a href="#FST.reconcile-397"><span class="linenos">397</span></a><span class="sd">    - `options`: See `get_options()`.</span>
</span><span id="FST.reconcile-398"><a href="#FST.reconcile-398"><span class="linenos">398</span></a>
</span><span id="FST.reconcile-399"><a href="#FST.reconcile-399"><span class="linenos">399</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.reconcile-400"><a href="#FST.reconcile-400"><span class="linenos">400</span></a><span class="sd">    - `FST`: A new valid reconciled `FST` if possible.</span>
</span><span id="FST.reconcile-401"><a href="#FST.reconcile-401"><span class="linenos">401</span></a>
</span><span id="FST.reconcile-402"><a href="#FST.reconcile-402"><span class="linenos">402</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.reconcile-403"><a href="#FST.reconcile-403"><span class="linenos">403</span></a><span class="sd">    ```py</span>
</span><span id="FST.reconcile-404"><a href="#FST.reconcile-404"><span class="linenos">404</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.reconcile-405"><a href="#FST.reconcile-405"><span class="linenos">405</span></a>
</span><span id="FST.reconcile-406"><a href="#FST.reconcile-406"><span class="linenos">406</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;&#39;&#39;</span>
</span><span id="FST.reconcile-407"><a href="#FST.reconcile-407"><span class="linenos">407</span></a><span class="sd">    ... @decorator  # something</span>
</span><span id="FST.reconcile-408"><a href="#FST.reconcile-408"><span class="linenos">408</span></a><span class="sd">    ... def function(a: int, b=2)-&gt;int:  # blah</span>
</span><span id="FST.reconcile-409"><a href="#FST.reconcile-409"><span class="linenos">409</span></a><span class="sd">    ...     return a+b  # return this</span>
</span><span id="FST.reconcile-410"><a href="#FST.reconcile-410"><span class="linenos">410</span></a><span class="sd">    ...</span>
</span><span id="FST.reconcile-411"><a href="#FST.reconcile-411"><span class="linenos">411</span></a><span class="sd">    ... def other_function(a, b):</span>
</span><span id="FST.reconcile-412"><a href="#FST.reconcile-412"><span class="linenos">412</span></a><span class="sd">    ...     return a - b  # return that</span>
</span><span id="FST.reconcile-413"><a href="#FST.reconcile-413"><span class="linenos">413</span></a><span class="sd">    ... &#39;&#39;&#39;.strip())</span>
</span><span id="FST.reconcile-414"><a href="#FST.reconcile-414"><span class="linenos">414</span></a>
</span><span id="FST.reconcile-415"><a href="#FST.reconcile-415"><span class="linenos">415</span></a><span class="sd">    &gt;&gt;&gt; m = f.mark()</span>
</span><span id="FST.reconcile-416"><a href="#FST.reconcile-416"><span class="linenos">416</span></a>
</span><span id="FST.reconcile-417"><a href="#FST.reconcile-417"><span class="linenos">417</span></a><span class="sd">    &gt;&gt;&gt; f.a.body[0].returns = Name(&#39;float&#39;)  # pure AST</span>
</span><span id="FST.reconcile-418"><a href="#FST.reconcile-418"><span class="linenos">418</span></a><span class="sd">    &gt;&gt;&gt; f.a.body[0].args.args[0].annotation = Name(&#39;float&#39;)</span>
</span><span id="FST.reconcile-419"><a href="#FST.reconcile-419"><span class="linenos">419</span></a><span class="sd">    &gt;&gt;&gt; f.a.body[0].decorator_list[0] = FST(&#39;call_decorator(1, 2, 3)&#39;).a</span>
</span><span id="FST.reconcile-420"><a href="#FST.reconcile-420"><span class="linenos">420</span></a><span class="sd">    &gt;&gt;&gt; f.a.body[1].name = &#39;last_function&#39;  # can change non-AST</span>
</span><span id="FST.reconcile-421"><a href="#FST.reconcile-421"><span class="linenos">421</span></a><span class="sd">    &gt;&gt;&gt; f.a.body[1].body[0] = f.a.body[0].body[0]  # AST from same FST tree</span>
</span><span id="FST.reconcile-422"><a href="#FST.reconcile-422"><span class="linenos">422</span></a><span class="sd">    &gt;&gt;&gt; other = FST(&#39;def first_function(a, b): return a * b  # yay!&#39;)</span>
</span><span id="FST.reconcile-423"><a href="#FST.reconcile-423"><span class="linenos">423</span></a><span class="sd">    &gt;&gt;&gt; f.a.body.insert(0, other.a)  # AST from other FST tree</span>
</span><span id="FST.reconcile-424"><a href="#FST.reconcile-424"><span class="linenos">424</span></a>
</span><span id="FST.reconcile-425"><a href="#FST.reconcile-425"><span class="linenos">425</span></a><span class="sd">    &gt;&gt;&gt; f = f.reconcile(m, pep8space=1)</span>
</span><span id="FST.reconcile-426"><a href="#FST.reconcile-426"><span class="linenos">426</span></a>
</span><span id="FST.reconcile-427"><a href="#FST.reconcile-427"><span class="linenos">427</span></a><span class="sd">    &gt;&gt;&gt; print(&#39;\n&#39;.join(l or &#39;.&#39; for l in f.lines))  # print this way for doctest</span>
</span><span id="FST.reconcile-428"><a href="#FST.reconcile-428"><span class="linenos">428</span></a><span class="sd">    def first_function(a, b): return a * b  # yay!</span>
</span><span id="FST.reconcile-429"><a href="#FST.reconcile-429"><span class="linenos">429</span></a><span class="sd">    .</span>
</span><span id="FST.reconcile-430"><a href="#FST.reconcile-430"><span class="linenos">430</span></a><span class="sd">    @call_decorator(1, 2, 3)  # something</span>
</span><span id="FST.reconcile-431"><a href="#FST.reconcile-431"><span class="linenos">431</span></a><span class="sd">    def function(a: float, b=2)-&gt;float:  # blah</span>
</span><span id="FST.reconcile-432"><a href="#FST.reconcile-432"><span class="linenos">432</span></a><span class="sd">        return a+b  # return this</span>
</span><span id="FST.reconcile-433"><a href="#FST.reconcile-433"><span class="linenos">433</span></a><span class="sd">    .</span>
</span><span id="FST.reconcile-434"><a href="#FST.reconcile-434"><span class="linenos">434</span></a><span class="sd">    def last_function(a, b):</span>
</span><span id="FST.reconcile-435"><a href="#FST.reconcile-435"><span class="linenos">435</span></a><span class="sd">        return a+b  # return this</span>
</span><span id="FST.reconcile-436"><a href="#FST.reconcile-436"><span class="linenos">436</span></a><span class="sd">    .</span>
</span><span id="FST.reconcile-437"><a href="#FST.reconcile-437"><span class="linenos">437</span></a>
</span><span id="FST.reconcile-438"><a href="#FST.reconcile-438"><span class="linenos">438</span></a><span class="sd">    &gt;&gt;&gt; m = f.mark()</span>
</span><span id="FST.reconcile-439"><a href="#FST.reconcile-439"><span class="linenos">439</span></a>
</span><span id="FST.reconcile-440"><a href="#FST.reconcile-440"><span class="linenos">440</span></a><span class="sd">    &gt;&gt;&gt; body = f.a.body[1].body</span>
</span><span id="FST.reconcile-441"><a href="#FST.reconcile-441"><span class="linenos">441</span></a><span class="sd">    &gt;&gt;&gt; f.a.body[1] = FST(&#39;def f(): pass&#39;).a</span>
</span><span id="FST.reconcile-442"><a href="#FST.reconcile-442"><span class="linenos">442</span></a><span class="sd">    &gt;&gt;&gt; f.a.body[1].body = body</span>
</span><span id="FST.reconcile-443"><a href="#FST.reconcile-443"><span class="linenos">443</span></a>
</span><span id="FST.reconcile-444"><a href="#FST.reconcile-444"><span class="linenos">444</span></a><span class="sd">    &gt;&gt;&gt; f = f.reconcile(m, pep8space=1)</span>
</span><span id="FST.reconcile-445"><a href="#FST.reconcile-445"><span class="linenos">445</span></a>
</span><span id="FST.reconcile-446"><a href="#FST.reconcile-446"><span class="linenos">446</span></a><span class="sd">    &gt;&gt;&gt; print(&#39;\n&#39;.join(l or &#39;.&#39; for l in f.lines))</span>
</span><span id="FST.reconcile-447"><a href="#FST.reconcile-447"><span class="linenos">447</span></a><span class="sd">    def first_function(a, b): return a * b  # yay!</span>
</span><span id="FST.reconcile-448"><a href="#FST.reconcile-448"><span class="linenos">448</span></a><span class="sd">    .</span>
</span><span id="FST.reconcile-449"><a href="#FST.reconcile-449"><span class="linenos">449</span></a><span class="sd">    def f():</span>
</span><span id="FST.reconcile-450"><a href="#FST.reconcile-450"><span class="linenos">450</span></a><span class="sd">        return a+b  # return this</span>
</span><span id="FST.reconcile-451"><a href="#FST.reconcile-451"><span class="linenos">451</span></a><span class="sd">    .</span>
</span><span id="FST.reconcile-452"><a href="#FST.reconcile-452"><span class="linenos">452</span></a><span class="sd">    def last_function(a, b):</span>
</span><span id="FST.reconcile-453"><a href="#FST.reconcile-453"><span class="linenos">453</span></a><span class="sd">        return a+b  # return this</span>
</span><span id="FST.reconcile-454"><a href="#FST.reconcile-454"><span class="linenos">454</span></a><span class="sd">    .</span>
</span><span id="FST.reconcile-455"><a href="#FST.reconcile-455"><span class="linenos">455</span></a><span class="sd">    ```</span>
</span><span id="FST.reconcile-456"><a href="#FST.reconcile-456"><span class="linenos">456</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.reconcile-457"><a href="#FST.reconcile-457"><span class="linenos">457</span></a>
</span><span id="FST.reconcile-458"><a href="#FST.reconcile-458"><span class="linenos">458</span></a>    <span class="c1"># TODO: allow multiple maked trees to participate?</span>
</span><span id="FST.reconcile-459"><a href="#FST.reconcile-459"><span class="linenos">459</span></a>
</span><span id="FST.reconcile-460"><a href="#FST.reconcile-460"><span class="linenos">460</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_root</span><span class="p">:</span>
</span><span id="FST.reconcile-461"><a href="#FST.reconcile-461"><span class="linenos">461</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;can only reconcile root nodes&#39;</span><span class="p">)</span>
</span><span id="FST.reconcile-462"><a href="#FST.reconcile-462"><span class="linenos">462</span></a>
</span><span id="FST.reconcile-463"><a href="#FST.reconcile-463"><span class="linenos">463</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serial</span> <span class="o">!=</span> <span class="n">mark</span><span class="o">.</span><span class="n">_serial</span><span class="p">:</span>
</span><span id="FST.reconcile-464"><a href="#FST.reconcile-464"><span class="linenos">464</span></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;modification detected after mark(), irreconcilable&#39;</span><span class="p">)</span>
</span><span id="FST.reconcile-465"><a href="#FST.reconcile-465"><span class="linenos">465</span></a>
</span><span id="FST.reconcile-466"><a href="#FST.reconcile-466"><span class="linenos">466</span></a>    <span class="n">rec</span> <span class="o">=</span> <span class="n">_Reconcile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mark</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span id="FST.reconcile-467"><a href="#FST.reconcile-467"><span class="linenos">467</span></a>
</span><span id="FST.reconcile-468"><a href="#FST.reconcile-468"><span class="linenos">468</span></a>    <span class="n">rec</span><span class="o">.</span><span class="n">recurse_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
</span><span id="FST.reconcile-469"><a href="#FST.reconcile-469"><span class="linenos">469</span></a>
</span><span id="FST.reconcile-470"><a href="#FST.reconcile-470"><span class="linenos">470</span></a>    <span class="k">return</span> <span class="n">rec</span><span class="o">.</span><span class="n">out</span>
</span></pre></div>


            <div class="docstring"><p>Reconcile <code>self</code> with a previously marked version and return a new valid <code><a href="#FST">FST</a></code> tree. This is meant for allowing
non-FST modifications to an <code><a href="#FST">FST</a></code> tree and later converting it to a valid <code><a href="#FST">FST</a></code> tree to preserve as much formatting
as possible and maybe continue operating in <code><a href="#FST">FST</a></code> land. Only <code>AST</code> nodes from the original tree carry formatting
information, so the more of those are replaced the more formatting is lost.</p>

<p><strong>Note:</strong> When replacing the <code>AST</code> nodes, make sure you are replacing the nodes in the parent <code>AST</code> fields, not the
<code>.a</code> attribute in <code><a href="#FST">FST</a></code> nodes, that won't do anything.</p>

<p><strong>WARNING!</strong> Just like an <code>ast.unparse()</code>, the fact that this function completes successfully does NOT mean the
output is syntactically correct if you put weird nodes where they don't belong, maybe accidentally. In order to make
sure the result is valid (syntactically) you should run <code><a href="#FST.verify">verify()</a></code> on the output. This still won't guarantee you
have actual valid code, <code>def f(x, x): pass</code> parses ok but will cause an error if you try to compile it.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.mark">mark</a></code>: A previously marked snapshot of <code>self</code>. This object is not consumed on use, success or failure.</li>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: A new valid reconciled <code><a href="#FST">FST</a></code> if possible.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">... @decorator  # something</span>
<span class="s1">... def function(a: int, b=2)-&gt;int:  # blah</span>
<span class="s1">...     return a+b  # return this</span>
<span class="s1">...</span>
<span class="s1">... def other_function(a, b):</span>
<span class="s1">...     return a - b  # return that</span>
<span class="s1">... &#39;&#39;&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">mark</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">returns</span> <span class="o">=</span> <span class="n">Name</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>  <span class="c1"># pure AST</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="n">Name</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decorator_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call_decorator(1, 2, 3)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">a</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;last_function&#39;</span>  <span class="c1"># can change non-AST</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># AST from same FST tree</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">other</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def first_function(a, b): return a * b  # yay!&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># AST from other FST tree</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">reconcile</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pep8space</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">lines</span><span class="p">))</span>  <span class="c1"># print this way for doctest</span>
<span class="k">def</span><span class="w"> </span><span class="nf">first_function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>  <span class="c1"># yay!</span>
<span class="o">.</span>
<span class="nd">@call_decorator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># something</span>
<span class="k">def</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">float</span><span class="p">:</span>  <span class="c1"># blah</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>  <span class="c1"># return this</span>
<span class="o">.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">last_function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>  <span class="c1"># return this</span>
<span class="o">.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">mark</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">body</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">body</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">a</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">body</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">reconcile</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pep8space</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">lines</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">first_function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>  <span class="c1"># yay!</span>
<span class="o">.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>  <span class="c1"># return this</span>
<span class="o">.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">last_function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>  <span class="c1"># return this</span>
<span class="o">.</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.copy" class="classattr">
                                        <input id="FST.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.copy-1243"><a href="#FST.copy-1243"><span class="linenos">1243</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST.copy-1244"><a href="#FST.copy-1244"><span class="linenos">1244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy this node to a new top-level tree, dedenting and fixing as necessary.</span>
</span><span id="FST.copy-1245"><a href="#FST.copy-1245"><span class="linenos">1245</span></a>
</span><span id="FST.copy-1246"><a href="#FST.copy-1246"><span class="linenos">1246</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.copy-1247"><a href="#FST.copy-1247"><span class="linenos">1247</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST.copy-1248"><a href="#FST.copy-1248"><span class="linenos">1248</span></a>
</span><span id="FST.copy-1249"><a href="#FST.copy-1249"><span class="linenos">1249</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.copy-1250"><a href="#FST.copy-1250"><span class="linenos">1250</span></a><span class="sd">        - `FST`: Copied node.</span>
</span><span id="FST.copy-1251"><a href="#FST.copy-1251"><span class="linenos">1251</span></a>
</span><span id="FST.copy-1252"><a href="#FST.copy-1252"><span class="linenos">1252</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.copy-1253"><a href="#FST.copy-1253"><span class="linenos">1253</span></a><span class="sd">        ```py</span>
</span><span id="FST.copy-1254"><a href="#FST.copy-1254"><span class="linenos">1254</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).elts[1].copy().src</span>
</span><span id="FST.copy-1255"><a href="#FST.copy-1255"><span class="linenos">1255</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="FST.copy-1256"><a href="#FST.copy-1256"><span class="linenos">1256</span></a><span class="sd">        ```</span>
</span><span id="FST.copy-1257"><a href="#FST.copy-1257"><span class="linenos">1257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.copy-1258"><a href="#FST.copy-1258"><span class="linenos">1258</span></a>
</span><span id="FST.copy-1259"><a href="#FST.copy-1259"><span class="linenos">1259</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST.copy-1260"><a href="#FST.copy-1260"><span class="linenos">1260</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_get_one</span><span class="p">((</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.copy-1261"><a href="#FST.copy-1261"><span class="linenos">1261</span></a>
</span><span id="FST.copy-1262"><a href="#FST.copy-1262"><span class="linenos">1262</span></a>        <span class="k">return</span> <span class="n">FST</span><span class="p">(</span><span class="n">copy_ast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span><span class="p">[:],</span> <span class="n">from_</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">lcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Copy this node to a new top-level tree, dedenting and fixing as necessary.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: Copied node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;1&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.cut" class="classattr">
                                        <input id="FST.cut-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cut</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.cut-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.cut"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.cut-1264"><a href="#FST.cut-1264"><span class="linenos">1264</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST.cut-1265"><a href="#FST.cut-1265"><span class="linenos">1265</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cut out this node to a new top-level tree (if possible), dedenting and fixing as necessary. Cannot cut root</span>
</span><span id="FST.cut-1266"><a href="#FST.cut-1266"><span class="linenos">1266</span></a><span class="sd">        node.</span>
</span><span id="FST.cut-1267"><a href="#FST.cut-1267"><span class="linenos">1267</span></a>
</span><span id="FST.cut-1268"><a href="#FST.cut-1268"><span class="linenos">1268</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.cut-1269"><a href="#FST.cut-1269"><span class="linenos">1269</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST.cut-1270"><a href="#FST.cut-1270"><span class="linenos">1270</span></a>
</span><span id="FST.cut-1271"><a href="#FST.cut-1271"><span class="linenos">1271</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.cut-1272"><a href="#FST.cut-1272"><span class="linenos">1272</span></a><span class="sd">        - `FST`: Cut node.</span>
</span><span id="FST.cut-1273"><a href="#FST.cut-1273"><span class="linenos">1273</span></a>
</span><span id="FST.cut-1274"><a href="#FST.cut-1274"><span class="linenos">1274</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.cut-1275"><a href="#FST.cut-1275"><span class="linenos">1275</span></a><span class="sd">        ```py</span>
</span><span id="FST.cut-1276"><a href="#FST.cut-1276"><span class="linenos">1276</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).elts[1].cut().src</span>
</span><span id="FST.cut-1277"><a href="#FST.cut-1277"><span class="linenos">1277</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="FST.cut-1278"><a href="#FST.cut-1278"><span class="linenos">1278</span></a>
</span><span id="FST.cut-1279"><a href="#FST.cut-1279"><span class="linenos">1279</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST.cut-1280"><a href="#FST.cut-1280"><span class="linenos">1280</span></a><span class="sd">        &#39;[0, 2, 3]&#39;</span>
</span><span id="FST.cut-1281"><a href="#FST.cut-1281"><span class="linenos">1281</span></a><span class="sd">        ```</span>
</span><span id="FST.cut-1282"><a href="#FST.cut-1282"><span class="linenos">1282</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.cut-1283"><a href="#FST.cut-1283"><span class="linenos">1283</span></a>
</span><span id="FST.cut-1284"><a href="#FST.cut-1284"><span class="linenos">1284</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST.cut-1285"><a href="#FST.cut-1285"><span class="linenos">1285</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_get_one</span><span class="p">((</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.cut-1286"><a href="#FST.cut-1286"><span class="linenos">1286</span></a>
</span><span id="FST.cut-1287"><a href="#FST.cut-1287"><span class="linenos">1287</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cannot cut root node&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Cut out this node to a new top-level tree (if possible), dedenting and fixing as necessary. Cannot cut root
node.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: Cut node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cut</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;1&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 2, 3]&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.replace" class="classattr">
                                        <input id="FST.replace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">replace</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">code</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#FST">FST</a></span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>,</span><span class="param">	<span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.replace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.replace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.replace-1289"><a href="#FST.replace-1289"><span class="linenos">1289</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># -&gt; replaced Self or None if deleted</span>
</span><span id="FST.replace-1290"><a href="#FST.replace-1290"><span class="linenos">1290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace or delete (if `code=None`, if possible) this node. Returns the new node for `self`, not the old</span>
</span><span id="FST.replace-1291"><a href="#FST.replace-1291"><span class="linenos">1291</span></a><span class="sd">        replaced node, or `None` if was deleted or raw replaced and the old node disappeared. Cannot delete root node.</span>
</span><span id="FST.replace-1292"><a href="#FST.replace-1292"><span class="linenos">1292</span></a><span class="sd">        CAN replace root node, in which case the accessing `FST` node remains the same but the top-level `AST` and</span>
</span><span id="FST.replace-1293"><a href="#FST.replace-1293"><span class="linenos">1293</span></a><span class="sd">        source change.</span>
</span><span id="FST.replace-1294"><a href="#FST.replace-1294"><span class="linenos">1294</span></a>
</span><span id="FST.replace-1295"><a href="#FST.replace-1295"><span class="linenos">1295</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.replace-1296"><a href="#FST.replace-1296"><span class="linenos">1296</span></a><span class="sd">        - `code`: `FST`, `AST` or source `str` or `list[str]` to put at this location. `None` to delete this node.</span>
</span><span id="FST.replace-1297"><a href="#FST.replace-1297"><span class="linenos">1297</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST.replace-1298"><a href="#FST.replace-1298"><span class="linenos">1298</span></a><span class="sd">            - `to`: Special option which only applies replacing in `raw` mode (either through `True` or `&#39;auto&#39;`).</span>
</span><span id="FST.replace-1299"><a href="#FST.replace-1299"><span class="linenos">1299</span></a><span class="sd">                Instead of replacing just this node, will replace the entire span from this node to the node specified</span>
</span><span id="FST.replace-1300"><a href="#FST.replace-1300"><span class="linenos">1300</span></a><span class="sd">                in `to` with the `code` passed.</span>
</span><span id="FST.replace-1301"><a href="#FST.replace-1301"><span class="linenos">1301</span></a>
</span><span id="FST.replace-1302"><a href="#FST.replace-1302"><span class="linenos">1302</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.replace-1303"><a href="#FST.replace-1303"><span class="linenos">1303</span></a><span class="sd">        - `FST | None`: Returns the new node if successfully replaced or `None` if deleted.</span>
</span><span id="FST.replace-1304"><a href="#FST.replace-1304"><span class="linenos">1304</span></a>
</span><span id="FST.replace-1305"><a href="#FST.replace-1305"><span class="linenos">1305</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.replace-1306"><a href="#FST.replace-1306"><span class="linenos">1306</span></a><span class="sd">        ```py</span>
</span><span id="FST.replace-1307"><a href="#FST.replace-1307"><span class="linenos">1307</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).elts[1].replace(&#39;4&#39;).root.src</span>
</span><span id="FST.replace-1308"><a href="#FST.replace-1308"><span class="linenos">1308</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="FST.replace-1309"><a href="#FST.replace-1309"><span class="linenos">1309</span></a>
</span><span id="FST.replace-1310"><a href="#FST.replace-1310"><span class="linenos">1310</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;def f(a, /, b, *c, **d) -&gt; int: pass&#39;)</span>
</span><span id="FST.replace-1311"><a href="#FST.replace-1311"><span class="linenos">1311</span></a><span class="sd">        &gt;&gt;&gt; f.args.posonlyargs[0].replace(&#39;)&#39;, to=f.returns, raw=True)  # raw reparse</span>
</span><span id="FST.replace-1312"><a href="#FST.replace-1312"><span class="linenos">1312</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST.replace-1313"><a href="#FST.replace-1313"><span class="linenos">1313</span></a><span class="sd">        &#39;def f(): pass&#39;</span>
</span><span id="FST.replace-1314"><a href="#FST.replace-1314"><span class="linenos">1314</span></a><span class="sd">        ```</span>
</span><span id="FST.replace-1315"><a href="#FST.replace-1315"><span class="linenos">1315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.replace-1316"><a href="#FST.replace-1316"><span class="linenos">1316</span></a>
</span><span id="FST.replace-1317"><a href="#FST.replace-1317"><span class="linenos">1317</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST.replace-1318"><a href="#FST.replace-1318"><span class="linenos">1318</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="p">(</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.replace-1319"><a href="#FST.replace-1319"><span class="linenos">1319</span></a>
</span><span id="FST.replace-1320"><a href="#FST.replace-1320"><span class="linenos">1320</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.replace-1321"><a href="#FST.replace-1321"><span class="linenos">1321</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cannot delete root node&#39;</span><span class="p">)</span>
</span><span id="FST.replace-1322"><a href="#FST.replace-1322"><span class="linenos">1322</span></a>        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">):</span>
</span><span id="FST.replace-1323"><a href="#FST.replace-1323"><span class="linenos">1323</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cannot replace root node using a &#39;to&#39; parameter&quot;</span><span class="p">)</span>
</span><span id="FST.replace-1324"><a href="#FST.replace-1324"><span class="linenos">1324</span></a>
</span><span id="FST.replace-1325"><a href="#FST.replace-1325"><span class="linenos">1325</span></a>        <span class="n">code</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_code_as_all</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_params</span><span class="p">)</span>
</span><span id="FST.replace-1326"><a href="#FST.replace-1326"><span class="linenos">1326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lines</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST.replace-1327"><a href="#FST.replace-1327"><span class="linenos">1327</span></a>
</span><span id="FST.replace-1328"><a href="#FST.replace-1328"><span class="linenos">1328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_ast</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="FST.replace-1329"><a href="#FST.replace-1329"><span class="linenos">1329</span></a>
</span><span id="FST.replace-1330"><a href="#FST.replace-1330"><span class="linenos">1330</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Replace or delete (if <code>code=None</code>, if possible) this node. Returns the new node for <code>self</code>, not the old
replaced node, or <code>None</code> if was deleted or raw replaced and the old node disappeared. Cannot delete root node.
CAN replace root node, in which case the accessing <code><a href="#FST">FST</a></code> node remains the same but the top-level <code>AST</code> and
source change.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>code</code>: <code><a href="#FST">FST</a></code>, <code>AST</code> or source <code>str</code> or <code>list[str]</code> to put at this location. <code>None</code> to delete this node.</li>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.
<ul>
<li><code>to</code>: Special option which only applies replacing in <code>raw</code> mode (either through <code>True</code> or <code>'auto'</code>).
Instead of replacing just this node, will replace the entire span from this node to the node specified
in <code>to</code> with the <code>code</code> passed.</li>
</ul></li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>FST | None</code>: Returns the new node if successfully replaced or <code>None</code> if deleted.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 4, 2, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(a, /, b, *c, **d) -&gt; int: pass&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">posonlyargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">returns</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># raw reparse</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;def f(): pass&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.remove" class="classattr">
                                        <input id="FST.remove-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">options</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FST.remove-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.remove"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.remove-1332"><a href="#FST.remove-1332"><span class="linenos">1332</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
</span><span id="FST.remove-1333"><a href="#FST.remove-1333"><span class="linenos">1333</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete this node if possible, equivalent to `replace(None, ...)`. Cannot delete root node.</span>
</span><span id="FST.remove-1334"><a href="#FST.remove-1334"><span class="linenos">1334</span></a>
</span><span id="FST.remove-1335"><a href="#FST.remove-1335"><span class="linenos">1335</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.remove-1336"><a href="#FST.remove-1336"><span class="linenos">1336</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST.remove-1337"><a href="#FST.remove-1337"><span class="linenos">1337</span></a>
</span><span id="FST.remove-1338"><a href="#FST.remove-1338"><span class="linenos">1338</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.remove-1339"><a href="#FST.remove-1339"><span class="linenos">1339</span></a><span class="sd">        ```py</span>
</span><span id="FST.remove-1340"><a href="#FST.remove-1340"><span class="linenos">1340</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).elts[1].remove(); f.src</span>
</span><span id="FST.remove-1341"><a href="#FST.remove-1341"><span class="linenos">1341</span></a><span class="sd">        &#39;[0, 2, 3]&#39;</span>
</span><span id="FST.remove-1342"><a href="#FST.remove-1342"><span class="linenos">1342</span></a><span class="sd">        ```</span>
</span><span id="FST.remove-1343"><a href="#FST.remove-1343"><span class="linenos">1343</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.remove-1344"><a href="#FST.remove-1344"><span class="linenos">1344</span></a>
</span><span id="FST.remove-1345"><a href="#FST.remove-1345"><span class="linenos">1345</span></a>        <span class="k">if</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST.remove-1346"><a href="#FST.remove-1346"><span class="linenos">1346</span></a>            <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">(</span><span class="n">pf</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.remove-1347"><a href="#FST.remove-1347"><span class="linenos">1347</span></a>
</span><span id="FST.remove-1348"><a href="#FST.remove-1348"><span class="linenos">1348</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot delete root node&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Delete this node if possible, equivalent to <code>replace(None, ...)</code>. Cannot delete root node.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">();</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 2, 3]&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.get" class="classattr">
                                        <input id="FST.get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">idx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stop</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">cut</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ellipsis</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">complex</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.get-1350"><a href="#FST.get-1350"><span class="linenos">1350</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FST.get-1351"><a href="#FST.get-1351"><span class="linenos">1351</span></a>            <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="n">constant</span><span class="p">:</span>
</span><span id="FST.get-1352"><a href="#FST.get-1352"><span class="linenos">1352</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copy or cut an individual child node or a slice of child nodes from `self` if possible. This function can do</span>
</span><span id="FST.get-1353"><a href="#FST.get-1353"><span class="linenos">1353</span></a><span class="sd">        everything that `get_slice()` can.</span>
</span><span id="FST.get-1354"><a href="#FST.get-1354"><span class="linenos">1354</span></a>
</span><span id="FST.get-1355"><a href="#FST.get-1355"><span class="linenos">1355</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.get-1356"><a href="#FST.get-1356"><span class="linenos">1356</span></a><span class="sd">        - `idx`: The index of the child node to get if the field being gotten from contains multiple elements or the</span>
</span><span id="FST.get-1357"><a href="#FST.get-1357"><span class="linenos">1357</span></a><span class="sd">            start of the slice to get if getting a slice (by specifying `stop`). If the field being gotten from is</span>
</span><span id="FST.get-1358"><a href="#FST.get-1358"><span class="linenos">1358</span></a><span class="sd">            an individual element then this should be `None`. If `stop` is specified and getting a slice then a `None`</span>
</span><span id="FST.get-1359"><a href="#FST.get-1359"><span class="linenos">1359</span></a><span class="sd">            here means copy from the start of the list.</span>
</span><span id="FST.get-1360"><a href="#FST.get-1360"><span class="linenos">1360</span></a><span class="sd">        - `stop`: The end index (exclusive) of the child node to get if getting a slice from a field that contains</span>
</span><span id="FST.get-1361"><a href="#FST.get-1361"><span class="linenos">1361</span></a><span class="sd">            multiple elements. This should be one past the last element to get (like python list indexing). If this is</span>
</span><span id="FST.get-1362"><a href="#FST.get-1362"><span class="linenos">1362</span></a><span class="sd">            `False` then it indicates that a single element is being requested and not a slice. If this is `None` then</span>
</span><span id="FST.get-1363"><a href="#FST.get-1363"><span class="linenos">1363</span></a><span class="sd">            it indicates a slice operation to the end of the list (like python `a[start:]`).</span>
</span><span id="FST.get-1364"><a href="#FST.get-1364"><span class="linenos">1364</span></a><span class="sd">        - `field`: The name of the field to get the element(s) from, which can be an individual element like a `value`</span>
</span><span id="FST.get-1365"><a href="#FST.get-1365"><span class="linenos">1365</span></a><span class="sd">            or a list like `body`. If this is `None` then the default field for the node type is used. Most node types</span>
</span><span id="FST.get-1366"><a href="#FST.get-1366"><span class="linenos">1366</span></a><span class="sd">            have a common-sense default field, e.g. `body` for all block statements, `value` for things like `Return`</span>
</span><span id="FST.get-1367"><a href="#FST.get-1367"><span class="linenos">1367</span></a><span class="sd">            and `Yield`. `Dict`, `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="FST.get-1368"><a href="#FST.get-1368"><span class="linenos">1368</span></a><span class="sd">        - `cut`: Whether to cut out the child node (if possible) or not (just copy).</span>
</span><span id="FST.get-1369"><a href="#FST.get-1369"><span class="linenos">1369</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST.get-1370"><a href="#FST.get-1370"><span class="linenos">1370</span></a>
</span><span id="FST.get-1371"><a href="#FST.get-1371"><span class="linenos">1371</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `idx` or `stop` parameter. If passed in</span>
</span><span id="FST.get-1372"><a href="#FST.get-1372"><span class="linenos">1372</span></a><span class="sd">        `idx` then the field is assumed individual and if passed in `stop` then it is a list and an individual element</span>
</span><span id="FST.get-1373"><a href="#FST.get-1373"><span class="linenos">1373</span></a><span class="sd">        is being gotten from `idx` and not a slice.</span>
</span><span id="FST.get-1374"><a href="#FST.get-1374"><span class="linenos">1374</span></a>
</span><span id="FST.get-1375"><a href="#FST.get-1375"><span class="linenos">1375</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.get-1376"><a href="#FST.get-1376"><span class="linenos">1376</span></a><span class="sd">        - `FST`: When getting an actual node (most situations).</span>
</span><span id="FST.get-1377"><a href="#FST.get-1377"><span class="linenos">1377</span></a><span class="sd">        - `str`: When getting am identifier, like from `Name.id`.</span>
</span><span id="FST.get-1378"><a href="#FST.get-1378"><span class="linenos">1378</span></a><span class="sd">        - `constant`: When getting a constant (`fst.astutil.constant`), like from `MatchSingleton.value`.</span>
</span><span id="FST.get-1379"><a href="#FST.get-1379"><span class="linenos">1379</span></a>
</span><span id="FST.get-1380"><a href="#FST.get-1380"><span class="linenos">1380</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.get-1381"><a href="#FST.get-1381"><span class="linenos">1381</span></a><span class="sd">        ```py</span>
</span><span id="FST.get-1382"><a href="#FST.get-1382"><span class="linenos">1382</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(1).src</span>
</span><span id="FST.get-1383"><a href="#FST.get-1383"><span class="linenos">1383</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="FST.get-1384"><a href="#FST.get-1384"><span class="linenos">1384</span></a>
</span><span id="FST.get-1385"><a href="#FST.get-1385"><span class="linenos">1385</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get(1, 3).src</span>
</span><span id="FST.get-1386"><a href="#FST.get-1386"><span class="linenos">1386</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST.get-1387"><a href="#FST.get-1387"><span class="linenos">1387</span></a>
</span><span id="FST.get-1388"><a href="#FST.get-1388"><span class="linenos">1388</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST.get-1389"><a href="#FST.get-1389"><span class="linenos">1389</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="FST.get-1390"><a href="#FST.get-1390"><span class="linenos">1390</span></a>
</span><span id="FST.get-1391"><a href="#FST.get-1391"><span class="linenos">1391</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get(1, 3, cut=True).src</span>
</span><span id="FST.get-1392"><a href="#FST.get-1392"><span class="linenos">1392</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST.get-1393"><a href="#FST.get-1393"><span class="linenos">1393</span></a>
</span><span id="FST.get-1394"><a href="#FST.get-1394"><span class="linenos">1394</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST.get-1395"><a href="#FST.get-1395"><span class="linenos">1395</span></a><span class="sd">        &#39;[0, 3]&#39;</span>
</span><span id="FST.get-1396"><a href="#FST.get-1396"><span class="linenos">1396</span></a>
</span><span id="FST.get-1397"><a href="#FST.get-1397"><span class="linenos">1397</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(None, 3).src</span>
</span><span id="FST.get-1398"><a href="#FST.get-1398"><span class="linenos">1398</span></a><span class="sd">        &#39;[0, 1, 2]&#39;</span>
</span><span id="FST.get-1399"><a href="#FST.get-1399"><span class="linenos">1399</span></a>
</span><span id="FST.get-1400"><a href="#FST.get-1400"><span class="linenos">1400</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get(-3, None).src</span>
</span><span id="FST.get-1401"><a href="#FST.get-1401"><span class="linenos">1401</span></a><span class="sd">        &#39;[1, 2, 3]&#39;</span>
</span><span id="FST.get-1402"><a href="#FST.get-1402"><span class="linenos">1402</span></a>
</span><span id="FST.get-1403"><a href="#FST.get-1403"><span class="linenos">1403</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2&#39;).get(0).src</span>
</span><span id="FST.get-1404"><a href="#FST.get-1404"><span class="linenos">1404</span></a><span class="sd">        &#39;i = 1&#39;</span>
</span><span id="FST.get-1405"><a href="#FST.get-1405"><span class="linenos">1405</span></a>
</span><span id="FST.get-1406"><a href="#FST.get-1406"><span class="linenos">1406</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2&#39;).get(&#39;orelse&#39;).src</span>
</span><span id="FST.get-1407"><a href="#FST.get-1407"><span class="linenos">1407</span></a><span class="sd">        &#39;j = 2&#39;</span>
</span><span id="FST.get-1408"><a href="#FST.get-1408"><span class="linenos">1408</span></a>
</span><span id="FST.get-1409"><a href="#FST.get-1409"><span class="linenos">1409</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2; k = 3&#39;).get(1, &#39;orelse&#39;).src</span>
</span><span id="FST.get-1410"><a href="#FST.get-1410"><span class="linenos">1410</span></a><span class="sd">        &#39;k = 3&#39;</span>
</span><span id="FST.get-1411"><a href="#FST.get-1411"><span class="linenos">1411</span></a>
</span><span id="FST.get-1412"><a href="#FST.get-1412"><span class="linenos">1412</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1\nelse: j = 2; k = 3; l = 4; m = 5&#39;).get(1, 3, &#39;orelse&#39;).src</span>
</span><span id="FST.get-1413"><a href="#FST.get-1413"><span class="linenos">1413</span></a><span class="sd">        &#39;k = 3; l = 4&#39;</span>
</span><span id="FST.get-1414"><a href="#FST.get-1414"><span class="linenos">1414</span></a>
</span><span id="FST.get-1415"><a href="#FST.get-1415"><span class="linenos">1415</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;return 1&#39;).get().src  # default field is &#39;value&#39;</span>
</span><span id="FST.get-1416"><a href="#FST.get-1416"><span class="linenos">1416</span></a><span class="sd">        &#39;1&#39;</span>
</span><span id="FST.get-1417"><a href="#FST.get-1417"><span class="linenos">1417</span></a>
</span><span id="FST.get-1418"><a href="#FST.get-1418"><span class="linenos">1418</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get().src  # &#39;elts&#39; slice copy is made</span>
</span><span id="FST.get-1419"><a href="#FST.get-1419"><span class="linenos">1419</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="FST.get-1420"><a href="#FST.get-1420"><span class="linenos">1420</span></a><span class="sd">        ```</span>
</span><span id="FST.get-1421"><a href="#FST.get-1421"><span class="linenos">1421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.get-1422"><a href="#FST.get-1422"><span class="linenos">1422</span></a>
</span><span id="FST.get-1423"><a href="#FST.get-1423"><span class="linenos">1423</span></a>        <span class="n">ast</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.get-1424"><a href="#FST.get-1424"><span class="linenos">1424</span></a>        <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="FST.get-1425"><a href="#FST.get-1425"><span class="linenos">1425</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>     <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="FST.get-1426"><a href="#FST.get-1426"><span class="linenos">1426</span></a>
</span><span id="FST.get-1427"><a href="#FST.get-1427"><span class="linenos">1427</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.get-1428"><a href="#FST.get-1428"><span class="linenos">1428</span></a>            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="FST.get-1429"><a href="#FST.get-1429"><span class="linenos">1429</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.get-1430"><a href="#FST.get-1430"><span class="linenos">1430</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.get-1431"><a href="#FST.get-1431"><span class="linenos">1431</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.get-1432"><a href="#FST.get-1432"><span class="linenos">1432</span></a>
</span><span id="FST.get-1433"><a href="#FST.get-1433"><span class="linenos">1433</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span>
</span><span id="FST.get-1434"><a href="#FST.get-1434"><span class="linenos">1434</span></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot get() non-slice from index &#39;end&#39;&quot;</span><span class="p">)</span>
</span><span id="FST.get-1435"><a href="#FST.get-1435"><span class="linenos">1435</span></a>
</span><span id="FST.get-1436"><a href="#FST.get-1436"><span class="linenos">1436</span></a>        <span class="k">elif</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.get-1437"><a href="#FST.get-1437"><span class="linenos">1437</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">field_</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1"> does not take an index&#39;</span><span class="p">)</span>
</span><span id="FST.get-1438"><a href="#FST.get-1438"><span class="linenos">1438</span></a>
</span><span id="FST.get-1439"><a href="#FST.get-1439"><span class="linenos">1439</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_one</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Copy or cut an individual child node or a slice of child nodes from <code>self</code> if possible. This function can do
everything that <code><a href="#FST.get_slice">get_slice()</a></code> can.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>idx</code>: The index of the child node to get if the field being gotten from contains multiple elements or the
start of the slice to get if getting a slice (by specifying <code>stop</code>). If the field being gotten from is
an individual element then this should be <code>None</code>. If <code>stop</code> is specified and getting a slice then a <code>None</code>
here means copy from the start of the list.</li>
<li><code>stop</code>: The end index (exclusive) of the child node to get if getting a slice from a field that contains
multiple elements. This should be one past the last element to get (like python list indexing). If this is
<code>False</code> then it indicates that a single element is being requested and not a slice. If this is <code>None</code> then
it indicates a slice operation to the end of the list (like python <code>a[start:]</code>).</li>
<li><code>field</code>: The name of the field to get the element(s) from, which can be an individual element like a <code>value</code>
or a list like <code>body</code>. If this is <code>None</code> then the default field for the node type is used. Most node types
have a common-sense default field, e.g. <code>body</code> for all block statements, <code>value</code> for things like <code>Return</code>
and <code>Yield</code>. <code>Dict</code>, <code>MatchMapping</code> and <code>Compare</code> nodes have special-case handling for a <code>None</code> field.</li>
<li><code><a href="#FST.cut">cut</a></code>: Whether to cut out the child node (if possible) or not (just copy).</li>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Note:</strong> The <code>field</code> value can be passed positionally in either the <code>idx</code> or <code>stop</code> parameter. If passed in
<code>idx</code> then the field is assumed individual and if passed in <code>stop</code> then it is a list and an individual element
is being gotten from <code>idx</code> and not a slice.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: When getting an actual node (most situations).</li>
<li><code>str</code>: When getting am identifier, like from <code>Name.id</code>.</li>
<li><code>constant</code>: When getting a constant (<code><a href="astutil.html#constant">fst.astutil.constant</a></code>), like from <code>MatchSingleton.value</code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;1&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 1, 2, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;i = 1&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;orelse&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;j = 2&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2; k = 3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;orelse&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;k = 3&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2; k = 3; l = 4; m = 5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;orelse&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;k = 3; l = 4&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;return 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># default field is &#39;value&#39;</span>
<span class="s1">&#39;1&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># &#39;elts&#39; slice copy is made</span>
<span class="s1">&#39;[0, 1, 2, 3]&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.put" class="classattr">
                                        <input id="FST.put-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">put</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">code</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#FST">FST</a></span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ellipsis</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>,</span><span class="param">	<span class="n">idx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stop</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="FST.put-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.put"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.put-1441"><a href="#FST.put-1441"><span class="linenos">1441</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="n">constant</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST.put-1442"><a href="#FST.put-1442"><span class="linenos">1442</span></a>            <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FST.put-1443"><a href="#FST.put-1443"><span class="linenos">1443</span></a>            <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="FST.put-1444"><a href="#FST.put-1444"><span class="linenos">1444</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put an individual node or a slice of nodes to `self` if possible. This function can do everything that</span>
</span><span id="FST.put-1445"><a href="#FST.put-1445"><span class="linenos">1445</span></a><span class="sd">        `put_slice()` can. The node is passed as an existing top-level `FST`, `AST`, string or list of string lines. If</span>
</span><span id="FST.put-1446"><a href="#FST.put-1446"><span class="linenos">1446</span></a><span class="sd">        passed as an `FST` then it should be considered &quot;consumed&quot; after this function returns and is no logner valid,</span>
</span><span id="FST.put-1447"><a href="#FST.put-1447"><span class="linenos">1447</span></a><span class="sd">        even on failure. `AST` is copied.</span>
</span><span id="FST.put-1448"><a href="#FST.put-1448"><span class="linenos">1448</span></a>
</span><span id="FST.put-1449"><a href="#FST.put-1449"><span class="linenos">1449</span></a><span class="sd">        **WARNING!** The original `self` node may be invalidated during the operation if using raw mode (either</span>
</span><span id="FST.put-1450"><a href="#FST.put-1450"><span class="linenos">1450</span></a><span class="sd">        specifically or as a fallback), so make sure to swap it out for the return value of this function if you will</span>
</span><span id="FST.put-1451"><a href="#FST.put-1451"><span class="linenos">1451</span></a><span class="sd">        keep using the variable you called this method on. It will be changed accordingly in the tree but any other</span>
</span><span id="FST.put-1452"><a href="#FST.put-1452"><span class="linenos">1452</span></a><span class="sd">        outside references to the node may become invalid.</span>
</span><span id="FST.put-1453"><a href="#FST.put-1453"><span class="linenos">1453</span></a>
</span><span id="FST.put-1454"><a href="#FST.put-1454"><span class="linenos">1454</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.put-1455"><a href="#FST.put-1455"><span class="linenos">1455</span></a><span class="sd">        - `code`: The node to put as an `FST` (must be root node), `AST`, a string or list of line strings. If putting</span>
</span><span id="FST.put-1456"><a href="#FST.put-1456"><span class="linenos">1456</span></a><span class="sd">            to an identifier field then this should be a string and it will be taken literally (no parsing). If putting</span>
</span><span id="FST.put-1457"><a href="#FST.put-1457"><span class="linenos">1457</span></a><span class="sd">            to a constant likew `MatchSingleton.value` or `Constant.value` then this should be an appropriate primitive</span>
</span><span id="FST.put-1458"><a href="#FST.put-1458"><span class="linenos">1458</span></a><span class="sd">            constant value.</span>
</span><span id="FST.put-1459"><a href="#FST.put-1459"><span class="linenos">1459</span></a><span class="sd">        - `idx`: The index of the field node to put to if the field being put to contains multiple elements or the start</span>
</span><span id="FST.put-1460"><a href="#FST.put-1460"><span class="linenos">1460</span></a><span class="sd">            of the slice to put if putting a slice (by specifying `stop`). If the field being put to is an individual</span>
</span><span id="FST.put-1461"><a href="#FST.put-1461"><span class="linenos">1461</span></a><span class="sd">            element then this should be `None`. If `stop` is specified and putting a slice then a `None` here means put</span>
</span><span id="FST.put-1462"><a href="#FST.put-1462"><span class="linenos">1462</span></a><span class="sd">            starting from the beginning of the list.</span>
</span><span id="FST.put-1463"><a href="#FST.put-1463"><span class="linenos">1463</span></a><span class="sd">        - `stop`: The end index (exclusive) of the field node to put to if putting a slice to a field that contains</span>
</span><span id="FST.put-1464"><a href="#FST.put-1464"><span class="linenos">1464</span></a><span class="sd">            multiple elements. This should be one past the last element to put (like python list indexing). If this is</span>
</span><span id="FST.put-1465"><a href="#FST.put-1465"><span class="linenos">1465</span></a><span class="sd">            `False` then it indicates that a single element is being put and not a slice. If this is `None` then it</span>
</span><span id="FST.put-1466"><a href="#FST.put-1466"><span class="linenos">1466</span></a><span class="sd">            indicates a slice operation to the end of the list (like python `a[start:]`).</span>
</span><span id="FST.put-1467"><a href="#FST.put-1467"><span class="linenos">1467</span></a><span class="sd">        - `field`: The name of the field to put the element(s) to, which can be an individual element like a `value` or</span>
</span><span id="FST.put-1468"><a href="#FST.put-1468"><span class="linenos">1468</span></a><span class="sd">            a list like `body`. If this is `None` then the default field for the node type is used. Most node types have</span>
</span><span id="FST.put-1469"><a href="#FST.put-1469"><span class="linenos">1469</span></a><span class="sd">            a common-sense default field, e.g. `body` for all block statements, `value` for things like `Return` and</span>
</span><span id="FST.put-1470"><a href="#FST.put-1470"><span class="linenos">1470</span></a><span class="sd">            `Yield`. `Dict`, `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="FST.put-1471"><a href="#FST.put-1471"><span class="linenos">1471</span></a><span class="sd">        - `one`: Only has meaning if putting a slice, and in this case `True` specifies that the source should be  put</span>
</span><span id="FST.put-1472"><a href="#FST.put-1472"><span class="linenos">1472</span></a><span class="sd">            as a single element to the range specified even if it is a valid slice. `False` indicates a true slice</span>
</span><span id="FST.put-1473"><a href="#FST.put-1473"><span class="linenos">1473</span></a><span class="sd">            operation replacing the range with the slice passed, which must in this case be a compatible slice type.</span>
</span><span id="FST.put-1474"><a href="#FST.put-1474"><span class="linenos">1474</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST.put-1475"><a href="#FST.put-1475"><span class="linenos">1475</span></a><span class="sd">            - `to`: Special option which only applies when putting a single element in `raw` mode (either through `True`</span>
</span><span id="FST.put-1476"><a href="#FST.put-1476"><span class="linenos">1476</span></a><span class="sd">                or `&#39;auto&#39;`). Instead of replacing just the target node, will replace the entire span from the target</span>
</span><span id="FST.put-1477"><a href="#FST.put-1477"><span class="linenos">1477</span></a><span class="sd">                node to the node specified in `to` with the `code` passed.</span>
</span><span id="FST.put-1478"><a href="#FST.put-1478"><span class="linenos">1478</span></a>
</span><span id="FST.put-1479"><a href="#FST.put-1479"><span class="linenos">1479</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `idx` or `stop` parameter. If passed in</span>
</span><span id="FST.put-1480"><a href="#FST.put-1480"><span class="linenos">1480</span></a><span class="sd">        `idx` then the field is assumed individual and if passed in `stop` then it is a list and an individual element</span>
</span><span id="FST.put-1481"><a href="#FST.put-1481"><span class="linenos">1481</span></a><span class="sd">        is being gotten from `idx` and not a slice.</span>
</span><span id="FST.put-1482"><a href="#FST.put-1482"><span class="linenos">1482</span></a>
</span><span id="FST.put-1483"><a href="#FST.put-1483"><span class="linenos">1483</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.put-1484"><a href="#FST.put-1484"><span class="linenos">1484</span></a><span class="sd">        - `self`</span>
</span><span id="FST.put-1485"><a href="#FST.put-1485"><span class="linenos">1485</span></a>
</span><span id="FST.put-1486"><a href="#FST.put-1486"><span class="linenos">1486</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.put-1487"><a href="#FST.put-1487"><span class="linenos">1487</span></a><span class="sd">        ```py</span>
</span><span id="FST.put-1488"><a href="#FST.put-1488"><span class="linenos">1488</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4&#39;, 1).src</span>
</span><span id="FST.put-1489"><a href="#FST.put-1489"><span class="linenos">1489</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="FST.put-1490"><a href="#FST.put-1490"><span class="linenos">1490</span></a>
</span><span id="FST.put-1491"><a href="#FST.put-1491"><span class="linenos">1491</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3).src</span>
</span><span id="FST.put-1492"><a href="#FST.put-1492"><span class="linenos">1492</span></a><span class="sd">        &#39;[0, (4, 5), 3]&#39;</span>
</span><span id="FST.put-1493"><a href="#FST.put-1493"><span class="linenos">1493</span></a>
</span><span id="FST.put-1494"><a href="#FST.put-1494"><span class="linenos">1494</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3, one=False).src</span>
</span><span id="FST.put-1495"><a href="#FST.put-1495"><span class="linenos">1495</span></a><span class="sd">        &#39;[0, 4, 5, 3]&#39;</span>
</span><span id="FST.put-1496"><a href="#FST.put-1496"><span class="linenos">1496</span></a>
</span><span id="FST.put-1497"><a href="#FST.put-1497"><span class="linenos">1497</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, None, 3).src</span>
</span><span id="FST.put-1498"><a href="#FST.put-1498"><span class="linenos">1498</span></a><span class="sd">        &#39;[(4, 5), 3]&#39;</span>
</span><span id="FST.put-1499"><a href="#FST.put-1499"><span class="linenos">1499</span></a>
</span><span id="FST.put-1500"><a href="#FST.put-1500"><span class="linenos">1500</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).put(&#39;4, 5&#39;, -3, None, one=False).src</span>
</span><span id="FST.put-1501"><a href="#FST.put-1501"><span class="linenos">1501</span></a><span class="sd">        &#39;[0, 4, 5]&#39;</span>
</span><span id="FST.put-1502"><a href="#FST.put-1502"><span class="linenos">1502</span></a>
</span><span id="FST.put-1503"><a href="#FST.put-1503"><span class="linenos">1503</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0).src)</span>
</span><span id="FST.put-1504"><a href="#FST.put-1504"><span class="linenos">1504</span></a><span class="sd">        if 1:</span>
</span><span id="FST.put-1505"><a href="#FST.put-1505"><span class="linenos">1505</span></a><span class="sd">            z = -1</span>
</span><span id="FST.put-1506"><a href="#FST.put-1506"><span class="linenos">1506</span></a><span class="sd">        else: j = 2</span>
</span><span id="FST.put-1507"><a href="#FST.put-1507"><span class="linenos">1507</span></a>
</span><span id="FST.put-1508"><a href="#FST.put-1508"><span class="linenos">1508</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0, &#39;orelse&#39;).src.rstrip())</span>
</span><span id="FST.put-1509"><a href="#FST.put-1509"><span class="linenos">1509</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST.put-1510"><a href="#FST.put-1510"><span class="linenos">1510</span></a><span class="sd">        else:</span>
</span><span id="FST.put-1511"><a href="#FST.put-1511"><span class="linenos">1511</span></a><span class="sd">            z = -1</span>
</span><span id="FST.put-1512"><a href="#FST.put-1512"><span class="linenos">1512</span></a>
</span><span id="FST.put-1513"><a href="#FST.put-1513"><span class="linenos">1513</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;)</span>
</span><span id="FST.put-1514"><a href="#FST.put-1514"><span class="linenos">1514</span></a><span class="sd">        ...       .put(&#39;z = -1\ny = -2\nx = -3&#39;, &#39;orelse&#39;, one=False).src.rstrip())</span>
</span><span id="FST.put-1515"><a href="#FST.put-1515"><span class="linenos">1515</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST.put-1516"><a href="#FST.put-1516"><span class="linenos">1516</span></a><span class="sd">        else:</span>
</span><span id="FST.put-1517"><a href="#FST.put-1517"><span class="linenos">1517</span></a><span class="sd">            z = -1</span>
</span><span id="FST.put-1518"><a href="#FST.put-1518"><span class="linenos">1518</span></a><span class="sd">            y = -2</span>
</span><span id="FST.put-1519"><a href="#FST.put-1519"><span class="linenos">1519</span></a><span class="sd">            x = -3</span>
</span><span id="FST.put-1520"><a href="#FST.put-1520"><span class="linenos">1520</span></a>
</span><span id="FST.put-1521"><a href="#FST.put-1521"><span class="linenos">1521</span></a><span class="sd">        &gt;&gt;&gt; print((f := FST(&#39;if 1: i = 1\nelse: j = 2&#39;))</span>
</span><span id="FST.put-1522"><a href="#FST.put-1522"><span class="linenos">1522</span></a><span class="sd">        ...       .put(&#39;z = -1&#39;, 0, raw=True, to=f.orelse[0]).root.src)</span>
</span><span id="FST.put-1523"><a href="#FST.put-1523"><span class="linenos">1523</span></a><span class="sd">        if 1: z = -1</span>
</span><span id="FST.put-1524"><a href="#FST.put-1524"><span class="linenos">1524</span></a><span class="sd">        ```</span>
</span><span id="FST.put-1525"><a href="#FST.put-1525"><span class="linenos">1525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.put-1526"><a href="#FST.put-1526"><span class="linenos">1526</span></a>
</span><span id="FST.put-1527"><a href="#FST.put-1527"><span class="linenos">1527</span></a>        <span class="n">ast</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.put-1528"><a href="#FST.put-1528"><span class="linenos">1528</span></a>        <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="FST.put-1529"><a href="#FST.put-1529"><span class="linenos">1529</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>     <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="FST.put-1530"><a href="#FST.put-1530"><span class="linenos">1530</span></a>
</span><span id="FST.put-1531"><a href="#FST.put-1531"><span class="linenos">1531</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.put-1532"><a href="#FST.put-1532"><span class="linenos">1532</span></a>            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="FST.put-1533"><a href="#FST.put-1533"><span class="linenos">1533</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.put-1534"><a href="#FST.put-1534"><span class="linenos">1534</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.put-1535"><a href="#FST.put-1535"><span class="linenos">1535</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.put-1536"><a href="#FST.put-1536"><span class="linenos">1536</span></a>
</span><span id="FST.put-1537"><a href="#FST.put-1537"><span class="linenos">1537</span></a>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span>
</span><span id="FST.put-1538"><a href="#FST.put-1538"><span class="linenos">1538</span></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot put() non-slice to index &#39;end&#39;&quot;</span><span class="p">)</span>
</span><span id="FST.put-1539"><a href="#FST.put-1539"><span class="linenos">1539</span></a>
</span><span id="FST.put-1540"><a href="#FST.put-1540"><span class="linenos">1540</span></a>        <span class="k">elif</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.put-1541"><a href="#FST.put-1541"><span class="linenos">1541</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">field_</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1"> does not take an index&#39;</span><span class="p">)</span>
</span><span id="FST.put-1542"><a href="#FST.put-1542"><span class="linenos">1542</span></a>
</span><span id="FST.put-1543"><a href="#FST.put-1543"><span class="linenos">1543</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">one</span><span class="p">:</span>
</span><span id="FST.put-1544"><a href="#FST.put-1544"><span class="linenos">1544</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot use &#39;one=False&#39; in non-slice put()&quot;</span><span class="p">)</span>
</span><span id="FST.put-1545"><a href="#FST.put-1545"><span class="linenos">1545</span></a>
</span><span id="FST.put-1546"><a href="#FST.put-1546"><span class="linenos">1546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_put_one</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span><span id="FST.put-1547"><a href="#FST.put-1547"><span class="linenos">1547</span></a>
</span><span id="FST.put-1548"><a href="#FST.put-1548"><span class="linenos">1548</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">repath</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Put an individual node or a slice of nodes to <code>self</code> if possible. This function can do everything that
<code><a href="#FST.put_slice">put_slice()</a></code> can. The node is passed as an existing top-level <code><a href="#FST">FST</a></code>, <code>AST</code>, string or list of string lines. If
passed as an <code><a href="#FST">FST</a></code> then it should be considered "consumed" after this function returns and is no logner valid,
even on failure. <code>AST</code> is copied.</p>

<p><strong>WARNING!</strong> The original <code>self</code> node may be invalidated during the operation if using raw mode (either
specifically or as a fallback), so make sure to swap it out for the return value of this function if you will
keep using the variable you called this method on. It will be changed accordingly in the tree but any other
outside references to the node may become invalid.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>code</code>: The node to put as an <code><a href="#FST">FST</a></code> (must be root node), <code>AST</code>, a string or list of line strings. If putting
to an identifier field then this should be a string and it will be taken literally (no parsing). If putting
to a constant likew <code>MatchSingleton.value</code> or <code>Constant.value</code> then this should be an appropriate primitive
constant value.</li>
<li><code>idx</code>: The index of the field node to put to if the field being put to contains multiple elements or the start
of the slice to put if putting a slice (by specifying <code>stop</code>). If the field being put to is an individual
element then this should be <code>None</code>. If <code>stop</code> is specified and putting a slice then a <code>None</code> here means put
starting from the beginning of the list.</li>
<li><code>stop</code>: The end index (exclusive) of the field node to put to if putting a slice to a field that contains
multiple elements. This should be one past the last element to put (like python list indexing). If this is
<code>False</code> then it indicates that a single element is being put and not a slice. If this is <code>None</code> then it
indicates a slice operation to the end of the list (like python <code>a[start:]</code>).</li>
<li><code>field</code>: The name of the field to put the element(s) to, which can be an individual element like a <code>value</code> or
a list like <code>body</code>. If this is <code>None</code> then the default field for the node type is used. Most node types have
a common-sense default field, e.g. <code>body</code> for all block statements, <code>value</code> for things like <code>Return</code> and
<code>Yield</code>. <code>Dict</code>, <code>MatchMapping</code> and <code>Compare</code> nodes have special-case handling for a <code>None</code> field.</li>
<li><code>one</code>: Only has meaning if putting a slice, and in this case <code>True</code> specifies that the source should be  put
as a single element to the range specified even if it is a valid slice. <code>False</code> indicates a true slice
operation replacing the range with the slice passed, which must in this case be a compatible slice type.</li>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.
<ul>
<li><code>to</code>: Special option which only applies when putting a single element in <code>raw</code> mode (either through <code>True</code>
or <code>'auto'</code>). Instead of replacing just the target node, will replace the entire span from the target
node to the node specified in <code>to</code> with the <code>code</code> passed.</li>
</ul></li>
</ul>

<p><strong>Note:</strong> The <code>field</code> value can be passed positionally in either the <code>idx</code> or <code>stop</code> parameter. If passed in
<code>idx</code> then the field is assumed individual and if passed in <code>stop</code> then it is a list and an individual element
is being gotten from <code>idx</code> and not a slice.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>self</code></li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 4, 2, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4, 5&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, (4, 5), 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4, 5&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">one</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 4, 5, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4, 5&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[(4, 5), 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4, 5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">one</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 4, 5]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;z = -1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="k">else</span><span class="p">:</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;z = -1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;orelse&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">)</span>
<span class="o">...</span>       <span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;z = -1</span><span class="se">\n</span><span class="s1">y = -2</span><span class="se">\n</span><span class="s1">x = -3&#39;</span><span class="p">,</span> <span class="s1">&#39;orelse&#39;</span><span class="p">,</span> <span class="n">one</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">))</span>
<span class="o">...</span>       <span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;z = -1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.get_slice" class="classattr">
                                        <input id="FST.get_slice-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_slice</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">start</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">cut</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.get_slice-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.get_slice"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.get_slice-1550"><a href="#FST.get_slice-1550"><span class="linenos">1550</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST.get_slice-1551"><a href="#FST.get_slice-1551"><span class="linenos">1551</span></a>                  <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST.get_slice-1552"><a href="#FST.get_slice-1552"><span class="linenos">1552</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copy or cut a slice of child nodes from `self` if possible.</span>
</span><span id="FST.get_slice-1553"><a href="#FST.get_slice-1553"><span class="linenos">1553</span></a>
</span><span id="FST.get_slice-1554"><a href="#FST.get_slice-1554"><span class="linenos">1554</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.get_slice-1555"><a href="#FST.get_slice-1555"><span class="linenos">1555</span></a><span class="sd">        - `start`: The start of the slice to get, or `None` for the beginning of the entire range.</span>
</span><span id="FST.get_slice-1556"><a href="#FST.get_slice-1556"><span class="linenos">1556</span></a><span class="sd">        - `stop`: The end index (exclusive) of the slice to get. This should be one past the last element to get (like</span>
</span><span id="FST.get_slice-1557"><a href="#FST.get_slice-1557"><span class="linenos">1557</span></a><span class="sd">            python list indexing). If this is `None` then it indicates a slice operation to the end of the list (like</span>
</span><span id="FST.get_slice-1558"><a href="#FST.get_slice-1558"><span class="linenos">1558</span></a><span class="sd">            python `a[start:]`).</span>
</span><span id="FST.get_slice-1559"><a href="#FST.get_slice-1559"><span class="linenos">1559</span></a><span class="sd">        - `field`: The name of the field to get the elements from, which can be an individual element like a `value` or</span>
</span><span id="FST.get_slice-1560"><a href="#FST.get_slice-1560"><span class="linenos">1560</span></a><span class="sd">            a list like `body`. If this is `None` then the default field for the node type is used. Most node types</span>
</span><span id="FST.get_slice-1561"><a href="#FST.get_slice-1561"><span class="linenos">1561</span></a><span class="sd">            have a common-sense default field, e.g. `body` for all block statements, `elts` for things like `List` and</span>
</span><span id="FST.get_slice-1562"><a href="#FST.get_slice-1562"><span class="linenos">1562</span></a><span class="sd">            `Tuple`. `MatchMapping` and `Compare` nodes have special-case handling for a `None` field.</span>
</span><span id="FST.get_slice-1563"><a href="#FST.get_slice-1563"><span class="linenos">1563</span></a><span class="sd">        - `cut`: Whether to cut out the slice or not (just copy).</span>
</span><span id="FST.get_slice-1564"><a href="#FST.get_slice-1564"><span class="linenos">1564</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST.get_slice-1565"><a href="#FST.get_slice-1565"><span class="linenos">1565</span></a>
</span><span id="FST.get_slice-1566"><a href="#FST.get_slice-1566"><span class="linenos">1566</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `start` or `stop` parameter. If passed in</span>
</span><span id="FST.get_slice-1567"><a href="#FST.get_slice-1567"><span class="linenos">1567</span></a><span class="sd">        `start` then the slice is assumed to be the entire range, and if passed in `stop` then the slice goes from</span>
</span><span id="FST.get_slice-1568"><a href="#FST.get_slice-1568"><span class="linenos">1568</span></a><span class="sd">        `start` to the end of the range.</span>
</span><span id="FST.get_slice-1569"><a href="#FST.get_slice-1569"><span class="linenos">1569</span></a>
</span><span id="FST.get_slice-1570"><a href="#FST.get_slice-1570"><span class="linenos">1570</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.get_slice-1571"><a href="#FST.get_slice-1571"><span class="linenos">1571</span></a><span class="sd">        - `FST`: Slice node of nodes gotten.</span>
</span><span id="FST.get_slice-1572"><a href="#FST.get_slice-1572"><span class="linenos">1572</span></a>
</span><span id="FST.get_slice-1573"><a href="#FST.get_slice-1573"><span class="linenos">1573</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.get_slice-1574"><a href="#FST.get_slice-1574"><span class="linenos">1574</span></a><span class="sd">        ```py</span>
</span><span id="FST.get_slice-1575"><a href="#FST.get_slice-1575"><span class="linenos">1575</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get_slice(1).src</span>
</span><span id="FST.get_slice-1576"><a href="#FST.get_slice-1576"><span class="linenos">1576</span></a><span class="sd">        &#39;[1, 2, 3]&#39;</span>
</span><span id="FST.get_slice-1577"><a href="#FST.get_slice-1577"><span class="linenos">1577</span></a>
</span><span id="FST.get_slice-1578"><a href="#FST.get_slice-1578"><span class="linenos">1578</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).get_slice(None, -1).src</span>
</span><span id="FST.get_slice-1579"><a href="#FST.get_slice-1579"><span class="linenos">1579</span></a><span class="sd">        &#39;[0, 1, 2]&#39;</span>
</span><span id="FST.get_slice-1580"><a href="#FST.get_slice-1580"><span class="linenos">1580</span></a>
</span><span id="FST.get_slice-1581"><a href="#FST.get_slice-1581"><span class="linenos">1581</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).get_slice(1, 3, cut=True).src</span>
</span><span id="FST.get_slice-1582"><a href="#FST.get_slice-1582"><span class="linenos">1582</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST.get_slice-1583"><a href="#FST.get_slice-1583"><span class="linenos">1583</span></a>
</span><span id="FST.get_slice-1584"><a href="#FST.get_slice-1584"><span class="linenos">1584</span></a><span class="sd">        &gt;&gt;&gt; f.src</span>
</span><span id="FST.get_slice-1585"><a href="#FST.get_slice-1585"><span class="linenos">1585</span></a><span class="sd">        &#39;[0, 3]&#39;</span>
</span><span id="FST.get_slice-1586"><a href="#FST.get_slice-1586"><span class="linenos">1586</span></a>
</span><span id="FST.get_slice-1587"><a href="#FST.get_slice-1587"><span class="linenos">1587</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;if 1: i = 1\nelse: j = 2; k = 3; l = 4; m = 5&#39;)</span>
</span><span id="FST.get_slice-1588"><a href="#FST.get_slice-1588"><span class="linenos">1588</span></a><span class="sd">        &gt;&gt;&gt; s = f.get_slice(1, 3, &#39;orelse&#39;, cut=True)</span>
</span><span id="FST.get_slice-1589"><a href="#FST.get_slice-1589"><span class="linenos">1589</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="FST.get_slice-1590"><a href="#FST.get_slice-1590"><span class="linenos">1590</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST.get_slice-1591"><a href="#FST.get_slice-1591"><span class="linenos">1591</span></a><span class="sd">        else: j = 2; m = 5</span>
</span><span id="FST.get_slice-1592"><a href="#FST.get_slice-1592"><span class="linenos">1592</span></a>
</span><span id="FST.get_slice-1593"><a href="#FST.get_slice-1593"><span class="linenos">1593</span></a><span class="sd">        &gt;&gt;&gt; print(s.src)</span>
</span><span id="FST.get_slice-1594"><a href="#FST.get_slice-1594"><span class="linenos">1594</span></a><span class="sd">        k = 3; l = 4</span>
</span><span id="FST.get_slice-1595"><a href="#FST.get_slice-1595"><span class="linenos">1595</span></a><span class="sd">        ```</span>
</span><span id="FST.get_slice-1596"><a href="#FST.get_slice-1596"><span class="linenos">1596</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.get_slice-1597"><a href="#FST.get_slice-1597"><span class="linenos">1597</span></a>
</span><span id="FST.get_slice-1598"><a href="#FST.get_slice-1598"><span class="linenos">1598</span></a>        <span class="n">ast</span>                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.get_slice-1599"><a href="#FST.get_slice-1599"><span class="linenos">1599</span></a>        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="FST.get_slice-1600"><a href="#FST.get_slice-1600"><span class="linenos">1600</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>       <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="FST.get_slice-1601"><a href="#FST.get_slice-1601"><span class="linenos">1601</span></a>
</span><span id="FST.get_slice-1602"><a href="#FST.get_slice-1602"><span class="linenos">1602</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.get_slice-1603"><a href="#FST.get_slice-1603"><span class="linenos">1603</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot get slice from non-list field </span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST.get_slice-1604"><a href="#FST.get_slice-1604"><span class="linenos">1604</span></a>
</span><span id="FST.get_slice-1605"><a href="#FST.get_slice-1605"><span class="linenos">1605</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Copy or cut a slice of child nodes from <code>self</code> if possible.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>start</code>: The start of the slice to get, or <code>None</code> for the beginning of the entire range.</li>
<li><code>stop</code>: The end index (exclusive) of the slice to get. This should be one past the last element to get (like
python list indexing). If this is <code>None</code> then it indicates a slice operation to the end of the list (like
python <code>a[start:]</code>).</li>
<li><code>field</code>: The name of the field to get the elements from, which can be an individual element like a <code>value</code> or
a list like <code>body</code>. If this is <code>None</code> then the default field for the node type is used. Most node types
have a common-sense default field, e.g. <code>body</code> for all block statements, <code>elts</code> for things like <code>List</code> and
<code>Tuple</code>. <code>MatchMapping</code> and <code>Compare</code> nodes have special-case handling for a <code>None</code> field.</li>
<li><code><a href="#FST.cut">cut</a></code>: Whether to cut out the slice or not (just copy).</li>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Note:</strong> The <code>field</code> value can be passed positionally in either the <code>start</code> or <code>stop</code> parameter. If passed in
<code>start</code> then the slice is assumed to be the entire range, and if passed in <code>stop</code> then the slice goes from
<code>start</code> to the end of the range.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: Slice node of nodes gotten.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get_slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2; k = 3; l = 4; m = 5&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;orelse&#39;</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">5</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.put_slice" class="classattr">
                                        <input id="FST.put_slice-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">put_slice</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">code</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#FST">FST</a></span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>,</span><span class="param">	<span class="n">start</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">options</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="FST.put_slice-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.put_slice"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.put_slice-1607"><a href="#FST.put_slice-1607"><span class="linenos">1607</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FST.put_slice-1608"><a href="#FST.put_slice-1608"><span class="linenos">1608</span></a>                  <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="FST.put_slice-1609"><a href="#FST.put_slice-1609"><span class="linenos">1609</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put a slice of nodes to `self` if possible.  The node is passed as an existing top-level `FST`, `AST`, string</span>
</span><span id="FST.put_slice-1610"><a href="#FST.put_slice-1610"><span class="linenos">1610</span></a><span class="sd">        or list of string lines. If passed as an `FST` then it should be considered &quot;consumed&quot; after this function</span>
</span><span id="FST.put_slice-1611"><a href="#FST.put_slice-1611"><span class="linenos">1611</span></a><span class="sd">        returns and is no logner valid, even on failure. `AST` is copied.</span>
</span><span id="FST.put_slice-1612"><a href="#FST.put_slice-1612"><span class="linenos">1612</span></a>
</span><span id="FST.put_slice-1613"><a href="#FST.put_slice-1613"><span class="linenos">1613</span></a><span class="sd">        **WARNING!** The original `self` node may be invalidated during the operation if using raw mode (either</span>
</span><span id="FST.put_slice-1614"><a href="#FST.put_slice-1614"><span class="linenos">1614</span></a><span class="sd">        specifically or as a fallback), so make sure to swap it out for the return value of this function if you will</span>
</span><span id="FST.put_slice-1615"><a href="#FST.put_slice-1615"><span class="linenos">1615</span></a><span class="sd">        keep using the variable you called this method on. It will be changed accordingly in the tree but any other</span>
</span><span id="FST.put_slice-1616"><a href="#FST.put_slice-1616"><span class="linenos">1616</span></a><span class="sd">        outside references to the node may become invalid.</span>
</span><span id="FST.put_slice-1617"><a href="#FST.put_slice-1617"><span class="linenos">1617</span></a>
</span><span id="FST.put_slice-1618"><a href="#FST.put_slice-1618"><span class="linenos">1618</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.put_slice-1619"><a href="#FST.put_slice-1619"><span class="linenos">1619</span></a><span class="sd">        - `code`: The slice to put as an `FST` (must be root node), `AST`, a string or list of line strings.</span>
</span><span id="FST.put_slice-1620"><a href="#FST.put_slice-1620"><span class="linenos">1620</span></a><span class="sd">        - `start`: The start of the slice to put, or `None` for the beginning of the entire range.</span>
</span><span id="FST.put_slice-1621"><a href="#FST.put_slice-1621"><span class="linenos">1621</span></a><span class="sd">        - `stop`: The end index (exclusive) of the slice. This should be one past the last element to put (like python</span>
</span><span id="FST.put_slice-1622"><a href="#FST.put_slice-1622"><span class="linenos">1622</span></a><span class="sd">            list indexing). If this is `None` then it indicates a slice operation to the end of the list (like python</span>
</span><span id="FST.put_slice-1623"><a href="#FST.put_slice-1623"><span class="linenos">1623</span></a><span class="sd">            `a[start:]`).</span>
</span><span id="FST.put_slice-1624"><a href="#FST.put_slice-1624"><span class="linenos">1624</span></a><span class="sd">        - `field`: The name of the field to put the elements to. If this is `None` then the default field for the node</span>
</span><span id="FST.put_slice-1625"><a href="#FST.put_slice-1625"><span class="linenos">1625</span></a><span class="sd">            type is used. Most node types have a common-sense default field, e.g. `body` for all block statements,</span>
</span><span id="FST.put_slice-1626"><a href="#FST.put_slice-1626"><span class="linenos">1626</span></a><span class="sd">            `elts` for things like `List` and `Tuple`. `MatchMapping` and `Compare` nodes have special-case handling for</span>
</span><span id="FST.put_slice-1627"><a href="#FST.put_slice-1627"><span class="linenos">1627</span></a><span class="sd">            a `None` field.</span>
</span><span id="FST.put_slice-1628"><a href="#FST.put_slice-1628"><span class="linenos">1628</span></a><span class="sd">        - `options`: See `get_options()`.</span>
</span><span id="FST.put_slice-1629"><a href="#FST.put_slice-1629"><span class="linenos">1629</span></a>
</span><span id="FST.put_slice-1630"><a href="#FST.put_slice-1630"><span class="linenos">1630</span></a><span class="sd">        **Note:** The `field` value can be passed positionally in either the `start` or `stop` parameter. If passed in</span>
</span><span id="FST.put_slice-1631"><a href="#FST.put_slice-1631"><span class="linenos">1631</span></a><span class="sd">        `start` then the slice is assumed to be the entire range, and if passed in `stop` then the slice goes from</span>
</span><span id="FST.put_slice-1632"><a href="#FST.put_slice-1632"><span class="linenos">1632</span></a><span class="sd">        `start` to the end of the range.</span>
</span><span id="FST.put_slice-1633"><a href="#FST.put_slice-1633"><span class="linenos">1633</span></a>
</span><span id="FST.put_slice-1634"><a href="#FST.put_slice-1634"><span class="linenos">1634</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.put_slice-1635"><a href="#FST.put_slice-1635"><span class="linenos">1635</span></a><span class="sd">        - `self`</span>
</span><span id="FST.put_slice-1636"><a href="#FST.put_slice-1636"><span class="linenos">1636</span></a>
</span><span id="FST.put_slice-1637"><a href="#FST.put_slice-1637"><span class="linenos">1637</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.put_slice-1638"><a href="#FST.put_slice-1638"><span class="linenos">1638</span></a><span class="sd">        ```py</span>
</span><span id="FST.put_slice-1639"><a href="#FST.put_slice-1639"><span class="linenos">1639</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4&#39;, 1).src</span>
</span><span id="FST.put_slice-1640"><a href="#FST.put_slice-1640"><span class="linenos">1640</span></a><span class="sd">        &#39;[0, 4, 2, 3]&#39;</span>
</span><span id="FST.put_slice-1641"><a href="#FST.put_slice-1641"><span class="linenos">1641</span></a>
</span><span id="FST.put_slice-1642"><a href="#FST.put_slice-1642"><span class="linenos">1642</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3).src</span>
</span><span id="FST.put_slice-1643"><a href="#FST.put_slice-1643"><span class="linenos">1643</span></a><span class="sd">        &#39;[0, (4, 5), 3]&#39;</span>
</span><span id="FST.put_slice-1644"><a href="#FST.put_slice-1644"><span class="linenos">1644</span></a>
</span><span id="FST.put_slice-1645"><a href="#FST.put_slice-1645"><span class="linenos">1645</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, 1, 3, one=False).src</span>
</span><span id="FST.put_slice-1646"><a href="#FST.put_slice-1646"><span class="linenos">1646</span></a><span class="sd">        &#39;[0, 4, 5, 3]&#39;</span>
</span><span id="FST.put_slice-1647"><a href="#FST.put_slice-1647"><span class="linenos">1647</span></a>
</span><span id="FST.put_slice-1648"><a href="#FST.put_slice-1648"><span class="linenos">1648</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;).put(&#39;4, 5&#39;, None, 3).src</span>
</span><span id="FST.put_slice-1649"><a href="#FST.put_slice-1649"><span class="linenos">1649</span></a><span class="sd">        &#39;[(4, 5), 3]&#39;</span>
</span><span id="FST.put_slice-1650"><a href="#FST.put_slice-1650"><span class="linenos">1650</span></a>
</span><span id="FST.put_slice-1651"><a href="#FST.put_slice-1651"><span class="linenos">1651</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[0, 1, 2, 3]&#39;)).put(&#39;4, 5&#39;, -3, None, one=False).src</span>
</span><span id="FST.put_slice-1652"><a href="#FST.put_slice-1652"><span class="linenos">1652</span></a><span class="sd">        &#39;[0, 4, 5]&#39;</span>
</span><span id="FST.put_slice-1653"><a href="#FST.put_slice-1653"><span class="linenos">1653</span></a>
</span><span id="FST.put_slice-1654"><a href="#FST.put_slice-1654"><span class="linenos">1654</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0).src)</span>
</span><span id="FST.put_slice-1655"><a href="#FST.put_slice-1655"><span class="linenos">1655</span></a><span class="sd">        if 1:</span>
</span><span id="FST.put_slice-1656"><a href="#FST.put_slice-1656"><span class="linenos">1656</span></a><span class="sd">            z = -1</span>
</span><span id="FST.put_slice-1657"><a href="#FST.put_slice-1657"><span class="linenos">1657</span></a><span class="sd">        else: j = 2</span>
</span><span id="FST.put_slice-1658"><a href="#FST.put_slice-1658"><span class="linenos">1658</span></a>
</span><span id="FST.put_slice-1659"><a href="#FST.put_slice-1659"><span class="linenos">1659</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;).put(&#39;z = -1&#39;, 0, &#39;orelse&#39;).src.rstrip())</span>
</span><span id="FST.put_slice-1660"><a href="#FST.put_slice-1660"><span class="linenos">1660</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST.put_slice-1661"><a href="#FST.put_slice-1661"><span class="linenos">1661</span></a><span class="sd">        else:</span>
</span><span id="FST.put_slice-1662"><a href="#FST.put_slice-1662"><span class="linenos">1662</span></a><span class="sd">            z = -1</span>
</span><span id="FST.put_slice-1663"><a href="#FST.put_slice-1663"><span class="linenos">1663</span></a>
</span><span id="FST.put_slice-1664"><a href="#FST.put_slice-1664"><span class="linenos">1664</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1\nelse: j = 2&#39;)</span>
</span><span id="FST.put_slice-1665"><a href="#FST.put_slice-1665"><span class="linenos">1665</span></a><span class="sd">        ...       .put(&#39;z = -1\ny = -2\nx = -3&#39;, &#39;orelse&#39;, one=False).src.rstrip())</span>
</span><span id="FST.put_slice-1666"><a href="#FST.put_slice-1666"><span class="linenos">1666</span></a><span class="sd">        if 1: i = 1</span>
</span><span id="FST.put_slice-1667"><a href="#FST.put_slice-1667"><span class="linenos">1667</span></a><span class="sd">        else:</span>
</span><span id="FST.put_slice-1668"><a href="#FST.put_slice-1668"><span class="linenos">1668</span></a><span class="sd">            z = -1</span>
</span><span id="FST.put_slice-1669"><a href="#FST.put_slice-1669"><span class="linenos">1669</span></a><span class="sd">            y = -2</span>
</span><span id="FST.put_slice-1670"><a href="#FST.put_slice-1670"><span class="linenos">1670</span></a><span class="sd">            x = -3</span>
</span><span id="FST.put_slice-1671"><a href="#FST.put_slice-1671"><span class="linenos">1671</span></a>
</span><span id="FST.put_slice-1672"><a href="#FST.put_slice-1672"><span class="linenos">1672</span></a><span class="sd">        &gt;&gt;&gt; print((f := FST(&#39;if 1: i = 1\nelse: j = 2&#39;))</span>
</span><span id="FST.put_slice-1673"><a href="#FST.put_slice-1673"><span class="linenos">1673</span></a><span class="sd">        ...       .put(&#39;z = -1&#39;, 0, raw=True, to=f.orelse[0]).root.src)</span>
</span><span id="FST.put_slice-1674"><a href="#FST.put_slice-1674"><span class="linenos">1674</span></a><span class="sd">        if 1: z = -1</span>
</span><span id="FST.put_slice-1675"><a href="#FST.put_slice-1675"><span class="linenos">1675</span></a><span class="sd">        ```</span>
</span><span id="FST.put_slice-1676"><a href="#FST.put_slice-1676"><span class="linenos">1676</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.put_slice-1677"><a href="#FST.put_slice-1677"><span class="linenos">1677</span></a>
</span><span id="FST.put_slice-1678"><a href="#FST.put_slice-1678"><span class="linenos">1678</span></a>        <span class="n">ast</span>                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.put_slice-1679"><a href="#FST.put_slice-1679"><span class="linenos">1679</span></a>        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="n">_swizzle_getput_params</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="FST.put_slice-1680"><a href="#FST.put_slice-1680"><span class="linenos">1680</span></a>        <span class="n">field_</span><span class="p">,</span> <span class="n">body</span>       <span class="o">=</span> <span class="n">_fixup_field_body</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
</span><span id="FST.put_slice-1681"><a href="#FST.put_slice-1681"><span class="linenos">1681</span></a>
</span><span id="FST.put_slice-1682"><a href="#FST.put_slice-1682"><span class="linenos">1682</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.put_slice-1683"><a href="#FST.put_slice-1683"><span class="linenos">1683</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cannot put slice to non-list field </span><span class="si">{</span><span class="n">ast</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">field_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="FST.put_slice-1684"><a href="#FST.put_slice-1684"><span class="linenos">1684</span></a>
</span><span id="FST.put_slice-1685"><a href="#FST.put_slice-1685"><span class="linenos">1685</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_slice</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">field_</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Put a slice of nodes to <code>self</code> if possible.  The node is passed as an existing top-level <code><a href="#FST">FST</a></code>, <code>AST</code>, string
or list of string lines. If passed as an <code><a href="#FST">FST</a></code> then it should be considered "consumed" after this function
returns and is no logner valid, even on failure. <code>AST</code> is copied.</p>

<p><strong>WARNING!</strong> The original <code>self</code> node may be invalidated during the operation if using raw mode (either
specifically or as a fallback), so make sure to swap it out for the return value of this function if you will
keep using the variable you called this method on. It will be changed accordingly in the tree but any other
outside references to the node may become invalid.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>code</code>: The slice to put as an <code><a href="#FST">FST</a></code> (must be root node), <code>AST</code>, a string or list of line strings.</li>
<li><code>start</code>: The start of the slice to put, or <code>None</code> for the beginning of the entire range.</li>
<li><code>stop</code>: The end index (exclusive) of the slice. This should be one past the last element to put (like python
list indexing). If this is <code>None</code> then it indicates a slice operation to the end of the list (like python
<code>a[start:]</code>).</li>
<li><code>field</code>: The name of the field to put the elements to. If this is <code>None</code> then the default field for the node
type is used. Most node types have a common-sense default field, e.g. <code>body</code> for all block statements,
<code>elts</code> for things like <code>List</code> and <code>Tuple</code>. <code>MatchMapping</code> and <code>Compare</code> nodes have special-case handling for
a <code>None</code> field.</li>
<li><code><a href="#FST.options">options</a></code>: See <code><a href="#FST.get_options">get_options()</a></code>.</li>
</ul>

<p><strong>Note:</strong> The <code>field</code> value can be passed positionally in either the <code>start</code> or <code>stop</code> parameter. If passed in
<code>start</code> then the slice is assumed to be the entire range, and if passed in <code>stop</code> then the slice goes from
<code>start</code> to the end of the range.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>self</code></li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 4, 2, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4, 5&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, (4, 5), 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4, 5&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">one</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 4, 5, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4, 5&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[(4, 5), 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;4, 5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">one</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[0, 4, 5]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;z = -1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="k">else</span><span class="p">:</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;z = -1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;orelse&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">)</span>
<span class="o">...</span>       <span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;z = -1</span><span class="se">\n</span><span class="s1">y = -2</span><span class="se">\n</span><span class="s1">x = -3&#39;</span><span class="p">,</span> <span class="s1">&#39;orelse&#39;</span><span class="p">,</span> <span class="n">one</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1</span><span class="se">\n</span><span class="s1">else: j = 2&#39;</span><span class="p">))</span>
<span class="o">...</span>       <span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;z = -1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="k">if</span> <span class="mi">1</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.get_src" class="classattr">
                                        <input id="FST.get_src-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_src</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ln</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">col</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">as_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FST.get_src-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.get_src"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.get_src-1687"><a href="#FST.get_src-1687"><span class="linenos">1687</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_src</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">as_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FST.get_src-1688"><a href="#FST.get_src-1688"><span class="linenos">1688</span></a>                <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">]:</span>
</span><span id="FST.get_src-1689"><a href="#FST.get_src-1689"><span class="linenos">1689</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get source at location, without dedenting or any other modification, returned as a string or individual</span>
</span><span id="FST.get_src-1690"><a href="#FST.get_src-1690"><span class="linenos">1690</span></a><span class="sd">        lines. The first and last lines are cropped to start `col` and `end_col`.</span>
</span><span id="FST.get_src-1691"><a href="#FST.get_src-1691"><span class="linenos">1691</span></a>
</span><span id="FST.get_src-1692"><a href="#FST.get_src-1692"><span class="linenos">1692</span></a><span class="sd">        Can call on any node in tree to access source for the whole tree.</span>
</span><span id="FST.get_src-1693"><a href="#FST.get_src-1693"><span class="linenos">1693</span></a>
</span><span id="FST.get_src-1694"><a href="#FST.get_src-1694"><span class="linenos">1694</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.get_src-1695"><a href="#FST.get_src-1695"><span class="linenos">1695</span></a><span class="sd">        - `ln`: Start line of span to get (0 based).</span>
</span><span id="FST.get_src-1696"><a href="#FST.get_src-1696"><span class="linenos">1696</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="FST.get_src-1697"><a href="#FST.get_src-1697"><span class="linenos">1697</span></a><span class="sd">        - `end_ln`: End line of span to get (0 based, inclusive).</span>
</span><span id="FST.get_src-1698"><a href="#FST.get_src-1698"><span class="linenos">1698</span></a><span class="sd">        - `end_col`: End column (character, exclusive) on end line.</span>
</span><span id="FST.get_src-1699"><a href="#FST.get_src-1699"><span class="linenos">1699</span></a><span class="sd">        - `as_lines`: If `False` then source is returned as a single string with embedded newlines. If `True` then</span>
</span><span id="FST.get_src-1700"><a href="#FST.get_src-1700"><span class="linenos">1700</span></a><span class="sd">            source is returned as a list of line strings (without newlines).</span>
</span><span id="FST.get_src-1701"><a href="#FST.get_src-1701"><span class="linenos">1701</span></a>
</span><span id="FST.get_src-1702"><a href="#FST.get_src-1702"><span class="linenos">1702</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.get_src-1703"><a href="#FST.get_src-1703"><span class="linenos">1703</span></a><span class="sd">        - `str | list[str]`: A single string or a list of lines if `as_lines=True`. If lines then there are no trailing</span>
</span><span id="FST.get_src-1704"><a href="#FST.get_src-1704"><span class="linenos">1704</span></a><span class="sd">            newlines in the individual line strings.</span>
</span><span id="FST.get_src-1705"><a href="#FST.get_src-1705"><span class="linenos">1705</span></a>
</span><span id="FST.get_src-1706"><a href="#FST.get_src-1706"><span class="linenos">1706</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.get_src-1707"><a href="#FST.get_src-1707"><span class="linenos">1707</span></a><span class="sd">        ```py</span>
</span><span id="FST.get_src-1708"><a href="#FST.get_src-1708"><span class="linenos">1708</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 2&#39;).get_src(0, 3, 1, 5)</span>
</span><span id="FST.get_src-1709"><a href="#FST.get_src-1709"><span class="linenos">1709</span></a><span class="sd">        &#39;1:\n  i =&#39;</span>
</span><span id="FST.get_src-1710"><a href="#FST.get_src-1710"><span class="linenos">1710</span></a>
</span><span id="FST.get_src-1711"><a href="#FST.get_src-1711"><span class="linenos">1711</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 2&#39;).get_src(0, 3, 1, 5, as_lines=True)</span>
</span><span id="FST.get_src-1712"><a href="#FST.get_src-1712"><span class="linenos">1712</span></a><span class="sd">        [&#39;1:&#39;, &#39;  i =&#39;]</span>
</span><span id="FST.get_src-1713"><a href="#FST.get_src-1713"><span class="linenos">1713</span></a>
</span><span id="FST.get_src-1714"><a href="#FST.get_src-1714"><span class="linenos">1714</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;if 1:\n  i = 2&#39;)).get_src(*f.body[0].bloc)</span>
</span><span id="FST.get_src-1715"><a href="#FST.get_src-1715"><span class="linenos">1715</span></a><span class="sd">        &#39;i = 2&#39;</span>
</span><span id="FST.get_src-1716"><a href="#FST.get_src-1716"><span class="linenos">1716</span></a><span class="sd">        ```</span>
</span><span id="FST.get_src-1717"><a href="#FST.get_src-1717"><span class="linenos">1717</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.get_src-1718"><a href="#FST.get_src-1718"><span class="linenos">1718</span></a>
</span><span id="FST.get_src-1719"><a href="#FST.get_src-1719"><span class="linenos">1719</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST.get_src-1720"><a href="#FST.get_src-1720"><span class="linenos">1720</span></a>
</span><span id="FST.get_src-1721"><a href="#FST.get_src-1721"><span class="linenos">1721</span></a>        <span class="k">if</span> <span class="n">as_lines</span><span class="p">:</span>
</span><span id="FST.get_src-1722"><a href="#FST.get_src-1722"><span class="linenos">1722</span></a>            <span class="k">return</span> <span class="p">([</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">end_col</span><span class="p">])]</span>  <span class="c1"># no real reason for bistr, just to be consistent and minor optimization if passed back into put_src()</span>
</span><span id="FST.get_src-1723"><a href="#FST.get_src-1723"><span class="linenos">1723</span></a>                    <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="k">else</span>
</span><span id="FST.get_src-1724"><a href="#FST.get_src-1724"><span class="linenos">1724</span></a>                    <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span><span class="p">:])]</span> <span class="o">+</span> <span class="n">ls</span><span class="p">[</span><span class="n">ln</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">end_ln</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">bistr</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">end_ln</span><span class="p">][:</span><span class="n">end_col</span><span class="p">])])</span>
</span><span id="FST.get_src-1725"><a href="#FST.get_src-1725"><span class="linenos">1725</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.get_src-1726"><a href="#FST.get_src-1726"><span class="linenos">1726</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">end_col</span><span class="p">]</span>
</span><span id="FST.get_src-1727"><a href="#FST.get_src-1727"><span class="linenos">1727</span></a>                    <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="k">else</span>
</span><span id="FST.get_src-1728"><a href="#FST.get_src-1728"><span class="linenos">1728</span></a>                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ls</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span><span class="p">:]]</span> <span class="o">+</span> <span class="n">ls</span><span class="p">[</span><span class="n">ln</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">end_ln</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">ls</span><span class="p">[</span><span class="n">end_ln</span><span class="p">][:</span><span class="n">end_col</span><span class="p">]]))</span>
</span></pre></div>


            <div class="docstring"><p>Get source at location, without dedenting or any other modification, returned as a string or individual
lines. The first and last lines are cropped to start <code><a href="#FST.col">col</a></code> and <code><a href="#FST.end_col">end_col</a></code>.</p>

<p>Can call on any node in tree to access source for the whole tree.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.ln">ln</a></code>: Start line of span to get (0 based).</li>
<li><code><a href="#FST.col">col</a></code>: Start column (character) on start line.</li>
<li><code><a href="#FST.end_ln">end_ln</a></code>: End line of span to get (0 based, inclusive).</li>
<li><code><a href="#FST.end_col">end_col</a></code>: End column (character, exclusive) on end line.</li>
<li><code>as_lines</code>: If <code>False</code> then source is returned as a single string with embedded newlines. If <code>True</code> then
source is returned as a list of line strings (without newlines).</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>str | list[str]</code>: A single string or a list of lines if <code>as_lines=True</code>. If lines then there are no trailing
newlines in the individual line strings.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n</span><span class="s1">  i = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="s1">&#39;1:</span><span class="se">\n</span><span class="s1">  i =&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n</span><span class="s1">  i = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">as_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;1:&#39;</span><span class="p">,</span> <span class="s1">&#39;  i =&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n</span><span class="s1">  i = 2&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get_src</span><span class="p">(</span><span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bloc</span><span class="p">)</span>
<span class="s1">&#39;i = 2&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.put_src" class="classattr">
                                        <input id="FST.put_src-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">put_src</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">code</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#FST">FST</a></span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>,</span><span class="param">	<span class="n">ln</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">col</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.put_src-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.put_src"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.put_src-1730"><a href="#FST.put_src-1730"><span class="linenos">1730</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">put_src</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="FST.put_src-1731"><a href="#FST.put_src-1731"><span class="linenos">1731</span></a>                <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.put_src-1732"><a href="#FST.put_src-1732"><span class="linenos">1732</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Put source and reparse. There are no rules on what is put, it is simply put and parse is attempted. If the</span>
</span><span id="FST.put_src-1733"><a href="#FST.put_src-1733"><span class="linenos">1733</span></a><span class="sd">        `code` is passed as an `AST` then it is unparsed to a string and that string is put into the location. If `FST`</span>
</span><span id="FST.put_src-1734"><a href="#FST.put_src-1734"><span class="linenos">1734</span></a><span class="sd">        then the exact source of the `FST` is put. If passed as a string or lines then that is put directly.</span>
</span><span id="FST.put_src-1735"><a href="#FST.put_src-1735"><span class="linenos">1735</span></a>
</span><span id="FST.put_src-1736"><a href="#FST.put_src-1736"><span class="linenos">1736</span></a><span class="sd">        The reparse that is triggered is of at least a statement level node or a statement block header, and can be</span>
</span><span id="FST.put_src-1737"><a href="#FST.put_src-1737"><span class="linenos">1737</span></a><span class="sd">        multiple statements if the location spans those or even statements outside of the location if the reparse</span>
</span><span id="FST.put_src-1738"><a href="#FST.put_src-1738"><span class="linenos">1738</span></a><span class="sd">        affects things like `elif`. `FST` nodes in the region of the put or even outside of it can become invalid. The</span>
</span><span id="FST.put_src-1739"><a href="#FST.put_src-1739"><span class="linenos">1739</span></a><span class="sd">        only `FST` node guaranteed not to change is the root node (identity, the `AST` it holds can change).</span>
</span><span id="FST.put_src-1740"><a href="#FST.put_src-1740"><span class="linenos">1740</span></a>
</span><span id="FST.put_src-1741"><a href="#FST.put_src-1741"><span class="linenos">1741</span></a><span class="sd">        When putting source raw by location like this there are no automatic modifications made to the source or</span>
</span><span id="FST.put_src-1742"><a href="#FST.put_src-1742"><span class="linenos">1742</span></a><span class="sd">        destination. No parenthesization, prefixes or suffixes or indentation, the source is just put and parsed so you</span>
</span><span id="FST.put_src-1743"><a href="#FST.put_src-1743"><span class="linenos">1743</span></a><span class="sd">        are responsible for the correct indentation and precedence.</span>
</span><span id="FST.put_src-1744"><a href="#FST.put_src-1744"><span class="linenos">1744</span></a>
</span><span id="FST.put_src-1745"><a href="#FST.put_src-1745"><span class="linenos">1745</span></a><span class="sd">        After put and successful reparse the location of the put is examined and an appropriate node is returned which</span>
</span><span id="FST.put_src-1746"><a href="#FST.put_src-1746"><span class="linenos">1746</span></a><span class="sd">        fits best for a node which may have been added or replaced. It is possible that `None` is returned if no good</span>
</span><span id="FST.put_src-1747"><a href="#FST.put_src-1747"><span class="linenos">1747</span></a><span class="sd">        candidate is found (since this can be used to delete or merge nodes).</span>
</span><span id="FST.put_src-1748"><a href="#FST.put_src-1748"><span class="linenos">1748</span></a>
</span><span id="FST.put_src-1749"><a href="#FST.put_src-1749"><span class="linenos">1749</span></a><span class="sd">        Can call on any node in tree to modify source for the whole tree.</span>
</span><span id="FST.put_src-1750"><a href="#FST.put_src-1750"><span class="linenos">1750</span></a>
</span><span id="FST.put_src-1751"><a href="#FST.put_src-1751"><span class="linenos">1751</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.put_src-1752"><a href="#FST.put_src-1752"><span class="linenos">1752</span></a><span class="sd">        - `code`: The code to put as an `FST` (must be root node), `AST`, a string or list of line strings.</span>
</span><span id="FST.put_src-1753"><a href="#FST.put_src-1753"><span class="linenos">1753</span></a><span class="sd">        - `ln`: Start line of span to put (0 based).</span>
</span><span id="FST.put_src-1754"><a href="#FST.put_src-1754"><span class="linenos">1754</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="FST.put_src-1755"><a href="#FST.put_src-1755"><span class="linenos">1755</span></a><span class="sd">        - `end_ln`: End line of span to put (0 based, inclusive).</span>
</span><span id="FST.put_src-1756"><a href="#FST.put_src-1756"><span class="linenos">1756</span></a><span class="sd">        - `end_col`: End column (character, exclusive) on end line.</span>
</span><span id="FST.put_src-1757"><a href="#FST.put_src-1757"><span class="linenos">1757</span></a><span class="sd">        - `exact`: This specifies how the node check after a successful reparse is done. `True` means allow return of</span>
</span><span id="FST.put_src-1758"><a href="#FST.put_src-1758"><span class="linenos">1758</span></a><span class="sd">            node which matches location exactly. Otherwise if `False`, the location must be inside the node but cannot</span>
</span><span id="FST.put_src-1759"><a href="#FST.put_src-1759"><span class="linenos">1759</span></a><span class="sd">            be touching BOTH ends of the node. This basically determines whether you can get the exact node of the</span>
</span><span id="FST.put_src-1760"><a href="#FST.put_src-1760"><span class="linenos">1760</span></a><span class="sd">            location or its parent. If passed as `None` then the check is even more restricted.</span>
</span><span id="FST.put_src-1761"><a href="#FST.put_src-1761"><span class="linenos">1761</span></a>
</span><span id="FST.put_src-1762"><a href="#FST.put_src-1762"><span class="linenos">1762</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.put_src-1763"><a href="#FST.put_src-1763"><span class="linenos">1763</span></a><span class="sd">        - `FST | None`: FIRST highest level node contained entirely within replacement source location (there may be</span>
</span><span id="FST.put_src-1764"><a href="#FST.put_src-1764"><span class="linenos">1764</span></a><span class="sd">            others following), or `None` if no such candidate and `exact=None`. If no candidate and `exact` is `True`</span>
</span><span id="FST.put_src-1765"><a href="#FST.put_src-1765"><span class="linenos">1765</span></a><span class="sd">            or `False` then will attempt to return a node which encloses the location using `find_loc(..., exact)`.</span>
</span><span id="FST.put_src-1766"><a href="#FST.put_src-1766"><span class="linenos">1766</span></a>
</span><span id="FST.put_src-1767"><a href="#FST.put_src-1767"><span class="linenos">1767</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.put_src-1768"><a href="#FST.put_src-1768"><span class="linenos">1768</span></a><span class="sd">        ```py</span>
</span><span id="FST.put_src-1769"><a href="#FST.put_src-1769"><span class="linenos">1769</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).put_src(&#39;2&#39;, 0, 4, 0, 5).root.src</span>
</span><span id="FST.put_src-1770"><a href="#FST.put_src-1770"><span class="linenos">1770</span></a><span class="sd">        &#39;i = 2&#39;</span>
</span><span id="FST.put_src-1771"><a href="#FST.put_src-1771"><span class="linenos">1771</span></a>
</span><span id="FST.put_src-1772"><a href="#FST.put_src-1772"><span class="linenos">1772</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).put_src(&#39;+= 3&#39;, 0, 2, 0, 5).root.src</span>
</span><span id="FST.put_src-1773"><a href="#FST.put_src-1773"><span class="linenos">1773</span></a><span class="sd">        &#39;i += 3&#39;</span>
</span><span id="FST.put_src-1774"><a href="#FST.put_src-1774"><span class="linenos">1774</span></a>
</span><span id="FST.put_src-1775"><a href="#FST.put_src-1775"><span class="linenos">1775</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{a: b, c: d, e: f}&#39;).put_src(&#39;**&#39;, 0, 7, 0, 10).root.src</span>
</span><span id="FST.put_src-1776"><a href="#FST.put_src-1776"><span class="linenos">1776</span></a><span class="sd">        &#39;{a: b, **d, e: f}&#39;</span>
</span><span id="FST.put_src-1777"><a href="#FST.put_src-1777"><span class="linenos">1777</span></a>
</span><span id="FST.put_src-1778"><a href="#FST.put_src-1778"><span class="linenos">1778</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;i = 1&#39;)</span>
</span><span id="FST.put_src-1779"><a href="#FST.put_src-1779"><span class="linenos">1779</span></a><span class="sd">        &gt;&gt;&gt; g = f.targets[0]</span>
</span><span id="FST.put_src-1780"><a href="#FST.put_src-1780"><span class="linenos">1780</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a))</span>
</span><span id="FST.put_src-1781"><a href="#FST.put_src-1781"><span class="linenos">1781</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt;</span>
</span><span id="FST.put_src-1782"><a href="#FST.put_src-1782"><span class="linenos">1782</span></a>
</span><span id="FST.put_src-1783"><a href="#FST.put_src-1783"><span class="linenos">1783</span></a><span class="sd">        &gt;&gt;&gt; f.put_src(&#39;4&#39;, 0, 4, 0, 5).src</span>
</span><span id="FST.put_src-1784"><a href="#FST.put_src-1784"><span class="linenos">1784</span></a><span class="sd">        &#39;4&#39;</span>
</span><span id="FST.put_src-1785"><a href="#FST.put_src-1785"><span class="linenos">1785</span></a>
</span><span id="FST.put_src-1786"><a href="#FST.put_src-1786"><span class="linenos">1786</span></a><span class="sd">        &gt;&gt;&gt; print(g.a)</span>
</span><span id="FST.put_src-1787"><a href="#FST.put_src-1787"><span class="linenos">1787</span></a><span class="sd">        None</span>
</span><span id="FST.put_src-1788"><a href="#FST.put_src-1788"><span class="linenos">1788</span></a>
</span><span id="FST.put_src-1789"><a href="#FST.put_src-1789"><span class="linenos">1789</span></a><span class="sd">        &gt;&gt;&gt; print(type(f.targets[0].a))</span>
</span><span id="FST.put_src-1790"><a href="#FST.put_src-1790"><span class="linenos">1790</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt;</span>
</span><span id="FST.put_src-1791"><a href="#FST.put_src-1791"><span class="linenos">1791</span></a>
</span><span id="FST.put_src-1792"><a href="#FST.put_src-1792"><span class="linenos">1792</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;&#39;&#39;</span>
</span><span id="FST.put_src-1793"><a href="#FST.put_src-1793"><span class="linenos">1793</span></a><span class="sd">        ... if a:</span>
</span><span id="FST.put_src-1794"><a href="#FST.put_src-1794"><span class="linenos">1794</span></a><span class="sd">        ...   i = 2</span>
</span><span id="FST.put_src-1795"><a href="#FST.put_src-1795"><span class="linenos">1795</span></a><span class="sd">        ... elif b:</span>
</span><span id="FST.put_src-1796"><a href="#FST.put_src-1796"><span class="linenos">1796</span></a><span class="sd">        ...   j = 3</span>
</span><span id="FST.put_src-1797"><a href="#FST.put_src-1797"><span class="linenos">1797</span></a><span class="sd">        ... &#39;&#39;&#39;.strip())</span>
</span><span id="FST.put_src-1798"><a href="#FST.put_src-1798"><span class="linenos">1798</span></a>
</span><span id="FST.put_src-1799"><a href="#FST.put_src-1799"><span class="linenos">1799</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="FST.put_src-1800"><a href="#FST.put_src-1800"><span class="linenos">1800</span></a><span class="sd">        if a:</span>
</span><span id="FST.put_src-1801"><a href="#FST.put_src-1801"><span class="linenos">1801</span></a><span class="sd">          i = 2</span>
</span><span id="FST.put_src-1802"><a href="#FST.put_src-1802"><span class="linenos">1802</span></a><span class="sd">        elif b:</span>
</span><span id="FST.put_src-1803"><a href="#FST.put_src-1803"><span class="linenos">1803</span></a><span class="sd">          j = 3</span>
</span><span id="FST.put_src-1804"><a href="#FST.put_src-1804"><span class="linenos">1804</span></a>
</span><span id="FST.put_src-1805"><a href="#FST.put_src-1805"><span class="linenos">1805</span></a><span class="sd">        &gt;&gt;&gt; f.put_src(&#39;&#39;&#39;</span>
</span><span id="FST.put_src-1806"><a href="#FST.put_src-1806"><span class="linenos">1806</span></a><span class="sd">        ... else:</span>
</span><span id="FST.put_src-1807"><a href="#FST.put_src-1807"><span class="linenos">1807</span></a><span class="sd">        ...   if b:</span>
</span><span id="FST.put_src-1808"><a href="#FST.put_src-1808"><span class="linenos">1808</span></a><span class="sd">        ...     k = 4</span>
</span><span id="FST.put_src-1809"><a href="#FST.put_src-1809"><span class="linenos">1809</span></a><span class="sd">        ... &#39;&#39;&#39;.strip(), *f.orelse[0].loc[:2], *f.loc[2:])</span>
</span><span id="FST.put_src-1810"><a href="#FST.put_src-1810"><span class="linenos">1810</span></a><span class="sd">        &lt;If 3,2..4,9&gt;</span>
</span><span id="FST.put_src-1811"><a href="#FST.put_src-1811"><span class="linenos">1811</span></a>
</span><span id="FST.put_src-1812"><a href="#FST.put_src-1812"><span class="linenos">1812</span></a><span class="sd">        &gt;&gt;&gt; print(f.src)</span>
</span><span id="FST.put_src-1813"><a href="#FST.put_src-1813"><span class="linenos">1813</span></a><span class="sd">        if a:</span>
</span><span id="FST.put_src-1814"><a href="#FST.put_src-1814"><span class="linenos">1814</span></a><span class="sd">          i = 2</span>
</span><span id="FST.put_src-1815"><a href="#FST.put_src-1815"><span class="linenos">1815</span></a><span class="sd">        else:</span>
</span><span id="FST.put_src-1816"><a href="#FST.put_src-1816"><span class="linenos">1816</span></a><span class="sd">          if b:</span>
</span><span id="FST.put_src-1817"><a href="#FST.put_src-1817"><span class="linenos">1817</span></a><span class="sd">            k = 4</span>
</span><span id="FST.put_src-1818"><a href="#FST.put_src-1818"><span class="linenos">1818</span></a><span class="sd">        ```</span>
</span><span id="FST.put_src-1819"><a href="#FST.put_src-1819"><span class="linenos">1819</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.put_src-1820"><a href="#FST.put_src-1820"><span class="linenos">1820</span></a>
</span><span id="FST.put_src-1821"><a href="#FST.put_src-1821"><span class="linenos">1821</span></a>        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
</span><span id="FST.put_src-1822"><a href="#FST.put_src-1822"><span class="linenos">1822</span></a>
</span><span id="FST.put_src-1823"><a href="#FST.put_src-1823"><span class="linenos">1823</span></a>        <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_reparse_raw</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">exact</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Put source and reparse. There are no rules on what is put, it is simply put and parse is attempted. If the
<code>code</code> is passed as an <code>AST</code> then it is unparsed to a string and that string is put into the location. If <code><a href="#FST">FST</a></code>
then the exact source of the <code><a href="#FST">FST</a></code> is put. If passed as a string or lines then that is put directly.</p>

<p>The reparse that is triggered is of at least a statement level node or a statement block header, and can be
multiple statements if the location spans those or even statements outside of the location if the reparse
affects things like <code>elif</code>. <code><a href="#FST">FST</a></code> nodes in the region of the put or even outside of it can become invalid. The
only <code><a href="#FST">FST</a></code> node guaranteed not to change is the root node (identity, the <code>AST</code> it holds can change).</p>

<p>When putting source raw by location like this there are no automatic modifications made to the source or
destination. No parenthesization, prefixes or suffixes or indentation, the source is just put and parsed so you
are responsible for the correct indentation and precedence.</p>

<p>After put and successful reparse the location of the put is examined and an appropriate node is returned which
fits best for a node which may have been added or replaced. It is possible that <code>None</code> is returned if no good
candidate is found (since this can be used to delete or merge nodes).</p>

<p>Can call on any node in tree to modify source for the whole tree.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>code</code>: The code to put as an <code><a href="#FST">FST</a></code> (must be root node), <code>AST</code>, a string or list of line strings.</li>
<li><code><a href="#FST.ln">ln</a></code>: Start line of span to put (0 based).</li>
<li><code><a href="#FST.col">col</a></code>: Start column (character) on start line.</li>
<li><code><a href="#FST.end_ln">end_ln</a></code>: End line of span to put (0 based, inclusive).</li>
<li><code><a href="#FST.end_col">end_col</a></code>: End column (character, exclusive) on end line.</li>
<li><code>exact</code>: This specifies how the node check after a successful reparse is done. <code>True</code> means allow return of
node which matches location exactly. Otherwise if <code>False</code>, the location must be inside the node but cannot
be touching BOTH ends of the node. This basically determines whether you can get the exact node of the
location or its parent. If passed as <code>None</code> then the check is even more restricted.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>FST | None</code>: FIRST highest level node contained entirely within replacement source location (there may be
others following), or <code>None</code> if no such candidate and <code>exact=None</code>. If no candidate and <code>exact</code> is <code>True</code>
or <code>False</code> then will attempt to return a node which encloses the location using <code>find_loc(..., exact)</code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put_src</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;i = 2&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put_src</span><span class="p">(</span><span class="s1">&#39;+= 3&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;i += 3&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;{a: b, c: d, e: f}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">put_src</span><span class="p">(</span><span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;{a: b, **d, e: f}&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = 1&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="p">))</span>
<span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">ast</span><span class="o">.</span><span class="n">Name</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">put_src</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;4&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="kc">None</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="p">))</span>
<span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">ast</span><span class="o">.</span><span class="n">Name</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">... if a:</span>
<span class="s1">...   i = 2</span>
<span class="s1">... elif b:</span>
<span class="s1">...   j = 3</span>
<span class="s1">... &#39;&#39;&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="k">if</span> <span class="n">a</span><span class="p">:</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">elif</span> <span class="n">b</span><span class="p">:</span>
  <span class="n">j</span> <span class="o">=</span> <span class="mi">3</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">put_src</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">... else:</span>
<span class="s1">...   if b:</span>
<span class="s1">...     k = 4</span>
<span class="s1">... &#39;&#39;&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<span class="o">&lt;</span><span class="n">If</span> <span class="mi">3</span><span class="p">,</span><span class="mf">2..4</span><span class="p">,</span><span class="mi">9</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="k">if</span> <span class="n">a</span><span class="p">:</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">else</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">b</span><span class="p">:</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.pars" class="classattr">
                                        <input id="FST.pars-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">pars</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="misc.html#fstloc">fst.misc.fstloc</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.pars-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.pars"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.pars-1825"><a href="#FST.pars-1825"><span class="linenos">1825</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fstloc</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.pars-1826"><a href="#FST.pars-1826"><span class="linenos">1826</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the location of enclosing GROUPING parentheses if present. Will balance parentheses if `self` is an</span>
</span><span id="FST.pars-1827"><a href="#FST.pars-1827"><span class="linenos">1827</span></a><span class="sd">        element of a tuple and not return the parentheses of the tuple. Likwise will not normally return the parentheses</span>
</span><span id="FST.pars-1828"><a href="#FST.pars-1828"><span class="linenos">1828</span></a><span class="sd">        of an enclosing `arguments` parent or class bases list (unless `shared=None`, but that is mostly for internal</span>
</span><span id="FST.pars-1829"><a href="#FST.pars-1829"><span class="linenos">1829</span></a><span class="sd">        use).</span>
</span><span id="FST.pars-1830"><a href="#FST.pars-1830"><span class="linenos">1830</span></a>
</span><span id="FST.pars-1831"><a href="#FST.pars-1831"><span class="linenos">1831</span></a><span class="sd">        Only normally works on (and makes sense for) `expr` or `pattern` nodes, otherwise returns `self.bloc` and count</span>
</span><span id="FST.pars-1832"><a href="#FST.pars-1832"><span class="linenos">1832</span></a><span class="sd">        of 0. Also handles special case of a single generator expression argument to a function sharing parameters with</span>
</span><span id="FST.pars-1833"><a href="#FST.pars-1833"><span class="linenos">1833</span></a><span class="sd">        the call arguments, in which case a count of -1 and the location of the `GeneratorExp` without its enclosing</span>
</span><span id="FST.pars-1834"><a href="#FST.pars-1834"><span class="linenos">1834</span></a><span class="sd">        parentheses may be returned, if this is enabled with `shared=False`.</span>
</span><span id="FST.pars-1835"><a href="#FST.pars-1835"><span class="linenos">1835</span></a>
</span><span id="FST.pars-1836"><a href="#FST.pars-1836"><span class="linenos">1836</span></a><span class="sd">        This function is cached so feel free to call as often as is needed.</span>
</span><span id="FST.pars-1837"><a href="#FST.pars-1837"><span class="linenos">1837</span></a>
</span><span id="FST.pars-1838"><a href="#FST.pars-1838"><span class="linenos">1838</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.pars-1839"><a href="#FST.pars-1839"><span class="linenos">1839</span></a><span class="sd">        - `shared`: If `True` then will include parentheses of a single call argument generator expression if they are</span>
</span><span id="FST.pars-1840"><a href="#FST.pars-1840"><span class="linenos">1840</span></a><span class="sd">            shared with the call arguments enclosing parentheses with a count of 0. If `False` then does not return</span>
</span><span id="FST.pars-1841"><a href="#FST.pars-1841"><span class="linenos">1841</span></a><span class="sd">            these and returns a count of -1, and thus the location is not a full valid `GeneratorExp` location. If</span>
</span><span id="FST.pars-1842"><a href="#FST.pars-1842"><span class="linenos">1842</span></a><span class="sd">            `None` then returns ANY directly enclosing parentheses, whether they belong to this node or not.</span>
</span><span id="FST.pars-1843"><a href="#FST.pars-1843"><span class="linenos">1843</span></a>
</span><span id="FST.pars-1844"><a href="#FST.pars-1844"><span class="linenos">1844</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.pars-1845"><a href="#FST.pars-1845"><span class="linenos">1845</span></a><span class="sd">        - `fstloc | None`: Location of enclosing parentheses if present else `self.bloc` (which can be `None`). Negative</span>
</span><span id="FST.pars-1846"><a href="#FST.pars-1846"><span class="linenos">1846</span></a><span class="sd">            parentheses count (from shared parens solo call arg generator expression) can also be checked in the case of</span>
</span><span id="FST.pars-1847"><a href="#FST.pars-1847"><span class="linenos">1847</span></a><span class="sd">            `shared=False` via `fst.pars() &gt; fst.bloc`. If only loc is returned, it will be an `fstloc` which will</span>
</span><span id="FST.pars-1848"><a href="#FST.pars-1848"><span class="linenos">1848</span></a><span class="sd">            still have the count of parentheses in an attribute `.n`.</span>
</span><span id="FST.pars-1849"><a href="#FST.pars-1849"><span class="linenos">1849</span></a>
</span><span id="FST.pars-1850"><a href="#FST.pars-1850"><span class="linenos">1850</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.pars-1851"><a href="#FST.pars-1851"><span class="linenos">1851</span></a><span class="sd">        ```py</span>
</span><span id="FST.pars-1852"><a href="#FST.pars-1852"><span class="linenos">1852</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).pars()</span>
</span><span id="FST.pars-1853"><a href="#FST.pars-1853"><span class="linenos">1853</span></a><span class="sd">        fstlocns(0, 0, 0, 1, n=0)</span>
</span><span id="FST.pars-1854"><a href="#FST.pars-1854"><span class="linenos">1854</span></a>
</span><span id="FST.pars-1855"><a href="#FST.pars-1855"><span class="linenos">1855</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(i)&#39;).pars()</span>
</span><span id="FST.pars-1856"><a href="#FST.pars-1856"><span class="linenos">1856</span></a><span class="sd">        fstlocns(0, 0, 0, 3, n=1)</span>
</span><span id="FST.pars-1857"><a href="#FST.pars-1857"><span class="linenos">1857</span></a>
</span><span id="FST.pars-1858"><a href="#FST.pars-1858"><span class="linenos">1858</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((i))&#39;).pars()</span>
</span><span id="FST.pars-1859"><a href="#FST.pars-1859"><span class="linenos">1859</span></a><span class="sd">        fstlocns(0, 0, 0, 5, n=2)</span>
</span><span id="FST.pars-1860"><a href="#FST.pars-1860"><span class="linenos">1860</span></a>
</span><span id="FST.pars-1861"><a href="#FST.pars-1861"><span class="linenos">1861</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).pars()  # tuple pars are not considered grouping pars</span>
</span><span id="FST.pars-1862"><a href="#FST.pars-1862"><span class="linenos">1862</span></a><span class="sd">        fstlocns(0, 0, 0, 6, n=0)</span>
</span><span id="FST.pars-1863"><a href="#FST.pars-1863"><span class="linenos">1863</span></a>
</span><span id="FST.pars-1864"><a href="#FST.pars-1864"><span class="linenos">1864</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((1, 2))&#39;).pars()</span>
</span><span id="FST.pars-1865"><a href="#FST.pars-1865"><span class="linenos">1865</span></a><span class="sd">        fstlocns(0, 0, 0, 8, n=1)</span>
</span><span id="FST.pars-1866"><a href="#FST.pars-1866"><span class="linenos">1866</span></a>
</span><span id="FST.pars-1867"><a href="#FST.pars-1867"><span class="linenos">1867</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].pars()  # any node, not just root</span>
</span><span id="FST.pars-1868"><a href="#FST.pars-1868"><span class="linenos">1868</span></a><span class="sd">        fstlocns(0, 5, 0, 6, n=0)</span>
</span><span id="FST.pars-1869"><a href="#FST.pars-1869"><span class="linenos">1869</span></a>
</span><span id="FST.pars-1870"><a href="#FST.pars-1870"><span class="linenos">1870</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((a))&#39;).args[0].pars()</span>
</span><span id="FST.pars-1871"><a href="#FST.pars-1871"><span class="linenos">1871</span></a><span class="sd">        fstlocns(0, 5, 0, 8, n=1)</span>
</span><span id="FST.pars-1872"><a href="#FST.pars-1872"><span class="linenos">1872</span></a>
</span><span id="FST.pars-1873"><a href="#FST.pars-1873"><span class="linenos">1873</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in j)&#39;).args[0].pars()</span>
</span><span id="FST.pars-1874"><a href="#FST.pars-1874"><span class="linenos">1874</span></a><span class="sd">        fstlocns(0, 4, 0, 18, n=0)</span>
</span><span id="FST.pars-1875"><a href="#FST.pars-1875"><span class="linenos">1875</span></a>
</span><span id="FST.pars-1876"><a href="#FST.pars-1876"><span class="linenos">1876</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in j)&#39;).args[0].pars(shared=False)  # exclude shared pars</span>
</span><span id="FST.pars-1877"><a href="#FST.pars-1877"><span class="linenos">1877</span></a><span class="sd">        fstlocns(0, 5, 0, 17, n=-1)</span>
</span><span id="FST.pars-1878"><a href="#FST.pars-1878"><span class="linenos">1878</span></a>
</span><span id="FST.pars-1879"><a href="#FST.pars-1879"><span class="linenos">1879</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in j))&#39;).args[0].pars(shared=False)</span>
</span><span id="FST.pars-1880"><a href="#FST.pars-1880"><span class="linenos">1880</span></a><span class="sd">        fstlocns(0, 5, 0, 19, n=0)</span>
</span><span id="FST.pars-1881"><a href="#FST.pars-1881"><span class="linenos">1881</span></a><span class="sd">        ```</span>
</span><span id="FST.pars-1882"><a href="#FST.pars-1882"><span class="linenos">1882</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.pars-1883"><a href="#FST.pars-1883"><span class="linenos">1883</span></a>
</span><span id="FST.pars-1884"><a href="#FST.pars-1884"><span class="linenos">1884</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;pars_</span><span class="si">{</span><span class="kc">None</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nb">bool</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="FST.pars-1885"><a href="#FST.pars-1885"><span class="linenos">1885</span></a>
</span><span id="FST.pars-1886"><a href="#FST.pars-1886"><span class="linenos">1886</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.pars-1887"><a href="#FST.pars-1887"><span class="linenos">1887</span></a>            <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="FST.pars-1888"><a href="#FST.pars-1888"><span class="linenos">1888</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="FST.pars-1889"><a href="#FST.pars-1889"><span class="linenos">1889</span></a>            <span class="k">pass</span>
</span><span id="FST.pars-1890"><a href="#FST.pars-1890"><span class="linenos">1890</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.pars-1891"><a href="#FST.pars-1891"><span class="linenos">1891</span></a>            <span class="k">return</span> <span class="n">cached</span>
</span><span id="FST.pars-1892"><a href="#FST.pars-1892"><span class="linenos">1892</span></a>
</span><span id="FST.pars-1893"><a href="#FST.pars-1893"><span class="linenos">1893</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span> <span class="ow">and</span> <span class="n">shared</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.pars-1894"><a href="#FST.pars-1894"><span class="linenos">1894</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="FST.pars-1895"><a href="#FST.pars-1895"><span class="linenos">1895</span></a>
</span><span id="FST.pars-1896"><a href="#FST.pars-1896"><span class="linenos">1896</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="FST.pars-1897"><a href="#FST.pars-1897"><span class="linenos">1897</span></a>
</span><span id="FST.pars-1898"><a href="#FST.pars-1898"><span class="linenos">1898</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc</span>
</span><span id="FST.pars-1899"><a href="#FST.pars-1899"><span class="linenos">1899</span></a>
</span><span id="FST.pars-1900"><a href="#FST.pars-1900"><span class="linenos">1900</span></a>        <span class="n">rpars</span> <span class="o">=</span> <span class="n">_next_pars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_bound</span><span class="p">())</span>
</span><span id="FST.pars-1901"><a href="#FST.pars-1901"><span class="linenos">1901</span></a>
</span><span id="FST.pars-1902"><a href="#FST.pars-1902"><span class="linenos">1902</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lrpars</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpars</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># no pars on right</span>
</span><span id="FST.pars-1903"><a href="#FST.pars-1903"><span class="linenos">1903</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">shared</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_call_arg_genexp</span><span class="p">():</span>
</span><span id="FST.pars-1904"><a href="#FST.pars-1904"><span class="linenos">1904</span></a>                <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="FST.pars-1905"><a href="#FST.pars-1905"><span class="linenos">1905</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.pars-1906"><a href="#FST.pars-1906"><span class="linenos">1906</span></a>                <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="FST.pars-1907"><a href="#FST.pars-1907"><span class="linenos">1907</span></a>
</span><span id="FST.pars-1908"><a href="#FST.pars-1908"><span class="linenos">1908</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span>
</span><span id="FST.pars-1909"><a href="#FST.pars-1909"><span class="linenos">1909</span></a>
</span><span id="FST.pars-1910"><a href="#FST.pars-1910"><span class="linenos">1910</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="FST.pars-1911"><a href="#FST.pars-1911"><span class="linenos">1911</span></a>
</span><span id="FST.pars-1912"><a href="#FST.pars-1912"><span class="linenos">1912</span></a>        <span class="n">lpars</span> <span class="o">=</span> <span class="n">_prev_pars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_prev_bound</span><span class="p">(),</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</span><span id="FST.pars-1913"><a href="#FST.pars-1913"><span class="linenos">1913</span></a>
</span><span id="FST.pars-1914"><a href="#FST.pars-1914"><span class="linenos">1914</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">llpars</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lpars</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># no pars on left</span>
</span><span id="FST.pars-1915"><a href="#FST.pars-1915"><span class="linenos">1915</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="FST.pars-1916"><a href="#FST.pars-1916"><span class="linenos">1916</span></a>
</span><span id="FST.pars-1917"><a href="#FST.pars-1917"><span class="linenos">1917</span></a>            <span class="k">return</span> <span class="n">locn</span>
</span><span id="FST.pars-1918"><a href="#FST.pars-1918"><span class="linenos">1918</span></a>
</span><span id="FST.pars-1919"><a href="#FST.pars-1919"><span class="linenos">1919</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">llpars</span> <span class="o">&lt;=</span> <span class="n">lrpars</span> <span class="ow">and</span> <span class="n">shared</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
</span><span id="FST.pars-1920"><a href="#FST.pars-1920"><span class="linenos">1920</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_solo_call_arg</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_class_base</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solo_matchcls_pat</span><span class="p">())</span>
</span><span id="FST.pars-1921"><a href="#FST.pars-1921"><span class="linenos">1921</span></a>        <span class="p">):</span>
</span><span id="FST.pars-1922"><a href="#FST.pars-1922"><span class="linenos">1922</span></a>            <span class="n">llpars</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="FST.pars-1923"><a href="#FST.pars-1923"><span class="linenos">1923</span></a>
</span><span id="FST.pars-1924"><a href="#FST.pars-1924"><span class="linenos">1924</span></a>        <span class="k">if</span> <span class="n">llpars</span> <span class="o">!=</span> <span class="n">lrpars</span><span class="p">:</span>  <span class="c1"># unbalanced pars so we know we can safely use the lower count</span>
</span><span id="FST.pars-1925"><a href="#FST.pars-1925"><span class="linenos">1925</span></a>            <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="o">*</span><span class="n">lpars</span><span class="p">[</span><span class="n">npars</span> <span class="o">:=</span> <span class="nb">min</span><span class="p">(</span><span class="n">llpars</span><span class="p">,</span> <span class="n">lrpars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="o">*</span><span class="n">rpars</span><span class="p">[</span><span class="n">npars</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="n">npars</span><span class="p">)</span>
</span><span id="FST.pars-1926"><a href="#FST.pars-1926"><span class="linenos">1926</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.pars-1927"><a href="#FST.pars-1927"><span class="linenos">1927</span></a>            <span class="n">locn</span> <span class="o">=</span> <span class="n">fstlocns</span><span class="p">(</span><span class="o">*</span><span class="n">lpars</span><span class="p">[</span><span class="n">npars</span> <span class="o">:=</span> <span class="n">llpars</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="o">*</span><span class="n">rpars</span><span class="p">[</span><span class="n">npars</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="n">npars</span><span class="p">)</span>
</span><span id="FST.pars-1928"><a href="#FST.pars-1928"><span class="linenos">1928</span></a>
</span><span id="FST.pars-1929"><a href="#FST.pars-1929"><span class="linenos">1929</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">locn</span>
</span><span id="FST.pars-1930"><a href="#FST.pars-1930"><span class="linenos">1930</span></a>
</span><span id="FST.pars-1931"><a href="#FST.pars-1931"><span class="linenos">1931</span></a>        <span class="k">return</span> <span class="n">locn</span>
</span></pre></div>


            <div class="docstring"><p>Return the location of enclosing GROUPING parentheses if present. Will balance parentheses if <code>self</code> is an
element of a tuple and not return the parentheses of the tuple. Likwise will not normally return the parentheses
of an enclosing <code>arguments</code> parent or class bases list (unless <code>shared=None</code>, but that is mostly for internal
use).</p>

<p>Only normally works on (and makes sense for) <code>expr</code> or <code>pattern</code> nodes, otherwise returns <code>self.bloc</code> and count
of 0. Also handles special case of a single generator expression argument to a function sharing parameters with
the call arguments, in which case a count of -1 and the location of the <code>GeneratorExp</code> without its enclosing
parentheses may be returned, if this is enabled with <code>shared=False</code>.</p>

<p>This function is cached so feel free to call as often as is needed.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>shared</code>: If <code>True</code> then will include parentheses of a single call argument generator expression if they are
shared with the call arguments enclosing parentheses with a count of 0. If <code>False</code> then does not return
these and returns a count of -1, and thus the location is not a full valid <code>GeneratorExp</code> location. If
<code>None</code> then returns ANY directly enclosing parentheses, whether they belong to this node or not.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>fstloc | None</code>: Location of enclosing parentheses if present else <code>self.bloc</code> (which can be <code>None</code>). Negative
parentheses count (from shared parens solo call arg generator expression) can also be checked in the case of
<code>shared=False</code> via <code>fst.pars() &gt; fst.bloc</code>. If only loc is returned, it will be an <code>fstloc</code> which will
still have the count of parentheses in an attribute <code>.n</code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(i)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;((i))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(1, 2)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span>  <span class="c1"># tuple pars are not considered grouping pars</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;((1, 2))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(a)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span>  <span class="c1"># any node, not just root</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call((a))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(i for i in j)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(i for i in j)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pars</span><span class="p">(</span><span class="n">shared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># exclude shared pars</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="n">n</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call((i for i in j))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pars</span><span class="p">(</span><span class="n">shared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fstlocns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.par" class="classattr">
                                        <input id="FST.par-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">par</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">whole</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="FST.par-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.par"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.par-1933"><a href="#FST.par-1933"><span class="linenos">1933</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">whole</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="FST.par-1934"><a href="#FST.par-1934"><span class="linenos">1934</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parenthesize node if it MAY need it. Will not parenthesize atoms which are always enclosed like `List`, or</span>
</span><span id="FST.par-1935"><a href="#FST.par-1935"><span class="linenos">1935</span></a><span class="sd">        nodes which are not `is_parenthesizable()`, unless `force=True`. Will add parentheses to unparenthesized `Tuple`</span>
</span><span id="FST.par-1936"><a href="#FST.par-1936"><span class="linenos">1936</span></a><span class="sd">        and brackets to unbracketed `MatchSequence` adjusting the node location. If dealing with a `Starred` then the</span>
</span><span id="FST.par-1937"><a href="#FST.par-1937"><span class="linenos">1937</span></a><span class="sd">        parentheses are applied to the child.</span>
</span><span id="FST.par-1938"><a href="#FST.par-1938"><span class="linenos">1938</span></a>
</span><span id="FST.par-1939"><a href="#FST.par-1939"><span class="linenos">1939</span></a><span class="sd">        **WARNING!** This function doesn&#39;t do any higher level syntactic validation. So if you parenthesize something</span>
</span><span id="FST.par-1940"><a href="#FST.par-1940"><span class="linenos">1940</span></a><span class="sd">        that shouldn&#39;t be parenthesized, and you wind up poking an eye out, that&#39;s on you.</span>
</span><span id="FST.par-1941"><a href="#FST.par-1941"><span class="linenos">1941</span></a>
</span><span id="FST.par-1942"><a href="#FST.par-1942"><span class="linenos">1942</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.par-1943"><a href="#FST.par-1943"><span class="linenos">1943</span></a><span class="sd">        - `force`: If `True` then will add another layer of parentheses regardless if any already present.</span>
</span><span id="FST.par-1944"><a href="#FST.par-1944"><span class="linenos">1944</span></a><span class="sd">        - `whole`: If at root then parenthesize whole source instead of just node, if `False` then only node.</span>
</span><span id="FST.par-1945"><a href="#FST.par-1945"><span class="linenos">1945</span></a>
</span><span id="FST.par-1946"><a href="#FST.par-1946"><span class="linenos">1946</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.par-1947"><a href="#FST.par-1947"><span class="linenos">1947</span></a><span class="sd">        - `self`</span>
</span><span id="FST.par-1948"><a href="#FST.par-1948"><span class="linenos">1948</span></a>
</span><span id="FST.par-1949"><a href="#FST.par-1949"><span class="linenos">1949</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.par-1950"><a href="#FST.par-1950"><span class="linenos">1950</span></a><span class="sd">        ```py</span>
</span><span id="FST.par-1951"><a href="#FST.par-1951"><span class="linenos">1951</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).par().src</span>
</span><span id="FST.par-1952"><a href="#FST.par-1952"><span class="linenos">1952</span></a><span class="sd">        &#39;(a + b)&#39;</span>
</span><span id="FST.par-1953"><a href="#FST.par-1953"><span class="linenos">1953</span></a>
</span><span id="FST.par-1954"><a href="#FST.par-1954"><span class="linenos">1954</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).par().src  # already parenthesized, so nothing done</span>
</span><span id="FST.par-1955"><a href="#FST.par-1955"><span class="linenos">1955</span></a><span class="sd">        &#39;(a + b)&#39;</span>
</span><span id="FST.par-1956"><a href="#FST.par-1956"><span class="linenos">1956</span></a>
</span><span id="FST.par-1957"><a href="#FST.par-1957"><span class="linenos">1957</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).par(force=True).src  # force it</span>
</span><span id="FST.par-1958"><a href="#FST.par-1958"><span class="linenos">1958</span></a><span class="sd">        &#39;((a + b))&#39;</span>
</span><span id="FST.par-1959"><a href="#FST.par-1959"><span class="linenos">1959</span></a>
</span><span id="FST.par-1960"><a href="#FST.par-1960"><span class="linenos">1960</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;).par().src  # parenthesize tuple</span>
</span><span id="FST.par-1961"><a href="#FST.par-1961"><span class="linenos">1961</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="FST.par-1962"><a href="#FST.par-1962"><span class="linenos">1962</span></a>
</span><span id="FST.par-1963"><a href="#FST.par-1963"><span class="linenos">1963</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).par().src  # an atom doesn&#39;t need parentheses</span>
</span><span id="FST.par-1964"><a href="#FST.par-1964"><span class="linenos">1964</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="FST.par-1965"><a href="#FST.par-1965"><span class="linenos">1965</span></a>
</span><span id="FST.par-1966"><a href="#FST.par-1966"><span class="linenos">1966</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).par(force=True).src  # so must be forced</span>
</span><span id="FST.par-1967"><a href="#FST.par-1967"><span class="linenos">1967</span></a><span class="sd">        &#39;(i)&#39;</span>
</span><span id="FST.par-1968"><a href="#FST.par-1968"><span class="linenos">1968</span></a>
</span><span id="FST.par-1969"><a href="#FST.par-1969"><span class="linenos">1969</span></a><span class="sd">        &gt;&gt;&gt; # parethesize MatchSequence puts brackets like ast.unparse()</span>
</span><span id="FST.par-1970"><a href="#FST.par-1970"><span class="linenos">1970</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;, &#39;pattern&#39;).par().src</span>
</span><span id="FST.par-1971"><a href="#FST.par-1971"><span class="linenos">1971</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST.par-1972"><a href="#FST.par-1972"><span class="linenos">1972</span></a>
</span><span id="FST.par-1973"><a href="#FST.par-1973"><span class="linenos">1973</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;*a or b&#39;).par().src  # par() a Starred parenthesizes its child</span>
</span><span id="FST.par-1974"><a href="#FST.par-1974"><span class="linenos">1974</span></a><span class="sd">        &#39;*(a or b)&#39;</span>
</span><span id="FST.par-1975"><a href="#FST.par-1975"><span class="linenos">1975</span></a>
</span><span id="FST.par-1976"><a href="#FST.par-1976"><span class="linenos">1976</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i = 1 + 2)&#39;).keywords[0].value.par().root.src  # not just root node</span>
</span><span id="FST.par-1977"><a href="#FST.par-1977"><span class="linenos">1977</span></a><span class="sd">        &#39;call(i = (1 + 2))&#39;</span>
</span><span id="FST.par-1978"><a href="#FST.par-1978"><span class="linenos">1978</span></a><span class="sd">        ```</span>
</span><span id="FST.par-1979"><a href="#FST.par-1979"><span class="linenos">1979</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.par-1980"><a href="#FST.par-1980"><span class="linenos">1980</span></a>
</span><span id="FST.par-1981"><a href="#FST.par-1981"><span class="linenos">1981</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
</span><span id="FST.par-1982"><a href="#FST.par-1982"><span class="linenos">1982</span></a>            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span> <span class="ow">or</span> <span class="p">(</span><span class="n">is_atom</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atom</span><span class="p">())</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;pars&#39;</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="FST.par-1983"><a href="#FST.par-1983"><span class="linenos">1983</span></a>                <span class="p">(</span><span class="n">is_atom</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">())</span>  <span class="c1"># &#39;unenclosable&#39;</span>
</span><span id="FST.par-1984"><a href="#FST.par-1984"><span class="linenos">1984</span></a>            <span class="p">):</span>
</span><span id="FST.par-1985"><a href="#FST.par-1985"><span class="linenos">1985</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.par-1986"><a href="#FST.par-1986"><span class="linenos">1986</span></a>
</span><span id="FST.par-1987"><a href="#FST.par-1987"><span class="linenos">1987</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">():</span>
</span><span id="FST.par-1988"><a href="#FST.par-1988"><span class="linenos">1988</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">):</span>
</span><span id="FST.par-1989"><a href="#FST.par-1989"><span class="linenos">1989</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_node</span><span class="p">(</span><span class="n">whole</span><span class="p">)</span>
</span><span id="FST.par-1990"><a href="#FST.par-1990"><span class="linenos">1990</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="FST.par-1991"><a href="#FST.par-1991"><span class="linenos">1991</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_node</span><span class="p">(</span><span class="n">whole</span><span class="p">,</span> <span class="s1">&#39;[]&#39;</span><span class="p">)</span>
</span><span id="FST.par-1992"><a href="#FST.par-1992"><span class="linenos">1992</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.par-1993"><a href="#FST.par-1993"><span class="linenos">1993</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_parenthesize_grouping</span><span class="p">(</span><span class="n">whole</span><span class="p">)</span>
</span><span id="FST.par-1994"><a href="#FST.par-1994"><span class="linenos">1994</span></a>
</span><span id="FST.par-1995"><a href="#FST.par-1995"><span class="linenos">1995</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Parenthesize node if it MAY need it. Will not parenthesize atoms which are always enclosed like <code>List</code>, or
nodes which are not <code><a href="#FST.is_parenthesizable">is_parenthesizable()</a></code>, unless <code>force=True</code>. Will add parentheses to unparenthesized <code>Tuple</code>
and brackets to unbracketed <code>MatchSequence</code> adjusting the node location. If dealing with a <code>Starred</code> then the
parentheses are applied to the child.</p>

<p><strong>WARNING!</strong> This function doesn't do any higher level syntactic validation. So if you parenthesize something
that shouldn't be parenthesized, and you wind up poking an eye out, that's on you.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>force</code>: If <code>True</code> then will add another layer of parentheses regardless if any already present.</li>
<li><code>whole</code>: If at root then parenthesize whole source instead of just node, if <code>False</code> then only node.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>self</code></li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a + b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">par</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;(a + b)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a + b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">par</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># already parenthesized, so nothing done</span>
<span class="s1">&#39;(a + b)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a + b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">par</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># force it</span>
<span class="s1">&#39;((a + b))&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;1, 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">par</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># parenthesize tuple</span>
<span class="s1">&#39;(1, 2)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">par</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># an atom doesn&#39;t need parentheses</span>
<span class="s1">&#39;i&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">par</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># so must be forced</span>
<span class="s1">&#39;(i)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="c1"># parethesize MatchSequence puts brackets like ast.unparse()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;1, 2&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">par</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;*a or b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">par</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># par() a Starred parenthesizes its child</span>
<span class="s1">&#39;*(a or b)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(i = 1 + 2)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">par</span><span class="p">()</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># not just root node</span>
<span class="s1">&#39;call(i = (1 + 2))&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.unpar" class="classattr">
                                        <input id="FST.unpar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">unpar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">intrinsic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">shared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="FST.unpar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.unpar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.unpar-1997"><a href="#FST.unpar-1997"><span class="linenos">1997</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">unpar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intrinsic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">shared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="FST.unpar-1998"><a href="#FST.unpar-1998"><span class="linenos">1998</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove all parentheses from node if present. Normally removes just grouping parentheses but can also remove</span>
</span><span id="FST.unpar-1999"><a href="#FST.unpar-1999"><span class="linenos">1999</span></a><span class="sd">        `Tuple` parentheses and `MatchSequence` parentheses or brackets if `intrinsic=True`. If dealing with a `Starred`</span>
</span><span id="FST.unpar-2000"><a href="#FST.unpar-2000"><span class="linenos">2000</span></a><span class="sd">        then the parentheses are checked in and removed from the child. If `shared=None` then will also remove</span>
</span><span id="FST.unpar-2001"><a href="#FST.unpar-2001"><span class="linenos">2001</span></a><span class="sd">        parentheses which do not belong to this node but enclose it directly.</span>
</span><span id="FST.unpar-2002"><a href="#FST.unpar-2002"><span class="linenos">2002</span></a>
</span><span id="FST.unpar-2003"><a href="#FST.unpar-2003"><span class="linenos">2003</span></a><span class="sd">        **WARNING!** This function doesn&#39;t do any higher level syntactic validation. So if you unparenthesize something</span>
</span><span id="FST.unpar-2004"><a href="#FST.unpar-2004"><span class="linenos">2004</span></a><span class="sd">        that shouldn&#39;t be unparenthesized, and you wind up poking an eye out, that&#39;s on you.</span>
</span><span id="FST.unpar-2005"><a href="#FST.unpar-2005"><span class="linenos">2005</span></a>
</span><span id="FST.unpar-2006"><a href="#FST.unpar-2006"><span class="linenos">2006</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.unpar-2007"><a href="#FST.unpar-2007"><span class="linenos">2007</span></a><span class="sd">        - `intrinsic`: If `True` then will remove parentheses from a parenthesized `Tuple` and parentheses / brackets</span>
</span><span id="FST.unpar-2008"><a href="#FST.unpar-2008"><span class="linenos">2008</span></a><span class="sd">            from parenthesized / bracketed `MatchSequence`, otherwise only removes grouping parentheses if present.</span>
</span><span id="FST.unpar-2009"><a href="#FST.unpar-2009"><span class="linenos">2009</span></a><span class="sd">        - `shared`: Whether to allow merge of parentheses of single call argument generator expression with `Call`</span>
</span><span id="FST.unpar-2010"><a href="#FST.unpar-2010"><span class="linenos">2010</span></a><span class="sd">            parentheses or not. If `None` then will attempt to unparenthesize any enclosing parentheses, whether they</span>
</span><span id="FST.unpar-2011"><a href="#FST.unpar-2011"><span class="linenos">2011</span></a><span class="sd">            belong to this node or not (meant for internal use).</span>
</span><span id="FST.unpar-2012"><a href="#FST.unpar-2012"><span class="linenos">2012</span></a>
</span><span id="FST.unpar-2013"><a href="#FST.unpar-2013"><span class="linenos">2013</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.unpar-2014"><a href="#FST.unpar-2014"><span class="linenos">2014</span></a><span class="sd">        - `self`</span>
</span><span id="FST.unpar-2015"><a href="#FST.unpar-2015"><span class="linenos">2015</span></a>
</span><span id="FST.unpar-2016"><a href="#FST.unpar-2016"><span class="linenos">2016</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.unpar-2017"><a href="#FST.unpar-2017"><span class="linenos">2017</span></a><span class="sd">        ```py</span>
</span><span id="FST.unpar-2018"><a href="#FST.unpar-2018"><span class="linenos">2018</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).unpar().src  # nothing done if no pars</span>
</span><span id="FST.unpar-2019"><a href="#FST.unpar-2019"><span class="linenos">2019</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="FST.unpar-2020"><a href="#FST.unpar-2020"><span class="linenos">2020</span></a>
</span><span id="FST.unpar-2021"><a href="#FST.unpar-2021"><span class="linenos">2021</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).unpar().src</span>
</span><span id="FST.unpar-2022"><a href="#FST.unpar-2022"><span class="linenos">2022</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="FST.unpar-2023"><a href="#FST.unpar-2023"><span class="linenos">2023</span></a>
</span><span id="FST.unpar-2024"><a href="#FST.unpar-2024"><span class="linenos">2024</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;((a + b))&#39;).unpar().src  # removes all</span>
</span><span id="FST.unpar-2025"><a href="#FST.unpar-2025"><span class="linenos">2025</span></a><span class="sd">        &#39;a + b&#39;</span>
</span><span id="FST.unpar-2026"><a href="#FST.unpar-2026"><span class="linenos">2026</span></a>
</span><span id="FST.unpar-2027"><a href="#FST.unpar-2027"><span class="linenos">2027</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).unpar().src  # but not from tuple</span>
</span><span id="FST.unpar-2028"><a href="#FST.unpar-2028"><span class="linenos">2028</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="FST.unpar-2029"><a href="#FST.unpar-2029"><span class="linenos">2029</span></a>
</span><span id="FST.unpar-2030"><a href="#FST.unpar-2030"><span class="linenos">2030</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).unpar(intrinsic=True).src  # unless explicitly specified</span>
</span><span id="FST.unpar-2031"><a href="#FST.unpar-2031"><span class="linenos">2031</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="FST.unpar-2032"><a href="#FST.unpar-2032"><span class="linenos">2032</span></a>
</span><span id="FST.unpar-2033"><a href="#FST.unpar-2033"><span class="linenos">2033</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(((1, 2)))&#39;).unpar().src</span>
</span><span id="FST.unpar-2034"><a href="#FST.unpar-2034"><span class="linenos">2034</span></a><span class="sd">        &#39;(1, 2)&#39;</span>
</span><span id="FST.unpar-2035"><a href="#FST.unpar-2035"><span class="linenos">2035</span></a>
</span><span id="FST.unpar-2036"><a href="#FST.unpar-2036"><span class="linenos">2036</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(((1, 2)))&#39;).unpar(intrinsic=True).src</span>
</span><span id="FST.unpar-2037"><a href="#FST.unpar-2037"><span class="linenos">2037</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="FST.unpar-2038"><a href="#FST.unpar-2038"><span class="linenos">2038</span></a>
</span><span id="FST.unpar-2039"><a href="#FST.unpar-2039"><span class="linenos">2039</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1, 2]&#39;, &#39;pattern&#39;).unpar().src</span>
</span><span id="FST.unpar-2040"><a href="#FST.unpar-2040"><span class="linenos">2040</span></a><span class="sd">        &#39;[1, 2]&#39;</span>
</span><span id="FST.unpar-2041"><a href="#FST.unpar-2041"><span class="linenos">2041</span></a>
</span><span id="FST.unpar-2042"><a href="#FST.unpar-2042"><span class="linenos">2042</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1, 2]&#39;, &#39;pattern&#39;).unpar(intrinsic=True).src</span>
</span><span id="FST.unpar-2043"><a href="#FST.unpar-2043"><span class="linenos">2043</span></a><span class="sd">        &#39;1, 2&#39;</span>
</span><span id="FST.unpar-2044"><a href="#FST.unpar-2044"><span class="linenos">2044</span></a>
</span><span id="FST.unpar-2045"><a href="#FST.unpar-2045"><span class="linenos">2045</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;*(a or b)&#39;).unpar().src  # unpar() a Starred unparenthesizes its child</span>
</span><span id="FST.unpar-2046"><a href="#FST.unpar-2046"><span class="linenos">2046</span></a><span class="sd">        &#39;*a or b&#39;</span>
</span><span id="FST.unpar-2047"><a href="#FST.unpar-2047"><span class="linenos">2047</span></a>
</span><span id="FST.unpar-2048"><a href="#FST.unpar-2048"><span class="linenos">2048</span></a><span class="sd">        &gt;&gt;&gt; # not just root node</span>
</span><span id="FST.unpar-2049"><a href="#FST.unpar-2049"><span class="linenos">2049</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i = (1 + 2))&#39;).keywords[0].value.unpar().root.src</span>
</span><span id="FST.unpar-2050"><a href="#FST.unpar-2050"><span class="linenos">2050</span></a><span class="sd">        &#39;call(i = 1 + 2)&#39;</span>
</span><span id="FST.unpar-2051"><a href="#FST.unpar-2051"><span class="linenos">2051</span></a>
</span><span id="FST.unpar-2052"><a href="#FST.unpar-2052"><span class="linenos">2052</span></a><span class="sd">        &gt;&gt;&gt; # by default allows sharing</span>
</span><span id="FST.unpar-2053"><a href="#FST.unpar-2053"><span class="linenos">2053</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(((i for i in j)))&#39;).args[0].unpar().root.src</span>
</span><span id="FST.unpar-2054"><a href="#FST.unpar-2054"><span class="linenos">2054</span></a><span class="sd">        &#39;call(i for i in j)&#39;</span>
</span><span id="FST.unpar-2055"><a href="#FST.unpar-2055"><span class="linenos">2055</span></a>
</span><span id="FST.unpar-2056"><a href="#FST.unpar-2056"><span class="linenos">2056</span></a><span class="sd">        &gt;&gt;&gt; # unless told not to</span>
</span><span id="FST.unpar-2057"><a href="#FST.unpar-2057"><span class="linenos">2057</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(((i for i in j)))&#39;).args[0].unpar(shared=False).root.src</span>
</span><span id="FST.unpar-2058"><a href="#FST.unpar-2058"><span class="linenos">2058</span></a><span class="sd">        &#39;call((i for i in j))&#39;</span>
</span><span id="FST.unpar-2059"><a href="#FST.unpar-2059"><span class="linenos">2059</span></a><span class="sd">        ```</span>
</span><span id="FST.unpar-2060"><a href="#FST.unpar-2060"><span class="linenos">2060</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.unpar-2061"><a href="#FST.unpar-2061"><span class="linenos">2061</span></a>
</span><span id="FST.unpar-2062"><a href="#FST.unpar-2062"><span class="linenos">2062</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Starred</span><span class="p">):</span>
</span><span id="FST.unpar-2063"><a href="#FST.unpar-2063"><span class="linenos">2063</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="FST.unpar-2064"><a href="#FST.unpar-2064"><span class="linenos">2064</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">():</span>
</span><span id="FST.unpar-2065"><a href="#FST.unpar-2065"><span class="linenos">2065</span></a>                    <span class="n">value</span><span class="o">.</span><span class="n">_unparenthesize_grouping</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span>
</span><span id="FST.unpar-2066"><a href="#FST.unpar-2066"><span class="linenos">2066</span></a>
</span><span id="FST.unpar-2067"><a href="#FST.unpar-2067"><span class="linenos">2067</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.unpar-2068"><a href="#FST.unpar-2068"><span class="linenos">2068</span></a>
</span><span id="FST.unpar-2069"><a href="#FST.unpar-2069"><span class="linenos">2069</span></a>        <span class="n">modifying</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST.unpar-2070"><a href="#FST.unpar-2070"><span class="linenos">2070</span></a>
</span><span id="FST.unpar-2071"><a href="#FST.unpar-2071"><span class="linenos">2071</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">(</span><span class="kc">None</span> <span class="k">if</span> <span class="n">shared</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="FST.unpar-2072"><a href="#FST.unpar-2072"><span class="linenos">2072</span></a>            <span class="n">modifying</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="FST.unpar-2073"><a href="#FST.unpar-2073"><span class="linenos">2073</span></a>
</span><span id="FST.unpar-2074"><a href="#FST.unpar-2074"><span class="linenos">2074</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_grouping</span><span class="p">(</span><span class="n">shared</span><span class="p">)</span>
</span><span id="FST.unpar-2075"><a href="#FST.unpar-2075"><span class="linenos">2075</span></a>
</span><span id="FST.unpar-2076"><a href="#FST.unpar-2076"><span class="linenos">2076</span></a>        <span class="k">if</span> <span class="n">intrinsic</span><span class="p">:</span>
</span><span id="FST.unpar-2077"><a href="#FST.unpar-2077"><span class="linenos">2077</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">):</span>
</span><span id="FST.unpar-2078"><a href="#FST.unpar-2078"><span class="linenos">2078</span></a>                <span class="n">modifying</span> <span class="o">=</span> <span class="n">modifying</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="FST.unpar-2079"><a href="#FST.unpar-2079"><span class="linenos">2079</span></a>
</span><span id="FST.unpar-2080"><a href="#FST.unpar-2080"><span class="linenos">2080</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_node</span><span class="p">()</span>  <span class="c1"># ret = self._unparenthesize_node() or ret</span>
</span><span id="FST.unpar-2081"><a href="#FST.unpar-2081"><span class="linenos">2081</span></a>
</span><span id="FST.unpar-2082"><a href="#FST.unpar-2082"><span class="linenos">2082</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="FST.unpar-2083"><a href="#FST.unpar-2083"><span class="linenos">2083</span></a>                <span class="n">modifying</span> <span class="o">=</span> <span class="n">modifying</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modifying</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">()</span>
</span><span id="FST.unpar-2084"><a href="#FST.unpar-2084"><span class="linenos">2084</span></a>
</span><span id="FST.unpar-2085"><a href="#FST.unpar-2085"><span class="linenos">2085</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_unparenthesize_node</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">)</span>  <span class="c1"># ret = self._unparenthesize_node() or ret</span>
</span><span id="FST.unpar-2086"><a href="#FST.unpar-2086"><span class="linenos">2086</span></a>
</span><span id="FST.unpar-2087"><a href="#FST.unpar-2087"><span class="linenos">2087</span></a>        <span class="k">if</span> <span class="n">modifying</span><span class="p">:</span>
</span><span id="FST.unpar-2088"><a href="#FST.unpar-2088"><span class="linenos">2088</span></a>            <span class="n">modifying</span><span class="o">.</span><span class="n">done</span><span class="p">()</span>
</span><span id="FST.unpar-2089"><a href="#FST.unpar-2089"><span class="linenos">2089</span></a>
</span><span id="FST.unpar-2090"><a href="#FST.unpar-2090"><span class="linenos">2090</span></a>        <span class="k">return</span> <span class="bp">self</span>  <span class="c1"># ret</span>
</span></pre></div>


            <div class="docstring"><p>Remove all parentheses from node if present. Normally removes just grouping parentheses but can also remove
<code>Tuple</code> parentheses and <code>MatchSequence</code> parentheses or brackets if <code>intrinsic=True</code>. If dealing with a <code>Starred</code>
then the parentheses are checked in and removed from the child. If <code>shared=None</code> then will also remove
parentheses which do not belong to this node but enclose it directly.</p>

<p><strong>WARNING!</strong> This function doesn't do any higher level syntactic validation. So if you unparenthesize something
that shouldn't be unparenthesized, and you wind up poking an eye out, that's on you.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>intrinsic</code>: If <code>True</code> then will remove parentheses from a parenthesized <code>Tuple</code> and parentheses / brackets
from parenthesized / bracketed <code>MatchSequence</code>, otherwise only removes grouping parentheses if present.</li>
<li><code>shared</code>: Whether to allow merge of parentheses of single call argument generator expression with <code>Call</code>
parentheses or not. If <code>None</code> then will attempt to unparenthesize any enclosing parentheses, whether they
belong to this node or not (meant for internal use).</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>self</code></li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a + b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># nothing done if no pars</span>
<span class="s1">&#39;a + b&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a + b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;a + b&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;((a + b))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># removes all</span>
<span class="s1">&#39;a + b&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(1, 2)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># but not from tuple</span>
<span class="s1">&#39;(1, 2)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(1, 2)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">(</span><span class="n">intrinsic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># unless explicitly specified</span>
<span class="s1">&#39;1, 2&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(((1, 2)))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;(1, 2)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(((1, 2)))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">(</span><span class="n">intrinsic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;1, 2&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[1, 2]&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[1, 2]&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">(</span><span class="n">intrinsic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;1, 2&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;*(a or b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>  <span class="c1"># unpar() a Starred unparenthesizes its child</span>
<span class="s1">&#39;*a or b&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="c1"># not just root node</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(i = (1 + 2))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;call(i = 1 + 2)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="c1"># by default allows sharing</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(((i for i in j)))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unpar</span><span class="p">()</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;call(i for i in j)&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="c1"># unless told not to</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(((i for i in j)))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unpar</span><span class="p">(</span><span class="n">shared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;call((i for i in j))&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.next" class="classattr">
                                        <input id="FST.next-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.next-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.next"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.next-87"><a href="#FST.next-87"><span class="linenos"> 87</span></a><span class="k">def</span><span class="w"> </span><span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># TODO: refactor</span>
</span><span id="FST.next-88"><a href="#FST.next-88"><span class="linenos"> 88</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get next sibling of `self` in syntactic order, only within parent.</span>
</span><span id="FST.next-89"><a href="#FST.next-89"><span class="linenos"> 89</span></a>
</span><span id="FST.next-90"><a href="#FST.next-90"><span class="linenos"> 90</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.next-91"><a href="#FST.next-91"><span class="linenos"> 91</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.next-92"><a href="#FST.next-92"><span class="linenos"> 92</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.next-93"><a href="#FST.next-93"><span class="linenos"> 93</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.next-94"><a href="#FST.next-94"><span class="linenos"> 94</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.next-95"><a href="#FST.next-95"><span class="linenos"> 95</span></a><span class="sd">            present).</span>
</span><span id="FST.next-96"><a href="#FST.next-96"><span class="linenos"> 96</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.next-97"><a href="#FST.next-97"><span class="linenos"> 97</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.next-98"><a href="#FST.next-98"><span class="linenos"> 98</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.next-99"><a href="#FST.next-99"><span class="linenos"> 99</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.next-100"><a href="#FST.next-100"><span class="linenos">100</span></a>
</span><span id="FST.next-101"><a href="#FST.next-101"><span class="linenos">101</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.next-102"><a href="#FST.next-102"><span class="linenos">102</span></a><span class="sd">    - `None` if last valid sibling in parent, otherwise next node.</span>
</span><span id="FST.next-103"><a href="#FST.next-103"><span class="linenos">103</span></a>
</span><span id="FST.next-104"><a href="#FST.next-104"><span class="linenos">104</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.next-105"><a href="#FST.next-105"><span class="linenos">105</span></a><span class="sd">    ```py</span>
</span><span id="FST.next-106"><a href="#FST.next-106"><span class="linenos">106</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.next-107"><a href="#FST.next-107"><span class="linenos">107</span></a>
</span><span id="FST.next-108"><a href="#FST.next-108"><span class="linenos">108</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[[1, 2], [3, 4]]&#39;)</span>
</span><span id="FST.next-109"><a href="#FST.next-109"><span class="linenos">109</span></a><span class="sd">    &gt;&gt;&gt; f.elts[0].next().src</span>
</span><span id="FST.next-110"><a href="#FST.next-110"><span class="linenos">110</span></a><span class="sd">    &#39;[3, 4]&#39;</span>
</span><span id="FST.next-111"><a href="#FST.next-111"><span class="linenos">111</span></a>
</span><span id="FST.next-112"><a href="#FST.next-112"><span class="linenos">112</span></a><span class="sd">    &gt;&gt;&gt; print(f.elts[1].next())</span>
</span><span id="FST.next-113"><a href="#FST.next-113"><span class="linenos">113</span></a><span class="sd">    None</span>
</span><span id="FST.next-114"><a href="#FST.next-114"><span class="linenos">114</span></a><span class="sd">    ```</span>
</span><span id="FST.next-115"><a href="#FST.next-115"><span class="linenos">115</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.next-116"><a href="#FST.next-116"><span class="linenos">116</span></a>
</span><span id="FST.next-117"><a href="#FST.next-117"><span class="linenos">117</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST.next-118"><a href="#FST.next-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-119"><a href="#FST.next-119"><span class="linenos">119</span></a>
</span><span id="FST.next-120"><a href="#FST.next-120"><span class="linenos">120</span></a>    <span class="n">aparent</span>   <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.next-121"><a href="#FST.next-121"><span class="linenos">121</span></a>    <span class="n">name</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span>
</span><span id="FST.next-122"><a href="#FST.next-122"><span class="linenos">122</span></a>
</span><span id="FST.next-123"><a href="#FST.next-123"><span class="linenos">123</span></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.next-124"><a href="#FST.next-124"><span class="linenos">124</span></a>        <span class="nb">next</span> <span class="o">=</span> <span class="n">_AST_FIELDS_NEXT</span><span class="p">[(</span><span class="n">aparent</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="FST.next-125"><a href="#FST.next-125"><span class="linenos">125</span></a>
</span><span id="FST.next-126"><a href="#FST.next-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">next</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># special case?</span>
</span><span id="FST.next-127"><a href="#FST.next-127"><span class="linenos">127</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.next-128"><a href="#FST.next-128"><span class="linenos">128</span></a>                <span class="k">match</span> <span class="nb">next</span><span class="p">:</span>
</span><span id="FST.next-129"><a href="#FST.next-129"><span class="linenos">129</span></a>                    <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># from Dict.keys</span>
</span><span id="FST.next-130"><a href="#FST.next-130"><span class="linenos">130</span></a>                        <span class="nb">next</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="FST.next-131"><a href="#FST.next-131"><span class="linenos">131</span></a>                        <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.next-132"><a href="#FST.next-132"><span class="linenos">132</span></a>
</span><span id="FST.next-133"><a href="#FST.next-133"><span class="linenos">133</span></a>                    <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># from Dict.values</span>
</span><span id="FST.next-134"><a href="#FST.next-134"><span class="linenos">134</span></a>                        <span class="nb">next</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FST.next-135"><a href="#FST.next-135"><span class="linenos">135</span></a>
</span><span id="FST.next-136"><a href="#FST.next-136"><span class="linenos">136</span></a>                        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-137"><a href="#FST.next-137"><span class="linenos">137</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">keys</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]):</span>
</span><span id="FST.next-138"><a href="#FST.next-138"><span class="linenos">138</span></a>                                <span class="k">continue</span>
</span><span id="FST.next-139"><a href="#FST.next-139"><span class="linenos">139</span></a>                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-140"><a href="#FST.next-140"><span class="linenos">140</span></a>                            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-141"><a href="#FST.next-141"><span class="linenos">141</span></a>
</span><span id="FST.next-142"><a href="#FST.next-142"><span class="linenos">142</span></a>                    <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># from Compare.ops</span>
</span><span id="FST.next-143"><a href="#FST.next-143"><span class="linenos">143</span></a>                        <span class="nb">next</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="FST.next-144"><a href="#FST.next-144"><span class="linenos">144</span></a>                        <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">comparators</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.next-145"><a href="#FST.next-145"><span class="linenos">145</span></a>
</span><span id="FST.next-146"><a href="#FST.next-146"><span class="linenos">146</span></a>                    <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>  <span class="c1"># all the logic for Call.args and Call.keywords</span>
</span><span id="FST.next-147"><a href="#FST.next-147"><span class="linenos">147</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">keywords</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">keywords</span><span class="p">):</span>  <span class="c1"># no keywords</span>
</span><span id="FST.next-148"><a href="#FST.next-148"><span class="linenos">148</span></a>                            <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-149"><a href="#FST.next-149"><span class="linenos">149</span></a>                                <span class="n">a</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-150"><a href="#FST.next-150"><span class="linenos">150</span></a>                            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-151"><a href="#FST.next-151"><span class="linenos">151</span></a>                                <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-152"><a href="#FST.next-152"><span class="linenos">152</span></a>
</span><span id="FST.next-153"><a href="#FST.next-153"><span class="linenos">153</span></a>                        <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">args</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>  <span class="c1"># no args</span>
</span><span id="FST.next-154"><a href="#FST.next-154"><span class="linenos">154</span></a>                            <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-155"><a href="#FST.next-155"><span class="linenos">155</span></a>                                <span class="n">a</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-156"><a href="#FST.next-156"><span class="linenos">156</span></a>                            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-157"><a href="#FST.next-157"><span class="linenos">157</span></a>                                <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-158"><a href="#FST.next-158"><span class="linenos">158</span></a>
</span><span id="FST.next-159"><a href="#FST.next-159"><span class="linenos">159</span></a>                        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">star</span> <span class="o">:=</span> <span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Starred</span><span class="p">):</span>  <span class="c1"># both args and keywords but no Starred</span>
</span><span id="FST.next-160"><a href="#FST.next-160"><span class="linenos">160</span></a>                            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span>
</span><span id="FST.next-161"><a href="#FST.next-161"><span class="linenos">161</span></a>                                <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-162"><a href="#FST.next-162"><span class="linenos">162</span></a>                                    <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-163"><a href="#FST.next-163"><span class="linenos">163</span></a>
</span><span id="FST.next-164"><a href="#FST.next-164"><span class="linenos">164</span></a>                                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-165"><a href="#FST.next-165"><span class="linenos">165</span></a>                                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;keywords&#39;</span>
</span><span id="FST.next-166"><a href="#FST.next-166"><span class="linenos">166</span></a>                                    <span class="n">a</span>    <span class="o">=</span> <span class="n">keywords</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">)]</span>
</span><span id="FST.next-167"><a href="#FST.next-167"><span class="linenos">167</span></a>
</span><span id="FST.next-168"><a href="#FST.next-168"><span class="linenos">168</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-169"><a href="#FST.next-169"><span class="linenos">169</span></a>                                <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-170"><a href="#FST.next-170"><span class="linenos">170</span></a>                                    <span class="n">a</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-171"><a href="#FST.next-171"><span class="linenos">171</span></a>                                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-172"><a href="#FST.next-172"><span class="linenos">172</span></a>                                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-173"><a href="#FST.next-173"><span class="linenos">173</span></a>
</span><span id="FST.next-174"><a href="#FST.next-174"><span class="linenos">174</span></a>                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># args, keywords AND Starred</span>
</span><span id="FST.next-175"><a href="#FST.next-175"><span class="linenos">175</span></a>                            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span>
</span><span id="FST.next-176"><a href="#FST.next-176"><span class="linenos">176</span></a>                                <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-177"><a href="#FST.next-177"><span class="linenos">177</span></a>                                    <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-178"><a href="#FST.next-178"><span class="linenos">178</span></a>
</span><span id="FST.next-179"><a href="#FST.next-179"><span class="linenos">179</span></a>                                    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="ow">is</span> <span class="n">star</span> <span class="ow">and</span> <span class="p">((</span><span class="n">kw</span> <span class="o">:=</span> <span class="n">keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">kw</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&lt;</span>
</span><span id="FST.next-180"><a href="#FST.next-180"><span class="linenos">180</span></a>                                        <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span>
</span><span id="FST.next-181"><a href="#FST.next-181"><span class="linenos">181</span></a>                                    <span class="p">):</span>  <span class="c1"># reached star and there is a keyword before it</span>
</span><span id="FST.next-182"><a href="#FST.next-182"><span class="linenos">182</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;keywords&#39;</span>
</span><span id="FST.next-183"><a href="#FST.next-183"><span class="linenos">183</span></a>                                        <span class="n">idx</span>  <span class="o">=</span> <span class="mi">0</span>
</span><span id="FST.next-184"><a href="#FST.next-184"><span class="linenos">184</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">kw</span>
</span><span id="FST.next-185"><a href="#FST.next-185"><span class="linenos">185</span></a>
</span><span id="FST.next-186"><a href="#FST.next-186"><span class="linenos">186</span></a>                                        <span class="k">break</span>
</span><span id="FST.next-187"><a href="#FST.next-187"><span class="linenos">187</span></a>
</span><span id="FST.next-188"><a href="#FST.next-188"><span class="linenos">188</span></a>                                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>  <span class="c1"># ran off the end of args, past star, find first kw after it (if any)</span>
</span><span id="FST.next-189"><a href="#FST.next-189"><span class="linenos">189</span></a>                                    <span class="n">star_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span>
</span><span id="FST.next-190"><a href="#FST.next-190"><span class="linenos">190</span></a>
</span><span id="FST.next-191"><a href="#FST.next-191"><span class="linenos">191</span></a>                                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>
</span><span id="FST.next-192"><a href="#FST.next-192"><span class="linenos">192</span></a>                                        <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">star_pos</span><span class="p">:</span>
</span><span id="FST.next-193"><a href="#FST.next-193"><span class="linenos">193</span></a>                                            <span class="k">break</span>
</span><span id="FST.next-194"><a href="#FST.next-194"><span class="linenos">194</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-195"><a href="#FST.next-195"><span class="linenos">195</span></a>                                        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-196"><a href="#FST.next-196"><span class="linenos">196</span></a>
</span><span id="FST.next-197"><a href="#FST.next-197"><span class="linenos">197</span></a>                            <span class="k">else</span><span class="p">:</span>  <span class="c1"># name == &#39;keywords&#39;</span>
</span><span id="FST.next-198"><a href="#FST.next-198"><span class="linenos">198</span></a>                                <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-199"><a href="#FST.next-199"><span class="linenos">199</span></a>                                    <span class="n">a</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-200"><a href="#FST.next-200"><span class="linenos">200</span></a>
</span><span id="FST.next-201"><a href="#FST.next-201"><span class="linenos">201</span></a>                                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>  <span class="c1"># ran off the end of keywords, now need to check if star lives here</span>
</span><span id="FST.next-202"><a href="#FST.next-202"><span class="linenos">202</span></a>                                    <span class="k">if</span> <span class="p">((</span><span class="n">sa</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">col_offset</span><span class="p">):</span>
</span><span id="FST.next-203"><a href="#FST.next-203"><span class="linenos">203</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.next-204"><a href="#FST.next-204"><span class="linenos">204</span></a>                                        <span class="n">idx</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="FST.next-205"><a href="#FST.next-205"><span class="linenos">205</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">star</span>
</span><span id="FST.next-206"><a href="#FST.next-206"><span class="linenos">206</span></a>
</span><span id="FST.next-207"><a href="#FST.next-207"><span class="linenos">207</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-208"><a href="#FST.next-208"><span class="linenos">208</span></a>                                        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-209"><a href="#FST.next-209"><span class="linenos">209</span></a>
</span><span id="FST.next-210"><a href="#FST.next-210"><span class="linenos">210</span></a>                                <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-211"><a href="#FST.next-211"><span class="linenos">211</span></a>                                    <span class="n">star_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span>
</span><span id="FST.next-212"><a href="#FST.next-212"><span class="linenos">212</span></a>
</span><span id="FST.next-213"><a href="#FST.next-213"><span class="linenos">213</span></a>                                    <span class="k">if</span> <span class="p">(((</span><span class="n">sa</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">star_pos</span> <span class="ow">and</span>
</span><span id="FST.next-214"><a href="#FST.next-214"><span class="linenos">214</span></a>                                        <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">star_pos</span>
</span><span id="FST.next-215"><a href="#FST.next-215"><span class="linenos">215</span></a>                                    <span class="p">):</span>  <span class="c1"># crossed star, jump back to it</span>
</span><span id="FST.next-216"><a href="#FST.next-216"><span class="linenos">216</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.next-217"><a href="#FST.next-217"><span class="linenos">217</span></a>                                        <span class="n">idx</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="FST.next-218"><a href="#FST.next-218"><span class="linenos">218</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">star</span>
</span><span id="FST.next-219"><a href="#FST.next-219"><span class="linenos">219</span></a>
</span><span id="FST.next-220"><a href="#FST.next-220"><span class="linenos">220</span></a>                    <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># from Compare.comparators or Compare.left (via comparators)</span>
</span><span id="FST.next-221"><a href="#FST.next-221"><span class="linenos">221</span></a>                        <span class="nb">next</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="FST.next-222"><a href="#FST.next-222"><span class="linenos">222</span></a>
</span><span id="FST.next-223"><a href="#FST.next-223"><span class="linenos">223</span></a>                        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-224"><a href="#FST.next-224"><span class="linenos">224</span></a>                            <span class="n">a</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">ops</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-225"><a href="#FST.next-225"><span class="linenos">225</span></a>                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-226"><a href="#FST.next-226"><span class="linenos">226</span></a>                            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-227"><a href="#FST.next-227"><span class="linenos">227</span></a>
</span><span id="FST.next-228"><a href="#FST.next-228"><span class="linenos">228</span></a>                    <span class="k">case</span> <span class="mi">7</span><span class="p">:</span>  <span class="c1"># all the logic arguments</span>
</span><span id="FST.next-229"><a href="#FST.next-229"><span class="linenos">229</span></a>                        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.next-230"><a href="#FST.next-230"><span class="linenos">230</span></a>                            <span class="k">match</span> <span class="n">name</span><span class="p">:</span>
</span><span id="FST.next-231"><a href="#FST.next-231"><span class="linenos">231</span></a>                                <span class="k">case</span> <span class="s1">&#39;posonlyargs&#39;</span><span class="p">:</span>
</span><span id="FST.next-232"><a href="#FST.next-232"><span class="linenos">232</span></a>                                    <span class="n">posonlyargs</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">posonlyargs</span>
</span><span id="FST.next-233"><a href="#FST.next-233"><span class="linenos">233</span></a>                                    <span class="n">defaults</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">defaults</span>
</span><span id="FST.next-234"><a href="#FST.next-234"><span class="linenos">234</span></a>
</span><span id="FST.next-235"><a href="#FST.next-235"><span class="linenos">235</span></a>                                    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">defaults</span> <span class="ow">or</span> <span class="p">(</span><span class="n">didx</span> <span class="o">:=</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="p">((</span><span class="n">ldefaults</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">))</span> <span class="o">-</span>
</span><span id="FST.next-236"><a href="#FST.next-236"><span class="linenos">236</span></a>                                        <span class="nb">len</span><span class="p">(</span><span class="n">args</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">posonlyargs</span><span class="p">))))</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">didx</span> <span class="o">&gt;=</span> <span class="n">ldefaults</span>
</span><span id="FST.next-237"><a href="#FST.next-237"><span class="linenos">237</span></a>                                    <span class="p">):</span>
</span><span id="FST.next-238"><a href="#FST.next-238"><span class="linenos">238</span></a>                                        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-239"><a href="#FST.next-239"><span class="linenos">239</span></a>                                            <span class="n">a</span> <span class="o">=</span> <span class="n">posonlyargs</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-240"><a href="#FST.next-240"><span class="linenos">240</span></a>
</span><span id="FST.next-241"><a href="#FST.next-241"><span class="linenos">241</span></a>                                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-242"><a href="#FST.next-242"><span class="linenos">242</span></a>                                            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.next-243"><a href="#FST.next-243"><span class="linenos">243</span></a>                                            <span class="n">idx</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="FST.next-244"><a href="#FST.next-244"><span class="linenos">244</span></a>
</span><span id="FST.next-245"><a href="#FST.next-245"><span class="linenos">245</span></a>                                            <span class="k">continue</span>
</span><span id="FST.next-246"><a href="#FST.next-246"><span class="linenos">246</span></a>
</span><span id="FST.next-247"><a href="#FST.next-247"><span class="linenos">247</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-248"><a href="#FST.next-248"><span class="linenos">248</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;defaults&#39;</span>
</span><span id="FST.next-249"><a href="#FST.next-249"><span class="linenos">249</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">didx</span><span class="p">]</span>
</span><span id="FST.next-250"><a href="#FST.next-250"><span class="linenos">250</span></a>
</span><span id="FST.next-251"><a href="#FST.next-251"><span class="linenos">251</span></a>                                <span class="k">case</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span>
</span><span id="FST.next-252"><a href="#FST.next-252"><span class="linenos">252</span></a>                                    <span class="n">args</span>     <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span>
</span><span id="FST.next-253"><a href="#FST.next-253"><span class="linenos">253</span></a>                                    <span class="n">defaults</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">defaults</span>
</span><span id="FST.next-254"><a href="#FST.next-254"><span class="linenos">254</span></a>
</span><span id="FST.next-255"><a href="#FST.next-255"><span class="linenos">255</span></a>                                    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">defaults</span> <span class="ow">or</span> <span class="p">(</span><span class="n">didx</span> <span class="o">:=</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="p">((</span><span class="n">ldefaults</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">))</span> <span class="o">-</span>
</span><span id="FST.next-256"><a href="#FST.next-256"><span class="linenos">256</span></a>                                        <span class="nb">len</span><span class="p">(</span><span class="n">args</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">))))</span> <span class="o">&lt;</span> <span class="mi">0</span>  <span class="c1"># or didx &gt;= ldefaults</span>
</span><span id="FST.next-257"><a href="#FST.next-257"><span class="linenos">257</span></a>                                    <span class="p">):</span>
</span><span id="FST.next-258"><a href="#FST.next-258"><span class="linenos">258</span></a>                                        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-259"><a href="#FST.next-259"><span class="linenos">259</span></a>                                            <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-260"><a href="#FST.next-260"><span class="linenos">260</span></a>
</span><span id="FST.next-261"><a href="#FST.next-261"><span class="linenos">261</span></a>                                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-262"><a href="#FST.next-262"><span class="linenos">262</span></a>                                            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;vararg&#39;</span>
</span><span id="FST.next-263"><a href="#FST.next-263"><span class="linenos">263</span></a>
</span><span id="FST.next-264"><a href="#FST.next-264"><span class="linenos">264</span></a>                                            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">vararg</span><span class="p">):</span>
</span><span id="FST.next-265"><a href="#FST.next-265"><span class="linenos">265</span></a>                                                <span class="k">continue</span>
</span><span id="FST.next-266"><a href="#FST.next-266"><span class="linenos">266</span></a>
</span><span id="FST.next-267"><a href="#FST.next-267"><span class="linenos">267</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-268"><a href="#FST.next-268"><span class="linenos">268</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;defaults&#39;</span>
</span><span id="FST.next-269"><a href="#FST.next-269"><span class="linenos">269</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">didx</span><span class="p">]</span>
</span><span id="FST.next-270"><a href="#FST.next-270"><span class="linenos">270</span></a>
</span><span id="FST.next-271"><a href="#FST.next-271"><span class="linenos">271</span></a>                                <span class="k">case</span> <span class="s1">&#39;defaults&#39;</span><span class="p">:</span>
</span><span id="FST.next-272"><a href="#FST.next-272"><span class="linenos">272</span></a>                                    <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="p">(</span><span class="n">ldefaults</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aparent</span><span class="o">.</span><span class="n">defaults</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># end of defaults</span>
</span><span id="FST.next-273"><a href="#FST.next-273"><span class="linenos">273</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;vararg&#39;</span>
</span><span id="FST.next-274"><a href="#FST.next-274"><span class="linenos">274</span></a>
</span><span id="FST.next-275"><a href="#FST.next-275"><span class="linenos">275</span></a>                                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">vararg</span><span class="p">):</span>
</span><span id="FST.next-276"><a href="#FST.next-276"><span class="linenos">276</span></a>                                            <span class="k">continue</span>
</span><span id="FST.next-277"><a href="#FST.next-277"><span class="linenos">277</span></a>
</span><span id="FST.next-278"><a href="#FST.next-278"><span class="linenos">278</span></a>                                    <span class="k">elif</span> <span class="p">(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="n">ldefaults</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FST.next-279"><a href="#FST.next-279"><span class="linenos">279</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.next-280"><a href="#FST.next-280"><span class="linenos">280</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.next-281"><a href="#FST.next-281"><span class="linenos">281</span></a>
</span><span id="FST.next-282"><a href="#FST.next-282"><span class="linenos">282</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-283"><a href="#FST.next-283"><span class="linenos">283</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;posonlyargs&#39;</span>
</span><span id="FST.next-284"><a href="#FST.next-284"><span class="linenos">284</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="p">(</span><span class="n">posonlyargs</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">posonlyargs</span><span class="p">)[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">posonlyargs</span><span class="p">))]</span>
</span><span id="FST.next-285"><a href="#FST.next-285"><span class="linenos">285</span></a>
</span><span id="FST.next-286"><a href="#FST.next-286"><span class="linenos">286</span></a>                                <span class="k">case</span> <span class="s1">&#39;vararg&#39;</span><span class="p">:</span>
</span><span id="FST.next-287"><a href="#FST.next-287"><span class="linenos">287</span></a>                                    <span class="k">if</span> <span class="n">kwonlyargs</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwonlyargs</span><span class="p">:</span>
</span><span id="FST.next-288"><a href="#FST.next-288"><span class="linenos">288</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kwonlyargs&#39;</span>
</span><span id="FST.next-289"><a href="#FST.next-289"><span class="linenos">289</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">kwonlyargs</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">)]</span>
</span><span id="FST.next-290"><a href="#FST.next-290"><span class="linenos">290</span></a>
</span><span id="FST.next-291"><a href="#FST.next-291"><span class="linenos">291</span></a>                                    <span class="k">elif</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwarg</span><span class="p">:</span>
</span><span id="FST.next-292"><a href="#FST.next-292"><span class="linenos">292</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kwarg&#39;</span>
</span><span id="FST.next-293"><a href="#FST.next-293"><span class="linenos">293</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-294"><a href="#FST.next-294"><span class="linenos">294</span></a>                                        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-295"><a href="#FST.next-295"><span class="linenos">295</span></a>
</span><span id="FST.next-296"><a href="#FST.next-296"><span class="linenos">296</span></a>                                <span class="k">case</span> <span class="s1">&#39;kwonlyargs&#39;</span><span class="p">:</span>
</span><span id="FST.next-297"><a href="#FST.next-297"><span class="linenos">297</span></a>                                    <span class="n">kwonlyargs</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwonlyargs</span>
</span><span id="FST.next-298"><a href="#FST.next-298"><span class="linenos">298</span></a>
</span><span id="FST.next-299"><a href="#FST.next-299"><span class="linenos">299</span></a>                                    <span class="k">if</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kw_defaults</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
</span><span id="FST.next-300"><a href="#FST.next-300"><span class="linenos">300</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kw_defaults&#39;</span>
</span><span id="FST.next-301"><a href="#FST.next-301"><span class="linenos">301</span></a>
</span><span id="FST.next-302"><a href="#FST.next-302"><span class="linenos">302</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-303"><a href="#FST.next-303"><span class="linenos">303</span></a>                                        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-304"><a href="#FST.next-304"><span class="linenos">304</span></a>                                            <span class="n">a</span> <span class="o">=</span> <span class="n">kwonlyargs</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-305"><a href="#FST.next-305"><span class="linenos">305</span></a>
</span><span id="FST.next-306"><a href="#FST.next-306"><span class="linenos">306</span></a>                                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-307"><a href="#FST.next-307"><span class="linenos">307</span></a>                                            <span class="k">if</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwarg</span><span class="p">:</span>
</span><span id="FST.next-308"><a href="#FST.next-308"><span class="linenos">308</span></a>                                                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kwarg&#39;</span>
</span><span id="FST.next-309"><a href="#FST.next-309"><span class="linenos">309</span></a>                                            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-310"><a href="#FST.next-310"><span class="linenos">310</span></a>                                                <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-311"><a href="#FST.next-311"><span class="linenos">311</span></a>
</span><span id="FST.next-312"><a href="#FST.next-312"><span class="linenos">312</span></a>                                <span class="k">case</span> <span class="s1">&#39;kw_defaults&#39;</span><span class="p">:</span>
</span><span id="FST.next-313"><a href="#FST.next-313"><span class="linenos">313</span></a>                                    <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-314"><a href="#FST.next-314"><span class="linenos">314</span></a>                                        <span class="n">a</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwonlyargs</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-315"><a href="#FST.next-315"><span class="linenos">315</span></a>
</span><span id="FST.next-316"><a href="#FST.next-316"><span class="linenos">316</span></a>                                    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-317"><a href="#FST.next-317"><span class="linenos">317</span></a>                                        <span class="k">if</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwarg</span><span class="p">:</span>
</span><span id="FST.next-318"><a href="#FST.next-318"><span class="linenos">318</span></a>                                            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kwarg&#39;</span>
</span><span id="FST.next-319"><a href="#FST.next-319"><span class="linenos">319</span></a>                                        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-320"><a href="#FST.next-320"><span class="linenos">320</span></a>                                            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-321"><a href="#FST.next-321"><span class="linenos">321</span></a>
</span><span id="FST.next-322"><a href="#FST.next-322"><span class="linenos">322</span></a>                                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kwonlyargs&#39;</span>
</span><span id="FST.next-323"><a href="#FST.next-323"><span class="linenos">323</span></a>
</span><span id="FST.next-324"><a href="#FST.next-324"><span class="linenos">324</span></a>                                <span class="k">case</span> <span class="s1">&#39;kwarg&#39;</span><span class="p">:</span>
</span><span id="FST.next-325"><a href="#FST.next-325"><span class="linenos">325</span></a>                                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;should not get here&#39;</span><span class="p">)</span>
</span><span id="FST.next-326"><a href="#FST.next-326"><span class="linenos">326</span></a>
</span><span id="FST.next-327"><a href="#FST.next-327"><span class="linenos">327</span></a>                            <span class="k">break</span>
</span><span id="FST.next-328"><a href="#FST.next-328"><span class="linenos">328</span></a>
</span><span id="FST.next-329"><a href="#FST.next-329"><span class="linenos">329</span></a>                    <span class="k">case</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># from MatchMapping.keys</span>
</span><span id="FST.next-330"><a href="#FST.next-330"><span class="linenos">330</span></a>                        <span class="nb">next</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="FST.next-331"><a href="#FST.next-331"><span class="linenos">331</span></a>                        <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.next-332"><a href="#FST.next-332"><span class="linenos">332</span></a>
</span><span id="FST.next-333"><a href="#FST.next-333"><span class="linenos">333</span></a>                    <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># from MatchMapping.patterns</span>
</span><span id="FST.next-334"><a href="#FST.next-334"><span class="linenos">334</span></a>                        <span class="nb">next</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="FST.next-335"><a href="#FST.next-335"><span class="linenos">335</span></a>
</span><span id="FST.next-336"><a href="#FST.next-336"><span class="linenos">336</span></a>                        <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-337"><a href="#FST.next-337"><span class="linenos">337</span></a>                            <span class="n">a</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">keys</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.next-338"><a href="#FST.next-338"><span class="linenos">338</span></a>                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-339"><a href="#FST.next-339"><span class="linenos">339</span></a>                            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.next-340"><a href="#FST.next-340"><span class="linenos">340</span></a>
</span><span id="FST.next-341"><a href="#FST.next-341"><span class="linenos">341</span></a>                <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.next-342"><a href="#FST.next-342"><span class="linenos">342</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.next-343"><a href="#FST.next-343"><span class="linenos">343</span></a>
</span><span id="FST.next-344"><a href="#FST.next-344"><span class="linenos">344</span></a>        <span class="k">elif</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.next-345"><a href="#FST.next-345"><span class="linenos">345</span></a>            <span class="n">sibling</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">aparent</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="FST.next-346"><a href="#FST.next-346"><span class="linenos">346</span></a>
</span><span id="FST.next-347"><a href="#FST.next-347"><span class="linenos">347</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.next-348"><a href="#FST.next-348"><span class="linenos">348</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="FST.next-349"><a href="#FST.next-349"><span class="linenos">349</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">sibling</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]):</span>  <span class="c1"># who knows where a `None` might pop up &quot;next&quot; these days... xD</span>
</span><span id="FST.next-350"><a href="#FST.next-350"><span class="linenos">350</span></a>                        <span class="k">continue</span>
</span><span id="FST.next-351"><a href="#FST.next-351"><span class="linenos">351</span></a>
</span><span id="FST.next-352"><a href="#FST.next-352"><span class="linenos">352</span></a>                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="FST.next-353"><a href="#FST.next-353"><span class="linenos">353</span></a>                    <span class="k">break</span>
</span><span id="FST.next-354"><a href="#FST.next-354"><span class="linenos">354</span></a>
</span><span id="FST.next-355"><a href="#FST.next-355"><span class="linenos">355</span></a>                <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.next-356"><a href="#FST.next-356"><span class="linenos">356</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.next-357"><a href="#FST.next-357"><span class="linenos">357</span></a>
</span><span id="FST.next-358"><a href="#FST.next-358"><span class="linenos">358</span></a>        <span class="k">while</span> <span class="nb">next</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.next-359"><a href="#FST.next-359"><span class="linenos">359</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">next</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FST.next-360"><a href="#FST.next-360"><span class="linenos">360</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="nb">next</span>
</span><span id="FST.next-361"><a href="#FST.next-361"><span class="linenos">361</span></a>
</span><span id="FST.next-362"><a href="#FST.next-362"><span class="linenos">362</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">aparent</span><span class="p">,</span> <span class="nb">next</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">AST</span><span class="p">):</span>  <span class="c1"># None because we know about fields from future python versions</span>
</span><span id="FST.next-363"><a href="#FST.next-363"><span class="linenos">363</span></a>                    <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">sibling</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.next-364"><a href="#FST.next-364"><span class="linenos">364</span></a>                        <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.next-365"><a href="#FST.next-365"><span class="linenos">365</span></a>
</span><span id="FST.next-366"><a href="#FST.next-366"><span class="linenos">366</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sibling</span><span class="p">:</span>
</span><span id="FST.next-367"><a href="#FST.next-367"><span class="linenos">367</span></a>                    <span class="n">idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="FST.next-368"><a href="#FST.next-368"><span class="linenos">368</span></a>
</span><span id="FST.next-369"><a href="#FST.next-369"><span class="linenos">369</span></a>                    <span class="k">break</span>
</span><span id="FST.next-370"><a href="#FST.next-370"><span class="linenos">370</span></a>
</span><span id="FST.next-371"><a href="#FST.next-371"><span class="linenos">371</span></a>                <span class="nb">next</span> <span class="o">=</span> <span class="n">_AST_FIELDS_NEXT</span><span class="p">[(</span><span class="n">aparent</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="FST.next-372"><a href="#FST.next-372"><span class="linenos">372</span></a>
</span><span id="FST.next-373"><a href="#FST.next-373"><span class="linenos">373</span></a>                <span class="k">continue</span>
</span><span id="FST.next-374"><a href="#FST.next-374"><span class="linenos">374</span></a>
</span><span id="FST.next-375"><a href="#FST.next-375"><span class="linenos">375</span></a>            <span class="c1"># non-str next, special case</span>
</span><span id="FST.next-376"><a href="#FST.next-376"><span class="linenos">376</span></a>
</span><span id="FST.next-377"><a href="#FST.next-377"><span class="linenos">377</span></a>            <span class="k">match</span> <span class="nb">next</span><span class="p">:</span>
</span><span id="FST.next-378"><a href="#FST.next-378"><span class="linenos">378</span></a>                <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># from Compare.left</span>
</span><span id="FST.next-379"><a href="#FST.next-379"><span class="linenos">379</span></a>                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;comparators&#39;</span>  <span class="c1"># will cause to get .ops[0]</span>
</span><span id="FST.next-380"><a href="#FST.next-380"><span class="linenos">380</span></a>                    <span class="n">idx</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="FST.next-381"><a href="#FST.next-381"><span class="linenos">381</span></a>
</span><span id="FST.next-382"><a href="#FST.next-382"><span class="linenos">382</span></a>                <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>  <span class="c1"># from Call.func</span>
</span><span id="FST.next-383"><a href="#FST.next-383"><span class="linenos">383</span></a>                    <span class="n">idx</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># will cause to get .args[0]</span>
</span><span id="FST.next-384"><a href="#FST.next-384"><span class="linenos">384</span></a>
</span><span id="FST.next-385"><a href="#FST.next-385"><span class="linenos">385</span></a>            <span class="k">break</span>
</span><span id="FST.next-386"><a href="#FST.next-386"><span class="linenos">386</span></a>
</span><span id="FST.next-387"><a href="#FST.next-387"><span class="linenos">387</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.next-388"><a href="#FST.next-388"><span class="linenos">388</span></a>            <span class="k">break</span>
</span><span id="FST.next-389"><a href="#FST.next-389"><span class="linenos">389</span></a>
</span><span id="FST.next-390"><a href="#FST.next-390"><span class="linenos">390</span></a>        <span class="k">continue</span>
</span><span id="FST.next-391"><a href="#FST.next-391"><span class="linenos">391</span></a>
</span><span id="FST.next-392"><a href="#FST.next-392"><span class="linenos">392</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Get next sibling of <code>self</code> in syntactic order, only within parent.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
</ul></li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if last valid sibling in parent, otherwise next node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[[1, 2], [3, 4]]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[3, 4]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
<span class="kc">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.prev" class="classattr">
                                        <input id="FST.prev-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prev</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.prev-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.prev"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.prev-395"><a href="#FST.prev-395"><span class="linenos">395</span></a><span class="k">def</span><span class="w"> </span><span class="nf">prev</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># TODO: refactor</span>
</span><span id="FST.prev-396"><a href="#FST.prev-396"><span class="linenos">396</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get previous sibling of `self` in syntactic order, only within parent.</span>
</span><span id="FST.prev-397"><a href="#FST.prev-397"><span class="linenos">397</span></a>
</span><span id="FST.prev-398"><a href="#FST.prev-398"><span class="linenos">398</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.prev-399"><a href="#FST.prev-399"><span class="linenos">399</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.prev-400"><a href="#FST.prev-400"><span class="linenos">400</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.prev-401"><a href="#FST.prev-401"><span class="linenos">401</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.prev-402"><a href="#FST.prev-402"><span class="linenos">402</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.prev-403"><a href="#FST.prev-403"><span class="linenos">403</span></a><span class="sd">            present).</span>
</span><span id="FST.prev-404"><a href="#FST.prev-404"><span class="linenos">404</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.prev-405"><a href="#FST.prev-405"><span class="linenos">405</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.prev-406"><a href="#FST.prev-406"><span class="linenos">406</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.prev-407"><a href="#FST.prev-407"><span class="linenos">407</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.prev-408"><a href="#FST.prev-408"><span class="linenos">408</span></a>
</span><span id="FST.prev-409"><a href="#FST.prev-409"><span class="linenos">409</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.prev-410"><a href="#FST.prev-410"><span class="linenos">410</span></a><span class="sd">    - `None` if first valid sibling in parent, otherwise previous node.</span>
</span><span id="FST.prev-411"><a href="#FST.prev-411"><span class="linenos">411</span></a>
</span><span id="FST.prev-412"><a href="#FST.prev-412"><span class="linenos">412</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.prev-413"><a href="#FST.prev-413"><span class="linenos">413</span></a><span class="sd">    ```py</span>
</span><span id="FST.prev-414"><a href="#FST.prev-414"><span class="linenos">414</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.prev-415"><a href="#FST.prev-415"><span class="linenos">415</span></a>
</span><span id="FST.prev-416"><a href="#FST.prev-416"><span class="linenos">416</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[[1, 2], [3, 4]]&#39;)</span>
</span><span id="FST.prev-417"><a href="#FST.prev-417"><span class="linenos">417</span></a><span class="sd">    &gt;&gt;&gt; f.elts[1].prev().src</span>
</span><span id="FST.prev-418"><a href="#FST.prev-418"><span class="linenos">418</span></a><span class="sd">    &#39;[1, 2]&#39;</span>
</span><span id="FST.prev-419"><a href="#FST.prev-419"><span class="linenos">419</span></a>
</span><span id="FST.prev-420"><a href="#FST.prev-420"><span class="linenos">420</span></a><span class="sd">    &gt;&gt;&gt; print(f.elts[0].prev())</span>
</span><span id="FST.prev-421"><a href="#FST.prev-421"><span class="linenos">421</span></a><span class="sd">    None</span>
</span><span id="FST.prev-422"><a href="#FST.prev-422"><span class="linenos">422</span></a><span class="sd">    ```</span>
</span><span id="FST.prev-423"><a href="#FST.prev-423"><span class="linenos">423</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.prev-424"><a href="#FST.prev-424"><span class="linenos">424</span></a>
</span><span id="FST.prev-425"><a href="#FST.prev-425"><span class="linenos">425</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST.prev-426"><a href="#FST.prev-426"><span class="linenos">426</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.prev-427"><a href="#FST.prev-427"><span class="linenos">427</span></a>
</span><span id="FST.prev-428"><a href="#FST.prev-428"><span class="linenos">428</span></a>    <span class="n">aparent</span>   <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.prev-429"><a href="#FST.prev-429"><span class="linenos">429</span></a>    <span class="n">name</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span>
</span><span id="FST.prev-430"><a href="#FST.prev-430"><span class="linenos">430</span></a>
</span><span id="FST.prev-431"><a href="#FST.prev-431"><span class="linenos">431</span></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.prev-432"><a href="#FST.prev-432"><span class="linenos">432</span></a>        <span class="n">prev</span> <span class="o">=</span> <span class="n">_AST_FIELDS_PREV</span><span class="p">[(</span><span class="n">aparent</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="FST.prev-433"><a href="#FST.prev-433"><span class="linenos">433</span></a>
</span><span id="FST.prev-434"><a href="#FST.prev-434"><span class="linenos">434</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># special case?</span>
</span><span id="FST.prev-435"><a href="#FST.prev-435"><span class="linenos">435</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.prev-436"><a href="#FST.prev-436"><span class="linenos">436</span></a>                <span class="k">match</span> <span class="n">prev</span><span class="p">:</span>
</span><span id="FST.prev-437"><a href="#FST.prev-437"><span class="linenos">437</span></a>                    <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># from Dict.keys</span>
</span><span id="FST.prev-438"><a href="#FST.prev-438"><span class="linenos">438</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-439"><a href="#FST.prev-439"><span class="linenos">439</span></a>                            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.prev-440"><a href="#FST.prev-440"><span class="linenos">440</span></a>
</span><span id="FST.prev-441"><a href="#FST.prev-441"><span class="linenos">441</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-442"><a href="#FST.prev-442"><span class="linenos">442</span></a>                            <span class="n">prev</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="FST.prev-443"><a href="#FST.prev-443"><span class="linenos">443</span></a>                            <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">values</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-444"><a href="#FST.prev-444"><span class="linenos">444</span></a>
</span><span id="FST.prev-445"><a href="#FST.prev-445"><span class="linenos">445</span></a>                    <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># from Dict.values</span>
</span><span id="FST.prev-446"><a href="#FST.prev-446"><span class="linenos">446</span></a>                        <span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FST.prev-447"><a href="#FST.prev-447"><span class="linenos">447</span></a>
</span><span id="FST.prev-448"><a href="#FST.prev-448"><span class="linenos">448</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]):</span>
</span><span id="FST.prev-449"><a href="#FST.prev-449"><span class="linenos">449</span></a>                            <span class="k">continue</span>
</span><span id="FST.prev-450"><a href="#FST.prev-450"><span class="linenos">450</span></a>
</span><span id="FST.prev-451"><a href="#FST.prev-451"><span class="linenos">451</span></a>                    <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="FST.prev-452"><a href="#FST.prev-452"><span class="linenos">452</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">keywords</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">keywords</span><span class="p">):</span>  <span class="c1"># no keywords</span>
</span><span id="FST.prev-453"><a href="#FST.prev-453"><span class="linenos">453</span></a>                            <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-454"><a href="#FST.prev-454"><span class="linenos">454</span></a>                                <span class="n">a</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-455"><a href="#FST.prev-455"><span class="linenos">455</span></a>
</span><span id="FST.prev-456"><a href="#FST.prev-456"><span class="linenos">456</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-457"><a href="#FST.prev-457"><span class="linenos">457</span></a>                                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;func&#39;</span>
</span><span id="FST.prev-458"><a href="#FST.prev-458"><span class="linenos">458</span></a>                                <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">func</span>
</span><span id="FST.prev-459"><a href="#FST.prev-459"><span class="linenos">459</span></a>
</span><span id="FST.prev-460"><a href="#FST.prev-460"><span class="linenos">460</span></a>                        <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">args</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>  <span class="c1"># no args</span>
</span><span id="FST.prev-461"><a href="#FST.prev-461"><span class="linenos">461</span></a>                            <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-462"><a href="#FST.prev-462"><span class="linenos">462</span></a>                                <span class="n">a</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-463"><a href="#FST.prev-463"><span class="linenos">463</span></a>
</span><span id="FST.prev-464"><a href="#FST.prev-464"><span class="linenos">464</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-465"><a href="#FST.prev-465"><span class="linenos">465</span></a>                                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;func&#39;</span>
</span><span id="FST.prev-466"><a href="#FST.prev-466"><span class="linenos">466</span></a>                                <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">func</span>
</span><span id="FST.prev-467"><a href="#FST.prev-467"><span class="linenos">467</span></a>
</span><span id="FST.prev-468"><a href="#FST.prev-468"><span class="linenos">468</span></a>                        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">star</span> <span class="o">:=</span> <span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Starred</span><span class="p">):</span>  <span class="c1"># both args and keywords but no Starred</span>
</span><span id="FST.prev-469"><a href="#FST.prev-469"><span class="linenos">469</span></a>                            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span>
</span><span id="FST.prev-470"><a href="#FST.prev-470"><span class="linenos">470</span></a>                                <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-471"><a href="#FST.prev-471"><span class="linenos">471</span></a>                                    <span class="n">a</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-472"><a href="#FST.prev-472"><span class="linenos">472</span></a>
</span><span id="FST.prev-473"><a href="#FST.prev-473"><span class="linenos">473</span></a>                                <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-474"><a href="#FST.prev-474"><span class="linenos">474</span></a>                                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;func&#39;</span>
</span><span id="FST.prev-475"><a href="#FST.prev-475"><span class="linenos">475</span></a>                                    <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">func</span>
</span><span id="FST.prev-476"><a href="#FST.prev-476"><span class="linenos">476</span></a>
</span><span id="FST.prev-477"><a href="#FST.prev-477"><span class="linenos">477</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-478"><a href="#FST.prev-478"><span class="linenos">478</span></a>                                <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-479"><a href="#FST.prev-479"><span class="linenos">479</span></a>                                    <span class="n">a</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-480"><a href="#FST.prev-480"><span class="linenos">480</span></a>
</span><span id="FST.prev-481"><a href="#FST.prev-481"><span class="linenos">481</span></a>                                <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-482"><a href="#FST.prev-482"><span class="linenos">482</span></a>                                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.prev-483"><a href="#FST.prev-483"><span class="linenos">483</span></a>                                    <span class="n">a</span>    <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-484"><a href="#FST.prev-484"><span class="linenos">484</span></a>
</span><span id="FST.prev-485"><a href="#FST.prev-485"><span class="linenos">485</span></a>                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># args, keywords AND Starred</span>
</span><span id="FST.prev-486"><a href="#FST.prev-486"><span class="linenos">486</span></a>                            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span>
</span><span id="FST.prev-487"><a href="#FST.prev-487"><span class="linenos">487</span></a>                                <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># is star</span>
</span><span id="FST.prev-488"><a href="#FST.prev-488"><span class="linenos">488</span></a>                                    <span class="n">star_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span>
</span><span id="FST.prev-489"><a href="#FST.prev-489"><span class="linenos">489</span></a>
</span><span id="FST.prev-490"><a href="#FST.prev-490"><span class="linenos">490</span></a>                                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span><span id="FST.prev-491"><a href="#FST.prev-491"><span class="linenos">491</span></a>                                        <span class="k">if</span> <span class="p">((</span><span class="n">kw</span> <span class="o">:=</span> <span class="n">keywords</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">kw</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">star_pos</span><span class="p">:</span>
</span><span id="FST.prev-492"><a href="#FST.prev-492"><span class="linenos">492</span></a>                                            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;keywords&#39;</span>
</span><span id="FST.prev-493"><a href="#FST.prev-493"><span class="linenos">493</span></a>                                            <span class="n">idx</span>  <span class="o">=</span> <span class="n">i</span>
</span><span id="FST.prev-494"><a href="#FST.prev-494"><span class="linenos">494</span></a>                                            <span class="n">a</span>    <span class="o">=</span> <span class="n">kw</span>
</span><span id="FST.prev-495"><a href="#FST.prev-495"><span class="linenos">495</span></a>
</span><span id="FST.prev-496"><a href="#FST.prev-496"><span class="linenos">496</span></a>                                            <span class="k">break</span>
</span><span id="FST.prev-497"><a href="#FST.prev-497"><span class="linenos">497</span></a>
</span><span id="FST.prev-498"><a href="#FST.prev-498"><span class="linenos">498</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-499"><a href="#FST.prev-499"><span class="linenos">499</span></a>                                        <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-500"><a href="#FST.prev-500"><span class="linenos">500</span></a>                                            <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-501"><a href="#FST.prev-501"><span class="linenos">501</span></a>
</span><span id="FST.prev-502"><a href="#FST.prev-502"><span class="linenos">502</span></a>                                        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-503"><a href="#FST.prev-503"><span class="linenos">503</span></a>                                            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;func&#39;</span>
</span><span id="FST.prev-504"><a href="#FST.prev-504"><span class="linenos">504</span></a>                                            <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">func</span>
</span><span id="FST.prev-505"><a href="#FST.prev-505"><span class="linenos">505</span></a>
</span><span id="FST.prev-506"><a href="#FST.prev-506"><span class="linenos">506</span></a>                                <span class="k">elif</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-507"><a href="#FST.prev-507"><span class="linenos">507</span></a>                                    <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-508"><a href="#FST.prev-508"><span class="linenos">508</span></a>
</span><span id="FST.prev-509"><a href="#FST.prev-509"><span class="linenos">509</span></a>                                <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-510"><a href="#FST.prev-510"><span class="linenos">510</span></a>                                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;func&#39;</span>
</span><span id="FST.prev-511"><a href="#FST.prev-511"><span class="linenos">511</span></a>                                    <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">func</span>
</span><span id="FST.prev-512"><a href="#FST.prev-512"><span class="linenos">512</span></a>
</span><span id="FST.prev-513"><a href="#FST.prev-513"><span class="linenos">513</span></a>                            <span class="k">else</span><span class="p">:</span>  <span class="c1"># name == &#39;keywords&#39;</span>
</span><span id="FST.prev-514"><a href="#FST.prev-514"><span class="linenos">514</span></a>                                <span class="n">star_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span>
</span><span id="FST.prev-515"><a href="#FST.prev-515"><span class="linenos">515</span></a>
</span><span id="FST.prev-516"><a href="#FST.prev-516"><span class="linenos">516</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-517"><a href="#FST.prev-517"><span class="linenos">517</span></a>                                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.prev-518"><a href="#FST.prev-518"><span class="linenos">518</span></a>
</span><span id="FST.prev-519"><a href="#FST.prev-519"><span class="linenos">519</span></a>                                    <span class="k">if</span> <span class="p">((</span><span class="n">sa</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">star_pos</span><span class="p">:</span>  <span class="c1"># all keywords above star so pass on to star</span>
</span><span id="FST.prev-520"><a href="#FST.prev-520"><span class="linenos">520</span></a>                                        <span class="n">idx</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="FST.prev-521"><a href="#FST.prev-521"><span class="linenos">521</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">star</span>
</span><span id="FST.prev-522"><a href="#FST.prev-522"><span class="linenos">522</span></a>
</span><span id="FST.prev-523"><a href="#FST.prev-523"><span class="linenos">523</span></a>                                    <span class="k">elif</span> <span class="p">(</span><span class="n">largs</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># no args left, we done here</span>
</span><span id="FST.prev-524"><a href="#FST.prev-524"><span class="linenos">524</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;func&#39;</span>
</span><span id="FST.prev-525"><a href="#FST.prev-525"><span class="linenos">525</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">func</span>
</span><span id="FST.prev-526"><a href="#FST.prev-526"><span class="linenos">526</span></a>
</span><span id="FST.prev-527"><a href="#FST.prev-527"><span class="linenos">527</span></a>                                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># some args left, go to those</span>
</span><span id="FST.prev-528"><a href="#FST.prev-528"><span class="linenos">528</span></a>                                        <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">largs</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)]</span>
</span><span id="FST.prev-529"><a href="#FST.prev-529"><span class="linenos">529</span></a>
</span><span id="FST.prev-530"><a href="#FST.prev-530"><span class="linenos">530</span></a>                                <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-531"><a href="#FST.prev-531"><span class="linenos">531</span></a>                                    <span class="n">a</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-532"><a href="#FST.prev-532"><span class="linenos">532</span></a>
</span><span id="FST.prev-533"><a href="#FST.prev-533"><span class="linenos">533</span></a>                                    <span class="k">if</span> <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">star_pos</span> <span class="ow">and</span>
</span><span id="FST.prev-534"><a href="#FST.prev-534"><span class="linenos">534</span></a>                                        <span class="p">((</span><span class="n">sa</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">col_offset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">star_pos</span>
</span><span id="FST.prev-535"><a href="#FST.prev-535"><span class="linenos">535</span></a>                                    <span class="p">):</span>  <span class="c1"># crossed star walking back, return star</span>
</span><span id="FST.prev-536"><a href="#FST.prev-536"><span class="linenos">536</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.prev-537"><a href="#FST.prev-537"><span class="linenos">537</span></a>                                        <span class="n">idx</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="FST.prev-538"><a href="#FST.prev-538"><span class="linenos">538</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">star</span>
</span><span id="FST.prev-539"><a href="#FST.prev-539"><span class="linenos">539</span></a>
</span><span id="FST.prev-540"><a href="#FST.prev-540"><span class="linenos">540</span></a>                    <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># from Compare.ops</span>
</span><span id="FST.prev-541"><a href="#FST.prev-541"><span class="linenos">541</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-542"><a href="#FST.prev-542"><span class="linenos">542</span></a>                            <span class="n">prev</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
</span><span id="FST.prev-543"><a href="#FST.prev-543"><span class="linenos">543</span></a>
</span><span id="FST.prev-544"><a href="#FST.prev-544"><span class="linenos">544</span></a>                            <span class="k">break</span>
</span><span id="FST.prev-545"><a href="#FST.prev-545"><span class="linenos">545</span></a>
</span><span id="FST.prev-546"><a href="#FST.prev-546"><span class="linenos">546</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-547"><a href="#FST.prev-547"><span class="linenos">547</span></a>                            <span class="n">prev</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="FST.prev-548"><a href="#FST.prev-548"><span class="linenos">548</span></a>                            <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">comparators</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-549"><a href="#FST.prev-549"><span class="linenos">549</span></a>
</span><span id="FST.prev-550"><a href="#FST.prev-550"><span class="linenos">550</span></a>                    <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># from Compare.comparators</span>
</span><span id="FST.prev-551"><a href="#FST.prev-551"><span class="linenos">551</span></a>                        <span class="n">prev</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="FST.prev-552"><a href="#FST.prev-552"><span class="linenos">552</span></a>                        <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">ops</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.prev-553"><a href="#FST.prev-553"><span class="linenos">553</span></a>
</span><span id="FST.prev-554"><a href="#FST.prev-554"><span class="linenos">554</span></a>                    <span class="k">case</span> <span class="mi">7</span><span class="p">:</span>
</span><span id="FST.prev-555"><a href="#FST.prev-555"><span class="linenos">555</span></a>                        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.prev-556"><a href="#FST.prev-556"><span class="linenos">556</span></a>                            <span class="k">match</span> <span class="n">name</span><span class="p">:</span>
</span><span id="FST.prev-557"><a href="#FST.prev-557"><span class="linenos">557</span></a>                                <span class="k">case</span> <span class="s1">&#39;posonlyargs&#39;</span><span class="p">:</span>
</span><span id="FST.prev-558"><a href="#FST.prev-558"><span class="linenos">558</span></a>                                    <span class="n">posonlyargs</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">posonlyargs</span>
</span><span id="FST.prev-559"><a href="#FST.prev-559"><span class="linenos">559</span></a>                                    <span class="n">defaults</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">defaults</span>
</span><span id="FST.prev-560"><a href="#FST.prev-560"><span class="linenos">560</span></a>
</span><span id="FST.prev-561"><a href="#FST.prev-561"><span class="linenos">561</span></a>                                    <span class="k">if</span> <span class="p">((</span><span class="n">didx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">posonlyargs</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span>
</span><span id="FST.prev-562"><a href="#FST.prev-562"><span class="linenos">562</span></a>                                        <span class="mi">0</span>
</span><span id="FST.prev-563"><a href="#FST.prev-563"><span class="linenos">563</span></a>                                    <span class="p">):</span>
</span><span id="FST.prev-564"><a href="#FST.prev-564"><span class="linenos">564</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;defaults&#39;</span>
</span><span id="FST.prev-565"><a href="#FST.prev-565"><span class="linenos">565</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">defaults</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">didx</span><span class="p">)]</span>
</span><span id="FST.prev-566"><a href="#FST.prev-566"><span class="linenos">566</span></a>
</span><span id="FST.prev-567"><a href="#FST.prev-567"><span class="linenos">567</span></a>                                    <span class="k">elif</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FST.prev-568"><a href="#FST.prev-568"><span class="linenos">568</span></a>                                        <span class="n">a</span> <span class="o">=</span> <span class="n">posonlyargs</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-569"><a href="#FST.prev-569"><span class="linenos">569</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-570"><a href="#FST.prev-570"><span class="linenos">570</span></a>                                        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.prev-571"><a href="#FST.prev-571"><span class="linenos">571</span></a>
</span><span id="FST.prev-572"><a href="#FST.prev-572"><span class="linenos">572</span></a>                                <span class="k">case</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span>
</span><span id="FST.prev-573"><a href="#FST.prev-573"><span class="linenos">573</span></a>                                    <span class="n">args</span>     <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span>
</span><span id="FST.prev-574"><a href="#FST.prev-574"><span class="linenos">574</span></a>                                    <span class="n">defaults</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">defaults</span>
</span><span id="FST.prev-575"><a href="#FST.prev-575"><span class="linenos">575</span></a>
</span><span id="FST.prev-576"><a href="#FST.prev-576"><span class="linenos">576</span></a>                                    <span class="k">if</span> <span class="p">(</span><span class="n">didx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FST.prev-577"><a href="#FST.prev-577"><span class="linenos">577</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;defaults&#39;</span>
</span><span id="FST.prev-578"><a href="#FST.prev-578"><span class="linenos">578</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">defaults</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">didx</span><span class="p">)]</span>
</span><span id="FST.prev-579"><a href="#FST.prev-579"><span class="linenos">579</span></a>
</span><span id="FST.prev-580"><a href="#FST.prev-580"><span class="linenos">580</span></a>                                    <span class="k">elif</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FST.prev-581"><a href="#FST.prev-581"><span class="linenos">581</span></a>                                        <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-582"><a href="#FST.prev-582"><span class="linenos">582</span></a>
</span><span id="FST.prev-583"><a href="#FST.prev-583"><span class="linenos">583</span></a>                                    <span class="k">elif</span> <span class="n">posonlyargs</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">posonlyargs</span><span class="p">:</span>
</span><span id="FST.prev-584"><a href="#FST.prev-584"><span class="linenos">584</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;posonlyargs&#39;</span>
</span><span id="FST.prev-585"><a href="#FST.prev-585"><span class="linenos">585</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">posonlyargs</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">posonlyargs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-586"><a href="#FST.prev-586"><span class="linenos">586</span></a>
</span><span id="FST.prev-587"><a href="#FST.prev-587"><span class="linenos">587</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-588"><a href="#FST.prev-588"><span class="linenos">588</span></a>                                        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.prev-589"><a href="#FST.prev-589"><span class="linenos">589</span></a>
</span><span id="FST.prev-590"><a href="#FST.prev-590"><span class="linenos">590</span></a>                                <span class="k">case</span> <span class="s1">&#39;defaults&#39;</span><span class="p">:</span>
</span><span id="FST.prev-591"><a href="#FST.prev-591"><span class="linenos">591</span></a>                                    <span class="n">args</span>     <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span>
</span><span id="FST.prev-592"><a href="#FST.prev-592"><span class="linenos">592</span></a>                                    <span class="n">defaults</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">defaults</span>
</span><span id="FST.prev-593"><a href="#FST.prev-593"><span class="linenos">593</span></a>
</span><span id="FST.prev-594"><a href="#FST.prev-594"><span class="linenos">594</span></a>                                    <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FST.prev-595"><a href="#FST.prev-595"><span class="linenos">595</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.prev-596"><a href="#FST.prev-596"><span class="linenos">596</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.prev-597"><a href="#FST.prev-597"><span class="linenos">597</span></a>
</span><span id="FST.prev-598"><a href="#FST.prev-598"><span class="linenos">598</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-599"><a href="#FST.prev-599"><span class="linenos">599</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;posonlyargs&#39;</span>
</span><span id="FST.prev-600"><a href="#FST.prev-600"><span class="linenos">600</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="p">(</span><span class="n">posonlyargs</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">posonlyargs</span><span class="p">)[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">posonlyargs</span><span class="p">)]</span>
</span><span id="FST.prev-601"><a href="#FST.prev-601"><span class="linenos">601</span></a>
</span><span id="FST.prev-602"><a href="#FST.prev-602"><span class="linenos">602</span></a>                                <span class="k">case</span> <span class="s1">&#39;vararg&#39;</span><span class="p">:</span>
</span><span id="FST.prev-603"><a href="#FST.prev-603"><span class="linenos">603</span></a>                                    <span class="k">if</span> <span class="n">defaults</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">defaults</span><span class="p">:</span>
</span><span id="FST.prev-604"><a href="#FST.prev-604"><span class="linenos">604</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;defaults&#39;</span>
</span><span id="FST.prev-605"><a href="#FST.prev-605"><span class="linenos">605</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">defaults</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-606"><a href="#FST.prev-606"><span class="linenos">606</span></a>
</span><span id="FST.prev-607"><a href="#FST.prev-607"><span class="linenos">607</span></a>                                    <span class="k">elif</span> <span class="n">args</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
</span><span id="FST.prev-608"><a href="#FST.prev-608"><span class="linenos">608</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;args&#39;</span>
</span><span id="FST.prev-609"><a href="#FST.prev-609"><span class="linenos">609</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">args</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-610"><a href="#FST.prev-610"><span class="linenos">610</span></a>
</span><span id="FST.prev-611"><a href="#FST.prev-611"><span class="linenos">611</span></a>                                    <span class="k">elif</span> <span class="n">posonlyargs</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">posonlyargs</span><span class="p">:</span>
</span><span id="FST.prev-612"><a href="#FST.prev-612"><span class="linenos">612</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;posonlyargs&#39;</span>
</span><span id="FST.prev-613"><a href="#FST.prev-613"><span class="linenos">613</span></a>                                        <span class="n">a</span>    <span class="o">=</span> <span class="n">posonlyargs</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">posonlyargs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-614"><a href="#FST.prev-614"><span class="linenos">614</span></a>
</span><span id="FST.prev-615"><a href="#FST.prev-615"><span class="linenos">615</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-616"><a href="#FST.prev-616"><span class="linenos">616</span></a>                                        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.prev-617"><a href="#FST.prev-617"><span class="linenos">617</span></a>
</span><span id="FST.prev-618"><a href="#FST.prev-618"><span class="linenos">618</span></a>                                <span class="k">case</span> <span class="s1">&#39;kwonlyargs&#39;</span><span class="p">:</span>
</span><span id="FST.prev-619"><a href="#FST.prev-619"><span class="linenos">619</span></a>                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-620"><a href="#FST.prev-620"><span class="linenos">620</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;vararg&#39;</span>
</span><span id="FST.prev-621"><a href="#FST.prev-621"><span class="linenos">621</span></a>
</span><span id="FST.prev-622"><a href="#FST.prev-622"><span class="linenos">622</span></a>                                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">vararg</span><span class="p">):</span>
</span><span id="FST.prev-623"><a href="#FST.prev-623"><span class="linenos">623</span></a>                                            <span class="k">continue</span>
</span><span id="FST.prev-624"><a href="#FST.prev-624"><span class="linenos">624</span></a>
</span><span id="FST.prev-625"><a href="#FST.prev-625"><span class="linenos">625</span></a>                                    <span class="k">elif</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kw_defaults</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]:</span>
</span><span id="FST.prev-626"><a href="#FST.prev-626"><span class="linenos">626</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kw_defaults&#39;</span>
</span><span id="FST.prev-627"><a href="#FST.prev-627"><span class="linenos">627</span></a>
</span><span id="FST.prev-628"><a href="#FST.prev-628"><span class="linenos">628</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-629"><a href="#FST.prev-629"><span class="linenos">629</span></a>                                        <span class="n">a</span> <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwonlyargs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.prev-630"><a href="#FST.prev-630"><span class="linenos">630</span></a>
</span><span id="FST.prev-631"><a href="#FST.prev-631"><span class="linenos">631</span></a>                                <span class="k">case</span> <span class="s1">&#39;kw_defaults&#39;</span><span class="p">:</span>
</span><span id="FST.prev-632"><a href="#FST.prev-632"><span class="linenos">632</span></a>                                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kwonlyargs&#39;</span>
</span><span id="FST.prev-633"><a href="#FST.prev-633"><span class="linenos">633</span></a>                                    <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwonlyargs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.prev-634"><a href="#FST.prev-634"><span class="linenos">634</span></a>
</span><span id="FST.prev-635"><a href="#FST.prev-635"><span class="linenos">635</span></a>                                <span class="k">case</span> <span class="s1">&#39;kwarg&#39;</span><span class="p">:</span>
</span><span id="FST.prev-636"><a href="#FST.prev-636"><span class="linenos">636</span></a>                                    <span class="k">if</span> <span class="n">kw_defaults</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kw_defaults</span><span class="p">:</span>
</span><span id="FST.prev-637"><a href="#FST.prev-637"><span class="linenos">637</span></a>                                        <span class="k">if</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">kw_defaults</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kw_defaults</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]:</span>
</span><span id="FST.prev-638"><a href="#FST.prev-638"><span class="linenos">638</span></a>                                            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kw_defaults&#39;</span>
</span><span id="FST.prev-639"><a href="#FST.prev-639"><span class="linenos">639</span></a>
</span><span id="FST.prev-640"><a href="#FST.prev-640"><span class="linenos">640</span></a>                                        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-641"><a href="#FST.prev-641"><span class="linenos">641</span></a>                                            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kwonlyargs&#39;</span>
</span><span id="FST.prev-642"><a href="#FST.prev-642"><span class="linenos">642</span></a>                                            <span class="n">a</span>    <span class="o">=</span> <span class="p">(</span><span class="n">kwonlyargs</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">kwonlyargs</span><span class="p">)[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwonlyargs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-643"><a href="#FST.prev-643"><span class="linenos">643</span></a>
</span><span id="FST.prev-644"><a href="#FST.prev-644"><span class="linenos">644</span></a>                                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-645"><a href="#FST.prev-645"><span class="linenos">645</span></a>                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;vararg&#39;</span>
</span><span id="FST.prev-646"><a href="#FST.prev-646"><span class="linenos">646</span></a>
</span><span id="FST.prev-647"><a href="#FST.prev-647"><span class="linenos">647</span></a>                                        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">vararg</span><span class="p">):</span>
</span><span id="FST.prev-648"><a href="#FST.prev-648"><span class="linenos">648</span></a>                                            <span class="k">continue</span>
</span><span id="FST.prev-649"><a href="#FST.prev-649"><span class="linenos">649</span></a>
</span><span id="FST.prev-650"><a href="#FST.prev-650"><span class="linenos">650</span></a>                            <span class="k">break</span>
</span><span id="FST.prev-651"><a href="#FST.prev-651"><span class="linenos">651</span></a>
</span><span id="FST.prev-652"><a href="#FST.prev-652"><span class="linenos">652</span></a>                    <span class="k">case</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># from Keys.keys</span>
</span><span id="FST.prev-653"><a href="#FST.prev-653"><span class="linenos">653</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-654"><a href="#FST.prev-654"><span class="linenos">654</span></a>                            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.prev-655"><a href="#FST.prev-655"><span class="linenos">655</span></a>
</span><span id="FST.prev-656"><a href="#FST.prev-656"><span class="linenos">656</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-657"><a href="#FST.prev-657"><span class="linenos">657</span></a>                            <span class="n">prev</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="FST.prev-658"><a href="#FST.prev-658"><span class="linenos">658</span></a>                            <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">patterns</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="FST.prev-659"><a href="#FST.prev-659"><span class="linenos">659</span></a>
</span><span id="FST.prev-660"><a href="#FST.prev-660"><span class="linenos">660</span></a>                    <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># from Keys.patterns</span>
</span><span id="FST.prev-661"><a href="#FST.prev-661"><span class="linenos">661</span></a>                        <span class="n">prev</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="FST.prev-662"><a href="#FST.prev-662"><span class="linenos">662</span></a>                        <span class="n">a</span>    <span class="o">=</span> <span class="n">aparent</span><span class="o">.</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="FST.prev-663"><a href="#FST.prev-663"><span class="linenos">663</span></a>
</span><span id="FST.prev-664"><a href="#FST.prev-664"><span class="linenos">664</span></a>                <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.prev-665"><a href="#FST.prev-665"><span class="linenos">665</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.prev-666"><a href="#FST.prev-666"><span class="linenos">666</span></a>
</span><span id="FST.prev-667"><a href="#FST.prev-667"><span class="linenos">667</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-668"><a href="#FST.prev-668"><span class="linenos">668</span></a>            <span class="n">sibling</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">aparent</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="FST.prev-669"><a href="#FST.prev-669"><span class="linenos">669</span></a>
</span><span id="FST.prev-670"><a href="#FST.prev-670"><span class="linenos">670</span></a>            <span class="k">while</span> <span class="n">idx</span><span class="p">:</span>
</span><span id="FST.prev-671"><a href="#FST.prev-671"><span class="linenos">671</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">sibling</span><span class="p">[(</span><span class="n">idx</span> <span class="o">:=</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]):</span>
</span><span id="FST.prev-672"><a href="#FST.prev-672"><span class="linenos">672</span></a>                    <span class="k">continue</span>
</span><span id="FST.prev-673"><a href="#FST.prev-673"><span class="linenos">673</span></a>
</span><span id="FST.prev-674"><a href="#FST.prev-674"><span class="linenos">674</span></a>                <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.prev-675"><a href="#FST.prev-675"><span class="linenos">675</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.prev-676"><a href="#FST.prev-676"><span class="linenos">676</span></a>
</span><span id="FST.prev-677"><a href="#FST.prev-677"><span class="linenos">677</span></a>        <span class="k">while</span> <span class="n">prev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.prev-678"><a href="#FST.prev-678"><span class="linenos">678</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FST.prev-679"><a href="#FST.prev-679"><span class="linenos">679</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">prev</span>
</span><span id="FST.prev-680"><a href="#FST.prev-680"><span class="linenos">680</span></a>
</span><span id="FST.prev-681"><a href="#FST.prev-681"><span class="linenos">681</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">aparent</span><span class="p">,</span> <span class="n">prev</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">AST</span><span class="p">):</span>  <span class="c1"># None because could have fields from future python versions</span>
</span><span id="FST.prev-682"><a href="#FST.prev-682"><span class="linenos">682</span></a>                    <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">sibling</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.prev-683"><a href="#FST.prev-683"><span class="linenos">683</span></a>                        <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.prev-684"><a href="#FST.prev-684"><span class="linenos">684</span></a>
</span><span id="FST.prev-685"><a href="#FST.prev-685"><span class="linenos">685</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sibling</span><span class="p">)):</span>
</span><span id="FST.prev-686"><a href="#FST.prev-686"><span class="linenos">686</span></a>                    <span class="k">break</span>
</span><span id="FST.prev-687"><a href="#FST.prev-687"><span class="linenos">687</span></a>
</span><span id="FST.prev-688"><a href="#FST.prev-688"><span class="linenos">688</span></a>                <span class="n">prev</span> <span class="o">=</span> <span class="n">_AST_FIELDS_PREV</span><span class="p">[(</span><span class="n">aparent</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="FST.prev-689"><a href="#FST.prev-689"><span class="linenos">689</span></a>
</span><span id="FST.prev-690"><a href="#FST.prev-690"><span class="linenos">690</span></a>                <span class="k">continue</span>
</span><span id="FST.prev-691"><a href="#FST.prev-691"><span class="linenos">691</span></a>
</span><span id="FST.prev-692"><a href="#FST.prev-692"><span class="linenos">692</span></a>            <span class="c1"># non-str prev, special case</span>
</span><span id="FST.prev-693"><a href="#FST.prev-693"><span class="linenos">693</span></a>
</span><span id="FST.prev-694"><a href="#FST.prev-694"><span class="linenos">694</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;should not get here&#39;</span><span class="p">)</span>  <span class="c1"># break  # when entrable special cases from ahead appear in future py versions add them here</span>
</span><span id="FST.prev-695"><a href="#FST.prev-695"><span class="linenos">695</span></a>
</span><span id="FST.prev-696"><a href="#FST.prev-696"><span class="linenos">696</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.prev-697"><a href="#FST.prev-697"><span class="linenos">697</span></a>            <span class="k">break</span>
</span><span id="FST.prev-698"><a href="#FST.prev-698"><span class="linenos">698</span></a>
</span><span id="FST.prev-699"><a href="#FST.prev-699"><span class="linenos">699</span></a>        <span class="k">continue</span>
</span><span id="FST.prev-700"><a href="#FST.prev-700"><span class="linenos">700</span></a>
</span><span id="FST.prev-701"><a href="#FST.prev-701"><span class="linenos">701</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Get previous sibling of <code>self</code> in syntactic order, only within parent.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
</ul></li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if first valid sibling in parent, otherwise previous node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[[1, 2], [3, 4]]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">prev</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">prev</span><span class="p">())</span>
<span class="kc">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.first_child" class="classattr">
                                        <input id="FST.first_child-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">first_child</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.first_child-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.first_child"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.first_child-704"><a href="#FST.first_child-704"><span class="linenos">704</span></a><span class="k">def</span><span class="w"> </span><span class="nf">first_child</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.first_child-705"><a href="#FST.first_child-705"><span class="linenos">705</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get first valid child in syntactic order.</span>
</span><span id="FST.first_child-706"><a href="#FST.first_child-706"><span class="linenos">706</span></a>
</span><span id="FST.first_child-707"><a href="#FST.first_child-707"><span class="linenos">707</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.first_child-708"><a href="#FST.first_child-708"><span class="linenos">708</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.first_child-709"><a href="#FST.first_child-709"><span class="linenos">709</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.first_child-710"><a href="#FST.first_child-710"><span class="linenos">710</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.first_child-711"><a href="#FST.first_child-711"><span class="linenos">711</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.first_child-712"><a href="#FST.first_child-712"><span class="linenos">712</span></a><span class="sd">            present).</span>
</span><span id="FST.first_child-713"><a href="#FST.first_child-713"><span class="linenos">713</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.first_child-714"><a href="#FST.first_child-714"><span class="linenos">714</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.first_child-715"><a href="#FST.first_child-715"><span class="linenos">715</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.first_child-716"><a href="#FST.first_child-716"><span class="linenos">716</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.first_child-717"><a href="#FST.first_child-717"><span class="linenos">717</span></a>
</span><span id="FST.first_child-718"><a href="#FST.first_child-718"><span class="linenos">718</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.first_child-719"><a href="#FST.first_child-719"><span class="linenos">719</span></a><span class="sd">    - `None` if no valid children, otherwise first valid child.</span>
</span><span id="FST.first_child-720"><a href="#FST.first_child-720"><span class="linenos">720</span></a>
</span><span id="FST.first_child-721"><a href="#FST.first_child-721"><span class="linenos">721</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.first_child-722"><a href="#FST.first_child-722"><span class="linenos">722</span></a><span class="sd">    ```py</span>
</span><span id="FST.first_child-723"><a href="#FST.first_child-723"><span class="linenos">723</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.first_child-724"><a href="#FST.first_child-724"><span class="linenos">724</span></a>
</span><span id="FST.first_child-725"><a href="#FST.first_child-725"><span class="linenos">725</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;def f(a: list[str], /, reject: int, *c, d=100, **e): pass&#39;)</span>
</span><span id="FST.first_child-726"><a href="#FST.first_child-726"><span class="linenos">726</span></a><span class="sd">    &gt;&gt;&gt; f.first_child().src</span>
</span><span id="FST.first_child-727"><a href="#FST.first_child-727"><span class="linenos">727</span></a><span class="sd">    &#39;a: list[str], /, reject: int, *c, d=100, **e&#39;</span>
</span><span id="FST.first_child-728"><a href="#FST.first_child-728"><span class="linenos">728</span></a>
</span><span id="FST.first_child-729"><a href="#FST.first_child-729"><span class="linenos">729</span></a><span class="sd">    &gt;&gt;&gt; f.args.first_child().src</span>
</span><span id="FST.first_child-730"><a href="#FST.first_child-730"><span class="linenos">730</span></a><span class="sd">    &#39;a: list[str]&#39;</span>
</span><span id="FST.first_child-731"><a href="#FST.first_child-731"><span class="linenos">731</span></a>
</span><span id="FST.first_child-732"><a href="#FST.first_child-732"><span class="linenos">732</span></a><span class="sd">    &gt;&gt;&gt; f.args.first_child().first_child().src</span>
</span><span id="FST.first_child-733"><a href="#FST.first_child-733"><span class="linenos">733</span></a><span class="sd">    &#39;list[str]&#39;</span>
</span><span id="FST.first_child-734"><a href="#FST.first_child-734"><span class="linenos">734</span></a><span class="sd">    ```</span>
</span><span id="FST.first_child-735"><a href="#FST.first_child-735"><span class="linenos">735</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.first_child-736"><a href="#FST.first_child-736"><span class="linenos">736</span></a>
</span><span id="FST.first_child-737"><a href="#FST.first_child-737"><span class="linenos">737</span></a>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">AST_FIELDS</span><span class="p">[(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="vm">__class__</span><span class="p">]:</span>
</span><span id="FST.first_child-738"><a href="#FST.first_child-738"><span class="linenos">738</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">child</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
</span><span id="FST.first_child-739"><a href="#FST.first_child-739"><span class="linenos">739</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="FST.first_child-740"><a href="#FST.first_child-740"><span class="linenos">740</span></a>                <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.first_child-741"><a href="#FST.first_child-741"><span class="linenos">741</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.first_child-742"><a href="#FST.first_child-742"><span class="linenos">742</span></a>
</span><span id="FST.first_child-743"><a href="#FST.first_child-743"><span class="linenos">743</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.first_child-744"><a href="#FST.first_child-744"><span class="linenos">744</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">:=</span> <span class="n">child</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">c</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.first_child-745"><a href="#FST.first_child-745"><span class="linenos">745</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.first_child-746"><a href="#FST.first_child-746"><span class="linenos">746</span></a>
</span><span id="FST.first_child-747"><a href="#FST.first_child-747"><span class="linenos">747</span></a>                <span class="k">return</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">(</span><span class="n">Pass</span><span class="p">(),</span> <span class="bp">self</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)</span>  <span class="c1"># Pass() is a hack just to have a simple AST node</span>
</span><span id="FST.first_child-748"><a href="#FST.first_child-748"><span class="linenos">748</span></a>
</span><span id="FST.first_child-749"><a href="#FST.first_child-749"><span class="linenos">749</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Get first valid child in syntactic order.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
</ul></li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if no valid children, otherwise first valid child.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(a: list[str], /, reject: int, *c, d=100, **e): pass&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">first_child</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;a: list[str], /, reject: int, *c, d=100, **e&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">first_child</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;a: list[str]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">first_child</span><span class="p">()</span><span class="o">.</span><span class="n">first_child</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;list[str]&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.last_child" class="classattr">
                                        <input id="FST.last_child-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">last_child</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.last_child-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.last_child"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.last_child-752"><a href="#FST.last_child-752"><span class="linenos">752</span></a><span class="k">def</span><span class="w"> </span><span class="nf">last_child</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.last_child-753"><a href="#FST.last_child-753"><span class="linenos">753</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get last valid child in syntactic order.</span>
</span><span id="FST.last_child-754"><a href="#FST.last_child-754"><span class="linenos">754</span></a>
</span><span id="FST.last_child-755"><a href="#FST.last_child-755"><span class="linenos">755</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.last_child-756"><a href="#FST.last_child-756"><span class="linenos">756</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.last_child-757"><a href="#FST.last_child-757"><span class="linenos">757</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.last_child-758"><a href="#FST.last_child-758"><span class="linenos">758</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.last_child-759"><a href="#FST.last_child-759"><span class="linenos">759</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.last_child-760"><a href="#FST.last_child-760"><span class="linenos">760</span></a><span class="sd">            present).</span>
</span><span id="FST.last_child-761"><a href="#FST.last_child-761"><span class="linenos">761</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.last_child-762"><a href="#FST.last_child-762"><span class="linenos">762</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.last_child-763"><a href="#FST.last_child-763"><span class="linenos">763</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.last_child-764"><a href="#FST.last_child-764"><span class="linenos">764</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.last_child-765"><a href="#FST.last_child-765"><span class="linenos">765</span></a>
</span><span id="FST.last_child-766"><a href="#FST.last_child-766"><span class="linenos">766</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.last_child-767"><a href="#FST.last_child-767"><span class="linenos">767</span></a><span class="sd">    - `None` if no valid children, otherwise last valid child.</span>
</span><span id="FST.last_child-768"><a href="#FST.last_child-768"><span class="linenos">768</span></a>
</span><span id="FST.last_child-769"><a href="#FST.last_child-769"><span class="linenos">769</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.last_child-770"><a href="#FST.last_child-770"><span class="linenos">770</span></a><span class="sd">    ```py</span>
</span><span id="FST.last_child-771"><a href="#FST.last_child-771"><span class="linenos">771</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.last_child-772"><a href="#FST.last_child-772"><span class="linenos">772</span></a>
</span><span id="FST.last_child-773"><a href="#FST.last_child-773"><span class="linenos">773</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;def f(a: list[str], /, reject: int, *c, d=100, **e): pass&#39;)</span>
</span><span id="FST.last_child-774"><a href="#FST.last_child-774"><span class="linenos">774</span></a><span class="sd">    &gt;&gt;&gt; f.last_child().src</span>
</span><span id="FST.last_child-775"><a href="#FST.last_child-775"><span class="linenos">775</span></a><span class="sd">    &#39;pass&#39;</span>
</span><span id="FST.last_child-776"><a href="#FST.last_child-776"><span class="linenos">776</span></a>
</span><span id="FST.last_child-777"><a href="#FST.last_child-777"><span class="linenos">777</span></a><span class="sd">    &gt;&gt;&gt; f.args.last_child().src</span>
</span><span id="FST.last_child-778"><a href="#FST.last_child-778"><span class="linenos">778</span></a><span class="sd">    &#39;e&#39;</span>
</span><span id="FST.last_child-779"><a href="#FST.last_child-779"><span class="linenos">779</span></a><span class="sd">    ```</span>
</span><span id="FST.last_child-780"><a href="#FST.last_child-780"><span class="linenos">780</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.last_child-781"><a href="#FST.last_child-781"><span class="linenos">781</span></a>
</span><span id="FST.last_child-782"><a href="#FST.last_child-782"><span class="linenos">782</span></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">))</span> <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">args</span> <span class="ow">and</span> <span class="p">(</span><span class="n">keywords</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">keywords</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Starred</span><span class="p">):</span>  <span class="c1"># super-special case Call with args and keywords and a Starred, it could be anywhere in there, including after last keyword, defer to prev() logic</span>
</span><span id="FST.last_child-783"><a href="#FST.last_child-783"><span class="linenos">783</span></a>        <span class="n">fst_</span>         <span class="o">=</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">Pass</span><span class="p">(),</span> <span class="bp">self</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="s1">&#39;keywords&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">keywords</span><span class="p">)))</span>
</span><span id="FST.last_child-784"><a href="#FST.last_child-784"><span class="linenos">784</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">lineno</span>     <span class="o">=</span> <span class="mh">0x7fffffffffffffff</span>
</span><span id="FST.last_child-785"><a href="#FST.last_child-785"><span class="linenos">785</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">col_offset</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FST.last_child-786"><a href="#FST.last_child-786"><span class="linenos">786</span></a>
</span><span id="FST.last_child-787"><a href="#FST.last_child-787"><span class="linenos">787</span></a>        <span class="k">return</span> <span class="n">fst_</span><span class="o">.</span><span class="n">prev</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)</span>
</span><span id="FST.last_child-788"><a href="#FST.last_child-788"><span class="linenos">788</span></a>
</span><span id="FST.last_child-789"><a href="#FST.last_child-789"><span class="linenos">789</span></a>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">AST_FIELDS</span><span class="p">[(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="vm">__class__</span><span class="p">]):</span>
</span><span id="FST.last_child-790"><a href="#FST.last_child-790"><span class="linenos">790</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">child</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
</span><span id="FST.last_child-791"><a href="#FST.last_child-791"><span class="linenos">791</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">AST</span><span class="p">):</span>
</span><span id="FST.last_child-792"><a href="#FST.last_child-792"><span class="linenos">792</span></a>                <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.last_child-793"><a href="#FST.last_child-793"><span class="linenos">793</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.last_child-794"><a href="#FST.last_child-794"><span class="linenos">794</span></a>
</span><span id="FST.last_child-795"><a href="#FST.last_child-795"><span class="linenos">795</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.last_child-796"><a href="#FST.last_child-796"><span class="linenos">796</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">:=</span> <span class="n">child</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">c</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.last_child-797"><a href="#FST.last_child-797"><span class="linenos">797</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.last_child-798"><a href="#FST.last_child-798"><span class="linenos">798</span></a>
</span><span id="FST.last_child-799"><a href="#FST.last_child-799"><span class="linenos">799</span></a>                <span class="k">return</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">(</span><span class="n">Pass</span><span class="p">(),</span> <span class="bp">self</span><span class="p">,</span> <span class="n">astfield</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">child</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">prev</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)</span>  <span class="c1"># Pass() is a hack just to have a simple AST node</span>
</span><span id="FST.last_child-800"><a href="#FST.last_child-800"><span class="linenos">800</span></a>
</span><span id="FST.last_child-801"><a href="#FST.last_child-801"><span class="linenos">801</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Get last valid child in syntactic order.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
</ul></li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if no valid children, otherwise last valid child.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(a: list[str], /, reject: int, *c, d=100, **e): pass&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">last_child</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;pass&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">last_child</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;e&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.last_header_child" class="classattr">
                                        <input id="FST.last_header_child-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">last_header_child</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.last_header_child-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.last_header_child"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.last_header_child-804"><a href="#FST.last_header_child-804"><span class="linenos">804</span></a><span class="k">def</span><span class="w"> </span><span class="nf">last_header_child</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.last_header_child-805"><a href="#FST.last_header_child-805"><span class="linenos">805</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get last valid child in syntactic order in a block header (before the `:`), e.g. the `something` in</span>
</span><span id="FST.last_header_child-806"><a href="#FST.last_header_child-806"><span class="linenos">806</span></a><span class="sd">    `if something: pass`.</span>
</span><span id="FST.last_header_child-807"><a href="#FST.last_header_child-807"><span class="linenos">807</span></a>
</span><span id="FST.last_header_child-808"><a href="#FST.last_header_child-808"><span class="linenos">808</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.last_header_child-809"><a href="#FST.last_header_child-809"><span class="linenos">809</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.last_header_child-810"><a href="#FST.last_header_child-810"><span class="linenos">810</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.last_header_child-811"><a href="#FST.last_header_child-811"><span class="linenos">811</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.last_header_child-812"><a href="#FST.last_header_child-812"><span class="linenos">812</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.last_header_child-813"><a href="#FST.last_header_child-813"><span class="linenos">813</span></a><span class="sd">            present).</span>
</span><span id="FST.last_header_child-814"><a href="#FST.last_header_child-814"><span class="linenos">814</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.last_header_child-815"><a href="#FST.last_header_child-815"><span class="linenos">815</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.last_header_child-816"><a href="#FST.last_header_child-816"><span class="linenos">816</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.last_header_child-817"><a href="#FST.last_header_child-817"><span class="linenos">817</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.last_header_child-818"><a href="#FST.last_header_child-818"><span class="linenos">818</span></a>
</span><span id="FST.last_header_child-819"><a href="#FST.last_header_child-819"><span class="linenos">819</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.last_header_child-820"><a href="#FST.last_header_child-820"><span class="linenos">820</span></a><span class="sd">    - `None` if no valid children or if `self` is not a block statement, otherwise last valid child in the block header.</span>
</span><span id="FST.last_header_child-821"><a href="#FST.last_header_child-821"><span class="linenos">821</span></a>
</span><span id="FST.last_header_child-822"><a href="#FST.last_header_child-822"><span class="linenos">822</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.last_header_child-823"><a href="#FST.last_header_child-823"><span class="linenos">823</span></a><span class="sd">    ```py</span>
</span><span id="FST.last_header_child-824"><a href="#FST.last_header_child-824"><span class="linenos">824</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.last_header_child-825"><a href="#FST.last_header_child-825"><span class="linenos">825</span></a>
</span><span id="FST.last_header_child-826"><a href="#FST.last_header_child-826"><span class="linenos">826</span></a><span class="sd">    &gt;&gt;&gt; print(FST(&#39;if something:\n    i = 2\n    i = 3&#39;)</span>
</span><span id="FST.last_header_child-827"><a href="#FST.last_header_child-827"><span class="linenos">827</span></a><span class="sd">    ...       .last_header_child().src)</span>
</span><span id="FST.last_header_child-828"><a href="#FST.last_header_child-828"><span class="linenos">828</span></a><span class="sd">    something</span>
</span><span id="FST.last_header_child-829"><a href="#FST.last_header_child-829"><span class="linenos">829</span></a>
</span><span id="FST.last_header_child-830"><a href="#FST.last_header_child-830"><span class="linenos">830</span></a><span class="sd">    &gt;&gt;&gt; print(FST(&#39;try: pass\nexcept Exception as exc: pass&#39;).handlers[0]</span>
</span><span id="FST.last_header_child-831"><a href="#FST.last_header_child-831"><span class="linenos">831</span></a><span class="sd">    ...       .last_header_child().src)</span>
</span><span id="FST.last_header_child-832"><a href="#FST.last_header_child-832"><span class="linenos">832</span></a><span class="sd">    Exception</span>
</span><span id="FST.last_header_child-833"><a href="#FST.last_header_child-833"><span class="linenos">833</span></a>
</span><span id="FST.last_header_child-834"><a href="#FST.last_header_child-834"><span class="linenos">834</span></a><span class="sd">    &gt;&gt;&gt; print(FST(&#39;with a, b: pass&#39;).last_header_child().src)</span>
</span><span id="FST.last_header_child-835"><a href="#FST.last_header_child-835"><span class="linenos">835</span></a><span class="sd">    b</span>
</span><span id="FST.last_header_child-836"><a href="#FST.last_header_child-836"><span class="linenos">836</span></a>
</span><span id="FST.last_header_child-837"><a href="#FST.last_header_child-837"><span class="linenos">837</span></a><span class="sd">    &gt;&gt;&gt; print(FST(&#39;try: pass\nfinally: pass&#39;).last_header_child())</span>
</span><span id="FST.last_header_child-838"><a href="#FST.last_header_child-838"><span class="linenos">838</span></a><span class="sd">    None</span>
</span><span id="FST.last_header_child-839"><a href="#FST.last_header_child-839"><span class="linenos">839</span></a>
</span><span id="FST.last_header_child-840"><a href="#FST.last_header_child-840"><span class="linenos">840</span></a><span class="sd">    &gt;&gt;&gt; print(FST(&#39;i = 1&#39;).last_header_child())</span>
</span><span id="FST.last_header_child-841"><a href="#FST.last_header_child-841"><span class="linenos">841</span></a><span class="sd">    None</span>
</span><span id="FST.last_header_child-842"><a href="#FST.last_header_child-842"><span class="linenos">842</span></a><span class="sd">    ```</span>
</span><span id="FST.last_header_child-843"><a href="#FST.last_header_child-843"><span class="linenos">843</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.last_header_child-844"><a href="#FST.last_header_child-844"><span class="linenos">844</span></a>
</span><span id="FST.last_header_child-845"><a href="#FST.last_header_child-845"><span class="linenos">845</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">child</span> <span class="o">:=</span> <span class="n">last_block_header_child</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)):</span>
</span><span id="FST.last_header_child-846"><a href="#FST.last_header_child-846"><span class="linenos">846</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.last_header_child-847"><a href="#FST.last_header_child-847"><span class="linenos">847</span></a>
</span><span id="FST.last_header_child-848"><a href="#FST.last_header_child-848"><span class="linenos">848</span></a>    <span class="k">if</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.last_header_child-849"><a href="#FST.last_header_child-849"><span class="linenos">849</span></a>        <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.last_header_child-850"><a href="#FST.last_header_child-850"><span class="linenos">850</span></a>
</span><span id="FST.last_header_child-851"><a href="#FST.last_header_child-851"><span class="linenos">851</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_child</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get last valid child in syntactic order in a block header (before the <code>:</code>), e.g. the <code>something</code> in
<code>if something: pass</code>.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
</ul></li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if no valid children or if <code>self</code> is not a block statement, otherwise last valid child in the block header.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if something:</span><span class="se">\n</span><span class="s1">    i = 2</span><span class="se">\n</span><span class="s1">    i = 3&#39;</span><span class="p">)</span>
<span class="o">...</span>       <span class="o">.</span><span class="n">last_header_child</span><span class="p">()</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="n">something</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">except Exception as exc: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">...</span>       <span class="o">.</span><span class="n">last_header_child</span><span class="p">()</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="ne">Exception</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;with a, b: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">last_header_child</span><span class="p">()</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="n">b</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">finally: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">last_header_child</span><span class="p">())</span>
<span class="kc">None</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">last_header_child</span><span class="p">())</span>
<span class="kc">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.next_child" class="classattr">
                                        <input id="FST.next_child-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_child</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">from_child</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.next_child-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.next_child"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.next_child-854"><a href="#FST.next_child-854"><span class="linenos">854</span></a><span class="k">def</span><span class="w"> </span><span class="nf">next_child</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">from_child</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FST.next_child-855"><a href="#FST.next_child-855"><span class="linenos">855</span></a>               <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.next_child-856"><a href="#FST.next_child-856"><span class="linenos">856</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the next child in syntactic order, meant for simple iteration.</span>
</span><span id="FST.next_child-857"><a href="#FST.next_child-857"><span class="linenos">857</span></a>
</span><span id="FST.next_child-858"><a href="#FST.next_child-858"><span class="linenos">858</span></a><span class="sd">    This is a slower way to iterate vs. `walk()`, but will work correctly if ANYTHING in the tree is modified during the</span>
</span><span id="FST.next_child-859"><a href="#FST.next_child-859"><span class="linenos">859</span></a><span class="sd">    walk as long as the replaced node and its parent is used for the following call.</span>
</span><span id="FST.next_child-860"><a href="#FST.next_child-860"><span class="linenos">860</span></a>
</span><span id="FST.next_child-861"><a href="#FST.next_child-861"><span class="linenos">861</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.next_child-862"><a href="#FST.next_child-862"><span class="linenos">862</span></a><span class="sd">    - `from_child`: Child node we are coming from which may or may not have location.</span>
</span><span id="FST.next_child-863"><a href="#FST.next_child-863"><span class="linenos">863</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.next_child-864"><a href="#FST.next_child-864"><span class="linenos">864</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.next_child-865"><a href="#FST.next_child-865"><span class="linenos">865</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.next_child-866"><a href="#FST.next_child-866"><span class="linenos">866</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.next_child-867"><a href="#FST.next_child-867"><span class="linenos">867</span></a><span class="sd">            present).</span>
</span><span id="FST.next_child-868"><a href="#FST.next_child-868"><span class="linenos">868</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.next_child-869"><a href="#FST.next_child-869"><span class="linenos">869</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.next_child-870"><a href="#FST.next_child-870"><span class="linenos">870</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.next_child-871"><a href="#FST.next_child-871"><span class="linenos">871</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.next_child-872"><a href="#FST.next_child-872"><span class="linenos">872</span></a>
</span><span id="FST.next_child-873"><a href="#FST.next_child-873"><span class="linenos">873</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.next_child-874"><a href="#FST.next_child-874"><span class="linenos">874</span></a><span class="sd">    - `None` if last valid child in `self`, otherwise next child node.</span>
</span><span id="FST.next_child-875"><a href="#FST.next_child-875"><span class="linenos">875</span></a>
</span><span id="FST.next_child-876"><a href="#FST.next_child-876"><span class="linenos">876</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.next_child-877"><a href="#FST.next_child-877"><span class="linenos">877</span></a><span class="sd">    ```py</span>
</span><span id="FST.next_child-878"><a href="#FST.next_child-878"><span class="linenos">878</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.next_child-879"><a href="#FST.next_child-879"><span class="linenos">879</span></a>
</span><span id="FST.next_child-880"><a href="#FST.next_child-880"><span class="linenos">880</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[[1, 2], [3, 4]]&#39;)</span>
</span><span id="FST.next_child-881"><a href="#FST.next_child-881"><span class="linenos">881</span></a><span class="sd">    &gt;&gt;&gt; f.next_child(f.elts[0]).src</span>
</span><span id="FST.next_child-882"><a href="#FST.next_child-882"><span class="linenos">882</span></a><span class="sd">    &#39;[3, 4]&#39;</span>
</span><span id="FST.next_child-883"><a href="#FST.next_child-883"><span class="linenos">883</span></a>
</span><span id="FST.next_child-884"><a href="#FST.next_child-884"><span class="linenos">884</span></a><span class="sd">    &gt;&gt;&gt; print(f.next_child(f.elts[1]))</span>
</span><span id="FST.next_child-885"><a href="#FST.next_child-885"><span class="linenos">885</span></a><span class="sd">    None</span>
</span><span id="FST.next_child-886"><a href="#FST.next_child-886"><span class="linenos">886</span></a>
</span><span id="FST.next_child-887"><a href="#FST.next_child-887"><span class="linenos">887</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[this, is_, reparsed, each, step, and_, still, walks, ok]&#39;)</span>
</span><span id="FST.next_child-888"><a href="#FST.next_child-888"><span class="linenos">888</span></a><span class="sd">    &gt;&gt;&gt; n = None</span>
</span><span id="FST.next_child-889"><a href="#FST.next_child-889"><span class="linenos">889</span></a><span class="sd">    &gt;&gt;&gt; while n := f.next_child(n):</span>
</span><span id="FST.next_child-890"><a href="#FST.next_child-890"><span class="linenos">890</span></a><span class="sd">    ...     if isinstance(n.a, Name):</span>
</span><span id="FST.next_child-891"><a href="#FST.next_child-891"><span class="linenos">891</span></a><span class="sd">    ...         n = n.replace(n.id[::-1], raw=True)  # raw here reparses all nodes</span>
</span><span id="FST.next_child-892"><a href="#FST.next_child-892"><span class="linenos">892</span></a><span class="sd">    &gt;&gt;&gt; f.src</span>
</span><span id="FST.next_child-893"><a href="#FST.next_child-893"><span class="linenos">893</span></a><span class="sd">    &#39;[siht, _si, desraper, hcae, pets, _dna, llits, sklaw, ko]&#39;</span>
</span><span id="FST.next_child-894"><a href="#FST.next_child-894"><span class="linenos">894</span></a><span class="sd">    ```</span>
</span><span id="FST.next_child-895"><a href="#FST.next_child-895"><span class="linenos">895</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.next_child-896"><a href="#FST.next_child-896"><span class="linenos">896</span></a>
</span><span id="FST.next_child-897"><a href="#FST.next_child-897"><span class="linenos">897</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_child</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)</span> <span class="k">if</span> <span class="n">from_child</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">from_child</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the next child in syntactic order, meant for simple iteration.</p>

<p>This is a slower way to iterate vs. <code><a href="#FST.walk">walk()</a></code>, but will work correctly if ANYTHING in the tree is modified during the
walk as long as the replaced node and its parent is used for the following call.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>from_child</code>: Child node we are coming from which may or may not have location.</li>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
</ul></li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if last valid child in <code>self</code>, otherwise next child node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[[1, 2], [3, 4]]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">next_child</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[3, 4]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">next_child</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="kc">None</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[this, is_, reparsed, each, step, and_, still, walks, ok]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="kc">None</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">f</span><span class="o">.</span><span class="n">next_child</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Name</span><span class="p">):</span>
<span class="o">...</span>         <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">id</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># raw here reparses all nodes</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[siht, _si, desraper, hcae, pets, _dna, llits, sklaw, ko]&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.prev_child" class="classattr">
                                        <input id="FST.prev_child-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prev_child</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">from_child</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.prev_child-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.prev_child"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.prev_child-900"><a href="#FST.prev_child-900"><span class="linenos">900</span></a><span class="k">def</span><span class="w"> </span><span class="nf">prev_child</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">from_child</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FST.prev_child-901"><a href="#FST.prev_child-901"><span class="linenos">901</span></a>               <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.prev_child-902"><a href="#FST.prev_child-902"><span class="linenos">902</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the previous child in syntactic order, meant for simple iteration.</span>
</span><span id="FST.prev_child-903"><a href="#FST.prev_child-903"><span class="linenos">903</span></a>
</span><span id="FST.prev_child-904"><a href="#FST.prev_child-904"><span class="linenos">904</span></a><span class="sd">    This is a slower way to iterate vs. `walk()`, but will work correctly if ANYTHING in the tree is modified during the</span>
</span><span id="FST.prev_child-905"><a href="#FST.prev_child-905"><span class="linenos">905</span></a><span class="sd">    walk as long as the replaced node and its parent is used for the following call.</span>
</span><span id="FST.prev_child-906"><a href="#FST.prev_child-906"><span class="linenos">906</span></a>
</span><span id="FST.prev_child-907"><a href="#FST.prev_child-907"><span class="linenos">907</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.prev_child-908"><a href="#FST.prev_child-908"><span class="linenos">908</span></a><span class="sd">    - `from_child`: Child node we are coming from which may or may not have location.</span>
</span><span id="FST.prev_child-909"><a href="#FST.prev_child-909"><span class="linenos">909</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.prev_child-910"><a href="#FST.prev_child-910"><span class="linenos">910</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.prev_child-911"><a href="#FST.prev_child-911"><span class="linenos">911</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.prev_child-912"><a href="#FST.prev_child-912"><span class="linenos">912</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.prev_child-913"><a href="#FST.prev_child-913"><span class="linenos">913</span></a><span class="sd">            present).</span>
</span><span id="FST.prev_child-914"><a href="#FST.prev_child-914"><span class="linenos">914</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.prev_child-915"><a href="#FST.prev_child-915"><span class="linenos">915</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.prev_child-916"><a href="#FST.prev_child-916"><span class="linenos">916</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.prev_child-917"><a href="#FST.prev_child-917"><span class="linenos">917</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.prev_child-918"><a href="#FST.prev_child-918"><span class="linenos">918</span></a>
</span><span id="FST.prev_child-919"><a href="#FST.prev_child-919"><span class="linenos">919</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.prev_child-920"><a href="#FST.prev_child-920"><span class="linenos">920</span></a><span class="sd">    - `None` if first valid child in `self`, otherwise previous child node.</span>
</span><span id="FST.prev_child-921"><a href="#FST.prev_child-921"><span class="linenos">921</span></a>
</span><span id="FST.prev_child-922"><a href="#FST.prev_child-922"><span class="linenos">922</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.prev_child-923"><a href="#FST.prev_child-923"><span class="linenos">923</span></a><span class="sd">    ```py</span>
</span><span id="FST.prev_child-924"><a href="#FST.prev_child-924"><span class="linenos">924</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.prev_child-925"><a href="#FST.prev_child-925"><span class="linenos">925</span></a>
</span><span id="FST.prev_child-926"><a href="#FST.prev_child-926"><span class="linenos">926</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[[1, 2], [3, 4]]&#39;)</span>
</span><span id="FST.prev_child-927"><a href="#FST.prev_child-927"><span class="linenos">927</span></a><span class="sd">    &gt;&gt;&gt; f.prev_child(f.elts[1]).src</span>
</span><span id="FST.prev_child-928"><a href="#FST.prev_child-928"><span class="linenos">928</span></a><span class="sd">    &#39;[1, 2]&#39;</span>
</span><span id="FST.prev_child-929"><a href="#FST.prev_child-929"><span class="linenos">929</span></a>
</span><span id="FST.prev_child-930"><a href="#FST.prev_child-930"><span class="linenos">930</span></a><span class="sd">    &gt;&gt;&gt; print(f.prev_child(f.elts[0]))</span>
</span><span id="FST.prev_child-931"><a href="#FST.prev_child-931"><span class="linenos">931</span></a><span class="sd">    None</span>
</span><span id="FST.prev_child-932"><a href="#FST.prev_child-932"><span class="linenos">932</span></a>
</span><span id="FST.prev_child-933"><a href="#FST.prev_child-933"><span class="linenos">933</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[this, is_, reparsed, each, step, and_, still, walks, ok]&#39;)</span>
</span><span id="FST.prev_child-934"><a href="#FST.prev_child-934"><span class="linenos">934</span></a><span class="sd">    &gt;&gt;&gt; n = None</span>
</span><span id="FST.prev_child-935"><a href="#FST.prev_child-935"><span class="linenos">935</span></a><span class="sd">    &gt;&gt;&gt; while n := f.prev_child(n):</span>
</span><span id="FST.prev_child-936"><a href="#FST.prev_child-936"><span class="linenos">936</span></a><span class="sd">    ...     if isinstance(n.a, Name):</span>
</span><span id="FST.prev_child-937"><a href="#FST.prev_child-937"><span class="linenos">937</span></a><span class="sd">    ...         n = n.replace(n.id[::-1], raw=True)  # raw here reparses all nodes</span>
</span><span id="FST.prev_child-938"><a href="#FST.prev_child-938"><span class="linenos">938</span></a><span class="sd">    &gt;&gt;&gt; f.src</span>
</span><span id="FST.prev_child-939"><a href="#FST.prev_child-939"><span class="linenos">939</span></a><span class="sd">    &#39;[siht, _si, desraper, hcae, pets, _dna, llits, sklaw, ko]&#39;</span>
</span><span id="FST.prev_child-940"><a href="#FST.prev_child-940"><span class="linenos">940</span></a><span class="sd">    ```</span>
</span><span id="FST.prev_child-941"><a href="#FST.prev_child-941"><span class="linenos">941</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.prev_child-942"><a href="#FST.prev_child-942"><span class="linenos">942</span></a>
</span><span id="FST.prev_child-943"><a href="#FST.prev_child-943"><span class="linenos">943</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_child</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)</span> <span class="k">if</span> <span class="n">from_child</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">from_child</span><span class="o">.</span><span class="n">prev</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the previous child in syntactic order, meant for simple iteration.</p>

<p>This is a slower way to iterate vs. <code><a href="#FST.walk">walk()</a></code>, but will work correctly if ANYTHING in the tree is modified during the
walk as long as the replaced node and its parent is used for the following call.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>from_child</code>: Child node we are coming from which may or may not have location.</li>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
</ul></li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if first valid child in <code>self</code>, otherwise previous child node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[[1, 2], [3, 4]]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">prev_child</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">prev_child</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="kc">None</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[this, is_, reparsed, each, step, and_, still, walks, ok]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="kc">None</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">f</span><span class="o">.</span><span class="n">prev_child</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Name</span><span class="p">):</span>
<span class="o">...</span>         <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">id</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># raw here reparses all nodes</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[siht, _si, desraper, hcae, pets, _dna, llits, sklaw, ko]&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.step_fwd" class="classattr">
                                        <input id="FST.step_fwd-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">step_fwd</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">,</span> <span class="s1">&#39;allown&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">recurse_self</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.step_fwd-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.step_fwd"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.step_fwd-946"><a href="#FST.step_fwd-946"><span class="linenos"> 946</span></a><span class="k">def</span><span class="w"> </span><span class="nf">step_fwd</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">,</span> <span class="s1">&#39;allown&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">recurse_self</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FST.step_fwd-947"><a href="#FST.step_fwd-947"><span class="linenos"> 947</span></a>             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.step_fwd-948"><a href="#FST.step_fwd-948"><span class="linenos"> 948</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Step forward in the tree in syntactic order, as if `walk()`ing forward, NOT the inverse of `step_back()`. Will</span>
</span><span id="FST.step_fwd-949"><a href="#FST.step_fwd-949"><span class="linenos"> 949</span></a><span class="sd">    walk up parents and down children to get the next node, returning `None` only when we are at the end of the whole</span>
</span><span id="FST.step_fwd-950"><a href="#FST.step_fwd-950"><span class="linenos"> 950</span></a><span class="sd">    thing.</span>
</span><span id="FST.step_fwd-951"><a href="#FST.step_fwd-951"><span class="linenos"> 951</span></a>
</span><span id="FST.step_fwd-952"><a href="#FST.step_fwd-952"><span class="linenos"> 952</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.step_fwd-953"><a href="#FST.step_fwd-953"><span class="linenos"> 953</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.step_fwd-954"><a href="#FST.step_fwd-954"><span class="linenos"> 954</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.step_fwd-955"><a href="#FST.step_fwd-955"><span class="linenos"> 955</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.step_fwd-956"><a href="#FST.step_fwd-956"><span class="linenos"> 956</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.step_fwd-957"><a href="#FST.step_fwd-957"><span class="linenos"> 957</span></a><span class="sd">            present).</span>
</span><span id="FST.step_fwd-958"><a href="#FST.step_fwd-958"><span class="linenos"> 958</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.step_fwd-959"><a href="#FST.step_fwd-959"><span class="linenos"> 959</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.step_fwd-960"><a href="#FST.step_fwd-960"><span class="linenos"> 960</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.step_fwd-961"><a href="#FST.step_fwd-961"><span class="linenos"> 961</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.step_fwd-962"><a href="#FST.step_fwd-962"><span class="linenos"> 962</span></a><span class="sd">        - `&#39;allown&#39;` Same as `&#39;own&#39;` but recurse into nodes with non-own locations (even though those nodes are not</span>
</span><span id="FST.step_fwd-963"><a href="#FST.step_fwd-963"><span class="linenos"> 963</span></a><span class="sd">            returned). This is only really meant for internal use to safely call from `.loc` location calculation.</span>
</span><span id="FST.step_fwd-964"><a href="#FST.step_fwd-964"><span class="linenos"> 964</span></a><span class="sd">    - `recurse_self`: Whether to allow recursion into `self` to return children or move directly to next nodes of `self`</span>
</span><span id="FST.step_fwd-965"><a href="#FST.step_fwd-965"><span class="linenos"> 965</span></a><span class="sd">        on start.</span>
</span><span id="FST.step_fwd-966"><a href="#FST.step_fwd-966"><span class="linenos"> 966</span></a>
</span><span id="FST.step_fwd-967"><a href="#FST.step_fwd-967"><span class="linenos"> 967</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.step_fwd-968"><a href="#FST.step_fwd-968"><span class="linenos"> 968</span></a><span class="sd">    - `None` if last valid node in tree, otherwise next node in order.</span>
</span><span id="FST.step_fwd-969"><a href="#FST.step_fwd-969"><span class="linenos"> 969</span></a>
</span><span id="FST.step_fwd-970"><a href="#FST.step_fwd-970"><span class="linenos"> 970</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.step_fwd-971"><a href="#FST.step_fwd-971"><span class="linenos"> 971</span></a><span class="sd">    ```py</span>
</span><span id="FST.step_fwd-972"><a href="#FST.step_fwd-972"><span class="linenos"> 972</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.step_fwd-973"><a href="#FST.step_fwd-973"><span class="linenos"> 973</span></a>
</span><span id="FST.step_fwd-974"><a href="#FST.step_fwd-974"><span class="linenos"> 974</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[[1, 2], [3, 4]]&#39;)</span>
</span><span id="FST.step_fwd-975"><a href="#FST.step_fwd-975"><span class="linenos"> 975</span></a><span class="sd">    &gt;&gt;&gt; f.elts[0].src</span>
</span><span id="FST.step_fwd-976"><a href="#FST.step_fwd-976"><span class="linenos"> 976</span></a><span class="sd">    &#39;[1, 2]&#39;</span>
</span><span id="FST.step_fwd-977"><a href="#FST.step_fwd-977"><span class="linenos"> 977</span></a>
</span><span id="FST.step_fwd-978"><a href="#FST.step_fwd-978"><span class="linenos"> 978</span></a><span class="sd">    &gt;&gt;&gt; f.elts[0].step_fwd().src</span>
</span><span id="FST.step_fwd-979"><a href="#FST.step_fwd-979"><span class="linenos"> 979</span></a><span class="sd">    &#39;1&#39;</span>
</span><span id="FST.step_fwd-980"><a href="#FST.step_fwd-980"><span class="linenos"> 980</span></a>
</span><span id="FST.step_fwd-981"><a href="#FST.step_fwd-981"><span class="linenos"> 981</span></a><span class="sd">    &gt;&gt;&gt; f.elts[0].step_fwd(recurse_self=False).src</span>
</span><span id="FST.step_fwd-982"><a href="#FST.step_fwd-982"><span class="linenos"> 982</span></a><span class="sd">    &#39;[3, 4]&#39;</span>
</span><span id="FST.step_fwd-983"><a href="#FST.step_fwd-983"><span class="linenos"> 983</span></a>
</span><span id="FST.step_fwd-984"><a href="#FST.step_fwd-984"><span class="linenos"> 984</span></a><span class="sd">    &gt;&gt;&gt; f.elts[0].elts[1].src</span>
</span><span id="FST.step_fwd-985"><a href="#FST.step_fwd-985"><span class="linenos"> 985</span></a><span class="sd">    &#39;2&#39;</span>
</span><span id="FST.step_fwd-986"><a href="#FST.step_fwd-986"><span class="linenos"> 986</span></a>
</span><span id="FST.step_fwd-987"><a href="#FST.step_fwd-987"><span class="linenos"> 987</span></a><span class="sd">    &gt;&gt;&gt; f.elts[0].elts[1].step_fwd().src</span>
</span><span id="FST.step_fwd-988"><a href="#FST.step_fwd-988"><span class="linenos"> 988</span></a><span class="sd">    &#39;[3, 4]&#39;</span>
</span><span id="FST.step_fwd-989"><a href="#FST.step_fwd-989"><span class="linenos"> 989</span></a>
</span><span id="FST.step_fwd-990"><a href="#FST.step_fwd-990"><span class="linenos"> 990</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[this, [is_, [reparsed, each], step, and_, still], walks, ok]&#39;)</span>
</span><span id="FST.step_fwd-991"><a href="#FST.step_fwd-991"><span class="linenos"> 991</span></a><span class="sd">    &gt;&gt;&gt; n = f.elts[0]</span>
</span><span id="FST.step_fwd-992"><a href="#FST.step_fwd-992"><span class="linenos"> 992</span></a><span class="sd">    &gt;&gt;&gt; while True:</span>
</span><span id="FST.step_fwd-993"><a href="#FST.step_fwd-993"><span class="linenos"> 993</span></a><span class="sd">    ...     if isinstance(n.a, Name):</span>
</span><span id="FST.step_fwd-994"><a href="#FST.step_fwd-994"><span class="linenos"> 994</span></a><span class="sd">    ...         n = n.replace(n.id[::-1], raw=True)  # raw here reparses all nodes</span>
</span><span id="FST.step_fwd-995"><a href="#FST.step_fwd-995"><span class="linenos"> 995</span></a><span class="sd">    ...     if not (n := n.step_fwd()):</span>
</span><span id="FST.step_fwd-996"><a href="#FST.step_fwd-996"><span class="linenos"> 996</span></a><span class="sd">    ...         break</span>
</span><span id="FST.step_fwd-997"><a href="#FST.step_fwd-997"><span class="linenos"> 997</span></a><span class="sd">    &gt;&gt;&gt; f.src</span>
</span><span id="FST.step_fwd-998"><a href="#FST.step_fwd-998"><span class="linenos"> 998</span></a><span class="sd">    &#39;[siht, [_si, [desraper, hcae], pets, _dna, llits], sklaw, ko]&#39;</span>
</span><span id="FST.step_fwd-999"><a href="#FST.step_fwd-999"><span class="linenos"> 999</span></a><span class="sd">    ```</span>
</span><span id="FST.step_fwd-1000"><a href="#FST.step_fwd-1000"><span class="linenos">1000</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.step_fwd-1001"><a href="#FST.step_fwd-1001"><span class="linenos">1001</span></a>
</span><span id="FST.step_fwd-1002"><a href="#FST.step_fwd-1002"><span class="linenos">1002</span></a>    <span class="k">if</span> <span class="n">allown</span> <span class="o">:=</span> <span class="n">with_loc</span> <span class="o">==</span> <span class="s1">&#39;allown&#39;</span><span class="p">:</span>
</span><span id="FST.step_fwd-1003"><a href="#FST.step_fwd-1003"><span class="linenos">1003</span></a>        <span class="n">with_loc</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FST.step_fwd-1004"><a href="#FST.step_fwd-1004"><span class="linenos">1004</span></a>
</span><span id="FST.step_fwd-1005"><a href="#FST.step_fwd-1005"><span class="linenos">1005</span></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.step_fwd-1006"><a href="#FST.step_fwd-1006"><span class="linenos">1006</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">recurse_self</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">fst_</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_child</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)):</span>
</span><span id="FST.step_fwd-1007"><a href="#FST.step_fwd-1007"><span class="linenos">1007</span></a>            <span class="n">recurse_self</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FST.step_fwd-1008"><a href="#FST.step_fwd-1008"><span class="linenos">1008</span></a>
</span><span id="FST.step_fwd-1009"><a href="#FST.step_fwd-1009"><span class="linenos">1009</span></a>            <span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="n">fst_</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)):</span>
</span><span id="FST.step_fwd-1010"><a href="#FST.step_fwd-1010"><span class="linenos">1010</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST.step_fwd-1011"><a href="#FST.step_fwd-1011"><span class="linenos">1011</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.step_fwd-1012"><a href="#FST.step_fwd-1012"><span class="linenos">1012</span></a>
</span><span id="FST.step_fwd-1013"><a href="#FST.step_fwd-1013"><span class="linenos">1013</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">allown</span> <span class="ow">or</span> <span class="n">fst_</span><span class="o">.</span><span class="n">has_own_loc</span><span class="p">:</span>
</span><span id="FST.step_fwd-1014"><a href="#FST.step_fwd-1014"><span class="linenos">1014</span></a>            <span class="k">break</span>
</span><span id="FST.step_fwd-1015"><a href="#FST.step_fwd-1015"><span class="linenos">1015</span></a>
</span><span id="FST.step_fwd-1016"><a href="#FST.step_fwd-1016"><span class="linenos">1016</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="n">fst_</span>
</span><span id="FST.step_fwd-1017"><a href="#FST.step_fwd-1017"><span class="linenos">1017</span></a>
</span><span id="FST.step_fwd-1018"><a href="#FST.step_fwd-1018"><span class="linenos">1018</span></a>    <span class="k">return</span> <span class="n">fst_</span>
</span></pre></div>


            <div class="docstring"><p>Step forward in the tree in syntactic order, as if <code><a href="#FST.walk">walk()</a></code>ing forward, NOT the inverse of <code><a href="#FST.step_back">step_back()</a></code>. Will
walk up parents and down children to get the next node, returning <code>None</code> only when we are at the end of the whole
thing.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
<li><code>'allown'</code> Same as <code>'own'</code> but recurse into nodes with non-own locations (even though those nodes are not
returned). This is only really meant for internal use to safely call from <code>.loc</code> location calculation.</li>
</ul></li>
<li><code>recurse_self</code>: Whether to allow recursion into <code>self</code> to return children or move directly to next nodes of <code>self</code>
on start.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if last valid node in tree, otherwise next node in order.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[[1, 2], [3, 4]]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">step_fwd</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;1&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">step_fwd</span><span class="p">(</span><span class="n">recurse_self</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[3, 4]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;2&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">step_fwd</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[3, 4]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[this, [is_, [reparsed, each], step, and_, still], walks, ok]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Name</span><span class="p">):</span>
<span class="o">...</span>         <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">id</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># raw here reparses all nodes</span>
<span class="o">...</span>     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">n</span> <span class="o">:=</span> <span class="n">n</span><span class="o">.</span><span class="n">step_fwd</span><span class="p">()):</span>
<span class="o">...</span>         <span class="k">break</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[siht, [_si, [desraper, hcae], pets, _dna, llits], sklaw, ko]&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.step_back" class="classattr">
                                        <input id="FST.step_back-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">step_back</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">,</span> <span class="s1">&#39;allown&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">recurse_self</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.step_back-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.step_back"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.step_back-1021"><a href="#FST.step_back-1021"><span class="linenos">1021</span></a><span class="k">def</span><span class="w"> </span><span class="nf">step_back</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">,</span> <span class="s1">&#39;allown&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">recurse_self</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FST.step_back-1022"><a href="#FST.step_back-1022"><span class="linenos">1022</span></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.step_back-1023"><a href="#FST.step_back-1023"><span class="linenos">1023</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Step backward in the tree in syntactic order, as if `walk()`ing backward, NOT the inverse of `step_fwd()`. Will</span>
</span><span id="FST.step_back-1024"><a href="#FST.step_back-1024"><span class="linenos">1024</span></a><span class="sd">    walk up parents and down children to get the next node, returning `None` only when we are at the beginning of the</span>
</span><span id="FST.step_back-1025"><a href="#FST.step_back-1025"><span class="linenos">1025</span></a><span class="sd">    whole thing.</span>
</span><span id="FST.step_back-1026"><a href="#FST.step_back-1026"><span class="linenos">1026</span></a>
</span><span id="FST.step_back-1027"><a href="#FST.step_back-1027"><span class="linenos">1027</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.step_back-1028"><a href="#FST.step_back-1028"><span class="linenos">1028</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.step_back-1029"><a href="#FST.step_back-1029"><span class="linenos">1029</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.step_back-1030"><a href="#FST.step_back-1030"><span class="linenos">1030</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.step_back-1031"><a href="#FST.step_back-1031"><span class="linenos">1031</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.step_back-1032"><a href="#FST.step_back-1032"><span class="linenos">1032</span></a><span class="sd">            present).</span>
</span><span id="FST.step_back-1033"><a href="#FST.step_back-1033"><span class="linenos">1033</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.step_back-1034"><a href="#FST.step_back-1034"><span class="linenos">1034</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.step_back-1035"><a href="#FST.step_back-1035"><span class="linenos">1035</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.step_back-1036"><a href="#FST.step_back-1036"><span class="linenos">1036</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.step_back-1037"><a href="#FST.step_back-1037"><span class="linenos">1037</span></a><span class="sd">        - `&#39;allown&#39;` Same as `&#39;own&#39;` but recurse into nodes with non-own locations (even though those nodes are not</span>
</span><span id="FST.step_back-1038"><a href="#FST.step_back-1038"><span class="linenos">1038</span></a><span class="sd">            returned). This is only really meant for internal use to safely call from `.loc` location calculation.</span>
</span><span id="FST.step_back-1039"><a href="#FST.step_back-1039"><span class="linenos">1039</span></a><span class="sd">    - `recurse_self`: Whether to allow recursion into `self` to return children or move directly to previous nodes of</span>
</span><span id="FST.step_back-1040"><a href="#FST.step_back-1040"><span class="linenos">1040</span></a><span class="sd">        `self` on start.</span>
</span><span id="FST.step_back-1041"><a href="#FST.step_back-1041"><span class="linenos">1041</span></a>
</span><span id="FST.step_back-1042"><a href="#FST.step_back-1042"><span class="linenos">1042</span></a><span class="sd">    **Returns:**</span>
</span><span id="FST.step_back-1043"><a href="#FST.step_back-1043"><span class="linenos">1043</span></a><span class="sd">    - `None` if first valid node in tree, otherwise previous node in order.</span>
</span><span id="FST.step_back-1044"><a href="#FST.step_back-1044"><span class="linenos">1044</span></a>
</span><span id="FST.step_back-1045"><a href="#FST.step_back-1045"><span class="linenos">1045</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.step_back-1046"><a href="#FST.step_back-1046"><span class="linenos">1046</span></a><span class="sd">    ```py</span>
</span><span id="FST.step_back-1047"><a href="#FST.step_back-1047"><span class="linenos">1047</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.step_back-1048"><a href="#FST.step_back-1048"><span class="linenos">1048</span></a>
</span><span id="FST.step_back-1049"><a href="#FST.step_back-1049"><span class="linenos">1049</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[[1, 2], [3, 4]]&#39;)</span>
</span><span id="FST.step_back-1050"><a href="#FST.step_back-1050"><span class="linenos">1050</span></a><span class="sd">    &gt;&gt;&gt; f.elts[1].src</span>
</span><span id="FST.step_back-1051"><a href="#FST.step_back-1051"><span class="linenos">1051</span></a><span class="sd">    &#39;[3, 4]&#39;</span>
</span><span id="FST.step_back-1052"><a href="#FST.step_back-1052"><span class="linenos">1052</span></a>
</span><span id="FST.step_back-1053"><a href="#FST.step_back-1053"><span class="linenos">1053</span></a><span class="sd">    &gt;&gt;&gt; f.elts[1].step_back().src</span>
</span><span id="FST.step_back-1054"><a href="#FST.step_back-1054"><span class="linenos">1054</span></a><span class="sd">    &#39;4&#39;</span>
</span><span id="FST.step_back-1055"><a href="#FST.step_back-1055"><span class="linenos">1055</span></a>
</span><span id="FST.step_back-1056"><a href="#FST.step_back-1056"><span class="linenos">1056</span></a><span class="sd">    &gt;&gt;&gt; f.elts[1].step_back(recurse_self=False).src</span>
</span><span id="FST.step_back-1057"><a href="#FST.step_back-1057"><span class="linenos">1057</span></a><span class="sd">    &#39;[1, 2]&#39;</span>
</span><span id="FST.step_back-1058"><a href="#FST.step_back-1058"><span class="linenos">1058</span></a>
</span><span id="FST.step_back-1059"><a href="#FST.step_back-1059"><span class="linenos">1059</span></a><span class="sd">    &gt;&gt;&gt; f.elts[1].elts[0].src</span>
</span><span id="FST.step_back-1060"><a href="#FST.step_back-1060"><span class="linenos">1060</span></a><span class="sd">    &#39;3&#39;</span>
</span><span id="FST.step_back-1061"><a href="#FST.step_back-1061"><span class="linenos">1061</span></a>
</span><span id="FST.step_back-1062"><a href="#FST.step_back-1062"><span class="linenos">1062</span></a><span class="sd">    &gt;&gt;&gt; f.elts[1].elts[0].step_back().src</span>
</span><span id="FST.step_back-1063"><a href="#FST.step_back-1063"><span class="linenos">1063</span></a><span class="sd">    &#39;[1, 2]&#39;</span>
</span><span id="FST.step_back-1064"><a href="#FST.step_back-1064"><span class="linenos">1064</span></a>
</span><span id="FST.step_back-1065"><a href="#FST.step_back-1065"><span class="linenos">1065</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;[this, [is_, [reparsed, each], step, and_, still], walks, ok]&#39;)</span>
</span><span id="FST.step_back-1066"><a href="#FST.step_back-1066"><span class="linenos">1066</span></a><span class="sd">    &gt;&gt;&gt; n = f.elts[-1]</span>
</span><span id="FST.step_back-1067"><a href="#FST.step_back-1067"><span class="linenos">1067</span></a><span class="sd">    &gt;&gt;&gt; while True:</span>
</span><span id="FST.step_back-1068"><a href="#FST.step_back-1068"><span class="linenos">1068</span></a><span class="sd">    ...     if isinstance(n.a, Name):</span>
</span><span id="FST.step_back-1069"><a href="#FST.step_back-1069"><span class="linenos">1069</span></a><span class="sd">    ...         n = n.replace(n.id[::-1], raw=True)  # raw here reparses all nodes</span>
</span><span id="FST.step_back-1070"><a href="#FST.step_back-1070"><span class="linenos">1070</span></a><span class="sd">    ...     if not (n := n.step_back()):</span>
</span><span id="FST.step_back-1071"><a href="#FST.step_back-1071"><span class="linenos">1071</span></a><span class="sd">    ...         break</span>
</span><span id="FST.step_back-1072"><a href="#FST.step_back-1072"><span class="linenos">1072</span></a><span class="sd">    &gt;&gt;&gt; f.src</span>
</span><span id="FST.step_back-1073"><a href="#FST.step_back-1073"><span class="linenos">1073</span></a><span class="sd">    &#39;[siht, [_si, [desraper, hcae], pets, _dna, llits], sklaw, ko]&#39;</span>
</span><span id="FST.step_back-1074"><a href="#FST.step_back-1074"><span class="linenos">1074</span></a><span class="sd">    ```</span>
</span><span id="FST.step_back-1075"><a href="#FST.step_back-1075"><span class="linenos">1075</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.step_back-1076"><a href="#FST.step_back-1076"><span class="linenos">1076</span></a>
</span><span id="FST.step_back-1077"><a href="#FST.step_back-1077"><span class="linenos">1077</span></a>    <span class="k">if</span> <span class="n">allown</span> <span class="o">:=</span> <span class="n">with_loc</span> <span class="o">==</span> <span class="s1">&#39;allown&#39;</span><span class="p">:</span>
</span><span id="FST.step_back-1078"><a href="#FST.step_back-1078"><span class="linenos">1078</span></a>        <span class="n">with_loc</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FST.step_back-1079"><a href="#FST.step_back-1079"><span class="linenos">1079</span></a>
</span><span id="FST.step_back-1080"><a href="#FST.step_back-1080"><span class="linenos">1080</span></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.step_back-1081"><a href="#FST.step_back-1081"><span class="linenos">1081</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">recurse_self</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">fst_</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_child</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)):</span>
</span><span id="FST.step_back-1082"><a href="#FST.step_back-1082"><span class="linenos">1082</span></a>            <span class="n">recurse_self</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FST.step_back-1083"><a href="#FST.step_back-1083"><span class="linenos">1083</span></a>
</span><span id="FST.step_back-1084"><a href="#FST.step_back-1084"><span class="linenos">1084</span></a>            <span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="n">fst_</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev</span><span class="p">(</span><span class="n">with_loc</span><span class="p">)):</span>
</span><span id="FST.step_back-1085"><a href="#FST.step_back-1085"><span class="linenos">1085</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST.step_back-1086"><a href="#FST.step_back-1086"><span class="linenos">1086</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.step_back-1087"><a href="#FST.step_back-1087"><span class="linenos">1087</span></a>
</span><span id="FST.step_back-1088"><a href="#FST.step_back-1088"><span class="linenos">1088</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">allown</span> <span class="ow">or</span> <span class="n">fst_</span><span class="o">.</span><span class="n">has_own_loc</span><span class="p">:</span>
</span><span id="FST.step_back-1089"><a href="#FST.step_back-1089"><span class="linenos">1089</span></a>            <span class="k">break</span>
</span><span id="FST.step_back-1090"><a href="#FST.step_back-1090"><span class="linenos">1090</span></a>
</span><span id="FST.step_back-1091"><a href="#FST.step_back-1091"><span class="linenos">1091</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="n">fst_</span>
</span><span id="FST.step_back-1092"><a href="#FST.step_back-1092"><span class="linenos">1092</span></a>
</span><span id="FST.step_back-1093"><a href="#FST.step_back-1093"><span class="linenos">1093</span></a>    <span class="k">return</span> <span class="n">fst_</span>
</span></pre></div>


            <div class="docstring"><p>Step backward in the tree in syntactic order, as if <code><a href="#FST.walk">walk()</a></code>ing backward, NOT the inverse of <code><a href="#FST.step_fwd">step_fwd()</a></code>. Will
walk up parents and down children to get the next node, returning <code>None</code> only when we are at the beginning of the
whole thing.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
<li><code>'allown'</code> Same as <code>'own'</code> but recurse into nodes with non-own locations (even though those nodes are not
returned). This is only really meant for internal use to safely call from <code>.loc</code> location calculation.</li>
</ul></li>
<li><code>recurse_self</code>: Whether to allow recursion into <code>self</code> to return children or move directly to previous nodes of
<code>self</code> on start.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>None</code> if first valid node in tree, otherwise previous node in order.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[[1, 2], [3, 4]]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[3, 4]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">step_back</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;4&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">step_back</span><span class="p">(</span><span class="n">recurse_self</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;3&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">step_back</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[1, 2]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[this, [is_, [reparsed, each], step, and_, still], walks, ok]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Name</span><span class="p">):</span>
<span class="o">...</span>         <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">id</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># raw here reparses all nodes</span>
<span class="o">...</span>     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">n</span> <span class="o">:=</span> <span class="n">n</span><span class="o">.</span><span class="n">step_back</span><span class="p">()):</span>
<span class="o">...</span>         <span class="k">break</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;[siht, [_si, [desraper, hcae], pets, _dna, llits], sklaw, ko]&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.walk" class="classattr">
                                        <input id="FST.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">with_loc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">recurse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">scope</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">back</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Generator</span><span class="p">[</span><span class="n"><a href="#FST">FST</a></span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FST.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.walk-1096"><a href="#FST.walk-1096"><span class="linenos">1096</span></a><span class="k">def</span><span class="w"> </span><span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">recurse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FST.walk-1097"><a href="#FST.walk-1097"><span class="linenos">1097</span></a>         <span class="n">scope</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">back</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">fst</span><span class="o">.</span><span class="n">FST</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="FST.walk-1098"><a href="#FST.walk-1098"><span class="linenos">1098</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Walk `self` and descendants in syntactic order. When walking, you can `send(False)` to the generator to skip</span>
</span><span id="FST.walk-1099"><a href="#FST.walk-1099"><span class="linenos">1099</span></a><span class="sd">    recursion into the current child. `send(True)` to allow recursion into child if called with `recurse=False` or</span>
</span><span id="FST.walk-1100"><a href="#FST.walk-1100"><span class="linenos">1100</span></a><span class="sd">    `scope=True` would otherwise disallow it. Can send multiple times, last value sent takes effect.</span>
</span><span id="FST.walk-1101"><a href="#FST.walk-1101"><span class="linenos">1101</span></a>
</span><span id="FST.walk-1102"><a href="#FST.walk-1102"><span class="linenos">1102</span></a><span class="sd">    The walk is defined forwards or backwards in that it returns a parent, then recurses into the children and walks</span>
</span><span id="FST.walk-1103"><a href="#FST.walk-1103"><span class="linenos">1103</span></a><span class="sd">    those in the given direction, recursing into each child&#39;s children before continuing with siblings. Walking</span>
</span><span id="FST.walk-1104"><a href="#FST.walk-1104"><span class="linenos">1104</span></a><span class="sd">    backwards will not generate the same sequence as `list(walk())[::-1]` due to this behavior.</span>
</span><span id="FST.walk-1105"><a href="#FST.walk-1105"><span class="linenos">1105</span></a>
</span><span id="FST.walk-1106"><a href="#FST.walk-1106"><span class="linenos">1106</span></a><span class="sd">    It is safe to modify the nodes (or previous nodes) as they are being walked as long as those modifications don&#39;t</span>
</span><span id="FST.walk-1107"><a href="#FST.walk-1107"><span class="linenos">1107</span></a><span class="sd">    touch the parent or following nodes. This means normal `.replace()` is fine as long as `raw=False`.</span>
</span><span id="FST.walk-1108"><a href="#FST.walk-1108"><span class="linenos">1108</span></a>
</span><span id="FST.walk-1109"><a href="#FST.walk-1109"><span class="linenos">1109</span></a><span class="sd">    The walk is relatively efficient but if all you need to do is just walk ALL the `AST` children without any bells or</span>
</span><span id="FST.walk-1110"><a href="#FST.walk-1110"><span class="linenos">1110</span></a><span class="sd">    whistles then `ast.walk()` will be a bit faster.</span>
</span><span id="FST.walk-1111"><a href="#FST.walk-1111"><span class="linenos">1111</span></a>
</span><span id="FST.walk-1112"><a href="#FST.walk-1112"><span class="linenos">1112</span></a><span class="sd">    **Parameters:**</span>
</span><span id="FST.walk-1113"><a href="#FST.walk-1113"><span class="linenos">1113</span></a><span class="sd">    - `with_loc`: Return nodes depending on their location information.</span>
</span><span id="FST.walk-1114"><a href="#FST.walk-1114"><span class="linenos">1114</span></a><span class="sd">        - `False`: All nodes with or without location.</span>
</span><span id="FST.walk-1115"><a href="#FST.walk-1115"><span class="linenos">1115</span></a><span class="sd">        - `True`: Only nodes which have implicit `AST` locations and also larger computed location nodes like</span>
</span><span id="FST.walk-1116"><a href="#FST.walk-1116"><span class="linenos">1116</span></a><span class="sd">            `comprehension`, `withitem`, `match_case` and `arguments` (the last one only if there are actually arguments</span>
</span><span id="FST.walk-1117"><a href="#FST.walk-1117"><span class="linenos">1117</span></a><span class="sd">            present).</span>
</span><span id="FST.walk-1118"><a href="#FST.walk-1118"><span class="linenos">1118</span></a><span class="sd">        - `&#39;all&#39;`: Same as `True` but also operators with calculated locations (excluding `and` and `or` since they do</span>
</span><span id="FST.walk-1119"><a href="#FST.walk-1119"><span class="linenos">1119</span></a><span class="sd">            not always have a well defined location).</span>
</span><span id="FST.walk-1120"><a href="#FST.walk-1120"><span class="linenos">1120</span></a><span class="sd">        - `&#39;own&#39;`: Only nodes with their own implicit `AST` locations, same as `True` but excludes those larger nodes</span>
</span><span id="FST.walk-1121"><a href="#FST.walk-1121"><span class="linenos">1121</span></a><span class="sd">            with calculated locations.</span>
</span><span id="FST.walk-1122"><a href="#FST.walk-1122"><span class="linenos">1122</span></a><span class="sd">    - `self_`: If `True` then self will be returned first with the possibility to skip children with `send(False)`,</span>
</span><span id="FST.walk-1123"><a href="#FST.walk-1123"><span class="linenos">1123</span></a><span class="sd">        otherwise will start directly with children.</span>
</span><span id="FST.walk-1124"><a href="#FST.walk-1124"><span class="linenos">1124</span></a><span class="sd">    - `recurse`: Whether to recurse into children by default, `send(True)` for a given node will always override this.</span>
</span><span id="FST.walk-1125"><a href="#FST.walk-1125"><span class="linenos">1125</span></a><span class="sd">    - `scope`: If `True` then will walk only within the scope of `self`. Meaning if called on a `FunctionDef` then</span>
</span><span id="FST.walk-1126"><a href="#FST.walk-1126"><span class="linenos">1126</span></a><span class="sd">        will only walk children which are within the function scope. Will yield children which have their own scopes,</span>
</span><span id="FST.walk-1127"><a href="#FST.walk-1127"><span class="linenos">1127</span></a><span class="sd">        and the parts of them which are visible in this scope (like default argument values), but will not recurse into</span>
</span><span id="FST.walk-1128"><a href="#FST.walk-1128"><span class="linenos">1128</span></a><span class="sd">        them unless `send(True)` is done for that child.</span>
</span><span id="FST.walk-1129"><a href="#FST.walk-1129"><span class="linenos">1129</span></a><span class="sd">    - `back`: If `True` then walk every node in reverse syntactic order. This is not the same as a full forwards</span>
</span><span id="FST.walk-1130"><a href="#FST.walk-1130"><span class="linenos">1130</span></a><span class="sd">        walk reversed due to recursion (parents are still returned before children, only in reverse sibling order).</span>
</span><span id="FST.walk-1131"><a href="#FST.walk-1131"><span class="linenos">1131</span></a>
</span><span id="FST.walk-1132"><a href="#FST.walk-1132"><span class="linenos">1132</span></a><span class="sd">    **Examples:**</span>
</span><span id="FST.walk-1133"><a href="#FST.walk-1133"><span class="linenos">1133</span></a><span class="sd">    ```py</span>
</span><span id="FST.walk-1134"><a href="#FST.walk-1134"><span class="linenos">1134</span></a><span class="sd">    &gt;&gt;&gt; from fst import *</span>
</span><span id="FST.walk-1135"><a href="#FST.walk-1135"><span class="linenos">1135</span></a><span class="sd">    &gt;&gt;&gt; import ast</span>
</span><span id="FST.walk-1136"><a href="#FST.walk-1136"><span class="linenos">1136</span></a>
</span><span id="FST.walk-1137"><a href="#FST.walk-1137"><span class="linenos">1137</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;def f(a: list[str], /, reject: int, *c, d=100, **e): pass&#39;)</span>
</span><span id="FST.walk-1138"><a href="#FST.walk-1138"><span class="linenos">1138</span></a><span class="sd">    &gt;&gt;&gt; for g in (gen := f.walk(with_loc=True)):</span>
</span><span id="FST.walk-1139"><a href="#FST.walk-1139"><span class="linenos">1139</span></a><span class="sd">    ...     if isinstance(g.a, ast.arg) and g.a.arg == &#39;reject&#39;:</span>
</span><span id="FST.walk-1140"><a href="#FST.walk-1140"><span class="linenos">1140</span></a><span class="sd">    ...         _ = gen.send(False)</span>
</span><span id="FST.walk-1141"><a href="#FST.walk-1141"><span class="linenos">1141</span></a><span class="sd">    ...     else:</span>
</span><span id="FST.walk-1142"><a href="#FST.walk-1142"><span class="linenos">1142</span></a><span class="sd">    ...         print(f&#39;{g!r:&lt;30}{g.src[:50]!r}&#39;)</span>
</span><span id="FST.walk-1143"><a href="#FST.walk-1143"><span class="linenos">1143</span></a><span class="sd">    &lt;FunctionDef ROOT 0,0..0,57&gt;  &#39;def f(a: list[str], /, reject: int, *c, d=100, **e&#39;</span>
</span><span id="FST.walk-1144"><a href="#FST.walk-1144"><span class="linenos">1144</span></a><span class="sd">    &lt;arguments 0,6..0,50&gt;         &#39;a: list[str], /, reject: int, *c, d=100, **e&#39;</span>
</span><span id="FST.walk-1145"><a href="#FST.walk-1145"><span class="linenos">1145</span></a><span class="sd">    &lt;arg 0,6..0,18&gt;               &#39;a: list[str]&#39;</span>
</span><span id="FST.walk-1146"><a href="#FST.walk-1146"><span class="linenos">1146</span></a><span class="sd">    &lt;Subscript 0,9..0,18&gt;         &#39;list[str]&#39;</span>
</span><span id="FST.walk-1147"><a href="#FST.walk-1147"><span class="linenos">1147</span></a><span class="sd">    &lt;Name 0,9..0,13&gt;              &#39;list&#39;</span>
</span><span id="FST.walk-1148"><a href="#FST.walk-1148"><span class="linenos">1148</span></a><span class="sd">    &lt;Name 0,14..0,17&gt;             &#39;str&#39;</span>
</span><span id="FST.walk-1149"><a href="#FST.walk-1149"><span class="linenos">1149</span></a><span class="sd">    &lt;arg 0,37..0,38&gt;              &#39;c&#39;</span>
</span><span id="FST.walk-1150"><a href="#FST.walk-1150"><span class="linenos">1150</span></a><span class="sd">    &lt;arg 0,40..0,41&gt;              &#39;d&#39;</span>
</span><span id="FST.walk-1151"><a href="#FST.walk-1151"><span class="linenos">1151</span></a><span class="sd">    &lt;Constant 0,42..0,45&gt;         &#39;100&#39;</span>
</span><span id="FST.walk-1152"><a href="#FST.walk-1152"><span class="linenos">1152</span></a><span class="sd">    &lt;arg 0,49..0,50&gt;              &#39;e&#39;</span>
</span><span id="FST.walk-1153"><a href="#FST.walk-1153"><span class="linenos">1153</span></a><span class="sd">    &lt;Pass 0,53..0,57&gt;             &#39;pass&#39;</span>
</span><span id="FST.walk-1154"><a href="#FST.walk-1154"><span class="linenos">1154</span></a>
</span><span id="FST.walk-1155"><a href="#FST.walk-1155"><span class="linenos">1155</span></a><span class="sd">    &gt;&gt;&gt; f = FST(&#39;&#39;&#39;</span>
</span><span id="FST.walk-1156"><a href="#FST.walk-1156"><span class="linenos">1156</span></a><span class="sd">    ... def f():</span>
</span><span id="FST.walk-1157"><a href="#FST.walk-1157"><span class="linenos">1157</span></a><span class="sd">    ...     def g(arg=1) -&gt; int:</span>
</span><span id="FST.walk-1158"><a href="#FST.walk-1158"><span class="linenos">1158</span></a><span class="sd">    ...         pass</span>
</span><span id="FST.walk-1159"><a href="#FST.walk-1159"><span class="linenos">1159</span></a><span class="sd">    ...     val = [i for i in iterator]</span>
</span><span id="FST.walk-1160"><a href="#FST.walk-1160"><span class="linenos">1160</span></a><span class="sd">    ... &#39;&#39;&#39;.strip())</span>
</span><span id="FST.walk-1161"><a href="#FST.walk-1161"><span class="linenos">1161</span></a><span class="sd">    &gt;&gt;&gt; for g in f.walk(True, scope=True):</span>
</span><span id="FST.walk-1162"><a href="#FST.walk-1162"><span class="linenos">1162</span></a><span class="sd">    ...     print(f&#39;{g!r:&lt;30}{g.src[:47]!r}&#39;)</span>
</span><span id="FST.walk-1163"><a href="#FST.walk-1163"><span class="linenos">1163</span></a><span class="sd">    &lt;FunctionDef ROOT 0,0..3,31&gt;  &#39;def f():\n    def g(arg=1) -&gt; int:\n        pass\n&#39;</span>
</span><span id="FST.walk-1164"><a href="#FST.walk-1164"><span class="linenos">1164</span></a><span class="sd">    &lt;FunctionDef 1,4..2,12&gt;       &#39;def g(arg=1) -&gt; int:\n        pass&#39;</span>
</span><span id="FST.walk-1165"><a href="#FST.walk-1165"><span class="linenos">1165</span></a><span class="sd">    &lt;Constant 1,14..1,15&gt;         &#39;1&#39;</span>
</span><span id="FST.walk-1166"><a href="#FST.walk-1166"><span class="linenos">1166</span></a><span class="sd">    &lt;Assign 3,4..3,31&gt;            &#39;val = [i for i in iterator]&#39;</span>
</span><span id="FST.walk-1167"><a href="#FST.walk-1167"><span class="linenos">1167</span></a><span class="sd">    &lt;Name 3,4..3,7&gt;               &#39;val&#39;</span>
</span><span id="FST.walk-1168"><a href="#FST.walk-1168"><span class="linenos">1168</span></a><span class="sd">    &lt;ListComp 3,10..3,31&gt;         &#39;[i for i in iterator]&#39;</span>
</span><span id="FST.walk-1169"><a href="#FST.walk-1169"><span class="linenos">1169</span></a><span class="sd">    &lt;Name 3,22..3,30&gt;             &#39;iterator&#39;</span>
</span><span id="FST.walk-1170"><a href="#FST.walk-1170"><span class="linenos">1170</span></a>
</span><span id="FST.walk-1171"><a href="#FST.walk-1171"><span class="linenos">1171</span></a><span class="sd">    &gt;&gt;&gt; for g in f.walk(True, back=True):</span>
</span><span id="FST.walk-1172"><a href="#FST.walk-1172"><span class="linenos">1172</span></a><span class="sd">    ...     print(f&#39;{g!r:&lt;30}{g.src[:47]!r}&#39;)</span>
</span><span id="FST.walk-1173"><a href="#FST.walk-1173"><span class="linenos">1173</span></a><span class="sd">    &lt;FunctionDef ROOT 0,0..3,31&gt;  &#39;def f():\n    def g(arg=1) -&gt; int:\n        pass\n&#39;</span>
</span><span id="FST.walk-1174"><a href="#FST.walk-1174"><span class="linenos">1174</span></a><span class="sd">    &lt;Assign 3,4..3,31&gt;            &#39;val = [i for i in iterator]&#39;</span>
</span><span id="FST.walk-1175"><a href="#FST.walk-1175"><span class="linenos">1175</span></a><span class="sd">    &lt;ListComp 3,10..3,31&gt;         &#39;[i for i in iterator]&#39;</span>
</span><span id="FST.walk-1176"><a href="#FST.walk-1176"><span class="linenos">1176</span></a><span class="sd">    &lt;comprehension 3,13..3,30&gt;    &#39;for i in iterator&#39;</span>
</span><span id="FST.walk-1177"><a href="#FST.walk-1177"><span class="linenos">1177</span></a><span class="sd">    &lt;Name 3,22..3,30&gt;             &#39;iterator&#39;</span>
</span><span id="FST.walk-1178"><a href="#FST.walk-1178"><span class="linenos">1178</span></a><span class="sd">    &lt;Name 3,17..3,18&gt;             &#39;i&#39;</span>
</span><span id="FST.walk-1179"><a href="#FST.walk-1179"><span class="linenos">1179</span></a><span class="sd">    &lt;Name 3,11..3,12&gt;             &#39;i&#39;</span>
</span><span id="FST.walk-1180"><a href="#FST.walk-1180"><span class="linenos">1180</span></a><span class="sd">    &lt;Name 3,4..3,7&gt;               &#39;val&#39;</span>
</span><span id="FST.walk-1181"><a href="#FST.walk-1181"><span class="linenos">1181</span></a><span class="sd">    &lt;FunctionDef 1,4..2,12&gt;       &#39;def g(arg=1) -&gt; int:\n        pass&#39;</span>
</span><span id="FST.walk-1182"><a href="#FST.walk-1182"><span class="linenos">1182</span></a><span class="sd">    &lt;Pass 2,8..2,12&gt;              &#39;pass&#39;</span>
</span><span id="FST.walk-1183"><a href="#FST.walk-1183"><span class="linenos">1183</span></a><span class="sd">    &lt;Name 1,20..1,23&gt;             &#39;int&#39;</span>
</span><span id="FST.walk-1184"><a href="#FST.walk-1184"><span class="linenos">1184</span></a><span class="sd">    &lt;arguments 1,10..1,15&gt;        &#39;arg=1&#39;</span>
</span><span id="FST.walk-1185"><a href="#FST.walk-1185"><span class="linenos">1185</span></a><span class="sd">    &lt;Constant 1,14..1,15&gt;         &#39;1&#39;</span>
</span><span id="FST.walk-1186"><a href="#FST.walk-1186"><span class="linenos">1186</span></a><span class="sd">    &lt;arg 1,10..1,13&gt;              &#39;arg&#39;</span>
</span><span id="FST.walk-1187"><a href="#FST.walk-1187"><span class="linenos">1187</span></a><span class="sd">    ```</span>
</span><span id="FST.walk-1188"><a href="#FST.walk-1188"><span class="linenos">1188</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FST.walk-1189"><a href="#FST.walk-1189"><span class="linenos">1189</span></a>
</span><span id="FST.walk-1190"><a href="#FST.walk-1190"><span class="linenos">1190</span></a>    <span class="k">if</span> <span class="n">self_</span><span class="p">:</span>
</span><span id="FST.walk-1191"><a href="#FST.walk-1191"><span class="linenos">1191</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_with_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.walk-1192"><a href="#FST.walk-1192"><span class="linenos">1192</span></a>            <span class="k">return</span>
</span><span id="FST.walk-1193"><a href="#FST.walk-1193"><span class="linenos">1193</span></a>
</span><span id="FST.walk-1194"><a href="#FST.walk-1194"><span class="linenos">1194</span></a>        <span class="n">recurse_</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="FST.walk-1195"><a href="#FST.walk-1195"><span class="linenos">1195</span></a>
</span><span id="FST.walk-1196"><a href="#FST.walk-1196"><span class="linenos">1196</span></a>        <span class="k">while</span> <span class="p">(</span><span class="n">sent</span> <span class="o">:=</span> <span class="p">(</span><span class="k">yield</span> <span class="bp">self</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.walk-1197"><a href="#FST.walk-1197"><span class="linenos">1197</span></a>            <span class="n">recurse_</span> <span class="o">=</span> <span class="n">sent</span>
</span><span id="FST.walk-1198"><a href="#FST.walk-1198"><span class="linenos">1198</span></a>
</span><span id="FST.walk-1199"><a href="#FST.walk-1199"><span class="linenos">1199</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">:</span>
</span><span id="FST.walk-1200"><a href="#FST.walk-1200"><span class="linenos">1200</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repath</span><span class="p">()</span>
</span><span id="FST.walk-1201"><a href="#FST.walk-1201"><span class="linenos">1201</span></a>
</span><span id="FST.walk-1202"><a href="#FST.walk-1202"><span class="linenos">1202</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">recurse_</span><span class="p">:</span>
</span><span id="FST.walk-1203"><a href="#FST.walk-1203"><span class="linenos">1203</span></a>            <span class="k">return</span>
</span><span id="FST.walk-1204"><a href="#FST.walk-1204"><span class="linenos">1204</span></a>
</span><span id="FST.walk-1205"><a href="#FST.walk-1205"><span class="linenos">1205</span></a>        <span class="k">elif</span> <span class="n">recurse_</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># user changed their mind?!?</span>
</span><span id="FST.walk-1206"><a href="#FST.walk-1206"><span class="linenos">1206</span></a>            <span class="n">recurse</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FST.walk-1207"><a href="#FST.walk-1207"><span class="linenos">1207</span></a>            <span class="n">scope</span>   <span class="o">=</span> <span class="kc">False</span>
</span><span id="FST.walk-1208"><a href="#FST.walk-1208"><span class="linenos">1208</span></a>
</span><span id="FST.walk-1209"><a href="#FST.walk-1209"><span class="linenos">1209</span></a>    <span class="n">stack</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FST.walk-1210"><a href="#FST.walk-1210"><span class="linenos">1210</span></a>    <span class="n">ast</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.walk-1211"><a href="#FST.walk-1211"><span class="linenos">1211</span></a>
</span><span id="FST.walk-1212"><a href="#FST.walk-1212"><span class="linenos">1212</span></a>    <span class="k">if</span> <span class="n">scope</span><span class="p">:</span>  <span class="c1"># some parts of a FunctionDef or ClassDef are outside its scope</span>
</span><span id="FST.walk-1213"><a href="#FST.walk-1213"><span class="linenos">1213</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FST.walk-1214"><a href="#FST.walk-1214"><span class="linenos">1214</span></a>            <span class="n">stack</span> <span class="o">=</span> <span class="n">ast</span><span class="p">[:]</span> <span class="k">if</span> <span class="n">back</span> <span class="k">else</span> <span class="n">ast</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FST.walk-1215"><a href="#FST.walk-1215"><span class="linenos">1215</span></a>
</span><span id="FST.walk-1216"><a href="#FST.walk-1216"><span class="linenos">1216</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">ClassDef</span><span class="p">,</span> <span class="n">Module</span><span class="p">,</span> <span class="n">Interactive</span><span class="p">)):</span>
</span><span id="FST.walk-1217"><a href="#FST.walk-1217"><span class="linenos">1217</span></a>            <span class="k">if</span> <span class="n">back</span><span class="p">:</span>
</span><span id="FST.walk-1218"><a href="#FST.walk-1218"><span class="linenos">1218</span></a>                <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FST.walk-1219"><a href="#FST.walk-1219"><span class="linenos">1219</span></a>
</span><span id="FST.walk-1220"><a href="#FST.walk-1220"><span class="linenos">1220</span></a>                <span class="k">if</span> <span class="n">type_params</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="FST.walk-1221"><a href="#FST.walk-1221"><span class="linenos">1221</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">type_params</span><span class="p">)</span>
</span><span id="FST.walk-1222"><a href="#FST.walk-1222"><span class="linenos">1222</span></a>
</span><span id="FST.walk-1223"><a href="#FST.walk-1223"><span class="linenos">1223</span></a>                <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</span><span id="FST.walk-1224"><a href="#FST.walk-1224"><span class="linenos">1224</span></a>
</span><span id="FST.walk-1225"><a href="#FST.walk-1225"><span class="linenos">1225</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1226"><a href="#FST.walk-1226"><span class="linenos">1226</span></a>                <span class="n">stack</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">body</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FST.walk-1227"><a href="#FST.walk-1227"><span class="linenos">1227</span></a>
</span><span id="FST.walk-1228"><a href="#FST.walk-1228"><span class="linenos">1228</span></a>                <span class="k">if</span> <span class="n">type_params</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="FST.walk-1229"><a href="#FST.walk-1229"><span class="linenos">1229</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">type_params</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1230"><a href="#FST.walk-1230"><span class="linenos">1230</span></a>
</span><span id="FST.walk-1231"><a href="#FST.walk-1231"><span class="linenos">1231</span></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">is_func</span> <span class="o">:=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">AsyncFunctionDef</span><span class="p">)))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">):</span>
</span><span id="FST.walk-1232"><a href="#FST.walk-1232"><span class="linenos">1232</span></a>            <span class="k">if</span> <span class="n">back</span><span class="p">:</span>
</span><span id="FST.walk-1233"><a href="#FST.walk-1233"><span class="linenos">1233</span></a>                <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FST.walk-1234"><a href="#FST.walk-1234"><span class="linenos">1234</span></a>
</span><span id="FST.walk-1235"><a href="#FST.walk-1235"><span class="linenos">1235</span></a>                <span class="k">if</span> <span class="n">type_params</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="FST.walk-1236"><a href="#FST.walk-1236"><span class="linenos">1236</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">type_params</span><span class="p">)</span>
</span><span id="FST.walk-1237"><a href="#FST.walk-1237"><span class="linenos">1237</span></a>
</span><span id="FST.walk-1238"><a href="#FST.walk-1238"><span class="linenos">1238</span></a>                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="FST.walk-1239"><a href="#FST.walk-1239"><span class="linenos">1239</span></a>
</span><span id="FST.walk-1240"><a href="#FST.walk-1240"><span class="linenos">1240</span></a>                <span class="k">if</span> <span class="n">is_func</span><span class="p">:</span>
</span><span id="FST.walk-1241"><a href="#FST.walk-1241"><span class="linenos">1241</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</span><span id="FST.walk-1242"><a href="#FST.walk-1242"><span class="linenos">1242</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1243"><a href="#FST.walk-1243"><span class="linenos">1243</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</span><span id="FST.walk-1244"><a href="#FST.walk-1244"><span class="linenos">1244</span></a>
</span><span id="FST.walk-1245"><a href="#FST.walk-1245"><span class="linenos">1245</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1246"><a href="#FST.walk-1246"><span class="linenos">1246</span></a>                <span class="n">stack</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">body</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_func</span> <span class="k">else</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">body</span><span class="p">]</span>
</span><span id="FST.walk-1247"><a href="#FST.walk-1247"><span class="linenos">1247</span></a>
</span><span id="FST.walk-1248"><a href="#FST.walk-1248"><span class="linenos">1248</span></a>                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="FST.walk-1249"><a href="#FST.walk-1249"><span class="linenos">1249</span></a>
</span><span id="FST.walk-1250"><a href="#FST.walk-1250"><span class="linenos">1250</span></a>                <span class="k">if</span> <span class="n">type_params</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="FST.walk-1251"><a href="#FST.walk-1251"><span class="linenos">1251</span></a>                    <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">type_params</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1252"><a href="#FST.walk-1252"><span class="linenos">1252</span></a>
</span><span id="FST.walk-1253"><a href="#FST.walk-1253"><span class="linenos">1253</span></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">is_elt</span> <span class="o">:=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">)))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">):</span>
</span><span id="FST.walk-1254"><a href="#FST.walk-1254"><span class="linenos">1254</span></a>            <span class="k">if</span> <span class="n">back</span><span class="p">:</span>
</span><span id="FST.walk-1255"><a href="#FST.walk-1255"><span class="linenos">1255</span></a>                <span class="n">stack</span> <span class="o">=</span> <span class="p">([</span><span class="n">ast</span><span class="o">.</span><span class="n">elt</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_elt</span> <span class="k">else</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">generators</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">generators</span><span class="p">)</span>
</span><span id="FST.walk-1256"><a href="#FST.walk-1256"><span class="linenos">1256</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1257"><a href="#FST.walk-1257"><span class="linenos">1257</span></a>                <span class="n">stack</span> <span class="o">=</span> <span class="p">(</span><span class="n">generators</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">generators</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">([</span><span class="n">ast</span><span class="o">.</span><span class="n">elt</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_elt</span> <span class="k">else</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">key</span><span class="p">])</span>
</span><span id="FST.walk-1258"><a href="#FST.walk-1258"><span class="linenos">1258</span></a>
</span><span id="FST.walk-1259"><a href="#FST.walk-1259"><span class="linenos">1259</span></a>            <span class="n">skip_iter</span> <span class="o">=</span> <span class="n">generators</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iter</span>
</span><span id="FST.walk-1260"><a href="#FST.walk-1260"><span class="linenos">1260</span></a>
</span><span id="FST.walk-1261"><a href="#FST.walk-1261"><span class="linenos">1261</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
</span><span id="FST.walk-1262"><a href="#FST.walk-1262"><span class="linenos">1262</span></a>            <span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">body</span><span class="p">]</span>
</span><span id="FST.walk-1263"><a href="#FST.walk-1263"><span class="linenos">1263</span></a>
</span><span id="FST.walk-1264"><a href="#FST.walk-1264"><span class="linenos">1264</span></a>    <span class="k">if</span> <span class="n">stack</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.walk-1265"><a href="#FST.walk-1265"><span class="linenos">1265</span></a>        <span class="n">stack</span> <span class="o">=</span> <span class="n">syntax_ordered_children</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="FST.walk-1266"><a href="#FST.walk-1266"><span class="linenos">1266</span></a>
</span><span id="FST.walk-1267"><a href="#FST.walk-1267"><span class="linenos">1267</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">back</span><span class="p">:</span>
</span><span id="FST.walk-1268"><a href="#FST.walk-1268"><span class="linenos">1268</span></a>            <span class="n">stack</span> <span class="o">=</span> <span class="n">stack</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FST.walk-1269"><a href="#FST.walk-1269"><span class="linenos">1269</span></a>
</span><span id="FST.walk-1270"><a href="#FST.walk-1270"><span class="linenos">1270</span></a>    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
</span><span id="FST.walk-1271"><a href="#FST.walk-1271"><span class="linenos">1271</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ast</span> <span class="o">:=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()):</span>
</span><span id="FST.walk-1272"><a href="#FST.walk-1272"><span class="linenos">1272</span></a>            <span class="k">continue</span>
</span><span id="FST.walk-1273"><a href="#FST.walk-1273"><span class="linenos">1273</span></a>
</span><span id="FST.walk-1274"><a href="#FST.walk-1274"><span class="linenos">1274</span></a>        <span class="n">fst_</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">f</span>
</span><span id="FST.walk-1275"><a href="#FST.walk-1275"><span class="linenos">1275</span></a>
</span><span id="FST.walk-1276"><a href="#FST.walk-1276"><span class="linenos">1276</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_with_loc</span><span class="p">(</span><span class="n">fst_</span><span class="p">,</span> <span class="n">with_loc</span><span class="p">):</span>
</span><span id="FST.walk-1277"><a href="#FST.walk-1277"><span class="linenos">1277</span></a>            <span class="k">continue</span>
</span><span id="FST.walk-1278"><a href="#FST.walk-1278"><span class="linenos">1278</span></a>
</span><span id="FST.walk-1279"><a href="#FST.walk-1279"><span class="linenos">1279</span></a>        <span class="n">recurse_</span> <span class="o">=</span> <span class="n">recurse</span>
</span><span id="FST.walk-1280"><a href="#FST.walk-1280"><span class="linenos">1280</span></a>
</span><span id="FST.walk-1281"><a href="#FST.walk-1281"><span class="linenos">1281</span></a>        <span class="k">while</span> <span class="p">(</span><span class="n">sent</span> <span class="o">:=</span> <span class="p">(</span><span class="k">yield</span> <span class="n">fst_</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.walk-1282"><a href="#FST.walk-1282"><span class="linenos">1282</span></a>            <span class="n">recurse_</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">sent</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="FST.walk-1283"><a href="#FST.walk-1283"><span class="linenos">1283</span></a>
</span><span id="FST.walk-1284"><a href="#FST.walk-1284"><span class="linenos">1284</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fst_</span><span class="o">.</span><span class="n">a</span><span class="p">:</span>  <span class="c1"># has been changed by the player</span>
</span><span id="FST.walk-1285"><a href="#FST.walk-1285"><span class="linenos">1285</span></a>            <span class="n">fst_</span> <span class="o">=</span> <span class="n">fst_</span><span class="o">.</span><span class="n">repath</span><span class="p">()</span>
</span><span id="FST.walk-1286"><a href="#FST.walk-1286"><span class="linenos">1286</span></a>
</span><span id="FST.walk-1287"><a href="#FST.walk-1287"><span class="linenos">1287</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="n">fst_</span><span class="o">.</span><span class="n">a</span>  <span class="c1"># could have just modified the ast</span>
</span><span id="FST.walk-1288"><a href="#FST.walk-1288"><span class="linenos">1288</span></a>
</span><span id="FST.walk-1289"><a href="#FST.walk-1289"><span class="linenos">1289</span></a>        <span class="k">if</span> <span class="n">recurse_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.walk-1290"><a href="#FST.walk-1290"><span class="linenos">1290</span></a>            <span class="k">if</span> <span class="n">recurse_</span><span class="p">:</span>  <span class="c1"># user did send(True), walk this child unconditionally</span>
</span><span id="FST.walk-1291"><a href="#FST.walk-1291"><span class="linenos">1291</span></a>                <span class="k">yield from</span> <span class="n">fst_</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">with_loc</span><span class="p">,</span> <span class="n">self_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
</span><span id="FST.walk-1292"><a href="#FST.walk-1292"><span class="linenos">1292</span></a>
</span><span id="FST.walk-1293"><a href="#FST.walk-1293"><span class="linenos">1293</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1294"><a href="#FST.walk-1294"><span class="linenos">1294</span></a>            <span class="k">if</span> <span class="n">scope</span><span class="p">:</span>
</span><span id="FST.walk-1295"><a href="#FST.walk-1295"><span class="linenos">1295</span></a>                <span class="n">recurse_</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="FST.walk-1296"><a href="#FST.walk-1296"><span class="linenos">1296</span></a>
</span><span id="FST.walk-1297"><a href="#FST.walk-1297"><span class="linenos">1297</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">ClassDef</span><span class="p">):</span>
</span><span id="FST.walk-1298"><a href="#FST.walk-1298"><span class="linenos">1298</span></a>                    <span class="k">if</span> <span class="n">back</span><span class="p">:</span>
</span><span id="FST.walk-1299"><a href="#FST.walk-1299"><span class="linenos">1299</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">decorator_list</span><span class="p">)</span>
</span><span id="FST.walk-1300"><a href="#FST.walk-1300"><span class="linenos">1300</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">bases</span><span class="p">)</span>
</span><span id="FST.walk-1301"><a href="#FST.walk-1301"><span class="linenos">1301</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">keywords</span><span class="p">)</span>
</span><span id="FST.walk-1302"><a href="#FST.walk-1302"><span class="linenos">1302</span></a>
</span><span id="FST.walk-1303"><a href="#FST.walk-1303"><span class="linenos">1303</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1304"><a href="#FST.walk-1304"><span class="linenos">1304</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">keywords</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1305"><a href="#FST.walk-1305"><span class="linenos">1305</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">bases</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1306"><a href="#FST.walk-1306"><span class="linenos">1306</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">decorator_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1307"><a href="#FST.walk-1307"><span class="linenos">1307</span></a>
</span><span id="FST.walk-1308"><a href="#FST.walk-1308"><span class="linenos">1308</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">AsyncFunctionDef</span><span class="p">)):</span>
</span><span id="FST.walk-1309"><a href="#FST.walk-1309"><span class="linenos">1309</span></a>                    <span class="k">if</span> <span class="n">back</span><span class="p">:</span>
</span><span id="FST.walk-1310"><a href="#FST.walk-1310"><span class="linenos">1310</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">decorator_list</span><span class="p">)</span>
</span><span id="FST.walk-1311"><a href="#FST.walk-1311"><span class="linenos">1311</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">defaults</span><span class="p">)</span>
</span><span id="FST.walk-1312"><a href="#FST.walk-1312"><span class="linenos">1312</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kw_defaults</span><span class="p">)</span>
</span><span id="FST.walk-1313"><a href="#FST.walk-1313"><span class="linenos">1313</span></a>
</span><span id="FST.walk-1314"><a href="#FST.walk-1314"><span class="linenos">1314</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1315"><a href="#FST.walk-1315"><span class="linenos">1315</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kw_defaults</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1316"><a href="#FST.walk-1316"><span class="linenos">1316</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">defaults</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1317"><a href="#FST.walk-1317"><span class="linenos">1317</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">decorator_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1318"><a href="#FST.walk-1318"><span class="linenos">1318</span></a>
</span><span id="FST.walk-1319"><a href="#FST.walk-1319"><span class="linenos">1319</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">):</span>
</span><span id="FST.walk-1320"><a href="#FST.walk-1320"><span class="linenos">1320</span></a>                    <span class="k">if</span> <span class="n">back</span><span class="p">:</span>
</span><span id="FST.walk-1321"><a href="#FST.walk-1321"><span class="linenos">1321</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">defaults</span><span class="p">)</span>
</span><span id="FST.walk-1322"><a href="#FST.walk-1322"><span class="linenos">1322</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kw_defaults</span><span class="p">)</span>
</span><span id="FST.walk-1323"><a href="#FST.walk-1323"><span class="linenos">1323</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1324"><a href="#FST.walk-1324"><span class="linenos">1324</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kw_defaults</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1325"><a href="#FST.walk-1325"><span class="linenos">1325</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">defaults</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FST.walk-1326"><a href="#FST.walk-1326"><span class="linenos">1326</span></a>
</span><span id="FST.walk-1327"><a href="#FST.walk-1327"><span class="linenos">1327</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">)):</span>
</span><span id="FST.walk-1328"><a href="#FST.walk-1328"><span class="linenos">1328</span></a>                    <span class="n">comp_first_iter</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">generators</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iter</span>
</span><span id="FST.walk-1329"><a href="#FST.walk-1329"><span class="linenos">1329</span></a>                    <span class="n">gen</span>             <span class="o">=</span> <span class="n">fst_</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">with_loc</span><span class="p">,</span> <span class="n">self_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="n">back</span><span class="p">)</span>
</span><span id="FST.walk-1330"><a href="#FST.walk-1330"><span class="linenos">1330</span></a>
</span><span id="FST.walk-1331"><a href="#FST.walk-1331"><span class="linenos">1331</span></a>                    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>  <span class="c1"># all NamedExpr assignments below are visible here, yeah, its ugly</span>
</span><span id="FST.walk-1332"><a href="#FST.walk-1332"><span class="linenos">1332</span></a>                        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">comp_first_iter</span> <span class="ow">or</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;target&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Name</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST.walk-1333"><a href="#FST.walk-1333"><span class="linenos">1333</span></a>                                                             <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">NamedExpr</span><span class="p">)):</span>
</span><span id="FST.walk-1334"><a href="#FST.walk-1334"><span class="linenos">1334</span></a>                            <span class="n">subrecurse</span> <span class="o">=</span> <span class="n">recurse</span>
</span><span id="FST.walk-1335"><a href="#FST.walk-1335"><span class="linenos">1335</span></a>
</span><span id="FST.walk-1336"><a href="#FST.walk-1336"><span class="linenos">1336</span></a>                            <span class="k">while</span> <span class="p">(</span><span class="n">sent</span> <span class="o">:=</span> <span class="p">(</span><span class="k">yield</span> <span class="n">f</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.walk-1337"><a href="#FST.walk-1337"><span class="linenos">1337</span></a>                                <span class="n">subrecurse</span> <span class="o">=</span> <span class="n">sent</span>
</span><span id="FST.walk-1338"><a href="#FST.walk-1338"><span class="linenos">1338</span></a>
</span><span id="FST.walk-1339"><a href="#FST.walk-1339"><span class="linenos">1339</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">subrecurse</span><span class="p">:</span>
</span><span id="FST.walk-1340"><a href="#FST.walk-1340"><span class="linenos">1340</span></a>                                <span class="n">gen</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FST.walk-1341"><a href="#FST.walk-1341"><span class="linenos">1341</span></a>
</span><span id="FST.walk-1342"><a href="#FST.walk-1342"><span class="linenos">1342</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">comprehension</span><span class="p">):</span>  <span class="c1"># this only comes from top level comprehension, not ones encountered here</span>
</span><span id="FST.walk-1343"><a href="#FST.walk-1343"><span class="linenos">1343</span></a>                    <span class="k">if</span> <span class="n">back</span><span class="p">:</span>
</span><span id="FST.walk-1344"><a href="#FST.walk-1344"><span class="linenos">1344</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</span><span id="FST.walk-1345"><a href="#FST.walk-1345"><span class="linenos">1345</span></a>
</span><span id="FST.walk-1346"><a href="#FST.walk-1346"><span class="linenos">1346</span></a>                        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">iter</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">skip_iter</span><span class="p">:</span>
</span><span id="FST.walk-1347"><a href="#FST.walk-1347"><span class="linenos">1347</span></a>                            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="FST.walk-1348"><a href="#FST.walk-1348"><span class="linenos">1348</span></a>
</span><span id="FST.walk-1349"><a href="#FST.walk-1349"><span class="linenos">1349</span></a>                        <span class="k">if</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">ifs</span><span class="p">:</span>
</span><span id="FST.walk-1350"><a href="#FST.walk-1350"><span class="linenos">1350</span></a>                            <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="FST.walk-1351"><a href="#FST.walk-1351"><span class="linenos">1351</span></a>
</span><span id="FST.walk-1352"><a href="#FST.walk-1352"><span class="linenos">1352</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1353"><a href="#FST.walk-1353"><span class="linenos">1353</span></a>                        <span class="k">if</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">ifs</span><span class="p">:</span>
</span><span id="FST.walk-1354"><a href="#FST.walk-1354"><span class="linenos">1354</span></a>                            <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="FST.walk-1355"><a href="#FST.walk-1355"><span class="linenos">1355</span></a>
</span><span id="FST.walk-1356"><a href="#FST.walk-1356"><span class="linenos">1356</span></a>                        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">iter</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">skip_iter</span><span class="p">:</span>
</span><span id="FST.walk-1357"><a href="#FST.walk-1357"><span class="linenos">1357</span></a>                            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="FST.walk-1358"><a href="#FST.walk-1358"><span class="linenos">1358</span></a>
</span><span id="FST.walk-1359"><a href="#FST.walk-1359"><span class="linenos">1359</span></a>                        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</span><span id="FST.walk-1360"><a href="#FST.walk-1360"><span class="linenos">1360</span></a>
</span><span id="FST.walk-1361"><a href="#FST.walk-1361"><span class="linenos">1361</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FST.walk-1362"><a href="#FST.walk-1362"><span class="linenos">1362</span></a>                    <span class="n">recurse_</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FST.walk-1363"><a href="#FST.walk-1363"><span class="linenos">1363</span></a>
</span><span id="FST.walk-1364"><a href="#FST.walk-1364"><span class="linenos">1364</span></a>            <span class="k">if</span> <span class="n">recurse_</span><span class="p">:</span>
</span><span id="FST.walk-1365"><a href="#FST.walk-1365"><span class="linenos">1365</span></a>                <span class="n">children</span> <span class="o">=</span> <span class="n">syntax_ordered_children</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="FST.walk-1366"><a href="#FST.walk-1366"><span class="linenos">1366</span></a>
</span><span id="FST.walk-1367"><a href="#FST.walk-1367"><span class="linenos">1367</span></a>                <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">children</span> <span class="k">if</span> <span class="n">back</span> <span class="k">else</span> <span class="n">children</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Walk <code>self</code> and descendants in syntactic order. When walking, you can <code>send(False)</code> to the generator to skip
recursion into the current child. <code>send(True)</code> to allow recursion into child if called with <code>recurse=False</code> or
<code>scope=True</code> would otherwise disallow it. Can send multiple times, last value sent takes effect.</p>

<p>The walk is defined forwards or backwards in that it returns a parent, then recurses into the children and walks
those in the given direction, recursing into each child's children before continuing with siblings. Walking
backwards will not generate the same sequence as <code>list(walk())[::-1]</code> due to this behavior.</p>

<p>It is safe to modify the nodes (or previous nodes) as they are being walked as long as those modifications don't
touch the parent or following nodes. This means normal <code>.replace()</code> is fine as long as <code>raw=False</code>.</p>

<p>The walk is relatively efficient but if all you need to do is just walk ALL the <code>AST</code> children without any bells or
whistles then <code>ast.walk()</code> will be a bit faster.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>with_loc</code>: Return nodes depending on their location information.
<ul>
<li><code>False</code>: All nodes with or without location.</li>
<li><code>True</code>: Only nodes which have implicit <code>AST</code> locations and also larger computed location nodes like
<code>comprehension</code>, <code>withitem</code>, <code>match_case</code> and <code>arguments</code> (the last one only if there are actually arguments
present).</li>
<li><code>'all'</code>: Same as <code>True</code> but also operators with calculated locations (excluding <code>and</code> and <code>or</code> since they do
not always have a well defined location).</li>
<li><code>'own'</code>: Only nodes with their own implicit <code>AST</code> locations, same as <code>True</code> but excludes those larger nodes
with calculated locations.</li>
</ul></li>
<li><code>self_</code>: If <code>True</code> then self will be returned first with the possibility to skip children with <code>send(False)</code>,
otherwise will start directly with children.</li>
<li><code>recurse</code>: Whether to recurse into children by default, <code>send(True)</code> for a given node will always override this.</li>
<li><code>scope</code>: If <code>True</code> then will walk only within the scope of <code>self</code>. Meaning if called on a <code>FunctionDef</code> then
will only walk children which are within the function scope. Will yield children which have their own scopes,
and the parts of them which are visible in this scope (like default argument values), but will not recurse into
them unless <code>send(True)</code> is done for that child.</li>
<li><code>back</code>: If <code>True</code> then walk every node in reverse syntactic order. This is not the same as a full forwards
walk reversed due to recursion (parents are still returned before children, only in reverse sibling order).</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">ast</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(a: list[str], /, reject: int, *c, d=100, **e): pass&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="p">(</span><span class="n">gen</span> <span class="o">:=</span> <span class="n">f</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">with_loc</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
<span class="o">...</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span> <span class="ow">and</span> <span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;reject&#39;</span><span class="p">:</span>
<span class="o">...</span>         <span class="n">_</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">else</span><span class="p">:</span>
<span class="o">...</span>         <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">g</span><span class="si">!r:</span><span class="s1">&lt;30</span><span class="si">}{</span><span class="n">g</span><span class="o">.</span><span class="n">src</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="si">!r}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">FunctionDef</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">57</span><span class="o">&gt;</span>  <span class="s1">&#39;def f(a: list[str], /, reject: int, *c, d=100, **e&#39;</span>
<span class="o">&lt;</span><span class="n">arguments</span> <span class="mi">0</span><span class="p">,</span><span class="mf">6..0</span><span class="p">,</span><span class="mi">50</span><span class="o">&gt;</span>         <span class="s1">&#39;a: list[str], /, reject: int, *c, d=100, **e&#39;</span>
<span class="o">&lt;</span><span class="n">arg</span> <span class="mi">0</span><span class="p">,</span><span class="mf">6..0</span><span class="p">,</span><span class="mi">18</span><span class="o">&gt;</span>               <span class="s1">&#39;a: list[str]&#39;</span>
<span class="o">&lt;</span><span class="n">Subscript</span> <span class="mi">0</span><span class="p">,</span><span class="mf">9..0</span><span class="p">,</span><span class="mi">18</span><span class="o">&gt;</span>         <span class="s1">&#39;list[str]&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">0</span><span class="p">,</span><span class="mf">9..0</span><span class="p">,</span><span class="mi">13</span><span class="o">&gt;</span>              <span class="s1">&#39;list&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">0</span><span class="p">,</span><span class="mf">14..0</span><span class="p">,</span><span class="mi">17</span><span class="o">&gt;</span>             <span class="s1">&#39;str&#39;</span>
<span class="o">&lt;</span><span class="n">arg</span> <span class="mi">0</span><span class="p">,</span><span class="mf">37..0</span><span class="p">,</span><span class="mi">38</span><span class="o">&gt;</span>              <span class="s1">&#39;c&#39;</span>
<span class="o">&lt;</span><span class="n">arg</span> <span class="mi">0</span><span class="p">,</span><span class="mf">40..0</span><span class="p">,</span><span class="mi">41</span><span class="o">&gt;</span>              <span class="s1">&#39;d&#39;</span>
<span class="o">&lt;</span><span class="n">Constant</span> <span class="mi">0</span><span class="p">,</span><span class="mf">42..0</span><span class="p">,</span><span class="mi">45</span><span class="o">&gt;</span>         <span class="s1">&#39;100&#39;</span>
<span class="o">&lt;</span><span class="n">arg</span> <span class="mi">0</span><span class="p">,</span><span class="mf">49..0</span><span class="p">,</span><span class="mi">50</span><span class="o">&gt;</span>              <span class="s1">&#39;e&#39;</span>
<span class="o">&lt;</span><span class="n">Pass</span> <span class="mi">0</span><span class="p">,</span><span class="mf">53..0</span><span class="p">,</span><span class="mi">57</span><span class="o">&gt;</span>             <span class="s1">&#39;pass&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">... def f():</span>
<span class="s1">...     def g(arg=1) -&gt; int:</span>
<span class="s1">...         pass</span>
<span class="s1">...     val = [i for i in iterator]</span>
<span class="s1">... &#39;&#39;&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="o">...</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">g</span><span class="si">!r:</span><span class="s1">&lt;30</span><span class="si">}{</span><span class="n">g</span><span class="o">.</span><span class="n">src</span><span class="p">[:</span><span class="mi">47</span><span class="p">]</span><span class="si">!r}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">FunctionDef</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..3</span><span class="p">,</span><span class="mi">31</span><span class="o">&gt;</span>  <span class="s1">&#39;def f():</span><span class="se">\n</span><span class="s1">    def g(arg=1) -&gt; int:</span><span class="se">\n</span><span class="s1">        pass</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="o">&lt;</span><span class="n">FunctionDef</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..2</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>       <span class="s1">&#39;def g(arg=1) -&gt; int:</span><span class="se">\n</span><span class="s1">        pass&#39;</span>
<span class="o">&lt;</span><span class="n">Constant</span> <span class="mi">1</span><span class="p">,</span><span class="mf">14..1</span><span class="p">,</span><span class="mi">15</span><span class="o">&gt;</span>         <span class="s1">&#39;1&#39;</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">3</span><span class="p">,</span><span class="mf">4..3</span><span class="p">,</span><span class="mi">31</span><span class="o">&gt;</span>            <span class="s1">&#39;val = [i for i in iterator]&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">3</span><span class="p">,</span><span class="mf">4..3</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>               <span class="s1">&#39;val&#39;</span>
<span class="o">&lt;</span><span class="n">ListComp</span> <span class="mi">3</span><span class="p">,</span><span class="mf">10..3</span><span class="p">,</span><span class="mi">31</span><span class="o">&gt;</span>         <span class="s1">&#39;[i for i in iterator]&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">3</span><span class="p">,</span><span class="mf">22..3</span><span class="p">,</span><span class="mi">30</span><span class="o">&gt;</span>             <span class="s1">&#39;iterator&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="o">...</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">g</span><span class="si">!r:</span><span class="s1">&lt;30</span><span class="si">}{</span><span class="n">g</span><span class="o">.</span><span class="n">src</span><span class="p">[:</span><span class="mi">47</span><span class="p">]</span><span class="si">!r}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">FunctionDef</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..3</span><span class="p">,</span><span class="mi">31</span><span class="o">&gt;</span>  <span class="s1">&#39;def f():</span><span class="se">\n</span><span class="s1">    def g(arg=1) -&gt; int:</span><span class="se">\n</span><span class="s1">        pass</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">3</span><span class="p">,</span><span class="mf">4..3</span><span class="p">,</span><span class="mi">31</span><span class="o">&gt;</span>            <span class="s1">&#39;val = [i for i in iterator]&#39;</span>
<span class="o">&lt;</span><span class="n">ListComp</span> <span class="mi">3</span><span class="p">,</span><span class="mf">10..3</span><span class="p">,</span><span class="mi">31</span><span class="o">&gt;</span>         <span class="s1">&#39;[i for i in iterator]&#39;</span>
<span class="o">&lt;</span><span class="n">comprehension</span> <span class="mi">3</span><span class="p">,</span><span class="mf">13..3</span><span class="p">,</span><span class="mi">30</span><span class="o">&gt;</span>    <span class="s1">&#39;for i in iterator&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">3</span><span class="p">,</span><span class="mf">22..3</span><span class="p">,</span><span class="mi">30</span><span class="o">&gt;</span>             <span class="s1">&#39;iterator&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">3</span><span class="p">,</span><span class="mf">17..3</span><span class="p">,</span><span class="mi">18</span><span class="o">&gt;</span>             <span class="s1">&#39;i&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">3</span><span class="p">,</span><span class="mf">11..3</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>             <span class="s1">&#39;i&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">3</span><span class="p">,</span><span class="mf">4..3</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>               <span class="s1">&#39;val&#39;</span>
<span class="o">&lt;</span><span class="n">FunctionDef</span> <span class="mi">1</span><span class="p">,</span><span class="mf">4..2</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>       <span class="s1">&#39;def g(arg=1) -&gt; int:</span><span class="se">\n</span><span class="s1">        pass&#39;</span>
<span class="o">&lt;</span><span class="n">Pass</span> <span class="mi">2</span><span class="p">,</span><span class="mf">8..2</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>              <span class="s1">&#39;pass&#39;</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">1</span><span class="p">,</span><span class="mf">20..1</span><span class="p">,</span><span class="mi">23</span><span class="o">&gt;</span>             <span class="s1">&#39;int&#39;</span>
<span class="o">&lt;</span><span class="n">arguments</span> <span class="mi">1</span><span class="p">,</span><span class="mf">10..1</span><span class="p">,</span><span class="mi">15</span><span class="o">&gt;</span>        <span class="s1">&#39;arg=1&#39;</span>
<span class="o">&lt;</span><span class="n">Constant</span> <span class="mi">1</span><span class="p">,</span><span class="mf">14..1</span><span class="p">,</span><span class="mi">15</span><span class="o">&gt;</span>         <span class="s1">&#39;1&#39;</span>
<span class="o">&lt;</span><span class="n">arg</span> <span class="mi">1</span><span class="p">,</span><span class="mf">10..1</span><span class="p">,</span><span class="mi">13</span><span class="o">&gt;</span>              <span class="s1">&#39;arg&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.parents" class="classattr">
                                        <input id="FST.parents-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parents</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Generator</span><span class="p">[</span><span class="n"><a href="#FST">FST</a></span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FST.parents-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.parents"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.parents-2119"><a href="#FST.parents-2119"><span class="linenos">2119</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FST</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="FST.parents-2120"><a href="#FST.parents-2120"><span class="linenos">2120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generator which yields parents all the way up to root. If `self_` is `True` then will yield `self` first.</span>
</span><span id="FST.parents-2121"><a href="#FST.parents-2121"><span class="linenos">2121</span></a>
</span><span id="FST.parents-2122"><a href="#FST.parents-2122"><span class="linenos">2122</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.parents-2123"><a href="#FST.parents-2123"><span class="linenos">2123</span></a><span class="sd">        - `self_`: Whether to yield `self` first.</span>
</span><span id="FST.parents-2124"><a href="#FST.parents-2124"><span class="linenos">2124</span></a>
</span><span id="FST.parents-2125"><a href="#FST.parents-2125"><span class="linenos">2125</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.parents-2126"><a href="#FST.parents-2126"><span class="linenos">2126</span></a><span class="sd">        ```py</span>
</span><span id="FST.parents-2127"><a href="#FST.parents-2127"><span class="linenos">2127</span></a><span class="sd">        &gt;&gt;&gt; list(FST(&#39;i = (f(), g())&#39;, &#39;exec&#39;).body[0].value.elts[0].parents())</span>
</span><span id="FST.parents-2128"><a href="#FST.parents-2128"><span class="linenos">2128</span></a><span class="sd">        [&lt;Tuple 0,4..0,14&gt;, &lt;Assign 0,0..0,14&gt;, &lt;Module ROOT 0,0..0,14&gt;]</span>
</span><span id="FST.parents-2129"><a href="#FST.parents-2129"><span class="linenos">2129</span></a>
</span><span id="FST.parents-2130"><a href="#FST.parents-2130"><span class="linenos">2130</span></a><span class="sd">        &gt;&gt;&gt; list(FST(&#39;i = (f(), g())&#39;, &#39;exec&#39;).body[0].value.elts[0].parents(self_=True))</span>
</span><span id="FST.parents-2131"><a href="#FST.parents-2131"><span class="linenos">2131</span></a><span class="sd">        [&lt;Call 0,5..0,8&gt;, &lt;Tuple 0,4..0,14&gt;, &lt;Assign 0,0..0,14&gt;, &lt;Module ROOT 0,0..0,14&gt;]</span>
</span><span id="FST.parents-2132"><a href="#FST.parents-2132"><span class="linenos">2132</span></a><span class="sd">        ```</span>
</span><span id="FST.parents-2133"><a href="#FST.parents-2133"><span class="linenos">2133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.parents-2134"><a href="#FST.parents-2134"><span class="linenos">2134</span></a>
</span><span id="FST.parents-2135"><a href="#FST.parents-2135"><span class="linenos">2135</span></a>        <span class="k">if</span> <span class="n">self_</span><span class="p">:</span>
</span><span id="FST.parents-2136"><a href="#FST.parents-2136"><span class="linenos">2136</span></a>            <span class="k">yield</span> <span class="bp">self</span>
</span><span id="FST.parents-2137"><a href="#FST.parents-2137"><span class="linenos">2137</span></a>
</span><span id="FST.parents-2138"><a href="#FST.parents-2138"><span class="linenos">2138</span></a>        <span class="k">while</span> <span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST.parents-2139"><a href="#FST.parents-2139"><span class="linenos">2139</span></a>            <span class="k">yield</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Generator which yields parents all the way up to root. If <code>self_</code> is <code>True</code> then will yield <code>self</code> first.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>self_</code>: Whether to yield <code>self</code> first.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = (f(), g())&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parents</span><span class="p">())</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">Tuple</span> <span class="mi">0</span><span class="p">,</span><span class="mf">4..0</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = (f(), g())&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">self_</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">Call</span> <span class="mi">0</span><span class="p">,</span><span class="mf">5..0</span><span class="p">,</span><span class="mi">8</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Tuple</span> <span class="mi">0</span><span class="p">,</span><span class="mf">4..0</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span><span class="p">]</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.parent_stmt" class="classattr">
                                        <input id="FST.parent_stmt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parent_stmt</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.parent_stmt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.parent_stmt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.parent_stmt-2141"><a href="#FST.parent_stmt-2141"><span class="linenos">2141</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.parent_stmt-2142"><a href="#FST.parent_stmt-2142"><span class="linenos">2142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The first parent which is a `stmt` or optionally `mod` node (if any). If `self_` is `True` then will check</span>
</span><span id="FST.parent_stmt-2143"><a href="#FST.parent_stmt-2143"><span class="linenos">2143</span></a><span class="sd">        `self` first (possibly returning `self`), otherwise only checks parents.</span>
</span><span id="FST.parent_stmt-2144"><a href="#FST.parent_stmt-2144"><span class="linenos">2144</span></a>
</span><span id="FST.parent_stmt-2145"><a href="#FST.parent_stmt-2145"><span class="linenos">2145</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.parent_stmt-2146"><a href="#FST.parent_stmt-2146"><span class="linenos">2146</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="FST.parent_stmt-2147"><a href="#FST.parent_stmt-2147"><span class="linenos">2147</span></a><span class="sd">        - `mod`: Whether to return `mod` nodes if found.</span>
</span><span id="FST.parent_stmt-2148"><a href="#FST.parent_stmt-2148"><span class="linenos">2148</span></a>
</span><span id="FST.parent_stmt-2149"><a href="#FST.parent_stmt-2149"><span class="linenos">2149</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.parent_stmt-2150"><a href="#FST.parent_stmt-2150"><span class="linenos">2150</span></a><span class="sd">        ```py</span>
</span><span id="FST.parent_stmt-2151"><a href="#FST.parent_stmt-2151"><span class="linenos">2151</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_stmt()</span>
</span><span id="FST.parent_stmt-2152"><a href="#FST.parent_stmt-2152"><span class="linenos">2152</span></a><span class="sd">        &lt;Assign 0,6..0,11&gt;</span>
</span><span id="FST.parent_stmt-2153"><a href="#FST.parent_stmt-2153"><span class="linenos">2153</span></a>
</span><span id="FST.parent_stmt-2154"><a href="#FST.parent_stmt-2154"><span class="linenos">2154</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].parent_stmt()</span>
</span><span id="FST.parent_stmt-2155"><a href="#FST.parent_stmt-2155"><span class="linenos">2155</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="FST.parent_stmt-2156"><a href="#FST.parent_stmt-2156"><span class="linenos">2156</span></a>
</span><span id="FST.parent_stmt-2157"><a href="#FST.parent_stmt-2157"><span class="linenos">2157</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt()</span>
</span><span id="FST.parent_stmt-2158"><a href="#FST.parent_stmt-2158"><span class="linenos">2158</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="FST.parent_stmt-2159"><a href="#FST.parent_stmt-2159"><span class="linenos">2159</span></a>
</span><span id="FST.parent_stmt-2160"><a href="#FST.parent_stmt-2160"><span class="linenos">2160</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt(mod=False))</span>
</span><span id="FST.parent_stmt-2161"><a href="#FST.parent_stmt-2161"><span class="linenos">2161</span></a><span class="sd">        None</span>
</span><span id="FST.parent_stmt-2162"><a href="#FST.parent_stmt-2162"><span class="linenos">2162</span></a>
</span><span id="FST.parent_stmt-2163"><a href="#FST.parent_stmt-2163"><span class="linenos">2163</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_stmt(self_=True)</span>
</span><span id="FST.parent_stmt-2164"><a href="#FST.parent_stmt-2164"><span class="linenos">2164</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="FST.parent_stmt-2165"><a href="#FST.parent_stmt-2165"><span class="linenos">2165</span></a><span class="sd">        ```</span>
</span><span id="FST.parent_stmt-2166"><a href="#FST.parent_stmt-2166"><span class="linenos">2166</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.parent_stmt-2167"><a href="#FST.parent_stmt-2167"><span class="linenos">2167</span></a>
</span><span id="FST.parent_stmt-2168"><a href="#FST.parent_stmt-2168"><span class="linenos">2168</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">ast_mod</span><span class="p">)</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">stmt</span>
</span><span id="FST.parent_stmt-2169"><a href="#FST.parent_stmt-2169"><span class="linenos">2169</span></a>
</span><span id="FST.parent_stmt-2170"><a href="#FST.parent_stmt-2170"><span class="linenos">2170</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_stmt-2171"><a href="#FST.parent_stmt-2171"><span class="linenos">2171</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.parent_stmt-2172"><a href="#FST.parent_stmt-2172"><span class="linenos">2172</span></a>
</span><span id="FST.parent_stmt-2173"><a href="#FST.parent_stmt-2173"><span class="linenos">2173</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_stmt-2174"><a href="#FST.parent_stmt-2174"><span class="linenos">2174</span></a>            <span class="k">pass</span>
</span><span id="FST.parent_stmt-2175"><a href="#FST.parent_stmt-2175"><span class="linenos">2175</span></a>
</span><span id="FST.parent_stmt-2176"><a href="#FST.parent_stmt-2176"><span class="linenos">2176</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>The first parent which is a <code>stmt</code> or optionally <code>mod</code> node (if any). If <code>self_</code> is <code>True</code> then will check
<code>self</code> first (possibly returning <code>self</code>), otherwise only checks parents.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>self_</code>: Whether to include <code>self</code> in the search, if so and <code>self</code> matches criteria then it is returned.</li>
<li><code>mod</code>: Whether to return <code>mod</code> nodes if found.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_stmt</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">0</span><span class="p">,</span><span class="mf">6..0</span><span class="p">,</span><span class="mi">11</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_stmt</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">If</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">11</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_stmt</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">11</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_stmt</span><span class="p">(</span><span class="n">mod</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="kc">None</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_stmt</span><span class="p">(</span><span class="n">self_</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">If</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">11</span><span class="o">&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.parent_stmtish" class="classattr">
                                        <input id="FST.parent_stmtish-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parent_stmtish</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.parent_stmtish-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.parent_stmtish"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.parent_stmtish-2178"><a href="#FST.parent_stmtish-2178"><span class="linenos">2178</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_stmtish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.parent_stmtish-2179"><a href="#FST.parent_stmtish-2179"><span class="linenos">2179</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is a `stmt`, `ExceptHandler`, `match_case` or optionally `mod` node (if any). If</span>
</span><span id="FST.parent_stmtish-2180"><a href="#FST.parent_stmtish-2180"><span class="linenos">2180</span></a><span class="sd">        `self_` is `True` then will check `self` first, otherwise only checks parents.</span>
</span><span id="FST.parent_stmtish-2181"><a href="#FST.parent_stmtish-2181"><span class="linenos">2181</span></a>
</span><span id="FST.parent_stmtish-2182"><a href="#FST.parent_stmtish-2182"><span class="linenos">2182</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.parent_stmtish-2183"><a href="#FST.parent_stmtish-2183"><span class="linenos">2183</span></a><span class="sd">        ```py</span>
</span><span id="FST.parent_stmtish-2184"><a href="#FST.parent_stmtish-2184"><span class="linenos">2184</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;)</span>
</span><span id="FST.parent_stmtish-2185"><a href="#FST.parent_stmtish-2185"><span class="linenos">2185</span></a><span class="sd">        ...  .body[0].handlers[0].body[0].parent_stmtish())</span>
</span><span id="FST.parent_stmtish-2186"><a href="#FST.parent_stmtish-2186"><span class="linenos">2186</span></a><span class="sd">        &lt;ExceptHandler 1,0..1,12&gt;</span>
</span><span id="FST.parent_stmtish-2187"><a href="#FST.parent_stmtish-2187"><span class="linenos">2187</span></a>
</span><span id="FST.parent_stmtish-2188"><a href="#FST.parent_stmtish-2188"><span class="linenos">2188</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;).body[0].handlers[0].parent_stmtish()</span>
</span><span id="FST.parent_stmtish-2189"><a href="#FST.parent_stmtish-2189"><span class="linenos">2189</span></a><span class="sd">        &lt;Try 0,0..1,12&gt;</span>
</span><span id="FST.parent_stmtish-2190"><a href="#FST.parent_stmtish-2190"><span class="linenos">2190</span></a>
</span><span id="FST.parent_stmtish-2191"><a href="#FST.parent_stmtish-2191"><span class="linenos">2191</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;, &#39;exec&#39;).body[0].parent_stmtish()</span>
</span><span id="FST.parent_stmtish-2192"><a href="#FST.parent_stmtish-2192"><span class="linenos">2192</span></a><span class="sd">        &lt;Module ROOT 0,0..1,12&gt;</span>
</span><span id="FST.parent_stmtish-2193"><a href="#FST.parent_stmtish-2193"><span class="linenos">2193</span></a>
</span><span id="FST.parent_stmtish-2194"><a href="#FST.parent_stmtish-2194"><span class="linenos">2194</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].body[0].parent_stmtish()</span>
</span><span id="FST.parent_stmtish-2195"><a href="#FST.parent_stmtish-2195"><span class="linenos">2195</span></a><span class="sd">        &lt;match_case 1,2..1,14&gt;</span>
</span><span id="FST.parent_stmtish-2196"><a href="#FST.parent_stmtish-2196"><span class="linenos">2196</span></a>
</span><span id="FST.parent_stmtish-2197"><a href="#FST.parent_stmtish-2197"><span class="linenos">2197</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].pattern.parent_stmtish()</span>
</span><span id="FST.parent_stmtish-2198"><a href="#FST.parent_stmtish-2198"><span class="linenos">2198</span></a><span class="sd">        &lt;match_case 1,2..1,14&gt;</span>
</span><span id="FST.parent_stmtish-2199"><a href="#FST.parent_stmtish-2199"><span class="linenos">2199</span></a><span class="sd">        ```</span>
</span><span id="FST.parent_stmtish-2200"><a href="#FST.parent_stmtish-2200"><span class="linenos">2200</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.parent_stmtish-2201"><a href="#FST.parent_stmtish-2201"><span class="linenos">2201</span></a>
</span><span id="FST.parent_stmtish-2202"><a href="#FST.parent_stmtish-2202"><span class="linenos">2202</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">STMTISH_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">STMTISH</span>
</span><span id="FST.parent_stmtish-2203"><a href="#FST.parent_stmtish-2203"><span class="linenos">2203</span></a>
</span><span id="FST.parent_stmtish-2204"><a href="#FST.parent_stmtish-2204"><span class="linenos">2204</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_stmtish-2205"><a href="#FST.parent_stmtish-2205"><span class="linenos">2205</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.parent_stmtish-2206"><a href="#FST.parent_stmtish-2206"><span class="linenos">2206</span></a>
</span><span id="FST.parent_stmtish-2207"><a href="#FST.parent_stmtish-2207"><span class="linenos">2207</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_stmtish-2208"><a href="#FST.parent_stmtish-2208"><span class="linenos">2208</span></a>            <span class="k">pass</span>
</span><span id="FST.parent_stmtish-2209"><a href="#FST.parent_stmtish-2209"><span class="linenos">2209</span></a>
</span><span id="FST.parent_stmtish-2210"><a href="#FST.parent_stmtish-2210"><span class="linenos">2210</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>The first parent which is a <code>stmt</code>, <code>ExceptHandler</code>, <code>match_case</code> or optionally <code>mod</code> node (if any). If
<code>self_</code> is <code>True</code> then will check <code>self</code> first, otherwise only checks parents.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">except: pass&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_stmtish</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">ExceptHandler</span> <span class="mi">1</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">except: pass&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_stmtish</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Try</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">except: pass&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_stmtish</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case 1: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_stmtish</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">match_case</span> <span class="mi">1</span><span class="p">,</span><span class="mf">2..1</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case 1: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">parent_stmtish</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">match_case</span> <span class="mi">1</span><span class="p">,</span><span class="mf">2..1</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.parent_block" class="classattr">
                                        <input id="FST.parent_block-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parent_block</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.parent_block-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.parent_block"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.parent_block-2212"><a href="#FST.parent_block-2212"><span class="linenos">2212</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.parent_block-2213"><a href="#FST.parent_block-2213"><span class="linenos">2213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The first parent which opens a block that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="FST.parent_block-2214"><a href="#FST.parent_block-2214"><span class="linenos">2214</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef`, `For`, `AsyncFor`, `While`, `If`, `With`, `AsyncWith`, `Match`, `Try`,</span>
</span><span id="FST.parent_block-2215"><a href="#FST.parent_block-2215"><span class="linenos">2215</span></a><span class="sd">        `TryStar`, `ExceptHandler`, `match_case` or optionally `mod` node (if any). If `self_` is `True` then will check</span>
</span><span id="FST.parent_block-2216"><a href="#FST.parent_block-2216"><span class="linenos">2216</span></a><span class="sd">        `self` first, otherwise only checks parents.</span>
</span><span id="FST.parent_block-2217"><a href="#FST.parent_block-2217"><span class="linenos">2217</span></a>
</span><span id="FST.parent_block-2218"><a href="#FST.parent_block-2218"><span class="linenos">2218</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.parent_block-2219"><a href="#FST.parent_block-2219"><span class="linenos">2219</span></a><span class="sd">        ```py</span>
</span><span id="FST.parent_block-2220"><a href="#FST.parent_block-2220"><span class="linenos">2220</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_block()</span>
</span><span id="FST.parent_block-2221"><a href="#FST.parent_block-2221"><span class="linenos">2221</span></a><span class="sd">        &lt;If 0,0..0,11&gt;</span>
</span><span id="FST.parent_block-2222"><a href="#FST.parent_block-2222"><span class="linenos">2222</span></a>
</span><span id="FST.parent_block-2223"><a href="#FST.parent_block-2223"><span class="linenos">2223</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].parent_block()</span>
</span><span id="FST.parent_block-2224"><a href="#FST.parent_block-2224"><span class="linenos">2224</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="FST.parent_block-2225"><a href="#FST.parent_block-2225"><span class="linenos">2225</span></a><span class="sd">        ```</span>
</span><span id="FST.parent_block-2226"><a href="#FST.parent_block-2226"><span class="linenos">2226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.parent_block-2227"><a href="#FST.parent_block-2227"><span class="linenos">2227</span></a>
</span><span id="FST.parent_block-2228"><a href="#FST.parent_block-2228"><span class="linenos">2228</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">BLOCK_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">BLOCK</span>
</span><span id="FST.parent_block-2229"><a href="#FST.parent_block-2229"><span class="linenos">2229</span></a>
</span><span id="FST.parent_block-2230"><a href="#FST.parent_block-2230"><span class="linenos">2230</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_block-2231"><a href="#FST.parent_block-2231"><span class="linenos">2231</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.parent_block-2232"><a href="#FST.parent_block-2232"><span class="linenos">2232</span></a>
</span><span id="FST.parent_block-2233"><a href="#FST.parent_block-2233"><span class="linenos">2233</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_block-2234"><a href="#FST.parent_block-2234"><span class="linenos">2234</span></a>            <span class="k">pass</span>
</span><span id="FST.parent_block-2235"><a href="#FST.parent_block-2235"><span class="linenos">2235</span></a>
</span><span id="FST.parent_block-2236"><a href="#FST.parent_block-2236"><span class="linenos">2236</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>The first parent which opens a block that <code>self</code> lives in (if any). Types include <code>FunctionDef</code>,
<code>AsyncFunctionDef</code>, <code>ClassDef</code>, <code>For</code>, <code>AsyncFor</code>, <code>While</code>, <code>If</code>, <code>With</code>, <code>AsyncWith</code>, <code>Match</code>, <code>Try</code>,
<code>TryStar</code>, <code>ExceptHandler</code>, <code>match_case</code> or optionally <code>mod</code> node (if any). If <code>self_</code> is <code>True</code> then will check
<code>self</code> first, otherwise only checks parents.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_block</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">If</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">11</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_block</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">11</span><span class="o">&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.parent_scope" class="classattr">
                                        <input id="FST.parent_scope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parent_scope</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.parent_scope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.parent_scope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.parent_scope-2238"><a href="#FST.parent_scope-2238"><span class="linenos">2238</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.parent_scope-2239"><a href="#FST.parent_scope-2239"><span class="linenos">2239</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which opens a scope that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="FST.parent_scope-2240"><a href="#FST.parent_scope-2240"><span class="linenos">2240</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef`, `Lambda`, `ListComp`, `SetComp`, `DictComp`, `GeneratorExp` or optionally `mod`</span>
</span><span id="FST.parent_scope-2241"><a href="#FST.parent_scope-2241"><span class="linenos">2241</span></a><span class="sd">        node (if any). If `self_` is `True` then will check `self` first, otherwise only checks parents.</span>
</span><span id="FST.parent_scope-2242"><a href="#FST.parent_scope-2242"><span class="linenos">2242</span></a>
</span><span id="FST.parent_scope-2243"><a href="#FST.parent_scope-2243"><span class="linenos">2243</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.parent_scope-2244"><a href="#FST.parent_scope-2244"><span class="linenos">2244</span></a><span class="sd">        ```py</span>
</span><span id="FST.parent_scope-2245"><a href="#FST.parent_scope-2245"><span class="linenos">2245</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_scope()</span>
</span><span id="FST.parent_scope-2246"><a href="#FST.parent_scope-2246"><span class="linenos">2246</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="FST.parent_scope-2247"><a href="#FST.parent_scope-2247"><span class="linenos">2247</span></a>
</span><span id="FST.parent_scope-2248"><a href="#FST.parent_scope-2248"><span class="linenos">2248</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f():\n  if 1: i = 1&#39;, &#39;exec&#39;)</span>
</span><span id="FST.parent_scope-2249"><a href="#FST.parent_scope-2249"><span class="linenos">2249</span></a><span class="sd">        ...  .body[0].body[0].body[0].value.parent_scope())</span>
</span><span id="FST.parent_scope-2250"><a href="#FST.parent_scope-2250"><span class="linenos">2250</span></a><span class="sd">        &lt;FunctionDef 0,0..1,13&gt;</span>
</span><span id="FST.parent_scope-2251"><a href="#FST.parent_scope-2251"><span class="linenos">2251</span></a>
</span><span id="FST.parent_scope-2252"><a href="#FST.parent_scope-2252"><span class="linenos">2252</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;lambda: None&#39;, &#39;exec&#39;).body[0].value.body.parent_scope()</span>
</span><span id="FST.parent_scope-2253"><a href="#FST.parent_scope-2253"><span class="linenos">2253</span></a><span class="sd">        &lt;Lambda 0,0..0,12&gt;</span>
</span><span id="FST.parent_scope-2254"><a href="#FST.parent_scope-2254"><span class="linenos">2254</span></a>
</span><span id="FST.parent_scope-2255"><a href="#FST.parent_scope-2255"><span class="linenos">2255</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[i for i in j]&#39;, &#39;exec&#39;).body[0].value.elt.parent_scope()</span>
</span><span id="FST.parent_scope-2256"><a href="#FST.parent_scope-2256"><span class="linenos">2256</span></a><span class="sd">        &lt;ListComp 0,0..0,14&gt;</span>
</span><span id="FST.parent_scope-2257"><a href="#FST.parent_scope-2257"><span class="linenos">2257</span></a><span class="sd">        ```</span>
</span><span id="FST.parent_scope-2258"><a href="#FST.parent_scope-2258"><span class="linenos">2258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.parent_scope-2259"><a href="#FST.parent_scope-2259"><span class="linenos">2259</span></a>
</span><span id="FST.parent_scope-2260"><a href="#FST.parent_scope-2260"><span class="linenos">2260</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">SCOPE_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">SCOPE</span>
</span><span id="FST.parent_scope-2261"><a href="#FST.parent_scope-2261"><span class="linenos">2261</span></a>
</span><span id="FST.parent_scope-2262"><a href="#FST.parent_scope-2262"><span class="linenos">2262</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_scope-2263"><a href="#FST.parent_scope-2263"><span class="linenos">2263</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.parent_scope-2264"><a href="#FST.parent_scope-2264"><span class="linenos">2264</span></a>
</span><span id="FST.parent_scope-2265"><a href="#FST.parent_scope-2265"><span class="linenos">2265</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_scope-2266"><a href="#FST.parent_scope-2266"><span class="linenos">2266</span></a>            <span class="k">pass</span>
</span><span id="FST.parent_scope-2267"><a href="#FST.parent_scope-2267"><span class="linenos">2267</span></a>
</span><span id="FST.parent_scope-2268"><a href="#FST.parent_scope-2268"><span class="linenos">2268</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>The first parent which opens a scope that <code>self</code> lives in (if any). Types include <code>FunctionDef</code>,
<code>AsyncFunctionDef</code>, <code>ClassDef</code>, <code>Lambda</code>, <code>ListComp</code>, <code>SetComp</code>, <code>DictComp</code>, <code>GeneratorExp</code> or optionally <code>mod</code>
node (if any). If <code>self_</code> is <code>True</code> then will check <code>self</code> first, otherwise only checks parents.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_scope</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">11</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f():</span><span class="se">\n</span><span class="s1">  if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_scope</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">FunctionDef</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">13</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;lambda: None&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">parent_scope</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Lambda</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[i for i in j]&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">elt</span><span class="o">.</span><span class="n">parent_scope</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">ListComp</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">14</span><span class="o">&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.parent_named_scope" class="classattr">
                                        <input id="FST.parent_named_scope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parent_named_scope</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.parent_named_scope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.parent_named_scope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.parent_named_scope-2270"><a href="#FST.parent_named_scope-2270"><span class="linenos">2270</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_named_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.parent_named_scope-2271"><a href="#FST.parent_named_scope-2271"><span class="linenos">2271</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which opens a named scope that `self` lives in (if any). Types include `FunctionDef`,</span>
</span><span id="FST.parent_named_scope-2272"><a href="#FST.parent_named_scope-2272"><span class="linenos">2272</span></a><span class="sd">        `AsyncFunctionDef`, `ClassDef` or optionally `mod` node (if any). If `self_` is `True` then will check `self`</span>
</span><span id="FST.parent_named_scope-2273"><a href="#FST.parent_named_scope-2273"><span class="linenos">2273</span></a><span class="sd">        first, otherwise only checks parents.</span>
</span><span id="FST.parent_named_scope-2274"><a href="#FST.parent_named_scope-2274"><span class="linenos">2274</span></a>
</span><span id="FST.parent_named_scope-2275"><a href="#FST.parent_named_scope-2275"><span class="linenos">2275</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.parent_named_scope-2276"><a href="#FST.parent_named_scope-2276"><span class="linenos">2276</span></a><span class="sd">        ```py</span>
</span><span id="FST.parent_named_scope-2277"><a href="#FST.parent_named_scope-2277"><span class="linenos">2277</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;, &#39;exec&#39;).body[0].body[0].value.parent_named_scope()</span>
</span><span id="FST.parent_named_scope-2278"><a href="#FST.parent_named_scope-2278"><span class="linenos">2278</span></a><span class="sd">        &lt;Module ROOT 0,0..0,11&gt;</span>
</span><span id="FST.parent_named_scope-2279"><a href="#FST.parent_named_scope-2279"><span class="linenos">2279</span></a>
</span><span id="FST.parent_named_scope-2280"><a href="#FST.parent_named_scope-2280"><span class="linenos">2280</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f():\n  if 1: i = 1&#39;, &#39;exec&#39;)</span>
</span><span id="FST.parent_named_scope-2281"><a href="#FST.parent_named_scope-2281"><span class="linenos">2281</span></a><span class="sd">        ...  .body[0].body[0].body[0].value.parent_named_scope())</span>
</span><span id="FST.parent_named_scope-2282"><a href="#FST.parent_named_scope-2282"><span class="linenos">2282</span></a><span class="sd">        &lt;FunctionDef 0,0..1,13&gt;</span>
</span><span id="FST.parent_named_scope-2283"><a href="#FST.parent_named_scope-2283"><span class="linenos">2283</span></a>
</span><span id="FST.parent_named_scope-2284"><a href="#FST.parent_named_scope-2284"><span class="linenos">2284</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;def f(): lambda: None&#39;, &#39;exec&#39;)</span>
</span><span id="FST.parent_named_scope-2285"><a href="#FST.parent_named_scope-2285"><span class="linenos">2285</span></a><span class="sd">        ...  .body[0].body[0].value.body.parent_named_scope())</span>
</span><span id="FST.parent_named_scope-2286"><a href="#FST.parent_named_scope-2286"><span class="linenos">2286</span></a><span class="sd">        &lt;FunctionDef 0,0..0,21&gt;</span>
</span><span id="FST.parent_named_scope-2287"><a href="#FST.parent_named_scope-2287"><span class="linenos">2287</span></a>
</span><span id="FST.parent_named_scope-2288"><a href="#FST.parent_named_scope-2288"><span class="linenos">2288</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;class cls: [i for i in j]&#39;, &#39;exec&#39;)</span>
</span><span id="FST.parent_named_scope-2289"><a href="#FST.parent_named_scope-2289"><span class="linenos">2289</span></a><span class="sd">        ...  .body[0].body[0].value.elt.parent_named_scope())</span>
</span><span id="FST.parent_named_scope-2290"><a href="#FST.parent_named_scope-2290"><span class="linenos">2290</span></a><span class="sd">        &lt;ClassDef 0,0..0,25&gt;</span>
</span><span id="FST.parent_named_scope-2291"><a href="#FST.parent_named_scope-2291"><span class="linenos">2291</span></a><span class="sd">        ```</span>
</span><span id="FST.parent_named_scope-2292"><a href="#FST.parent_named_scope-2292"><span class="linenos">2292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.parent_named_scope-2293"><a href="#FST.parent_named_scope-2293"><span class="linenos">2293</span></a>
</span><span id="FST.parent_named_scope-2294"><a href="#FST.parent_named_scope-2294"><span class="linenos">2294</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">NAMED_SCOPE_OR_MOD</span> <span class="k">if</span> <span class="n">mod</span> <span class="k">else</span> <span class="n">NAMED_SCOPE</span>
</span><span id="FST.parent_named_scope-2295"><a href="#FST.parent_named_scope-2295"><span class="linenos">2295</span></a>
</span><span id="FST.parent_named_scope-2296"><a href="#FST.parent_named_scope-2296"><span class="linenos">2296</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_named_scope-2297"><a href="#FST.parent_named_scope-2297"><span class="linenos">2297</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.parent_named_scope-2298"><a href="#FST.parent_named_scope-2298"><span class="linenos">2298</span></a>
</span><span id="FST.parent_named_scope-2299"><a href="#FST.parent_named_scope-2299"><span class="linenos">2299</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_named_scope-2300"><a href="#FST.parent_named_scope-2300"><span class="linenos">2300</span></a>            <span class="k">pass</span>
</span><span id="FST.parent_named_scope-2301"><a href="#FST.parent_named_scope-2301"><span class="linenos">2301</span></a>
</span><span id="FST.parent_named_scope-2302"><a href="#FST.parent_named_scope-2302"><span class="linenos">2302</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>The first parent which opens a named scope that <code>self</code> lives in (if any). Types include <code>FunctionDef</code>,
<code>AsyncFunctionDef</code>, <code>ClassDef</code> or optionally <code>mod</code> node (if any). If <code>self_</code> is <code>True</code> then will check <code>self</code>
first, otherwise only checks parents.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_named_scope</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">11</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f():</span><span class="se">\n</span><span class="s1">  if 1: i = 1&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_named_scope</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">FunctionDef</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">13</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(): lambda: None&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">parent_named_scope</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">FunctionDef</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">21</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;class cls: [i for i in j]&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">elt</span><span class="o">.</span><span class="n">parent_named_scope</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">ClassDef</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">25</span><span class="o">&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.parent_non_expr" class="classattr">
                                        <input id="FST.parent_non_expr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parent_non_expr</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>, </span><span class="param"><span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.parent_non_expr-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.parent_non_expr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.parent_non_expr-2304"><a href="#FST.parent_non_expr-2304"><span class="linenos">2304</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_non_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.parent_non_expr-2305"><a href="#FST.parent_non_expr-2305"><span class="linenos">2305</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is not an `expr`. If `self_` is `True` then will check `self` first (possibly</span>
</span><span id="FST.parent_non_expr-2306"><a href="#FST.parent_non_expr-2306"><span class="linenos">2306</span></a><span class="sd">        returning `self`), otherwise only checks parents.</span>
</span><span id="FST.parent_non_expr-2307"><a href="#FST.parent_non_expr-2307"><span class="linenos">2307</span></a>
</span><span id="FST.parent_non_expr-2308"><a href="#FST.parent_non_expr-2308"><span class="linenos">2308</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.parent_non_expr-2309"><a href="#FST.parent_non_expr-2309"><span class="linenos">2309</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="FST.parent_non_expr-2310"><a href="#FST.parent_non_expr-2310"><span class="linenos">2310</span></a><span class="sd">        - `strict`: `False` means consider `comprehension`, `arguments`, `arg` and `keyword` nodes as `expr` for the</span>
</span><span id="FST.parent_non_expr-2311"><a href="#FST.parent_non_expr-2311"><span class="linenos">2311</span></a><span class="sd">            sake of the walk up since these nodes can have other `expr` parents. `True` means only `expr` nodes, which</span>
</span><span id="FST.parent_non_expr-2312"><a href="#FST.parent_non_expr-2312"><span class="linenos">2312</span></a><span class="sd">            means you could get an `arg` or `comprehension` node for example which still has `expr` parents. Also</span>
</span><span id="FST.parent_non_expr-2313"><a href="#FST.parent_non_expr-2313"><span class="linenos">2313</span></a><span class="sd">            `expr_context`, `boolop`, `operator`, `unaruop` and `cmpop` are included if `strict=False` but this only</span>
</span><span id="FST.parent_non_expr-2314"><a href="#FST.parent_non_expr-2314"><span class="linenos">2314</span></a><span class="sd">            makes sense if `self_=True` and you are calling this function on one of those.</span>
</span><span id="FST.parent_non_expr-2315"><a href="#FST.parent_non_expr-2315"><span class="linenos">2315</span></a>
</span><span id="FST.parent_non_expr-2316"><a href="#FST.parent_non_expr-2316"><span class="linenos">2316</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.parent_non_expr-2317"><a href="#FST.parent_non_expr-2317"><span class="linenos">2317</span></a><span class="sd">        ```py</span>
</span><span id="FST.parent_non_expr-2318"><a href="#FST.parent_non_expr-2318"><span class="linenos">2318</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1 + a[b]&#39;).body[0].value.right.value.parent_non_expr()</span>
</span><span id="FST.parent_non_expr-2319"><a href="#FST.parent_non_expr-2319"><span class="linenos">2319</span></a><span class="sd">        &lt;Assign 0,6..0,18&gt;</span>
</span><span id="FST.parent_non_expr-2320"><a href="#FST.parent_non_expr-2320"><span class="linenos">2320</span></a>
</span><span id="FST.parent_non_expr-2321"><a href="#FST.parent_non_expr-2321"><span class="linenos">2321</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n case {a.b.c: 1}: pass&#39;)</span>
</span><span id="FST.parent_non_expr-2322"><a href="#FST.parent_non_expr-2322"><span class="linenos">2322</span></a><span class="sd">        ...  .cases[0].pattern.keys[0].value.value.parent_non_expr())</span>
</span><span id="FST.parent_non_expr-2323"><a href="#FST.parent_non_expr-2323"><span class="linenos">2323</span></a><span class="sd">        &lt;MatchMapping 1,6..1,16&gt;</span>
</span><span id="FST.parent_non_expr-2324"><a href="#FST.parent_non_expr-2324"><span class="linenos">2324</span></a>
</span><span id="FST.parent_non_expr-2325"><a href="#FST.parent_non_expr-2325"><span class="linenos">2325</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;var = call(a, b=1)&#39;).value.keywords[0].value.parent_non_expr()</span>
</span><span id="FST.parent_non_expr-2326"><a href="#FST.parent_non_expr-2326"><span class="linenos">2326</span></a><span class="sd">        &lt;Assign ROOT 0,0..0,18&gt;</span>
</span><span id="FST.parent_non_expr-2327"><a href="#FST.parent_non_expr-2327"><span class="linenos">2327</span></a>
</span><span id="FST.parent_non_expr-2328"><a href="#FST.parent_non_expr-2328"><span class="linenos">2328</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;var = call(a, b=1)&#39;)</span>
</span><span id="FST.parent_non_expr-2329"><a href="#FST.parent_non_expr-2329"><span class="linenos">2329</span></a><span class="sd">        ...  .value.keywords[0].value.parent_non_expr(strict=True))</span>
</span><span id="FST.parent_non_expr-2330"><a href="#FST.parent_non_expr-2330"><span class="linenos">2330</span></a><span class="sd">        &lt;keyword 0,14..0,17&gt;</span>
</span><span id="FST.parent_non_expr-2331"><a href="#FST.parent_non_expr-2331"><span class="linenos">2331</span></a><span class="sd">        ```</span>
</span><span id="FST.parent_non_expr-2332"><a href="#FST.parent_non_expr-2332"><span class="linenos">2332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.parent_non_expr-2333"><a href="#FST.parent_non_expr-2333"><span class="linenos">2333</span></a>
</span><span id="FST.parent_non_expr-2334"><a href="#FST.parent_non_expr-2334"><span class="linenos">2334</span></a>        <span class="n">types</span> <span class="o">=</span> <span class="n">expr</span> <span class="k">if</span> <span class="n">strict</span> <span class="k">else</span> <span class="n">EXPRISH_ALL</span>  <span class="c1"># ops because of maybe self_</span>
</span><span id="FST.parent_non_expr-2335"><a href="#FST.parent_non_expr-2335"><span class="linenos">2335</span></a>
</span><span id="FST.parent_non_expr-2336"><a href="#FST.parent_non_expr-2336"><span class="linenos">2336</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_non_expr-2337"><a href="#FST.parent_non_expr-2337"><span class="linenos">2337</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.parent_non_expr-2338"><a href="#FST.parent_non_expr-2338"><span class="linenos">2338</span></a>
</span><span id="FST.parent_non_expr-2339"><a href="#FST.parent_non_expr-2339"><span class="linenos">2339</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
</span><span id="FST.parent_non_expr-2340"><a href="#FST.parent_non_expr-2340"><span class="linenos">2340</span></a>            <span class="k">pass</span>
</span><span id="FST.parent_non_expr-2341"><a href="#FST.parent_non_expr-2341"><span class="linenos">2341</span></a>
</span><span id="FST.parent_non_expr-2342"><a href="#FST.parent_non_expr-2342"><span class="linenos">2342</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>The first parent which is not an <code>expr</code>. If <code>self_</code> is <code>True</code> then will check <code>self</code> first (possibly
returning <code>self</code>), otherwise only checks parents.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>self_</code>: Whether to include <code>self</code> in the search, if so and <code>self</code> matches criteria then it is returned.</li>
<li><code>strict</code>: <code>False</code> means consider <code>comprehension</code>, <code>arguments</code>, <code>arg</code> and <code>keyword</code> nodes as <code>expr</code> for the
sake of the walk up since these nodes can have other <code>expr</code> parents. <code>True</code> means only <code>expr</code> nodes, which
means you could get an <code>arg</code> or <code>comprehension</code> node for example which still has <code>expr</code> parents. Also
<code>expr_context</code>, <code>boolop</code>, <code>operator</code>, <code>unaruop</code> and <code>cmpop</code> are included if <code>strict=False</code> but this only
makes sense if <code>self_=True</code> and you are calling this function on one of those.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1 + a[b]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_non_expr</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">0</span><span class="p">,</span><span class="mf">6..0</span><span class="p">,</span><span class="mi">18</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1"> case </span><span class="si">{a.b.c: 1}</span><span class="s1">: pass&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_non_expr</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">MatchMapping</span> <span class="mi">1</span><span class="p">,</span><span class="mf">6..1</span><span class="p">,</span><span class="mi">16</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;var = call(a, b=1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_non_expr</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">18</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;var = call(a, b=1)&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">parent_non_expr</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="o">&lt;</span><span class="n">keyword</span> <span class="mi">0</span><span class="p">,</span><span class="mf">14..0</span><span class="p">,</span><span class="mi">17</span><span class="o">&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.parent_pattern" class="classattr">
                                        <input id="FST.parent_pattern-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parent_pattern</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.parent_pattern-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.parent_pattern"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.parent_pattern-2344"><a href="#FST.parent_pattern-2344"><span class="linenos">2344</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parent_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.parent_pattern-2345"><a href="#FST.parent_pattern-2345"><span class="linenos">2345</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The first parent which is a `pattern`. If `self_` is `True` then will check `self` first (possibly returning</span>
</span><span id="FST.parent_pattern-2346"><a href="#FST.parent_pattern-2346"><span class="linenos">2346</span></a><span class="sd">        `self`), otherwise only checks parents.</span>
</span><span id="FST.parent_pattern-2347"><a href="#FST.parent_pattern-2347"><span class="linenos">2347</span></a>
</span><span id="FST.parent_pattern-2348"><a href="#FST.parent_pattern-2348"><span class="linenos">2348</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.parent_pattern-2349"><a href="#FST.parent_pattern-2349"><span class="linenos">2349</span></a><span class="sd">        - `self_`: Whether to include `self` in the search, if so and `self` matches criteria then it is returned.</span>
</span><span id="FST.parent_pattern-2350"><a href="#FST.parent_pattern-2350"><span class="linenos">2350</span></a>
</span><span id="FST.parent_pattern-2351"><a href="#FST.parent_pattern-2351"><span class="linenos">2351</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.parent_pattern-2352"><a href="#FST.parent_pattern-2352"><span class="linenos">2352</span></a><span class="sd">        ```py</span>
</span><span id="FST.parent_pattern-2353"><a href="#FST.parent_pattern-2353"><span class="linenos">2353</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;case 1+1j: pass&#39;).pattern.value.left.parent_pattern().src</span>
</span><span id="FST.parent_pattern-2354"><a href="#FST.parent_pattern-2354"><span class="linenos">2354</span></a><span class="sd">        &#39;1+1j&#39;</span>
</span><span id="FST.parent_pattern-2355"><a href="#FST.parent_pattern-2355"><span class="linenos">2355</span></a>
</span><span id="FST.parent_pattern-2356"><a href="#FST.parent_pattern-2356"><span class="linenos">2356</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="FST.parent_pattern-2357"><a href="#FST.parent_pattern-2357"><span class="linenos">2357</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern(self_=True))</span>
</span><span id="FST.parent_pattern-2358"><a href="#FST.parent_pattern-2358"><span class="linenos">2358</span></a><span class="sd">        &lt;MatchAs 0,15..0,16&gt;</span>
</span><span id="FST.parent_pattern-2359"><a href="#FST.parent_pattern-2359"><span class="linenos">2359</span></a>
</span><span id="FST.parent_pattern-2360"><a href="#FST.parent_pattern-2360"><span class="linenos">2360</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="FST.parent_pattern-2361"><a href="#FST.parent_pattern-2361"><span class="linenos">2361</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern())</span>
</span><span id="FST.parent_pattern-2362"><a href="#FST.parent_pattern-2362"><span class="linenos">2362</span></a><span class="sd">        &lt;MatchMapping 0,9..0,17&gt;</span>
</span><span id="FST.parent_pattern-2363"><a href="#FST.parent_pattern-2363"><span class="linenos">2363</span></a>
</span><span id="FST.parent_pattern-2364"><a href="#FST.parent_pattern-2364"><span class="linenos">2364</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;case 1 | {a.b: c}: pass&#39;)</span>
</span><span id="FST.parent_pattern-2365"><a href="#FST.parent_pattern-2365"><span class="linenos">2365</span></a><span class="sd">        ...  .pattern.patterns[1].patterns[0].parent_pattern().parent_pattern())</span>
</span><span id="FST.parent_pattern-2366"><a href="#FST.parent_pattern-2366"><span class="linenos">2366</span></a><span class="sd">        &lt;MatchOr 0,5..0,17&gt;</span>
</span><span id="FST.parent_pattern-2367"><a href="#FST.parent_pattern-2367"><span class="linenos">2367</span></a><span class="sd">        ```</span>
</span><span id="FST.parent_pattern-2368"><a href="#FST.parent_pattern-2368"><span class="linenos">2368</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.parent_pattern-2369"><a href="#FST.parent_pattern-2369"><span class="linenos">2369</span></a>
</span><span id="FST.parent_pattern-2370"><a href="#FST.parent_pattern-2370"><span class="linenos">2370</span></a>        <span class="k">if</span> <span class="n">self_</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
</span><span id="FST.parent_pattern-2371"><a href="#FST.parent_pattern-2371"><span class="linenos">2371</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.parent_pattern-2372"><a href="#FST.parent_pattern-2372"><span class="linenos">2372</span></a>
</span><span id="FST.parent_pattern-2373"><a href="#FST.parent_pattern-2373"><span class="linenos">2373</span></a>        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
</span><span id="FST.parent_pattern-2374"><a href="#FST.parent_pattern-2374"><span class="linenos">2374</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">match_case</span><span class="p">,</span> <span class="n">stmt</span><span class="p">)):</span>
</span><span id="FST.parent_pattern-2375"><a href="#FST.parent_pattern-2375"><span class="linenos">2375</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.parent_pattern-2376"><a href="#FST.parent_pattern-2376"><span class="linenos">2376</span></a>
</span><span id="FST.parent_pattern-2377"><a href="#FST.parent_pattern-2377"><span class="linenos">2377</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>The first parent which is a <code>pattern</code>. If <code>self_</code> is <code>True</code> then will check <code>self</code> first (possibly returning
<code>self</code>), otherwise only checks parents.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>self_</code>: Whether to include <code>self</code> in the search, if so and <code>self</code> matches criteria then it is returned.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;case 1+1j: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">parent_pattern</span><span class="p">()</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;1+1j&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;case 1 | </span><span class="si">{a.b: c}</span><span class="s1">: pass&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_pattern</span><span class="p">(</span><span class="n">self_</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="o">&lt;</span><span class="n">MatchAs</span> <span class="mi">0</span><span class="p">,</span><span class="mf">15..0</span><span class="p">,</span><span class="mi">16</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;case 1 | </span><span class="si">{a.b: c}</span><span class="s1">: pass&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_pattern</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">MatchMapping</span> <span class="mi">0</span><span class="p">,</span><span class="mf">9..0</span><span class="p">,</span><span class="mi">17</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;case 1 | </span><span class="si">{a.b: c}</span><span class="s1">: pass&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent_pattern</span><span class="p">()</span><span class="o">.</span><span class="n">parent_pattern</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">MatchOr</span> <span class="mi">0</span><span class="p">,</span><span class="mf">5..0</span><span class="p">,</span><span class="mi">17</span><span class="o">&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.child_path" class="classattr">
                                        <input id="FST.child_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">child_path</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">child</span><span class="p">:</span> <span class="n"><a href="#FST">FST</a></span>,</span><span class="param">	<span class="n">as_str</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="misc.html#astfield">fst.misc.astfield</a></span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="FST.child_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.child_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.child_path-2379"><a href="#FST.child_path-2379"><span class="linenos">2379</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">child_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">FST</span><span class="p">,</span> <span class="n">as_str</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">astfield</span><span class="p">]</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">:</span>
</span><span id="FST.child_path-2380"><a href="#FST.child_path-2380"><span class="linenos">2380</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get path to `child` node from `self` which can later be used on a copy of this tree to get to the  same</span>
</span><span id="FST.child_path-2381"><a href="#FST.child_path-2381"><span class="linenos">2381</span></a><span class="sd">        relative child node.</span>
</span><span id="FST.child_path-2382"><a href="#FST.child_path-2382"><span class="linenos">2382</span></a>
</span><span id="FST.child_path-2383"><a href="#FST.child_path-2383"><span class="linenos">2383</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.child_path-2384"><a href="#FST.child_path-2384"><span class="linenos">2384</span></a><span class="sd">        - `child`: Child node to get path to, can be `self` in which case an empty path is returned.</span>
</span><span id="FST.child_path-2385"><a href="#FST.child_path-2385"><span class="linenos">2385</span></a><span class="sd">        - `as_str`: If `True` will return the path as a python-ish string suitable for attribute access, else a list of</span>
</span><span id="FST.child_path-2386"><a href="#FST.child_path-2386"><span class="linenos">2386</span></a><span class="sd">            `astfield`s which can be used more directly.</span>
</span><span id="FST.child_path-2387"><a href="#FST.child_path-2387"><span class="linenos">2387</span></a>
</span><span id="FST.child_path-2388"><a href="#FST.child_path-2388"><span class="linenos">2388</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.child_path-2389"><a href="#FST.child_path-2389"><span class="linenos">2389</span></a><span class="sd">        - `list[astfield] | str`: Path to child if exists, otherwise raises.</span>
</span><span id="FST.child_path-2390"><a href="#FST.child_path-2390"><span class="linenos">2390</span></a>
</span><span id="FST.child_path-2391"><a href="#FST.child_path-2391"><span class="linenos">2391</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.child_path-2392"><a href="#FST.child_path-2392"><span class="linenos">2392</span></a><span class="sd">        ```py</span>
</span><span id="FST.child_path-2393"><a href="#FST.child_path-2393"><span class="linenos">2393</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;[i for i in j]&#39;, &#39;exec&#39;)).child_path(f.body[0].value.elt)</span>
</span><span id="FST.child_path-2394"><a href="#FST.child_path-2394"><span class="linenos">2394</span></a><span class="sd">        [astfield(&#39;body&#39;, 0), astfield(&#39;value&#39;), astfield(&#39;elt&#39;)]</span>
</span><span id="FST.child_path-2395"><a href="#FST.child_path-2395"><span class="linenos">2395</span></a>
</span><span id="FST.child_path-2396"><a href="#FST.child_path-2396"><span class="linenos">2396</span></a><span class="sd">        &gt;&gt;&gt; ((f := FST(&#39;[i for i in j]&#39;, &#39;exec&#39;))</span>
</span><span id="FST.child_path-2397"><a href="#FST.child_path-2397"><span class="linenos">2397</span></a><span class="sd">        ...  .child_path(f.body[0].value.elt, as_str=True))</span>
</span><span id="FST.child_path-2398"><a href="#FST.child_path-2398"><span class="linenos">2398</span></a><span class="sd">        &#39;body[0].value.elt&#39;</span>
</span><span id="FST.child_path-2399"><a href="#FST.child_path-2399"><span class="linenos">2399</span></a>
</span><span id="FST.child_path-2400"><a href="#FST.child_path-2400"><span class="linenos">2400</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_path(f)</span>
</span><span id="FST.child_path-2401"><a href="#FST.child_path-2401"><span class="linenos">2401</span></a><span class="sd">        []</span>
</span><span id="FST.child_path-2402"><a href="#FST.child_path-2402"><span class="linenos">2402</span></a>
</span><span id="FST.child_path-2403"><a href="#FST.child_path-2403"><span class="linenos">2403</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_path(f, as_str=True)</span>
</span><span id="FST.child_path-2404"><a href="#FST.child_path-2404"><span class="linenos">2404</span></a><span class="sd">        &#39;&#39;</span>
</span><span id="FST.child_path-2405"><a href="#FST.child_path-2405"><span class="linenos">2405</span></a><span class="sd">        ```</span>
</span><span id="FST.child_path-2406"><a href="#FST.child_path-2406"><span class="linenos">2406</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.child_path-2407"><a href="#FST.child_path-2407"><span class="linenos">2407</span></a>
</span><span id="FST.child_path-2408"><a href="#FST.child_path-2408"><span class="linenos">2408</span></a>        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
</span><span id="FST.child_path-2409"><a href="#FST.child_path-2409"><span class="linenos">2409</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;child is not part of same tree&#39;</span><span class="p">)</span>
</span><span id="FST.child_path-2410"><a href="#FST.child_path-2410"><span class="linenos">2410</span></a>
</span><span id="FST.child_path-2411"><a href="#FST.child_path-2411"><span class="linenos">2411</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FST.child_path-2412"><a href="#FST.child_path-2412"><span class="linenos">2412</span></a>
</span><span id="FST.child_path-2413"><a href="#FST.child_path-2413"><span class="linenos">2413</span></a>        <span class="k">while</span> <span class="n">child</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="FST.child_path-2414"><a href="#FST.child_path-2414"><span class="linenos">2414</span></a>            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">pfield</span><span class="p">)</span>
</span><span id="FST.child_path-2415"><a href="#FST.child_path-2415"><span class="linenos">2415</span></a>
</span><span id="FST.child_path-2416"><a href="#FST.child_path-2416"><span class="linenos">2416</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">child</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST.child_path-2417"><a href="#FST.child_path-2417"><span class="linenos">2417</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid child&#39;</span><span class="p">)</span>
</span><span id="FST.child_path-2418"><a href="#FST.child_path-2418"><span class="linenos">2418</span></a>
</span><span id="FST.child_path-2419"><a href="#FST.child_path-2419"><span class="linenos">2419</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="FST.child_path-2420"><a href="#FST.child_path-2420"><span class="linenos">2420</span></a>
</span><span id="FST.child_path-2421"><a href="#FST.child_path-2421"><span class="linenos">2421</span></a>        <span class="k">return</span> <span class="n">path</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">as_str</span> <span class="k">else</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">af</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">af</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">af</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">for</span> <span class="n">af</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get path to <code>child</code> node from <code>self</code> which can later be used on a copy of this tree to get to the  same
relative child node.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>child</code>: Child node to get path to, can be <code>self</code> in which case an empty path is returned.</li>
<li><code>as_str</code>: If <code>True</code> will return the path as a python-ish string suitable for attribute access, else a list of
<code>astfield</code>s which can be used more directly.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>list[astfield] | str</code>: Path to child if exists, otherwise raises.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[i for i in j]&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">elt</span><span class="p">)</span>
<span class="p">[</span><span class="n">astfield</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">astfield</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="n">astfield</span><span class="p">(</span><span class="s1">&#39;elt&#39;</span><span class="p">)]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">((</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[i for i in j]&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">))</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">elt</span><span class="p">,</span> <span class="n">as_str</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="s1">&#39;body[0].value.elt&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="p">[]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">as_str</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="s1">&#39;&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.child_from_path" class="classattr">
                                        <input id="FST.child_from_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">child_from_path</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="misc.html#astfield">fst.misc.astfield</a></span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">last_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#FST">FST</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="FST.child_from_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.child_from_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.child_from_path-2423"><a href="#FST.child_from_path-2423"><span class="linenos">2423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">child_from_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">astfield</span><span class="p">]</span> <span class="o">|</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">last_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]:</span>
</span><span id="FST.child_from_path-2424"><a href="#FST.child_from_path-2424"><span class="linenos">2424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get child node specified by `path` if it exists. If succeeds then it doesn&#39;t mean that the child node is</span>
</span><span id="FST.child_from_path-2425"><a href="#FST.child_from_path-2425"><span class="linenos">2425</span></a><span class="sd">        guaranteed to be the same or even same type as was originally used to get the path, just that the path is valid.</span>
</span><span id="FST.child_from_path-2426"><a href="#FST.child_from_path-2426"><span class="linenos">2426</span></a><span class="sd">        For example after deleting an element from a list the item at the former element&#39;s location will be the previous</span>
</span><span id="FST.child_from_path-2427"><a href="#FST.child_from_path-2427"><span class="linenos">2427</span></a><span class="sd">        next element.</span>
</span><span id="FST.child_from_path-2428"><a href="#FST.child_from_path-2428"><span class="linenos">2428</span></a>
</span><span id="FST.child_from_path-2429"><a href="#FST.child_from_path-2429"><span class="linenos">2429</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.child_from_path-2430"><a href="#FST.child_from_path-2430"><span class="linenos">2430</span></a><span class="sd">        - `path`: Path to child as a list of `astfield`s or string.</span>
</span><span id="FST.child_from_path-2431"><a href="#FST.child_from_path-2431"><span class="linenos">2431</span></a><span class="sd">        - `last_valid`: If `True` then return the last valid node along the path, will not fail, can return `self`.</span>
</span><span id="FST.child_from_path-2432"><a href="#FST.child_from_path-2432"><span class="linenos">2432</span></a>
</span><span id="FST.child_from_path-2433"><a href="#FST.child_from_path-2433"><span class="linenos">2433</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.child_from_path-2434"><a href="#FST.child_from_path-2434"><span class="linenos">2434</span></a><span class="sd">        - `FST`: Child node if path is valid, otherwise `False` if path invalid. `False` and not `None` because `None`</span>
</span><span id="FST.child_from_path-2435"><a href="#FST.child_from_path-2435"><span class="linenos">2435</span></a><span class="sd">            can be in a field that can hold an `AST` but `False` can not.</span>
</span><span id="FST.child_from_path-2436"><a href="#FST.child_from_path-2436"><span class="linenos">2436</span></a>
</span><span id="FST.child_from_path-2437"><a href="#FST.child_from_path-2437"><span class="linenos">2437</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.child_from_path-2438"><a href="#FST.child_from_path-2438"><span class="linenos">2438</span></a><span class="sd">        ```py</span>
</span><span id="FST.child_from_path-2439"><a href="#FST.child_from_path-2439"><span class="linenos">2439</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;[i for i in j]&#39;, &#39;exec&#39;)</span>
</span><span id="FST.child_from_path-2440"><a href="#FST.child_from_path-2440"><span class="linenos">2440</span></a><span class="sd">        &gt;&gt;&gt; f.child_from_path(f.child_path(f.body[0].value.elt)).src</span>
</span><span id="FST.child_from_path-2441"><a href="#FST.child_from_path-2441"><span class="linenos">2441</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="FST.child_from_path-2442"><a href="#FST.child_from_path-2442"><span class="linenos">2442</span></a>
</span><span id="FST.child_from_path-2443"><a href="#FST.child_from_path-2443"><span class="linenos">2443</span></a><span class="sd">        &gt;&gt;&gt; f.child_from_path(f.child_path(f.body[0].value.elt, True)).src</span>
</span><span id="FST.child_from_path-2444"><a href="#FST.child_from_path-2444"><span class="linenos">2444</span></a><span class="sd">        &#39;i&#39;</span>
</span><span id="FST.child_from_path-2445"><a href="#FST.child_from_path-2445"><span class="linenos">2445</span></a>
</span><span id="FST.child_from_path-2446"><a href="#FST.child_from_path-2446"><span class="linenos">2446</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[0, 1, 2, 3]&#39;, &#39;exec&#39;).child_from_path(&#39;body[0].value.elts[4]&#39;)</span>
</span><span id="FST.child_from_path-2447"><a href="#FST.child_from_path-2447"><span class="linenos">2447</span></a><span class="sd">        False</span>
</span><span id="FST.child_from_path-2448"><a href="#FST.child_from_path-2448"><span class="linenos">2448</span></a>
</span><span id="FST.child_from_path-2449"><a href="#FST.child_from_path-2449"><span class="linenos">2449</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;[0, 1, 2, 3]&#39;, &#39;exec&#39;)</span>
</span><span id="FST.child_from_path-2450"><a href="#FST.child_from_path-2450"><span class="linenos">2450</span></a><span class="sd">        ...  .child_from_path(&#39;body[0].value.elts[4]&#39;, last_valid=True).src)</span>
</span><span id="FST.child_from_path-2451"><a href="#FST.child_from_path-2451"><span class="linenos">2451</span></a><span class="sd">        &#39;[0, 1, 2, 3]&#39;</span>
</span><span id="FST.child_from_path-2452"><a href="#FST.child_from_path-2452"><span class="linenos">2452</span></a>
</span><span id="FST.child_from_path-2453"><a href="#FST.child_from_path-2453"><span class="linenos">2453</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_from_path([]) is f</span>
</span><span id="FST.child_from_path-2454"><a href="#FST.child_from_path-2454"><span class="linenos">2454</span></a><span class="sd">        True</span>
</span><span id="FST.child_from_path-2455"><a href="#FST.child_from_path-2455"><span class="linenos">2455</span></a>
</span><span id="FST.child_from_path-2456"><a href="#FST.child_from_path-2456"><span class="linenos">2456</span></a><span class="sd">        &gt;&gt;&gt; (f := FST(&#39;i&#39;)).child_from_path(&#39;&#39;) is f</span>
</span><span id="FST.child_from_path-2457"><a href="#FST.child_from_path-2457"><span class="linenos">2457</span></a><span class="sd">        True</span>
</span><span id="FST.child_from_path-2458"><a href="#FST.child_from_path-2458"><span class="linenos">2458</span></a><span class="sd">        ```</span>
</span><span id="FST.child_from_path-2459"><a href="#FST.child_from_path-2459"><span class="linenos">2459</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.child_from_path-2460"><a href="#FST.child_from_path-2460"><span class="linenos">2460</span></a>
</span><span id="FST.child_from_path-2461"><a href="#FST.child_from_path-2461"><span class="linenos">2461</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FST.child_from_path-2462"><a href="#FST.child_from_path-2462"><span class="linenos">2462</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">astfield</span><span class="p">(</span><span class="n">p</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="n">p</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">astfield</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="FST.child_from_path-2463"><a href="#FST.child_from_path-2463"><span class="linenos">2463</span></a>                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span> <span class="k">if</span> <span class="n">path</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="FST.child_from_path-2464"><a href="#FST.child_from_path-2464"><span class="linenos">2464</span></a>
</span><span id="FST.child_from_path-2465"><a href="#FST.child_from_path-2465"><span class="linenos">2465</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
</span><span id="FST.child_from_path-2466"><a href="#FST.child_from_path-2466"><span class="linenos">2466</span></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">next</span> <span class="o">:=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_no_raise</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="FST.child_from_path-2467"><a href="#FST.child_from_path-2467"><span class="linenos">2467</span></a>                <span class="k">return</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">last_valid</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="FST.child_from_path-2468"><a href="#FST.child_from_path-2468"><span class="linenos">2468</span></a>
</span><span id="FST.child_from_path-2469"><a href="#FST.child_from_path-2469"><span class="linenos">2469</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="nb">next</span>
</span><span id="FST.child_from_path-2470"><a href="#FST.child_from_path-2470"><span class="linenos">2470</span></a>
</span><span id="FST.child_from_path-2471"><a href="#FST.child_from_path-2471"><span class="linenos">2471</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Get child node specified by <code>path</code> if it exists. If succeeds then it doesn't mean that the child node is
guaranteed to be the same or even same type as was originally used to get the path, just that the path is valid.
For example after deleting an element from a list the item at the former element's location will be the previous
next element.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>path</code>: Path to child as a list of <code>astfield</code>s or string.</li>
<li><code>last_valid</code>: If <code>True</code> then return the last valid node along the path, will not fail, can return <code>self</code>.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: Child node if path is valid, otherwise <code>False</code> if path invalid. <code>False</code> and not <code>None</code> because <code>None</code>
can be in a field that can hold an <code>AST</code> but <code>False</code> can not.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[i for i in j]&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">child_from_path</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">elt</span><span class="p">))</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;i&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">child_from_path</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">elt</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">src</span>
<span class="s1">&#39;i&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">child_from_path</span><span class="p">(</span><span class="s1">&#39;body[0].value.elts[4]&#39;</span><span class="p">)</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">child_from_path</span><span class="p">(</span><span class="s1">&#39;body[0].value.elts[4]&#39;</span><span class="p">,</span> <span class="n">last_valid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="s1">&#39;[0, 1, 2, 3]&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">child_from_path</span><span class="p">([])</span> <span class="ow">is</span> <span class="n">f</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">child_from_path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">f</span>
<span class="kc">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.repath" class="classattr">
                                        <input id="FST.repath-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repath</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span>:</span></span>

                <label class="view-source-button" for="FST.repath-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.repath"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.repath-2473"><a href="#FST.repath-2473"><span class="linenos">2473</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">repath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span><span class="p">:</span>
</span><span id="FST.repath-2474"><a href="#FST.repath-2474"><span class="linenos">2474</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recalculate `self` from path from root. Useful if `self` has been replaced by another node by some operation.</span>
</span><span id="FST.repath-2475"><a href="#FST.repath-2475"><span class="linenos">2475</span></a><span class="sd">        When nodes are deleted the corresponding `FST.a` and `AST.f` attributes are set to `None`. The `root`, `parent`</span>
</span><span id="FST.repath-2476"><a href="#FST.repath-2476"><span class="linenos">2476</span></a><span class="sd">        and `pfield` attributes are left so that things like this can work. Useful when a node has been deleted but you</span>
</span><span id="FST.repath-2477"><a href="#FST.repath-2477"><span class="linenos">2477</span></a><span class="sd">        want to know where it was and what may be there now.</span>
</span><span id="FST.repath-2478"><a href="#FST.repath-2478"><span class="linenos">2478</span></a>
</span><span id="FST.repath-2479"><a href="#FST.repath-2479"><span class="linenos">2479</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.repath-2480"><a href="#FST.repath-2480"><span class="linenos">2480</span></a><span class="sd">        - `FST`: Possibly `self` or the node which took our place at our relative position from `root`.</span>
</span><span id="FST.repath-2481"><a href="#FST.repath-2481"><span class="linenos">2481</span></a>
</span><span id="FST.repath-2482"><a href="#FST.repath-2482"><span class="linenos">2482</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.repath-2483"><a href="#FST.repath-2483"><span class="linenos">2483</span></a><span class="sd">        ```py</span>
</span><span id="FST.repath-2484"><a href="#FST.repath-2484"><span class="linenos">2484</span></a><span class="sd">        &gt;&gt;&gt; f = FST(&#39;[0, 1, 2, 3]&#39;)</span>
</span><span id="FST.repath-2485"><a href="#FST.repath-2485"><span class="linenos">2485</span></a><span class="sd">        &gt;&gt;&gt; g = f.elts[1]</span>
</span><span id="FST.repath-2486"><a href="#FST.repath-2486"><span class="linenos">2486</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a), g.root)</span>
</span><span id="FST.repath-2487"><a href="#FST.repath-2487"><span class="linenos">2487</span></a><span class="sd">        &lt;class &#39;ast.Constant&#39;&gt; &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="FST.repath-2488"><a href="#FST.repath-2488"><span class="linenos">2488</span></a>
</span><span id="FST.repath-2489"><a href="#FST.repath-2489"><span class="linenos">2489</span></a><span class="sd">        &gt;&gt;&gt; f.put(&#39;x&#39;, 1, raw=True)  # raw forces reparse at List</span>
</span><span id="FST.repath-2490"><a href="#FST.repath-2490"><span class="linenos">2490</span></a><span class="sd">        &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="FST.repath-2491"><a href="#FST.repath-2491"><span class="linenos">2491</span></a>
</span><span id="FST.repath-2492"><a href="#FST.repath-2492"><span class="linenos">2492</span></a><span class="sd">        &gt;&gt;&gt; print(g.a, g.root)</span>
</span><span id="FST.repath-2493"><a href="#FST.repath-2493"><span class="linenos">2493</span></a><span class="sd">        None &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="FST.repath-2494"><a href="#FST.repath-2494"><span class="linenos">2494</span></a>
</span><span id="FST.repath-2495"><a href="#FST.repath-2495"><span class="linenos">2495</span></a><span class="sd">        &gt;&gt;&gt; g = g.repath()</span>
</span><span id="FST.repath-2496"><a href="#FST.repath-2496"><span class="linenos">2496</span></a><span class="sd">        &gt;&gt;&gt; print(type(g.a), g.root)</span>
</span><span id="FST.repath-2497"><a href="#FST.repath-2497"><span class="linenos">2497</span></a><span class="sd">        &lt;class &#39;ast.Name&#39;&gt; &lt;List ROOT 0,0..0,12&gt;</span>
</span><span id="FST.repath-2498"><a href="#FST.repath-2498"><span class="linenos">2498</span></a><span class="sd">        ```</span>
</span><span id="FST.repath-2499"><a href="#FST.repath-2499"><span class="linenos">2499</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.repath-2500"><a href="#FST.repath-2500"><span class="linenos">2500</span></a>
</span><span id="FST.repath-2501"><a href="#FST.repath-2501"><span class="linenos">2501</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">root</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">child_from_path</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">child_path</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Recalculate <code>self</code> from path from root. Useful if <code>self</code> has been replaced by another node by some operation.
When nodes are deleted the corresponding <code><a href="#FST.a">FST.a</a></code> and <code>AST.f</code> attributes are set to <code>None</code>. The <code><a href="#FST.root">root</a></code>, <code><a href="#FST.parent">parent</a></code>
and <code><a href="#FST.pfield">pfield</a></code> attributes are left so that things like this can work. Useful when a node has been deleted but you
want to know where it was and what may be there now.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code><a href="#FST">FST</a></code>: Possibly <code>self</code> or the node which took our place at our relative position from <code><a href="#FST.root">root</a></code>.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[0, 1, 2, 3]&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="p">),</span> <span class="n">g</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">ast</span><span class="o">.</span><span class="n">Constant</span><span class="s1">&#39;&gt; &lt;List ROOT 0,0..0,12&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># raw forces reparse at List</span>
<span class="o">&lt;</span><span class="n">List</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<span class="kc">None</span> <span class="o">&lt;</span><span class="n">List</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">repath</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="p">),</span> <span class="n">g</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">ast</span><span class="o">.</span><span class="n">Name</span><span class="s1">&#39;&gt; &lt;List ROOT 0,0..0,12&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.find_loc" class="classattr">
                                        <input id="FST.find_loc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_loc</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ln</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">col</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.find_loc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.find_loc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.find_loc-2503"><a href="#FST.find_loc-2503"><span class="linenos">2503</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.find_loc-2504"><a href="#FST.find_loc-2504"><span class="linenos">2504</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Find the lowest level node which entirely contains location (starting search at `self`). To reiterate, the</span>
</span><span id="FST.find_loc-2505"><a href="#FST.find_loc-2505"><span class="linenos">2505</span></a><span class="sd">        search will only find nodes at self or below, no parents.</span>
</span><span id="FST.find_loc-2506"><a href="#FST.find_loc-2506"><span class="linenos">2506</span></a>
</span><span id="FST.find_loc-2507"><a href="#FST.find_loc-2507"><span class="linenos">2507</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.find_loc-2508"><a href="#FST.find_loc-2508"><span class="linenos">2508</span></a><span class="sd">        - `ln`: Start line of location to search for (0 based).</span>
</span><span id="FST.find_loc-2509"><a href="#FST.find_loc-2509"><span class="linenos">2509</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="FST.find_loc-2510"><a href="#FST.find_loc-2510"><span class="linenos">2510</span></a><span class="sd">        - `end_ln`: End line of location to search for (0 based, inclusive).</span>
</span><span id="FST.find_loc-2511"><a href="#FST.find_loc-2511"><span class="linenos">2511</span></a><span class="sd">        - `end_col`: End column (character, inclusive with `FST.end_col`, exclusive with `FST.col`) on end line.</span>
</span><span id="FST.find_loc-2512"><a href="#FST.find_loc-2512"><span class="linenos">2512</span></a><span class="sd">        - `exact`: Whether to allow return of exact location match with node or not. `True` means allow return of node</span>
</span><span id="FST.find_loc-2513"><a href="#FST.find_loc-2513"><span class="linenos">2513</span></a><span class="sd">            which matches location exactly. Otherwise the location must be inside the node but cannot be touching BOTH</span>
</span><span id="FST.find_loc-2514"><a href="#FST.find_loc-2514"><span class="linenos">2514</span></a><span class="sd">            ends of the node. This basically determines whether you can get the exact node of the location or its</span>
</span><span id="FST.find_loc-2515"><a href="#FST.find_loc-2515"><span class="linenos">2515</span></a><span class="sd">            parent.</span>
</span><span id="FST.find_loc-2516"><a href="#FST.find_loc-2516"><span class="linenos">2516</span></a>
</span><span id="FST.find_loc-2517"><a href="#FST.find_loc-2517"><span class="linenos">2517</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.find_loc-2518"><a href="#FST.find_loc-2518"><span class="linenos">2518</span></a><span class="sd">        - `FST | None`: Node which entirely contains location, either exactly or not, or `None` if no such node.</span>
</span><span id="FST.find_loc-2519"><a href="#FST.find_loc-2519"><span class="linenos">2519</span></a>
</span><span id="FST.find_loc-2520"><a href="#FST.find_loc-2520"><span class="linenos">2520</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.find_loc-2521"><a href="#FST.find_loc-2521"><span class="linenos">2521</span></a><span class="sd">        ```py</span>
</span><span id="FST.find_loc-2522"><a href="#FST.find_loc-2522"><span class="linenos">2522</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 6, 0, 7)</span>
</span><span id="FST.find_loc-2523"><a href="#FST.find_loc-2523"><span class="linenos">2523</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST.find_loc-2524"><a href="#FST.find_loc-2524"><span class="linenos">2524</span></a>
</span><span id="FST.find_loc-2525"><a href="#FST.find_loc-2525"><span class="linenos">2525</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 7)</span>
</span><span id="FST.find_loc-2526"><a href="#FST.find_loc-2526"><span class="linenos">2526</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST.find_loc-2527"><a href="#FST.find_loc-2527"><span class="linenos">2527</span></a>
</span><span id="FST.find_loc-2528"><a href="#FST.find_loc-2528"><span class="linenos">2528</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 7, exact=False)</span>
</span><span id="FST.find_loc-2529"><a href="#FST.find_loc-2529"><span class="linenos">2529</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="FST.find_loc-2530"><a href="#FST.find_loc-2530"><span class="linenos">2530</span></a>
</span><span id="FST.find_loc-2531"><a href="#FST.find_loc-2531"><span class="linenos">2531</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 5, 0, 7, exact=False)</span>
</span><span id="FST.find_loc-2532"><a href="#FST.find_loc-2532"><span class="linenos">2532</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST.find_loc-2533"><a href="#FST.find_loc-2533"><span class="linenos">2533</span></a>
</span><span id="FST.find_loc-2534"><a href="#FST.find_loc-2534"><span class="linenos">2534</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 4, 0, 6, exact=False)</span>
</span><span id="FST.find_loc-2535"><a href="#FST.find_loc-2535"><span class="linenos">2535</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST.find_loc-2536"><a href="#FST.find_loc-2536"><span class="linenos">2536</span></a>
</span><span id="FST.find_loc-2537"><a href="#FST.find_loc-2537"><span class="linenos">2537</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 3, 0, 7)</span>
</span><span id="FST.find_loc-2538"><a href="#FST.find_loc-2538"><span class="linenos">2538</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="FST.find_loc-2539"><a href="#FST.find_loc-2539"><span class="linenos">2539</span></a>
</span><span id="FST.find_loc-2540"><a href="#FST.find_loc-2540"><span class="linenos">2540</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 3, 0, 7, exact=False)</span>
</span><span id="FST.find_loc-2541"><a href="#FST.find_loc-2541"><span class="linenos">2541</span></a><span class="sd">        &lt;Assign 0,0..0,7&gt;</span>
</span><span id="FST.find_loc-2542"><a href="#FST.find_loc-2542"><span class="linenos">2542</span></a>
</span><span id="FST.find_loc-2543"><a href="#FST.find_loc-2543"><span class="linenos">2543</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;i = val&#39;, &#39;exec&#39;).find_loc(0, 0, 0, 7, exact=False))</span>
</span><span id="FST.find_loc-2544"><a href="#FST.find_loc-2544"><span class="linenos">2544</span></a><span class="sd">        None</span>
</span><span id="FST.find_loc-2545"><a href="#FST.find_loc-2545"><span class="linenos">2545</span></a>
</span><span id="FST.find_loc-2546"><a href="#FST.find_loc-2546"><span class="linenos">2546</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val\n&#39;, &#39;exec&#39;).find_loc(0, 0, 0, 7, exact=False)</span>
</span><span id="FST.find_loc-2547"><a href="#FST.find_loc-2547"><span class="linenos">2547</span></a><span class="sd">        &lt;Module ROOT 0,0..1,0&gt;</span>
</span><span id="FST.find_loc-2548"><a href="#FST.find_loc-2548"><span class="linenos">2548</span></a><span class="sd">        ```</span>
</span><span id="FST.find_loc-2549"><a href="#FST.find_loc-2549"><span class="linenos">2549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.find_loc-2550"><a href="#FST.find_loc-2550"><span class="linenos">2550</span></a>
</span><span id="FST.find_loc-2551"><a href="#FST.find_loc-2551"><span class="linenos">2551</span></a>        <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST.find_loc-2552"><a href="#FST.find_loc-2552"><span class="linenos">2552</span></a>
</span><span id="FST.find_loc-2553"><a href="#FST.find_loc-2553"><span class="linenos">2553</span></a>        <span class="k">if</span> <span class="p">((((</span><span class="n">same_ln</span> <span class="o">:=</span> <span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&lt;=</span> <span class="n">col</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fln</span> <span class="o">&lt;</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST.find_loc-2554"><a href="#FST.find_loc-2554"><span class="linenos">2554</span></a>            <span class="p">(((</span><span class="n">same_end_ln</span> <span class="o">:=</span> <span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&gt;=</span> <span class="n">end_col</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fend_ln</span> <span class="o">&gt;</span> <span class="n">end_ln</span><span class="p">)</span>
</span><span id="FST.find_loc-2555"><a href="#FST.find_loc-2555"><span class="linenos">2555</span></a>        <span class="p">):</span>
</span><span id="FST.find_loc-2556"><a href="#FST.find_loc-2556"><span class="linenos">2556</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exact</span> <span class="ow">and</span> <span class="n">same_ln</span> <span class="ow">and</span> <span class="n">same_end_ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">==</span> <span class="n">col</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">==</span> <span class="n">end_col</span><span class="p">:</span>
</span><span id="FST.find_loc-2557"><a href="#FST.find_loc-2557"><span class="linenos">2557</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.find_loc-2558"><a href="#FST.find_loc-2558"><span class="linenos">2558</span></a>
</span><span id="FST.find_loc-2559"><a href="#FST.find_loc-2559"><span class="linenos">2559</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FST.find_loc-2560"><a href="#FST.find_loc-2560"><span class="linenos">2560</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.find_loc-2561"><a href="#FST.find_loc-2561"><span class="linenos">2561</span></a>
</span><span id="FST.find_loc-2562"><a href="#FST.find_loc-2562"><span class="linenos">2562</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.find_loc-2563"><a href="#FST.find_loc-2563"><span class="linenos">2563</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">self_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="FST.find_loc-2564"><a href="#FST.find_loc-2564"><span class="linenos">2564</span></a>                <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST.find_loc-2565"><a href="#FST.find_loc-2565"><span class="linenos">2565</span></a>
</span><span id="FST.find_loc-2566"><a href="#FST.find_loc-2566"><span class="linenos">2566</span></a>                <span class="k">if</span> <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">col</span><span class="p">):</span>
</span><span id="FST.find_loc-2567"><a href="#FST.find_loc-2567"><span class="linenos">2567</span></a>                    <span class="k">continue</span>
</span><span id="FST.find_loc-2568"><a href="#FST.find_loc-2568"><span class="linenos">2568</span></a>
</span><span id="FST.find_loc-2569"><a href="#FST.find_loc-2569"><span class="linenos">2569</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">fln</span> <span class="o">&gt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">((</span><span class="n">same_ln</span> <span class="o">:=</span> <span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&gt;</span> <span class="n">col</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="FST.find_loc-2570"><a href="#FST.find_loc-2570"><span class="linenos">2570</span></a>                    <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">((</span><span class="n">same_end_ln</span> <span class="o">:=</span> <span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;</span> <span class="n">end_col</span><span class="p">)</span>
</span><span id="FST.find_loc-2571"><a href="#FST.find_loc-2571"><span class="linenos">2571</span></a>                <span class="p">):</span>
</span><span id="FST.find_loc-2572"><a href="#FST.find_loc-2572"><span class="linenos">2572</span></a>                    <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.find_loc-2573"><a href="#FST.find_loc-2573"><span class="linenos">2573</span></a>
</span><span id="FST.find_loc-2574"><a href="#FST.find_loc-2574"><span class="linenos">2574</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">exact</span> <span class="ow">and</span> <span class="n">same_ln</span> <span class="ow">and</span> <span class="n">same_end_ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">==</span> <span class="n">col</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">==</span> <span class="n">end_col</span><span class="p">:</span>
</span><span id="FST.find_loc-2575"><a href="#FST.find_loc-2575"><span class="linenos">2575</span></a>                    <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.find_loc-2576"><a href="#FST.find_loc-2576"><span class="linenos">2576</span></a>
</span><span id="FST.find_loc-2577"><a href="#FST.find_loc-2577"><span class="linenos">2577</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="FST.find_loc-2578"><a href="#FST.find_loc-2578"><span class="linenos">2578</span></a>
</span><span id="FST.find_loc-2579"><a href="#FST.find_loc-2579"><span class="linenos">2579</span></a>                <span class="k">break</span>
</span><span id="FST.find_loc-2580"><a href="#FST.find_loc-2580"><span class="linenos">2580</span></a>
</span><span id="FST.find_loc-2581"><a href="#FST.find_loc-2581"><span class="linenos">2581</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.find_loc-2582"><a href="#FST.find_loc-2582"><span class="linenos">2582</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Find the lowest level node which entirely contains location (starting search at <code>self</code>). To reiterate, the
search will only find nodes at self or below, no parents.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.ln">ln</a></code>: Start line of location to search for (0 based).</li>
<li><code><a href="#FST.col">col</a></code>: Start column (character) on start line.</li>
<li><code><a href="#FST.end_ln">end_ln</a></code>: End line of location to search for (0 based, inclusive).</li>
<li><code><a href="#FST.end_col">end_col</a></code>: End column (character, inclusive with <code><a href="#FST.end_col">FST.end_col</a></code>, exclusive with <code><a href="#FST.col">FST.col</a></code>) on end line.</li>
<li><code>exact</code>: Whether to allow return of exact location match with node or not. <code>True</code> means allow return of node
which matches location exactly. Otherwise the location must be inside the node but cannot be touching BOTH
ends of the node. This basically determines whether you can get the exact node of the location or its
parent.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>FST | None</code>: Node which entirely contains location, either exactly or not, or <code>None</code> if no such node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">0</span><span class="p">,</span><span class="mf">4..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">0</span><span class="p">,</span><span class="mf">4..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">0</span><span class="p">,</span><span class="mf">4..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">0</span><span class="p">,</span><span class="mf">4..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Assign</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="kc">None</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..1</span><span class="p">,</span><span class="mi">0</span><span class="o">&gt;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.find_in_loc" class="classattr">
                                        <input id="FST.find_in_loc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_in_loc</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ln</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">col</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#FST">FST</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.find_in_loc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.find_in_loc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.find_in_loc-2584"><a href="#FST.find_in_loc-2584"><span class="linenos">2584</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_in_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_col</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FST</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.find_in_loc-2585"><a href="#FST.find_in_loc-2585"><span class="linenos">2585</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the first highest level node which is contained entirely in location (inclusive, starting search at</span>
</span><span id="FST.find_in_loc-2586"><a href="#FST.find_in_loc-2586"><span class="linenos">2586</span></a><span class="sd">        `self`). To reiterate, the search will only find nodes at self or below, no parents.</span>
</span><span id="FST.find_in_loc-2587"><a href="#FST.find_in_loc-2587"><span class="linenos">2587</span></a>
</span><span id="FST.find_in_loc-2588"><a href="#FST.find_in_loc-2588"><span class="linenos">2588</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.find_in_loc-2589"><a href="#FST.find_in_loc-2589"><span class="linenos">2589</span></a><span class="sd">        - `ln`: Start line of location to search (0 based).</span>
</span><span id="FST.find_in_loc-2590"><a href="#FST.find_in_loc-2590"><span class="linenos">2590</span></a><span class="sd">        - `col`: Start column (character) on start line.</span>
</span><span id="FST.find_in_loc-2591"><a href="#FST.find_in_loc-2591"><span class="linenos">2591</span></a><span class="sd">        - `end_ln`: End line of location to search (0 based, inclusive).</span>
</span><span id="FST.find_in_loc-2592"><a href="#FST.find_in_loc-2592"><span class="linenos">2592</span></a><span class="sd">        - `end_col`: End column (character, inclusive with `FST.end_col`, exclusive with `FST.col`) on end line.</span>
</span><span id="FST.find_in_loc-2593"><a href="#FST.find_in_loc-2593"><span class="linenos">2593</span></a>
</span><span id="FST.find_in_loc-2594"><a href="#FST.find_in_loc-2594"><span class="linenos">2594</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.find_in_loc-2595"><a href="#FST.find_in_loc-2595"><span class="linenos">2595</span></a><span class="sd">        - `FST | None`: First node which is entirely contained in the location or `None` if no such node.</span>
</span><span id="FST.find_in_loc-2596"><a href="#FST.find_in_loc-2596"><span class="linenos">2596</span></a>
</span><span id="FST.find_in_loc-2597"><a href="#FST.find_in_loc-2597"><span class="linenos">2597</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.find_in_loc-2598"><a href="#FST.find_in_loc-2598"><span class="linenos">2598</span></a><span class="sd">        ```py</span>
</span><span id="FST.find_in_loc-2599"><a href="#FST.find_in_loc-2599"><span class="linenos">2599</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 0, 0, 7)</span>
</span><span id="FST.find_in_loc-2600"><a href="#FST.find_in_loc-2600"><span class="linenos">2600</span></a><span class="sd">        &lt;Module ROOT 0,0..0,7&gt;</span>
</span><span id="FST.find_in_loc-2601"><a href="#FST.find_in_loc-2601"><span class="linenos">2601</span></a>
</span><span id="FST.find_in_loc-2602"><a href="#FST.find_in_loc-2602"><span class="linenos">2602</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 1, 0, 7)</span>
</span><span id="FST.find_in_loc-2603"><a href="#FST.find_in_loc-2603"><span class="linenos">2603</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST.find_in_loc-2604"><a href="#FST.find_in_loc-2604"><span class="linenos">2604</span></a>
</span><span id="FST.find_in_loc-2605"><a href="#FST.find_in_loc-2605"><span class="linenos">2605</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 4, 0, 7)</span>
</span><span id="FST.find_in_loc-2606"><a href="#FST.find_in_loc-2606"><span class="linenos">2606</span></a><span class="sd">        &lt;Name 0,4..0,7&gt;</span>
</span><span id="FST.find_in_loc-2607"><a href="#FST.find_in_loc-2607"><span class="linenos">2607</span></a>
</span><span id="FST.find_in_loc-2608"><a href="#FST.find_in_loc-2608"><span class="linenos">2608</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;i = val&#39;, &#39;exec&#39;).find_in_loc(0, 5, 0, 7))</span>
</span><span id="FST.find_in_loc-2609"><a href="#FST.find_in_loc-2609"><span class="linenos">2609</span></a><span class="sd">        None</span>
</span><span id="FST.find_in_loc-2610"><a href="#FST.find_in_loc-2610"><span class="linenos">2610</span></a><span class="sd">        ```</span>
</span><span id="FST.find_in_loc-2611"><a href="#FST.find_in_loc-2611"><span class="linenos">2611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.find_in_loc-2612"><a href="#FST.find_in_loc-2612"><span class="linenos">2612</span></a>
</span><span id="FST.find_in_loc-2613"><a href="#FST.find_in_loc-2613"><span class="linenos">2613</span></a>        <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST.find_in_loc-2614"><a href="#FST.find_in_loc-2614"><span class="linenos">2614</span></a>
</span><span id="FST.find_in_loc-2615"><a href="#FST.find_in_loc-2615"><span class="linenos">2615</span></a>        <span class="k">if</span> <span class="p">((</span><span class="n">fln</span> <span class="o">&gt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&gt;=</span> <span class="n">col</span><span class="p">))</span> <span class="ow">and</span>
</span><span id="FST.find_in_loc-2616"><a href="#FST.find_in_loc-2616"><span class="linenos">2616</span></a>            <span class="p">(</span><span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">end_col</span><span class="p">))</span>
</span><span id="FST.find_in_loc-2617"><a href="#FST.find_in_loc-2617"><span class="linenos">2617</span></a>        <span class="p">):</span>
</span><span id="FST.find_in_loc-2618"><a href="#FST.find_in_loc-2618"><span class="linenos">2618</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FST.find_in_loc-2619"><a href="#FST.find_in_loc-2619"><span class="linenos">2619</span></a>
</span><span id="FST.find_in_loc-2620"><a href="#FST.find_in_loc-2620"><span class="linenos">2620</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FST.find_in_loc-2621"><a href="#FST.find_in_loc-2621"><span class="linenos">2621</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">self_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="FST.find_in_loc-2622"><a href="#FST.find_in_loc-2622"><span class="linenos">2622</span></a>                <span class="n">fln</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">fend_ln</span><span class="p">,</span> <span class="n">fend_col</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST.find_in_loc-2623"><a href="#FST.find_in_loc-2623"><span class="linenos">2623</span></a>
</span><span id="FST.find_in_loc-2624"><a href="#FST.find_in_loc-2624"><span class="linenos">2624</span></a>                <span class="k">if</span> <span class="n">fln</span> <span class="o">&lt;</span> <span class="n">ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fln</span> <span class="o">==</span> <span class="n">ln</span> <span class="ow">and</span> <span class="n">fcol</span> <span class="o">&lt;</span> <span class="n">col</span><span class="p">):</span>
</span><span id="FST.find_in_loc-2625"><a href="#FST.find_in_loc-2625"><span class="linenos">2625</span></a>                    <span class="k">continue</span>
</span><span id="FST.find_in_loc-2626"><a href="#FST.find_in_loc-2626"><span class="linenos">2626</span></a>
</span><span id="FST.find_in_loc-2627"><a href="#FST.find_in_loc-2627"><span class="linenos">2627</span></a>                <span class="k">if</span> <span class="n">fend_ln</span> <span class="o">&lt;</span> <span class="n">end_ln</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fend_ln</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="ow">and</span> <span class="n">fend_col</span> <span class="o">&lt;=</span> <span class="n">end_col</span><span class="p">):</span>
</span><span id="FST.find_in_loc-2628"><a href="#FST.find_in_loc-2628"><span class="linenos">2628</span></a>                    <span class="k">return</span> <span class="n">f</span>
</span><span id="FST.find_in_loc-2629"><a href="#FST.find_in_loc-2629"><span class="linenos">2629</span></a>
</span><span id="FST.find_in_loc-2630"><a href="#FST.find_in_loc-2630"><span class="linenos">2630</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="FST.find_in_loc-2631"><a href="#FST.find_in_loc-2631"><span class="linenos">2631</span></a>
</span><span id="FST.find_in_loc-2632"><a href="#FST.find_in_loc-2632"><span class="linenos">2632</span></a>                <span class="k">break</span>
</span><span id="FST.find_in_loc-2633"><a href="#FST.find_in_loc-2633"><span class="linenos">2633</span></a>
</span><span id="FST.find_in_loc-2634"><a href="#FST.find_in_loc-2634"><span class="linenos">2634</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FST.find_in_loc-2635"><a href="#FST.find_in_loc-2635"><span class="linenos">2635</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Find the first highest level node which is contained entirely in location (inclusive, starting search at
<code>self</code>). To reiterate, the search will only find nodes at self or below, no parents.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.ln">ln</a></code>: Start line of location to search (0 based).</li>
<li><code><a href="#FST.col">col</a></code>: Start column (character) on start line.</li>
<li><code><a href="#FST.end_ln">end_ln</a></code>: End line of location to search (0 based, inclusive).</li>
<li><code><a href="#FST.end_col">end_col</a></code>: End column (character, inclusive with <code><a href="#FST.end_col">FST.end_col</a></code>, exclusive with <code><a href="#FST.col">FST.col</a></code>) on end line.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>FST | None</code>: First node which is entirely contained in the location or <code>None</code> if no such node.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_in_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Module</span> <span class="n">ROOT</span> <span class="mi">0</span><span class="p">,</span><span class="mf">0..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_in_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">0</span><span class="p">,</span><span class="mf">4..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_in_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Name</span> <span class="mi">0</span><span class="p">,</span><span class="mf">4..0</span><span class="p">,</span><span class="mi">7</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = val&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_in_loc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="kc">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.get_indent" class="classattr">
                                        <input id="FST.get_indent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_indent</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="FST.get_indent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.get_indent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.get_indent-2640"><a href="#FST.get_indent-2640"><span class="linenos">2640</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span><span class="p">:</span>
</span><span id="FST.get_indent-2641"><a href="#FST.get_indent-2641"><span class="linenos">2641</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine proper indentation of node at `stmt` (or other similar) level at or above `self`. Even if it is a</span>
</span><span id="FST.get_indent-2642"><a href="#FST.get_indent-2642"><span class="linenos">2642</span></a><span class="sd">        continuation or on same line as block statement. If indentation is impossible to determine because is solo</span>
</span><span id="FST.get_indent-2643"><a href="#FST.get_indent-2643"><span class="linenos">2643</span></a><span class="sd">        statement on same line as parent block then the current tree default indentation is added to the parent block</span>
</span><span id="FST.get_indent-2644"><a href="#FST.get_indent-2644"><span class="linenos">2644</span></a><span class="sd">        indentation and returned.</span>
</span><span id="FST.get_indent-2645"><a href="#FST.get_indent-2645"><span class="linenos">2645</span></a>
</span><span id="FST.get_indent-2646"><a href="#FST.get_indent-2646"><span class="linenos">2646</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.get_indent-2647"><a href="#FST.get_indent-2647"><span class="linenos">2647</span></a><span class="sd">        - `str`: Entire indentation string for the block this node lives in (not just a single level).</span>
</span><span id="FST.get_indent-2648"><a href="#FST.get_indent-2648"><span class="linenos">2648</span></a>
</span><span id="FST.get_indent-2649"><a href="#FST.get_indent-2649"><span class="linenos">2649</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.get_indent-2650"><a href="#FST.get_indent-2650"><span class="linenos">2650</span></a><span class="sd">        ```py</span>
</span><span id="FST.get_indent-2651"><a href="#FST.get_indent-2651"><span class="linenos">2651</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i = 1&#39;).get_indent()</span>
</span><span id="FST.get_indent-2652"><a href="#FST.get_indent-2652"><span class="linenos">2652</span></a><span class="sd">        &#39;&#39;</span>
</span><span id="FST.get_indent-2653"><a href="#FST.get_indent-2653"><span class="linenos">2653</span></a>
</span><span id="FST.get_indent-2654"><a href="#FST.get_indent-2654"><span class="linenos">2654</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="FST.get_indent-2655"><a href="#FST.get_indent-2655"><span class="linenos">2655</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="FST.get_indent-2656"><a href="#FST.get_indent-2656"><span class="linenos">2656</span></a>
</span><span id="FST.get_indent-2657"><a href="#FST.get_indent-2657"><span class="linenos">2657</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1&#39;).body[0].get_indent()</span>
</span><span id="FST.get_indent-2658"><a href="#FST.get_indent-2658"><span class="linenos">2658</span></a><span class="sd">        &#39;    &#39;</span>
</span><span id="FST.get_indent-2659"><a href="#FST.get_indent-2659"><span class="linenos">2659</span></a>
</span><span id="FST.get_indent-2660"><a href="#FST.get_indent-2660"><span class="linenos">2660</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: i = 1; j = 2&#39;).body[1].get_indent()</span>
</span><span id="FST.get_indent-2661"><a href="#FST.get_indent-2661"><span class="linenos">2661</span></a><span class="sd">        &#39;    &#39;</span>
</span><span id="FST.get_indent-2662"><a href="#FST.get_indent-2662"><span class="linenos">2662</span></a>
</span><span id="FST.get_indent-2663"><a href="#FST.get_indent-2663"><span class="linenos">2663</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n  i = 1\n  j = 2&#39;).body[1].get_indent()</span>
</span><span id="FST.get_indent-2664"><a href="#FST.get_indent-2664"><span class="linenos">2664</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="FST.get_indent-2665"><a href="#FST.get_indent-2665"><span class="linenos">2665</span></a>
</span><span id="FST.get_indent-2666"><a href="#FST.get_indent-2666"><span class="linenos">2666</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 2:\n    if 1:\n      i = 1\n      j = 2&#39;).body[0].body[1].get_indent()</span>
</span><span id="FST.get_indent-2667"><a href="#FST.get_indent-2667"><span class="linenos">2667</span></a><span class="sd">        &#39;      &#39;</span>
</span><span id="FST.get_indent-2668"><a href="#FST.get_indent-2668"><span class="linenos">2668</span></a>
</span><span id="FST.get_indent-2669"><a href="#FST.get_indent-2669"><span class="linenos">2669</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n\\\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="FST.get_indent-2670"><a href="#FST.get_indent-2670"><span class="linenos">2670</span></a><span class="sd">        &#39;  &#39;</span>
</span><span id="FST.get_indent-2671"><a href="#FST.get_indent-2671"><span class="linenos">2671</span></a>
</span><span id="FST.get_indent-2672"><a href="#FST.get_indent-2672"><span class="linenos">2672</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1:\n \\\n  i = 1&#39;).body[0].get_indent()</span>
</span><span id="FST.get_indent-2673"><a href="#FST.get_indent-2673"><span class="linenos">2673</span></a><span class="sd">        &#39; &#39;</span>
</span><span id="FST.get_indent-2674"><a href="#FST.get_indent-2674"><span class="linenos">2674</span></a><span class="sd">        ```</span>
</span><span id="FST.get_indent-2675"><a href="#FST.get_indent-2675"><span class="linenos">2675</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.get_indent-2676"><a href="#FST.get_indent-2676"><span class="linenos">2676</span></a>
</span><span id="FST.get_indent-2677"><a href="#FST.get_indent-2677"><span class="linenos">2677</span></a>        <span class="k">while</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">STMTISH</span><span class="p">):</span>
</span><span id="FST.get_indent-2678"><a href="#FST.get_indent-2678"><span class="linenos">2678</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="FST.get_indent-2679"><a href="#FST.get_indent-2679"><span class="linenos">2679</span></a>
</span><span id="FST.get_indent-2680"><a href="#FST.get_indent-2680"><span class="linenos">2680</span></a>        <span class="n">root</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
</span><span id="FST.get_indent-2681"><a href="#FST.get_indent-2681"><span class="linenos">2681</span></a>        <span class="n">lines</span>  <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST.get_indent-2682"><a href="#FST.get_indent-2682"><span class="linenos">2682</span></a>        <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST.get_indent-2683"><a href="#FST.get_indent-2683"><span class="linenos">2683</span></a>
</span><span id="FST.get_indent-2684"><a href="#FST.get_indent-2684"><span class="linenos">2684</span></a>        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
</span><span id="FST.get_indent-2685"><a href="#FST.get_indent-2685"><span class="linenos">2685</span></a>            <span class="n">f</span>             <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">f</span>
</span><span id="FST.get_indent-2686"><a href="#FST.get_indent-2686"><span class="linenos">2686</span></a>            <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST.get_indent-2687"><a href="#FST.get_indent-2687"><span class="linenos">2687</span></a>            <span class="n">prev</span>          <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">prev</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># there may not be one (&quot;try&quot; at start of module)</span>
</span><span id="FST.get_indent-2688"><a href="#FST.get_indent-2688"><span class="linenos">2688</span></a>            <span class="n">prev_end_ln</span>   <span class="o">=</span> <span class="n">prev</span><span class="o">.</span><span class="n">end_ln</span> <span class="k">if</span> <span class="n">prev</span> <span class="k">else</span> <span class="o">-</span><span class="mi">2</span>  <span class="c1"># -2 so it never hits it</span>
</span><span id="FST.get_indent-2689"><a href="#FST.get_indent-2689"><span class="linenos">2689</span></a>            <span class="n">good_line</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="FST.get_indent-2690"><a href="#FST.get_indent-2690"><span class="linenos">2690</span></a>
</span><span id="FST.get_indent-2691"><a href="#FST.get_indent-2691"><span class="linenos">2691</span></a>            <span class="k">while</span> <span class="n">ln</span> <span class="o">&gt;</span> <span class="n">prev_end_ln</span> <span class="ow">and</span> <span class="n">re_empty_line</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line_start</span> <span class="o">:=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
</span><span id="FST.get_indent-2692"><a href="#FST.get_indent-2692"><span class="linenos">2692</span></a>                <span class="n">end_col</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">preceding_ln</span> <span class="o">:=</span> <span class="n">ln</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prev_end_ln</span> <span class="k">else</span> <span class="n">prev</span><span class="o">.</span><span class="n">end_col</span>
</span><span id="FST.get_indent-2693"><a href="#FST.get_indent-2693"><span class="linenos">2693</span></a>
</span><span id="FST.get_indent-2694"><a href="#FST.get_indent-2694"><span class="linenos">2694</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">ln</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">re_line_continuation</span><span class="o">.</span><span class="n">match</span><span class="p">((</span><span class="n">l</span> <span class="o">:=</span> <span class="n">lines</span><span class="p">[</span><span class="n">preceding_ln</span><span class="p">]),</span> <span class="n">end_col</span><span class="p">):</span>
</span><span id="FST.get_indent-2695"><a href="#FST.get_indent-2695"><span class="linenos">2695</span></a>                    <span class="k">return</span> <span class="p">(</span><span class="n">line_start</span><span class="p">[:</span><span class="n">col</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="k">else</span> <span class="n">good_line</span><span class="p">)</span> <span class="o">+</span> <span class="n">indent</span>
</span><span id="FST.get_indent-2696"><a href="#FST.get_indent-2696"><span class="linenos">2696</span></a>
</span><span id="FST.get_indent-2697"><a href="#FST.get_indent-2697"><span class="linenos">2697</span></a>                <span class="k">if</span> <span class="n">col</span><span class="p">:</span>  <span class="c1"># we do this to skip backslashes at the start of line as those are just a noop</span>
</span><span id="FST.get_indent-2698"><a href="#FST.get_indent-2698"><span class="linenos">2698</span></a>                    <span class="n">good_line</span> <span class="o">=</span> <span class="n">line_start</span><span class="p">[:</span><span class="n">col</span><span class="p">]</span>
</span><span id="FST.get_indent-2699"><a href="#FST.get_indent-2699"><span class="linenos">2699</span></a>
</span><span id="FST.get_indent-2700"><a href="#FST.get_indent-2700"><span class="linenos">2700</span></a>                <span class="n">ln</span>  <span class="o">=</span> <span class="n">preceding_ln</span>
</span><span id="FST.get_indent-2701"><a href="#FST.get_indent-2701"><span class="linenos">2701</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># was line continuation so last char is &#39;\&#39; and rest should be empty</span>
</span><span id="FST.get_indent-2702"><a href="#FST.get_indent-2702"><span class="linenos">2702</span></a>
</span><span id="FST.get_indent-2703"><a href="#FST.get_indent-2703"><span class="linenos">2703</span></a>            <span class="n">indent</span> <span class="o">+=</span> <span class="n">root</span><span class="o">.</span><span class="n">indent</span>
</span><span id="FST.get_indent-2704"><a href="#FST.get_indent-2704"><span class="linenos">2704</span></a>            <span class="bp">self</span>    <span class="o">=</span> <span class="n">parent</span>
</span><span id="FST.get_indent-2705"><a href="#FST.get_indent-2705"><span class="linenos">2705</span></a>            <span class="n">parent</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
</span><span id="FST.get_indent-2706"><a href="#FST.get_indent-2706"><span class="linenos">2706</span></a>
</span><span id="FST.get_indent-2707"><a href="#FST.get_indent-2707"><span class="linenos">2707</span></a>        <span class="k">return</span> <span class="n">indent</span>
</span></pre></div>


            <div class="docstring"><p>Determine proper indentation of node at <code>stmt</code> (or other similar) level at or above <code>self</code>. Even if it is a
continuation or on same line as block statement. If indentation is impossible to determine because is solo
statement on same line as parent block then the current tree default indentation is added to the parent block
indentation and returned.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>str</code>: Entire indentation string for the block this node lives in (not just a single level).</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i = 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
<span class="s1">&#39;&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n</span><span class="s1">  i = 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
<span class="s1">&#39;  &#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
<span class="s1">&#39;    &#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: i = 1; j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
<span class="s1">&#39;    &#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n</span><span class="s1">  i = 1</span><span class="se">\n</span><span class="s1">  j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
<span class="s1">&#39;  &#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 2:</span><span class="se">\n</span><span class="s1">    if 1:</span><span class="se">\n</span><span class="s1">      i = 1</span><span class="se">\n</span><span class="s1">      j = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
<span class="s1">&#39;      &#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n\\\n</span><span class="s1">  i = 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
<span class="s1">&#39;  &#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1:</span><span class="se">\n</span><span class="s1"> </span><span class="se">\\\n</span><span class="s1">  i = 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_indent</span><span class="p">()</span>
<span class="s1">&#39; &#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_parsable" class="classattr">
                                        <input id="FST.is_parsable-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_parsable</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.is_parsable-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_parsable"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_parsable-2709"><a href="#FST.is_parsable-2709"><span class="linenos">2709</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parsable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_parsable-2710"><a href="#FST.is_parsable-2710"><span class="linenos">2710</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether the source for this node is parsable by `FST` or not (if properly dedented for top level). This is</span>
</span><span id="FST.is_parsable-2711"><a href="#FST.is_parsable-2711"><span class="linenos">2711</span></a><span class="sd">        different from `astutil.is_parsable` because that one indicates what is parsable by the python `ast` module,</span>
</span><span id="FST.is_parsable-2712"><a href="#FST.is_parsable-2712"><span class="linenos">2712</span></a><span class="sd">        while `FST` can parse more things.</span>
</span><span id="FST.is_parsable-2713"><a href="#FST.is_parsable-2713"><span class="linenos">2713</span></a>
</span><span id="FST.is_parsable-2714"><a href="#FST.is_parsable-2714"><span class="linenos">2714</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_parsable-2715"><a href="#FST.is_parsable-2715"><span class="linenos">2715</span></a><span class="sd">        - `bool`: Whether is parsable by `FST` from a string or not.</span>
</span><span id="FST.is_parsable-2716"><a href="#FST.is_parsable-2716"><span class="linenos">2716</span></a>
</span><span id="FST.is_parsable-2717"><a href="#FST.is_parsable-2717"><span class="linenos">2717</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_parsable-2718"><a href="#FST.is_parsable-2718"><span class="linenos">2718</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_parsable-2719"><a href="#FST.is_parsable-2719"><span class="linenos">2719</span></a><span class="sd">        &gt;&gt;&gt; from fst import astutil</span>
</span><span id="FST.is_parsable-2720"><a href="#FST.is_parsable-2720"><span class="linenos">2720</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i&#39;).is_parsable()</span>
</span><span id="FST.is_parsable-2721"><a href="#FST.is_parsable-2721"><span class="linenos">2721</span></a><span class="sd">        True</span>
</span><span id="FST.is_parsable-2722"><a href="#FST.is_parsable-2722"><span class="linenos">2722</span></a>
</span><span id="FST.is_parsable-2723"><a href="#FST.is_parsable-2723"><span class="linenos">2723</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b]&#39;).slice.is_parsable()</span>
</span><span id="FST.is_parsable-2724"><a href="#FST.is_parsable-2724"><span class="linenos">2724</span></a><span class="sd">        True</span>
</span><span id="FST.is_parsable-2725"><a href="#FST.is_parsable-2725"><span class="linenos">2725</span></a>
</span><span id="FST.is_parsable-2726"><a href="#FST.is_parsable-2726"><span class="linenos">2726</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a[b:c]&#39;).slice.is_parsable()</span>
</span><span id="FST.is_parsable-2727"><a href="#FST.is_parsable-2727"><span class="linenos">2727</span></a><span class="sd">        True</span>
</span><span id="FST.is_parsable-2728"><a href="#FST.is_parsable-2728"><span class="linenos">2728</span></a>
</span><span id="FST.is_parsable-2729"><a href="#FST.is_parsable-2729"><span class="linenos">2729</span></a><span class="sd">        &gt;&gt;&gt; is_parsable(FST(&#39;a[b:c]&#39;).slice.a)</span>
</span><span id="FST.is_parsable-2730"><a href="#FST.is_parsable-2730"><span class="linenos">2730</span></a><span class="sd">        False</span>
</span><span id="FST.is_parsable-2731"><a href="#FST.is_parsable-2731"><span class="linenos">2731</span></a>
</span><span id="FST.is_parsable-2732"><a href="#FST.is_parsable-2732"><span class="linenos">2732</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].is_parsable()</span>
</span><span id="FST.is_parsable-2733"><a href="#FST.is_parsable-2733"><span class="linenos">2733</span></a><span class="sd">        False</span>
</span><span id="FST.is_parsable-2734"><a href="#FST.is_parsable-2734"><span class="linenos">2734</span></a>
</span><span id="FST.is_parsable-2735"><a href="#FST.is_parsable-2735"><span class="linenos">2735</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].value.is_parsable()</span>
</span><span id="FST.is_parsable-2736"><a href="#FST.is_parsable-2736"><span class="linenos">2736</span></a><span class="sd">        True</span>
</span><span id="FST.is_parsable-2737"><a href="#FST.is_parsable-2737"><span class="linenos">2737</span></a>
</span><span id="FST.is_parsable-2738"><a href="#FST.is_parsable-2738"><span class="linenos">2738</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{a!r:&lt;8}&quot;&#39;).values[0].format_spec.is_parsable()</span>
</span><span id="FST.is_parsable-2739"><a href="#FST.is_parsable-2739"><span class="linenos">2739</span></a><span class="sd">        False</span>
</span><span id="FST.is_parsable-2740"><a href="#FST.is_parsable-2740"><span class="linenos">2740</span></a>
</span><span id="FST.is_parsable-2741"><a href="#FST.is_parsable-2741"><span class="linenos">2741</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).body[0].is_parsable()</span>
</span><span id="FST.is_parsable-2742"><a href="#FST.is_parsable-2742"><span class="linenos">2742</span></a><span class="sd">        True</span>
</span><span id="FST.is_parsable-2743"><a href="#FST.is_parsable-2743"><span class="linenos">2743</span></a>
</span><span id="FST.is_parsable-2744"><a href="#FST.is_parsable-2744"><span class="linenos">2744</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].is_parsable()</span>
</span><span id="FST.is_parsable-2745"><a href="#FST.is_parsable-2745"><span class="linenos">2745</span></a><span class="sd">        True</span>
</span><span id="FST.is_parsable-2746"><a href="#FST.is_parsable-2746"><span class="linenos">2746</span></a>
</span><span id="FST.is_parsable-2747"><a href="#FST.is_parsable-2747"><span class="linenos">2747</span></a><span class="sd">        &gt;&gt;&gt; astutil.is_parsable(FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].a)</span>
</span><span id="FST.is_parsable-2748"><a href="#FST.is_parsable-2748"><span class="linenos">2748</span></a><span class="sd">        False</span>
</span><span id="FST.is_parsable-2749"><a href="#FST.is_parsable-2749"><span class="linenos">2749</span></a>
</span><span id="FST.is_parsable-2750"><a href="#FST.is_parsable-2750"><span class="linenos">2750</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;try: pass\nexcept: pass&#39;).handlers[0].body[0].is_parsable()</span>
</span><span id="FST.is_parsable-2751"><a href="#FST.is_parsable-2751"><span class="linenos">2751</span></a><span class="sd">        True</span>
</span><span id="FST.is_parsable-2752"><a href="#FST.is_parsable-2752"><span class="linenos">2752</span></a>
</span><span id="FST.is_parsable-2753"><a href="#FST.is_parsable-2753"><span class="linenos">2753</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1: pass&#39;).cases[0].is_parsable()</span>
</span><span id="FST.is_parsable-2754"><a href="#FST.is_parsable-2754"><span class="linenos">2754</span></a><span class="sd">        True</span>
</span><span id="FST.is_parsable-2755"><a href="#FST.is_parsable-2755"><span class="linenos">2755</span></a>
</span><span id="FST.is_parsable-2756"><a href="#FST.is_parsable-2756"><span class="linenos">2756</span></a><span class="sd">        &gt;&gt;&gt; is_parsable(FST(&#39;match a:\n  case 1: pass&#39;).cases[0].a)</span>
</span><span id="FST.is_parsable-2757"><a href="#FST.is_parsable-2757"><span class="linenos">2757</span></a><span class="sd">        False</span>
</span><span id="FST.is_parsable-2758"><a href="#FST.is_parsable-2758"><span class="linenos">2758</span></a><span class="sd">        ```</span>
</span><span id="FST.is_parsable-2759"><a href="#FST.is_parsable-2759"><span class="linenos">2759</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_parsable-2760"><a href="#FST.is_parsable-2760"><span class="linenos">2760</span></a>
</span><span id="FST.is_parsable-2761"><a href="#FST.is_parsable-2761"><span class="linenos">2761</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">:</span>
</span><span id="FST.is_parsable-2762"><a href="#FST.is_parsable-2762"><span class="linenos">2762</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_parsable-2763"><a href="#FST.is_parsable-2763"><span class="linenos">2763</span></a>
</span><span id="FST.is_parsable-2764"><a href="#FST.is_parsable-2764"><span class="linenos">2764</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.is_parsable-2765"><a href="#FST.is_parsable-2765"><span class="linenos">2765</span></a>
</span><span id="FST.is_parsable-2766"><a href="#FST.is_parsable-2766"><span class="linenos">2766</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">expr_context</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">,</span> <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">)):</span>
</span><span id="FST.is_parsable-2767"><a href="#FST.is_parsable-2767"><span class="linenos">2767</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_parsable-2768"><a href="#FST.is_parsable-2768"><span class="linenos">2768</span></a>
</span><span id="FST.is_parsable-2769"><a href="#FST.is_parsable-2769"><span class="linenos">2769</span></a>        <span class="k">elif</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST.is_parsable-2770"><a href="#FST.is_parsable-2770"><span class="linenos">2770</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">):</span>  <span class="c1"># TemplateStr doesn&#39;t go into a .format_spec, &#39;.1f&#39; type strings without quote delimiters</span>
</span><span id="FST.is_parsable-2771"><a href="#FST.is_parsable-2771"><span class="linenos">2771</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;format_spec&#39;</span><span class="p">:</span>  <span class="c1"># isinstance(parent.a, (FormattedValue, Interpolation)):</span>
</span><span id="FST.is_parsable-2772"><a href="#FST.is_parsable-2772"><span class="linenos">2772</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_parsable-2773"><a href="#FST.is_parsable-2773"><span class="linenos">2773</span></a>
</span><span id="FST.is_parsable-2774"><a href="#FST.is_parsable-2774"><span class="linenos">2774</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>  <span class="c1"># string parts of f-string without quote delimiters</span>
</span><span id="FST.is_parsable-2775"><a href="#FST.is_parsable-2775"><span class="linenos">2775</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;values&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">)):</span>  <span class="c1"># isinstance(ast.value, str)</span>
</span><span id="FST.is_parsable-2776"><a href="#FST.is_parsable-2776"><span class="linenos">2776</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_parsable-2777"><a href="#FST.is_parsable-2777"><span class="linenos">2777</span></a>
</span><span id="FST.is_parsable-2778"><a href="#FST.is_parsable-2778"><span class="linenos">2778</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Whether the source for this node is parsable by <code><a href="#FST">FST</a></code> or not (if properly dedented for top level). This is
different from <code>astutil.is_parsable</code> because that one indicates what is parsable by the python <code>ast</code> module,
while <code><a href="#FST">FST</a></code> can parse more things.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>bool</code>: Whether is parsable by <code><a href="#FST">FST</a></code> from a string or not.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fst</span><span class="w"> </span><span class="kn">import</span> <span class="n">astutil</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a[b]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a[b:c]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">is_parsable</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a[b:c]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;f&quot;</span><span class="si">{a!r:&lt;8}</span><span class="s1">&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;f&quot;</span><span class="si">{a!r:&lt;8}</span><span class="s1">&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;f&quot;</span><span class="si">{a!r:&lt;8}</span><span class="s1">&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">format_spec</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">except: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">except: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">astutil</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">except: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;try: pass</span><span class="se">\n</span><span class="s1">except: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case 1: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_parsable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">is_parsable</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case 1: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_parenthesizable" class="classattr">
                                        <input id="FST.is_parenthesizable-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_parenthesizable</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.is_parenthesizable-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_parenthesizable"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_parenthesizable-2780"><a href="#FST.is_parenthesizable-2780"><span class="linenos">2780</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parenthesizable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_parenthesizable-2781"><a href="#FST.is_parenthesizable-2781"><span class="linenos">2781</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is parenthesizable with grouping parentheses or now. Essentially all `expr`s and `pattern`s</span>
</span><span id="FST.is_parenthesizable-2782"><a href="#FST.is_parenthesizable-2782"><span class="linenos">2782</span></a><span class="sd">        except for `Slice`.</span>
</span><span id="FST.is_parenthesizable-2783"><a href="#FST.is_parenthesizable-2783"><span class="linenos">2783</span></a>
</span><span id="FST.is_parenthesizable-2784"><a href="#FST.is_parenthesizable-2784"><span class="linenos">2784</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_parenthesizable-2785"><a href="#FST.is_parenthesizable-2785"><span class="linenos">2785</span></a><span class="sd">        - `bool`: Whether is syntactically legal to add grouping parentheses or not. Can always be forced.</span>
</span><span id="FST.is_parenthesizable-2786"><a href="#FST.is_parenthesizable-2786"><span class="linenos">2786</span></a>
</span><span id="FST.is_parenthesizable-2787"><a href="#FST.is_parenthesizable-2787"><span class="linenos">2787</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_parenthesizable-2788"><a href="#FST.is_parenthesizable-2788"><span class="linenos">2788</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_parenthesizable-2789"><a href="#FST.is_parenthesizable-2789"><span class="linenos">2789</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;i + j&#39;).is_parenthesizable()  # expr</span>
</span><span id="FST.is_parenthesizable-2790"><a href="#FST.is_parenthesizable-2790"><span class="linenos">2790</span></a><span class="sd">        True</span>
</span><span id="FST.is_parenthesizable-2791"><a href="#FST.is_parenthesizable-2791"><span class="linenos">2791</span></a>
</span><span id="FST.is_parenthesizable-2792"><a href="#FST.is_parenthesizable-2792"><span class="linenos">2792</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{a.b: c, **d}&#39;, &#39;pattern&#39;).is_parenthesizable()</span>
</span><span id="FST.is_parenthesizable-2793"><a href="#FST.is_parenthesizable-2793"><span class="linenos">2793</span></a><span class="sd">        True</span>
</span><span id="FST.is_parenthesizable-2794"><a href="#FST.is_parenthesizable-2794"><span class="linenos">2794</span></a>
</span><span id="FST.is_parenthesizable-2795"><a href="#FST.is_parenthesizable-2795"><span class="linenos">2795</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a:b:c&#39;).is_parenthesizable()  # Slice</span>
</span><span id="FST.is_parenthesizable-2796"><a href="#FST.is_parenthesizable-2796"><span class="linenos">2796</span></a><span class="sd">        False</span>
</span><span id="FST.is_parenthesizable-2797"><a href="#FST.is_parenthesizable-2797"><span class="linenos">2797</span></a>
</span><span id="FST.is_parenthesizable-2798"><a href="#FST.is_parenthesizable-2798"><span class="linenos">2798</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;for i in j&#39;).is_parenthesizable()  # comprehension</span>
</span><span id="FST.is_parenthesizable-2799"><a href="#FST.is_parenthesizable-2799"><span class="linenos">2799</span></a><span class="sd">        False</span>
</span><span id="FST.is_parenthesizable-2800"><a href="#FST.is_parenthesizable-2800"><span class="linenos">2800</span></a>
</span><span id="FST.is_parenthesizable-2801"><a href="#FST.is_parenthesizable-2801"><span class="linenos">2801</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a: int, b=2&#39;).is_parenthesizable()  # arguments</span>
</span><span id="FST.is_parenthesizable-2802"><a href="#FST.is_parenthesizable-2802"><span class="linenos">2802</span></a><span class="sd">        False</span>
</span><span id="FST.is_parenthesizable-2803"><a href="#FST.is_parenthesizable-2803"><span class="linenos">2803</span></a>
</span><span id="FST.is_parenthesizable-2804"><a href="#FST.is_parenthesizable-2804"><span class="linenos">2804</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a: int&#39;, &#39;arg&#39;).is_parenthesizable()</span>
</span><span id="FST.is_parenthesizable-2805"><a href="#FST.is_parenthesizable-2805"><span class="linenos">2805</span></a><span class="sd">        False</span>
</span><span id="FST.is_parenthesizable-2806"><a href="#FST.is_parenthesizable-2806"><span class="linenos">2806</span></a>
</span><span id="FST.is_parenthesizable-2807"><a href="#FST.is_parenthesizable-2807"><span class="linenos">2807</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;key=&quot;word&quot;&#39;, &#39;keyword&#39;).is_parenthesizable()</span>
</span><span id="FST.is_parenthesizable-2808"><a href="#FST.is_parenthesizable-2808"><span class="linenos">2808</span></a><span class="sd">        False</span>
</span><span id="FST.is_parenthesizable-2809"><a href="#FST.is_parenthesizable-2809"><span class="linenos">2809</span></a>
</span><span id="FST.is_parenthesizable-2810"><a href="#FST.is_parenthesizable-2810"><span class="linenos">2810</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a as b&#39;, &#39;alias&#39;).is_parenthesizable()</span>
</span><span id="FST.is_parenthesizable-2811"><a href="#FST.is_parenthesizable-2811"><span class="linenos">2811</span></a><span class="sd">        False</span>
</span><span id="FST.is_parenthesizable-2812"><a href="#FST.is_parenthesizable-2812"><span class="linenos">2812</span></a>
</span><span id="FST.is_parenthesizable-2813"><a href="#FST.is_parenthesizable-2813"><span class="linenos">2813</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a as b&#39;, &#39;withitem&#39;).is_parenthesizable()</span>
</span><span id="FST.is_parenthesizable-2814"><a href="#FST.is_parenthesizable-2814"><span class="linenos">2814</span></a><span class="sd">        False</span>
</span><span id="FST.is_parenthesizable-2815"><a href="#FST.is_parenthesizable-2815"><span class="linenos">2815</span></a><span class="sd">        ```</span>
</span><span id="FST.is_parenthesizable-2816"><a href="#FST.is_parenthesizable-2816"><span class="linenos">2816</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_parenthesizable-2817"><a href="#FST.is_parenthesizable-2817"><span class="linenos">2817</span></a>
</span><span id="FST.is_parenthesizable-2818"><a href="#FST.is_parenthesizable-2818"><span class="linenos">2818</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Slice</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">else</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is parenthesizable with grouping parentheses or now. Essentially all <code>expr</code>s and <code>pattern</code>s
except for <code>Slice</code>.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>bool</code>: Whether is syntactically legal to add grouping parentheses or not. Can always be forced.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;i + j&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>  <span class="c1"># expr</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;{a.b: c, **d}&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a:b:c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>  <span class="c1"># Slice</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;for i in j&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>  <span class="c1"># comprehension</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a: int, b=2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>  <span class="c1"># arguments</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a: int&#39;</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;key=&quot;word&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;keyword&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a as b&#39;</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a as b&#39;</span><span class="p">,</span> <span class="s1">&#39;withitem&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesizable</span><span class="p">()</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_atom" class="classattr">
                                        <input id="FST.is_atom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_atom</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">always_enclosed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;unenclosable&#39;</span><span class="p">,</span> <span class="s1">&#39;pars&#39;</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="FST.is_atom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_atom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_atom-2820"><a href="#FST.is_atom-2820"><span class="linenos">2820</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">always_enclosed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;unenclosable&#39;</span><span class="p">,</span> <span class="s1">&#39;pars&#39;</span><span class="p">]:</span>
</span><span id="FST.is_atom-2821"><a href="#FST.is_atom-2821"><span class="linenos">2821</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is innately atomic precedence-wise like `Name`, `Constant`, `List`, etc... Or otherwise</span>
</span><span id="FST.is_atom-2822"><a href="#FST.is_atom-2822"><span class="linenos">2822</span></a><span class="sd">        optionally enclosed in parentheses so that it functions as a parsable atom and cannot be split up by precedence</span>
</span><span id="FST.is_atom-2823"><a href="#FST.is_atom-2823"><span class="linenos">2823</span></a><span class="sd">        rules when reparsed.</span>
</span><span id="FST.is_atom-2824"><a href="#FST.is_atom-2824"><span class="linenos">2824</span></a>
</span><span id="FST.is_atom-2825"><a href="#FST.is_atom-2825"><span class="linenos">2825</span></a><span class="sd">        Node types where this doesn&#39;t normally apply like `stmt` or `alias` return `True`.</span>
</span><span id="FST.is_atom-2826"><a href="#FST.is_atom-2826"><span class="linenos">2826</span></a>
</span><span id="FST.is_atom-2827"><a href="#FST.is_atom-2827"><span class="linenos">2827</span></a><span class="sd">        Being atomic precedence-wise does not guarantee parsability as an otherwise atomic node could be spread across</span>
</span><span id="FST.is_atom-2828"><a href="#FST.is_atom-2828"><span class="linenos">2828</span></a><span class="sd">        multiple lines without line continuations or grouping parentheses, in this case `&#39;unenclosable&#39;` is returned (if</span>
</span><span id="FST.is_atom-2829"><a href="#FST.is_atom-2829"><span class="linenos">2829</span></a><span class="sd">        these nodes are not excluded altogether with `always_enclosed=True`). Also see `is_enclosed()`.</span>
</span><span id="FST.is_atom-2830"><a href="#FST.is_atom-2830"><span class="linenos">2830</span></a>
</span><span id="FST.is_atom-2831"><a href="#FST.is_atom-2831"><span class="linenos">2831</span></a><span class="sd">        If this function returns `&#39;pars&#39;` then `self` is enclosed due to the grouping parentheses.</span>
</span><span id="FST.is_atom-2832"><a href="#FST.is_atom-2832"><span class="linenos">2832</span></a>
</span><span id="FST.is_atom-2833"><a href="#FST.is_atom-2833"><span class="linenos">2833</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.is_atom-2834"><a href="#FST.is_atom-2834"><span class="linenos">2834</span></a><span class="sd">        - `pars`: Whether to check for grouping parentheses or not for node types which are not innately atomic</span>
</span><span id="FST.is_atom-2835"><a href="#FST.is_atom-2835"><span class="linenos">2835</span></a><span class="sd">            (`NamedExpr`, `BinOp`, `Yield`, etc...). If `True` then `(a + b)` is considered atomic, if `False` then it</span>
</span><span id="FST.is_atom-2836"><a href="#FST.is_atom-2836"><span class="linenos">2836</span></a><span class="sd">            is not.</span>
</span><span id="FST.is_atom-2837"><a href="#FST.is_atom-2837"><span class="linenos">2837</span></a><span class="sd">        - `always_enclosed`: If `True` then will only consider nodes innately atomic which are always enclosed like</span>
</span><span id="FST.is_atom-2838"><a href="#FST.is_atom-2838"><span class="linenos">2838</span></a><span class="sd">            `List` or parenthesized `Tuple`. Nodes which may be split up across multiple lines like `Call` or</span>
</span><span id="FST.is_atom-2839"><a href="#FST.is_atom-2839"><span class="linenos">2839</span></a><span class="sd">            `Attribute` will not be considered atomic and will return `False` unless `pars=True` and grouping</span>
</span><span id="FST.is_atom-2840"><a href="#FST.is_atom-2840"><span class="linenos">2840</span></a><span class="sd">            parentheses present, in which case `&#39;pars&#39;` is returned.</span>
</span><span id="FST.is_atom-2841"><a href="#FST.is_atom-2841"><span class="linenos">2841</span></a>
</span><span id="FST.is_atom-2842"><a href="#FST.is_atom-2842"><span class="linenos">2842</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_atom-2843"><a href="#FST.is_atom-2843"><span class="linenos">2843</span></a><span class="sd">        - `True`: Is atomic and no combination of changes in the source will make it parse to a different node.</span>
</span><span id="FST.is_atom-2844"><a href="#FST.is_atom-2844"><span class="linenos">2844</span></a><span class="sd">        - `&#39;unenclosable&#39;`: Is atomic precedence-wise but may be made non-parsable by being spread over multiple lines.</span>
</span><span id="FST.is_atom-2845"><a href="#FST.is_atom-2845"><span class="linenos">2845</span></a><span class="sd">        - `&#39;pars&#39;`: Is atomic due to enclosing grouping parentheses and would not be otherwise, can not be returned for</span>
</span><span id="FST.is_atom-2846"><a href="#FST.is_atom-2846"><span class="linenos">2846</span></a><span class="sd">            `&#39;unenclosable&#39;` nodes if `always_enclosed=False`.</span>
</span><span id="FST.is_atom-2847"><a href="#FST.is_atom-2847"><span class="linenos">2847</span></a><span class="sd">        - `False`: Not atomic.</span>
</span><span id="FST.is_atom-2848"><a href="#FST.is_atom-2848"><span class="linenos">2848</span></a>
</span><span id="FST.is_atom-2849"><a href="#FST.is_atom-2849"><span class="linenos">2849</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_atom-2850"><a href="#FST.is_atom-2850"><span class="linenos">2850</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_atom-2851"><a href="#FST.is_atom-2851"><span class="linenos">2851</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a&#39;).is_atom()</span>
</span><span id="FST.is_atom-2852"><a href="#FST.is_atom-2852"><span class="linenos">2852</span></a><span class="sd">        True</span>
</span><span id="FST.is_atom-2853"><a href="#FST.is_atom-2853"><span class="linenos">2853</span></a>
</span><span id="FST.is_atom-2854"><a href="#FST.is_atom-2854"><span class="linenos">2854</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + b&#39;).is_atom()</span>
</span><span id="FST.is_atom-2855"><a href="#FST.is_atom-2855"><span class="linenos">2855</span></a><span class="sd">        False</span>
</span><span id="FST.is_atom-2856"><a href="#FST.is_atom-2856"><span class="linenos">2856</span></a>
</span><span id="FST.is_atom-2857"><a href="#FST.is_atom-2857"><span class="linenos">2857</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).is_atom()</span>
</span><span id="FST.is_atom-2858"><a href="#FST.is_atom-2858"><span class="linenos">2858</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="FST.is_atom-2859"><a href="#FST.is_atom-2859"><span class="linenos">2859</span></a>
</span><span id="FST.is_atom-2860"><a href="#FST.is_atom-2860"><span class="linenos">2860</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + b)&#39;).is_atom(pars=False)</span>
</span><span id="FST.is_atom-2861"><a href="#FST.is_atom-2861"><span class="linenos">2861</span></a><span class="sd">        False</span>
</span><span id="FST.is_atom-2862"><a href="#FST.is_atom-2862"><span class="linenos">2862</span></a>
</span><span id="FST.is_atom-2863"><a href="#FST.is_atom-2863"><span class="linenos">2863</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a.b&#39;).is_atom()</span>
</span><span id="FST.is_atom-2864"><a href="#FST.is_atom-2864"><span class="linenos">2864</span></a><span class="sd">        &#39;unenclosable&#39;</span>
</span><span id="FST.is_atom-2865"><a href="#FST.is_atom-2865"><span class="linenos">2865</span></a>
</span><span id="FST.is_atom-2866"><a href="#FST.is_atom-2866"><span class="linenos">2866</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a.b&#39;).is_atom(always_enclosed=True)  # because of &quot;a\n.b&quot;</span>
</span><span id="FST.is_atom-2867"><a href="#FST.is_atom-2867"><span class="linenos">2867</span></a><span class="sd">        False</span>
</span><span id="FST.is_atom-2868"><a href="#FST.is_atom-2868"><span class="linenos">2868</span></a>
</span><span id="FST.is_atom-2869"><a href="#FST.is_atom-2869"><span class="linenos">2869</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a.b)&#39;).is_atom(always_enclosed=True)</span>
</span><span id="FST.is_atom-2870"><a href="#FST.is_atom-2870"><span class="linenos">2870</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="FST.is_atom-2871"><a href="#FST.is_atom-2871"><span class="linenos">2871</span></a>
</span><span id="FST.is_atom-2872"><a href="#FST.is_atom-2872"><span class="linenos">2872</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_atom(always_enclosed=True)  # because List is always enclosed</span>
</span><span id="FST.is_atom-2873"><a href="#FST.is_atom-2873"><span class="linenos">2873</span></a><span class="sd">        True</span>
</span><span id="FST.is_atom-2874"><a href="#FST.is_atom-2874"><span class="linenos">2874</span></a><span class="sd">        ```</span>
</span><span id="FST.is_atom-2875"><a href="#FST.is_atom-2875"><span class="linenos">2875</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_atom-2876"><a href="#FST.is_atom-2876"><span class="linenos">2876</span></a>
</span><span id="FST.is_atom-2877"><a href="#FST.is_atom-2877"><span class="linenos">2877</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.is_atom-2878"><a href="#FST.is_atom-2878"><span class="linenos">2878</span></a>
</span><span id="FST.is_atom-2879"><a href="#FST.is_atom-2879"><span class="linenos">2879</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span>
</span><span id="FST.is_atom-2880"><a href="#FST.is_atom-2880"><span class="linenos">2880</span></a>                            <span class="n">MatchValue</span><span class="p">,</span> <span class="n">MatchSingleton</span><span class="p">,</span> <span class="n">MatchMapping</span><span class="p">,</span>
</span><span id="FST.is_atom-2881"><a href="#FST.is_atom-2881"><span class="linenos">2881</span></a>                            <span class="n">expr_context</span><span class="p">,</span> <span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span>
</span><span id="FST.is_atom-2882"><a href="#FST.is_atom-2882"><span class="linenos">2882</span></a>                            <span class="n">stmt</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="FST.is_atom-2883"><a href="#FST.is_atom-2883"><span class="linenos">2883</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_atom-2884"><a href="#FST.is_atom-2884"><span class="linenos">2884</span></a>
</span><span id="FST.is_atom-2885"><a href="#FST.is_atom-2885"><span class="linenos">2885</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">always_enclosed</span><span class="p">:</span>
</span><span id="FST.is_atom-2886"><a href="#FST.is_atom-2886"><span class="linenos">2886</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="FST.is_atom-2887"><a href="#FST.is_atom-2887"><span class="linenos">2887</span></a>                <span class="k">return</span> <span class="s1">&#39;unenclosable&#39;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="FST.is_atom-2888"><a href="#FST.is_atom-2888"><span class="linenos">2888</span></a>
</span><span id="FST.is_atom-2889"><a href="#FST.is_atom-2889"><span class="linenos">2889</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">Call</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">,</span> <span class="n">Constant</span><span class="p">,</span> <span class="n">Attribute</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">,</span>
</span><span id="FST.is_atom-2890"><a href="#FST.is_atom-2890"><span class="linenos">2890</span></a>                                <span class="n">MatchClass</span><span class="p">,</span> <span class="n">MatchStar</span><span class="p">,</span>
</span><span id="FST.is_atom-2891"><a href="#FST.is_atom-2891"><span class="linenos">2891</span></a>                                <span class="n">cmpop</span><span class="p">,</span> <span class="n">comprehension</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span>
</span><span id="FST.is_atom-2892"><a href="#FST.is_atom-2892"><span class="linenos">2892</span></a>                                <span class="n">arg</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">withitem</span><span class="p">,</span> <span class="n">type_param</span><span class="p">)):</span>
</span><span id="FST.is_atom-2893"><a href="#FST.is_atom-2893"><span class="linenos">2893</span></a>                <span class="k">return</span> <span class="s1">&#39;unenclosable&#39;</span>
</span><span id="FST.is_atom-2894"><a href="#FST.is_atom-2894"><span class="linenos">2894</span></a>
</span><span id="FST.is_atom-2895"><a href="#FST.is_atom-2895"><span class="linenos">2895</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">comprehension</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">type_param</span><span class="p">)):</span>  <span class="c1"># can&#39;t be parenthesized</span>
</span><span id="FST.is_atom-2896"><a href="#FST.is_atom-2896"><span class="linenos">2896</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_atom-2897"><a href="#FST.is_atom-2897"><span class="linenos">2897</span></a>
</span><span id="FST.is_atom-2898"><a href="#FST.is_atom-2898"><span class="linenos">2898</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="FST.is_atom-2899"><a href="#FST.is_atom-2899"><span class="linenos">2899</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>  <span class="c1"># str and bytes can be multiline implicit needing parentheses</span>
</span><span id="FST.is_atom-2900"><a href="#FST.is_atom-2900"><span class="linenos">2900</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_atom-2901"><a href="#FST.is_atom-2901"><span class="linenos">2901</span></a>
</span><span id="FST.is_atom-2902"><a href="#FST.is_atom-2902"><span class="linenos">2902</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">withitem</span><span class="p">):</span>  <span class="c1"># isn&#39;t atom on its own and can&#39;t be parenthesized directly but if only has context_expr then take on value of that if starts and ends on same lines</span>
</span><span id="FST.is_atom-2903"><a href="#FST.is_atom-2903"><span class="linenos">2903</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">optional_vars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">ce</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">context_expr</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">()[::</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span>
</span><span id="FST.is_atom-2904"><a href="#FST.is_atom-2904"><span class="linenos">2904</span></a>                    <span class="n">ce</span><span class="o">.</span><span class="n">is_atom</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="n">pars</span><span class="p">,</span> <span class="n">always_enclosed</span><span class="o">=</span><span class="n">always_enclosed</span><span class="p">))</span>
</span><span id="FST.is_atom-2905"><a href="#FST.is_atom-2905"><span class="linenos">2905</span></a>
</span><span id="FST.is_atom-2906"><a href="#FST.is_atom-2906"><span class="linenos">2906</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">cmpop</span><span class="p">):</span>
</span><span id="FST.is_atom-2907"><a href="#FST.is_atom-2907"><span class="linenos">2907</span></a>            <span class="k">return</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">IsNot</span><span class="p">,</span> <span class="n">NotIn</span><span class="p">))</span>  <span class="c1"># could be spread across multiple lines</span>
</span><span id="FST.is_atom-2908"><a href="#FST.is_atom-2908"><span class="linenos">2908</span></a>
</span><span id="FST.is_atom-2909"><a href="#FST.is_atom-2909"><span class="linenos">2909</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># if this is False then cannot be enclosed in grouping pars because that would reparse to a parenthesized Tuple and so is inconsistent</span>
</span><span id="FST.is_atom-2910"><a href="#FST.is_atom-2910"><span class="linenos">2910</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="FST.is_atom-2911"><a href="#FST.is_atom-2911"><span class="linenos">2911</span></a>
</span><span id="FST.is_atom-2912"><a href="#FST.is_atom-2912"><span class="linenos">2912</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># like Tuple, cannot be enclosed in grouping pars</span>
</span><span id="FST.is_atom-2913"><a href="#FST.is_atom-2913"><span class="linenos">2913</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="FST.is_atom-2914"><a href="#FST.is_atom-2914"><span class="linenos">2914</span></a>
</span><span id="FST.is_atom-2915"><a href="#FST.is_atom-2915"><span class="linenos">2915</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">pattern</span><span class="p">))</span>
</span><span id="FST.is_atom-2916"><a href="#FST.is_atom-2916"><span class="linenos">2916</span></a>
</span><span id="FST.is_atom-2917"><a href="#FST.is_atom-2917"><span class="linenos">2917</span></a>        <span class="k">return</span> <span class="s1">&#39;pars&#39;</span> <span class="k">if</span> <span class="n">pars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span> <span class="k">else</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is innately atomic precedence-wise like <code>Name</code>, <code>Constant</code>, <code>List</code>, etc... Or otherwise
optionally enclosed in parentheses so that it functions as a parsable atom and cannot be split up by precedence
rules when reparsed.</p>

<p>Node types where this doesn't normally apply like <code>stmt</code> or <code>alias</code> return <code>True</code>.</p>

<p>Being atomic precedence-wise does not guarantee parsability as an otherwise atomic node could be spread across
multiple lines without line continuations or grouping parentheses, in this case <code>'unenclosable'</code> is returned (if
these nodes are not excluded altogether with <code>always_enclosed=True</code>). Also see <code><a href="#FST.is_enclosed">is_enclosed()</a></code>.</p>

<p>If this function returns <code>'pars'</code> then <code>self</code> is enclosed due to the grouping parentheses.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.pars">pars</a></code>: Whether to check for grouping parentheses or not for node types which are not innately atomic
(<code>NamedExpr</code>, <code>BinOp</code>, <code>Yield</code>, etc...). If <code>True</code> then <code>(a + b)</code> is considered atomic, if <code>False</code> then it
is not.</li>
<li><code>always_enclosed</code>: If <code>True</code> then will only consider nodes innately atomic which are always enclosed like
<code>List</code> or parenthesized <code>Tuple</code>. Nodes which may be split up across multiple lines like <code>Call</code> or
<code>Attribute</code> will not be considered atomic and will return <code>False</code> unless <code>pars=True</code> and grouping
parentheses present, in which case <code>'pars'</code> is returned.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>True</code>: Is atomic and no combination of changes in the source will make it parse to a different node.</li>
<li><code>'unenclosable'</code>: Is atomic precedence-wise but may be made non-parsable by being spread over multiple lines.</li>
<li><code>'pars'</code>: Is atomic due to enclosing grouping parentheses and would not be otherwise, can not be returned for
<code>'unenclosable'</code> nodes if <code>always_enclosed=False</code>.</li>
<li><code>False</code>: Not atomic.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_atom</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a + b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_atom</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a + b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_atom</span><span class="p">()</span>
<span class="s1">&#39;pars&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a + b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_atom</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a.b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_atom</span><span class="p">()</span>
<span class="s1">&#39;unenclosable&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a.b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_atom</span><span class="p">(</span><span class="n">always_enclosed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># because of &quot;a\n.b&quot;</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a.b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_atom</span><span class="p">(</span><span class="n">always_enclosed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="s1">&#39;pars&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_atom</span><span class="p">(</span><span class="n">always_enclosed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># because List is always enclosed</span>
<span class="kc">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_enclosed" class="classattr">
                                        <input id="FST.is_enclosed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_enclosed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">pars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pars&#39;</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="FST.is_enclosed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_enclosed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_enclosed-2919"><a href="#FST.is_enclosed-2919"><span class="linenos">2919</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pars&#39;</span><span class="p">]:</span>
</span><span id="FST.is_enclosed-2920"><a href="#FST.is_enclosed-2920"><span class="linenos">2920</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` lives on a single line or is otherwise enclosed in some kind of delimiters `()`, `[]`, `{}` or</span>
</span><span id="FST.is_enclosed-2921"><a href="#FST.is_enclosed-2921"><span class="linenos">2921</span></a><span class="sd">        entirely terminated with line continuations so that it can be parsed without error due to being spread across</span>
</span><span id="FST.is_enclosed-2922"><a href="#FST.is_enclosed-2922"><span class="linenos">2922</span></a><span class="sd">        multiple lines. This does not mean it can&#39;t have other errors, such as a `Slice` outside of `Subscript.slice`.</span>
</span><span id="FST.is_enclosed-2923"><a href="#FST.is_enclosed-2923"><span class="linenos">2923</span></a>
</span><span id="FST.is_enclosed-2924"><a href="#FST.is_enclosed-2924"><span class="linenos">2924</span></a><span class="sd">        Node types where this doesn&#39;t normally apply like `stmt`, `ExceptHandler`, `boolop`, `expr_context`, etc...</span>
</span><span id="FST.is_enclosed-2925"><a href="#FST.is_enclosed-2925"><span class="linenos">2925</span></a><span class="sd">        return `True`. Node types that are not enclosed but which are never used without being enclosed by a parent like</span>
</span><span id="FST.is_enclosed-2926"><a href="#FST.is_enclosed-2926"><span class="linenos">2926</span></a><span class="sd">        `Slice`, `keyword` or `type_param` will also return `True`. Other node types which cannot be enclosed</span>
</span><span id="FST.is_enclosed-2927"><a href="#FST.is_enclosed-2927"><span class="linenos">2927</span></a><span class="sd">        individually and are not on a single line or not parenthesized and do not have line continuations but would need</span>
</span><span id="FST.is_enclosed-2928"><a href="#FST.is_enclosed-2928"><span class="linenos">2928</span></a><span class="sd">        a parent to enclose them like `arguments` or the `cmpop`s `is not` or `not in` will return `False`.</span>
</span><span id="FST.is_enclosed-2929"><a href="#FST.is_enclosed-2929"><span class="linenos">2929</span></a>
</span><span id="FST.is_enclosed-2930"><a href="#FST.is_enclosed-2930"><span class="linenos">2930</span></a><span class="sd">        This function does NOT check whether `self` is enclosed by some parent up the tree if it is not enclosed itself,</span>
</span><span id="FST.is_enclosed-2931"><a href="#FST.is_enclosed-2931"><span class="linenos">2931</span></a><span class="sd">        for that see `is_enclosed_in_parents()`.</span>
</span><span id="FST.is_enclosed-2932"><a href="#FST.is_enclosed-2932"><span class="linenos">2932</span></a>
</span><span id="FST.is_enclosed-2933"><a href="#FST.is_enclosed-2933"><span class="linenos">2933</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.is_enclosed-2934"><a href="#FST.is_enclosed-2934"><span class="linenos">2934</span></a><span class="sd">        - `pars`: Whether to check for grouping parentheses or not for nodes which are not enclosed or otherwise</span>
</span><span id="FST.is_enclosed-2935"><a href="#FST.is_enclosed-2935"><span class="linenos">2935</span></a><span class="sd">            multiline-safe. Grouping parentheses are different from tuple parentheses which are always checked.</span>
</span><span id="FST.is_enclosed-2936"><a href="#FST.is_enclosed-2936"><span class="linenos">2936</span></a>
</span><span id="FST.is_enclosed-2937"><a href="#FST.is_enclosed-2937"><span class="linenos">2937</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_enclosed-2938"><a href="#FST.is_enclosed-2938"><span class="linenos">2938</span></a><span class="sd">        - `True`: Mode is enclosed.</span>
</span><span id="FST.is_enclosed-2939"><a href="#FST.is_enclosed-2939"><span class="linenos">2939</span></a><span class="sd">        - `&#39;pars&#39;` Enclosed by grouping parentheses and would not be otherwise.</span>
</span><span id="FST.is_enclosed-2940"><a href="#FST.is_enclosed-2940"><span class="linenos">2940</span></a><span class="sd">        - `False`: Not enclosed and should be parenthesized or put into an enclosed parent for successful parse.</span>
</span><span id="FST.is_enclosed-2941"><a href="#FST.is_enclosed-2941"><span class="linenos">2941</span></a>
</span><span id="FST.is_enclosed-2942"><a href="#FST.is_enclosed-2942"><span class="linenos">2942</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_enclosed-2943"><a href="#FST.is_enclosed-2943"><span class="linenos">2943</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_enclosed-2944"><a href="#FST.is_enclosed-2944"><span class="linenos">2944</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a&#39;).is_enclosed()</span>
</span><span id="FST.is_enclosed-2945"><a href="#FST.is_enclosed-2945"><span class="linenos">2945</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed-2946"><a href="#FST.is_enclosed-2946"><span class="linenos">2946</span></a>
</span><span id="FST.is_enclosed-2947"><a href="#FST.is_enclosed-2947"><span class="linenos">2947</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + \\\n b&#39;).is_enclosed()  # because of the line continuation</span>
</span><span id="FST.is_enclosed-2948"><a href="#FST.is_enclosed-2948"><span class="linenos">2948</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed-2949"><a href="#FST.is_enclosed-2949"><span class="linenos">2949</span></a>
</span><span id="FST.is_enclosed-2950"><a href="#FST.is_enclosed-2950"><span class="linenos">2950</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a + \n b)&#39;).is_enclosed()</span>
</span><span id="FST.is_enclosed-2951"><a href="#FST.is_enclosed-2951"><span class="linenos">2951</span></a><span class="sd">        &#39;pars&#39;</span>
</span><span id="FST.is_enclosed-2952"><a href="#FST.is_enclosed-2952"><span class="linenos">2952</span></a>
</span><span id="FST.is_enclosed-2953"><a href="#FST.is_enclosed-2953"><span class="linenos">2953</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;a + \n b&#39;).is_enclosed()</span>
</span><span id="FST.is_enclosed-2954"><a href="#FST.is_enclosed-2954"><span class="linenos">2954</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed-2955"><a href="#FST.is_enclosed-2955"><span class="linenos">2955</span></a>
</span><span id="FST.is_enclosed-2956"><a href="#FST.is_enclosed-2956"><span class="linenos">2956</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[a + \n b]&#39;).elts[0].is_enclosed()</span>
</span><span id="FST.is_enclosed-2957"><a href="#FST.is_enclosed-2957"><span class="linenos">2957</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed-2958"><a href="#FST.is_enclosed-2958"><span class="linenos">2958</span></a>
</span><span id="FST.is_enclosed-2959"><a href="#FST.is_enclosed-2959"><span class="linenos">2959</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[a + \n b]&#39;).elts[0].is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed-2960"><a href="#FST.is_enclosed-2960"><span class="linenos">2960</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed-2961"><a href="#FST.is_enclosed-2961"><span class="linenos">2961</span></a>
</span><span id="FST.is_enclosed-2962"><a href="#FST.is_enclosed-2962"><span class="linenos">2962</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a, b): pass&#39;).args.is_enclosed()</span>
</span><span id="FST.is_enclosed-2963"><a href="#FST.is_enclosed-2963"><span class="linenos">2963</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed-2964"><a href="#FST.is_enclosed-2964"><span class="linenos">2964</span></a>
</span><span id="FST.is_enclosed-2965"><a href="#FST.is_enclosed-2965"><span class="linenos">2965</span></a><span class="sd">        &gt;&gt;&gt; # because the parentheses belong to the FunctionDef</span>
</span><span id="FST.is_enclosed-2966"><a href="#FST.is_enclosed-2966"><span class="linenos">2966</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a,\n b): pass&#39;).args.is_enclosed()</span>
</span><span id="FST.is_enclosed-2967"><a href="#FST.is_enclosed-2967"><span class="linenos">2967</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed-2968"><a href="#FST.is_enclosed-2968"><span class="linenos">2968</span></a>
</span><span id="FST.is_enclosed-2969"><a href="#FST.is_enclosed-2969"><span class="linenos">2969</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;def f(a,\n b): pass&#39;).args.is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed-2970"><a href="#FST.is_enclosed-2970"><span class="linenos">2970</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed-2971"><a href="#FST.is_enclosed-2971"><span class="linenos">2971</span></a>
</span><span id="FST.is_enclosed-2972"><a href="#FST.is_enclosed-2972"><span class="linenos">2972</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a is not b)&#39;).ops[0].is_enclosed()</span>
</span><span id="FST.is_enclosed-2973"><a href="#FST.is_enclosed-2973"><span class="linenos">2973</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed-2974"><a href="#FST.is_enclosed-2974"><span class="linenos">2974</span></a>
</span><span id="FST.is_enclosed-2975"><a href="#FST.is_enclosed-2975"><span class="linenos">2975</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(a is \n not b)&#39;).ops[0].is_enclosed()</span>
</span><span id="FST.is_enclosed-2976"><a href="#FST.is_enclosed-2976"><span class="linenos">2976</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed-2977"><a href="#FST.is_enclosed-2977"><span class="linenos">2977</span></a><span class="sd">        ```</span>
</span><span id="FST.is_enclosed-2978"><a href="#FST.is_enclosed-2978"><span class="linenos">2978</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_enclosed-2979"><a href="#FST.is_enclosed-2979"><span class="linenos">2979</span></a>
</span><span id="FST.is_enclosed-2980"><a href="#FST.is_enclosed-2980"><span class="linenos">2980</span></a>        <span class="n">ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.is_enclosed-2981"><a href="#FST.is_enclosed-2981"><span class="linenos">2981</span></a>
</span><span id="FST.is_enclosed-2982"><a href="#FST.is_enclosed-2982"><span class="linenos">2982</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span> <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">,</span>
</span><span id="FST.is_enclosed-2983"><a href="#FST.is_enclosed-2983"><span class="linenos">2983</span></a>                            <span class="n">Name</span><span class="p">,</span> <span class="n">Slice</span><span class="p">,</span>
</span><span id="FST.is_enclosed-2984"><a href="#FST.is_enclosed-2984"><span class="linenos">2984</span></a>                            <span class="n">MatchValue</span><span class="p">,</span> <span class="n">MatchSingleton</span><span class="p">,</span> <span class="n">MatchMapping</span><span class="p">,</span>
</span><span id="FST.is_enclosed-2985"><a href="#FST.is_enclosed-2985"><span class="linenos">2985</span></a>                            <span class="n">expr_context</span><span class="p">,</span> <span class="n">boolop</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">unaryop</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">type_param</span><span class="p">,</span>
</span><span id="FST.is_enclosed-2986"><a href="#FST.is_enclosed-2986"><span class="linenos">2986</span></a>                            <span class="n">stmt</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="FST.is_enclosed-2987"><a href="#FST.is_enclosed-2987"><span class="linenos">2987</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed-2988"><a href="#FST.is_enclosed-2988"><span class="linenos">2988</span></a>
</span><span id="FST.is_enclosed-2989"><a href="#FST.is_enclosed-2989"><span class="linenos">2989</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">):</span>  <span class="c1"># this catches empty `arguments` mostly</span>
</span><span id="FST.is_enclosed-2990"><a href="#FST.is_enclosed-2990"><span class="linenos">2990</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed-2991"><a href="#FST.is_enclosed-2991"><span class="linenos">2991</span></a>
</span><span id="FST.is_enclosed-2992"><a href="#FST.is_enclosed-2992"><span class="linenos">2992</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="n">loc</span>
</span><span id="FST.is_enclosed-2993"><a href="#FST.is_enclosed-2993"><span class="linenos">2993</span></a>
</span><span id="FST.is_enclosed-2994"><a href="#FST.is_enclosed-2994"><span class="linenos">2994</span></a>        <span class="k">if</span> <span class="n">end_ln</span> <span class="o">==</span> <span class="n">ln</span><span class="p">:</span>
</span><span id="FST.is_enclosed-2995"><a href="#FST.is_enclosed-2995"><span class="linenos">2995</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed-2996"><a href="#FST.is_enclosed-2996"><span class="linenos">2996</span></a>
</span><span id="FST.is_enclosed-2997"><a href="#FST.is_enclosed-2997"><span class="linenos">2997</span></a>        <span class="k">if</span> <span class="n">pars</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
</span><span id="FST.is_enclosed-2998"><a href="#FST.is_enclosed-2998"><span class="linenos">2998</span></a>            <span class="k">return</span> <span class="s1">&#39;pars&#39;</span>
</span><span id="FST.is_enclosed-2999"><a href="#FST.is_enclosed-2999"><span class="linenos">2999</span></a>
</span><span id="FST.is_enclosed-3000"><a href="#FST.is_enclosed-3000"><span class="linenos">3000</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="FST.is_enclosed-3001"><a href="#FST.is_enclosed-3001"><span class="linenos">3001</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
</span><span id="FST.is_enclosed-3002"><a href="#FST.is_enclosed-3002"><span class="linenos">3002</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed-3003"><a href="#FST.is_enclosed-3003"><span class="linenos">3003</span></a>
</span><span id="FST.is_enclosed-3004"><a href="#FST.is_enclosed-3004"><span class="linenos">3004</span></a>            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_multiline_str_continuation_lns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">))</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="o">-</span> <span class="n">ln</span>
</span><span id="FST.is_enclosed-3005"><a href="#FST.is_enclosed-3005"><span class="linenos">3005</span></a>
</span><span id="FST.is_enclosed-3006"><a href="#FST.is_enclosed-3006"><span class="linenos">3006</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="p">(</span><span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">)):</span>
</span><span id="FST.is_enclosed-3007"><a href="#FST.is_enclosed-3007"><span class="linenos">3007</span></a>            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_multiline_fstr_continuation_lns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">,</span> <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">,</span> <span class="n">end_col</span><span class="p">))</span> <span class="o">==</span> <span class="n">end_ln</span> <span class="o">-</span> <span class="n">ln</span>
</span><span id="FST.is_enclosed-3008"><a href="#FST.is_enclosed-3008"><span class="linenos">3008</span></a>
</span><span id="FST.is_enclosed-3009"><a href="#FST.is_enclosed-3009"><span class="linenos">3009</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_enclosed-3010"><a href="#FST.is_enclosed-3010"><span class="linenos">3010</span></a>            <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="FST.is_enclosed-3011"><a href="#FST.is_enclosed-3011"><span class="linenos">3011</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed-3012"><a href="#FST.is_enclosed-3012"><span class="linenos">3012</span></a>
</span><span id="FST.is_enclosed-3013"><a href="#FST.is_enclosed-3013"><span class="linenos">3013</span></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_enclosed-3014"><a href="#FST.is_enclosed-3014"><span class="linenos">3014</span></a>            <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="FST.is_enclosed-3015"><a href="#FST.is_enclosed-3015"><span class="linenos">3015</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed-3016"><a href="#FST.is_enclosed-3016"><span class="linenos">3016</span></a>
</span><span id="FST.is_enclosed-3017"><a href="#FST.is_enclosed-3017"><span class="linenos">3017</span></a>        <span class="n">last_ln</span> <span class="o">=</span> <span class="n">ln</span>
</span><span id="FST.is_enclosed-3018"><a href="#FST.is_enclosed-3018"><span class="linenos">3018</span></a>        <span class="n">lines</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span>
</span><span id="FST.is_enclosed-3019"><a href="#FST.is_enclosed-3019"><span class="linenos">3019</span></a>
</span><span id="FST.is_enclosed-3020"><a href="#FST.is_enclosed-3020"><span class="linenos">3020</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Call</span><span class="p">):</span>
</span><span id="FST.is_enclosed-3021"><a href="#FST.is_enclosed-3021"><span class="linenos">3021</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">func</span><span class="p">,</span>
</span><span id="FST.is_enclosed-3022"><a href="#FST.is_enclosed-3022"><span class="linenos">3022</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_Call_pars</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="FST.is_enclosed-3023"><a href="#FST.is_enclosed-3023"><span class="linenos">3023</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">):</span>
</span><span id="FST.is_enclosed-3024"><a href="#FST.is_enclosed-3024"><span class="linenos">3024</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="FST.is_enclosed-3025"><a href="#FST.is_enclosed-3025"><span class="linenos">3025</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_Subscript_brackets</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="FST.is_enclosed-3026"><a href="#FST.is_enclosed-3026"><span class="linenos">3026</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">):</span>
</span><span id="FST.is_enclosed-3027"><a href="#FST.is_enclosed-3027"><span class="linenos">3027</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">cls</span><span class="p">,</span>
</span><span id="FST.is_enclosed-3028"><a href="#FST.is_enclosed-3028"><span class="linenos">3028</span></a>                        <span class="n">nspace</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">nspace</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loc_MatchClass_pars</span><span class="p">(),</span> <span class="n">is_enclosed</span><span class="o">=</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="kc">True</span><span class="p">))]</span>
</span><span id="FST.is_enclosed-3029"><a href="#FST.is_enclosed-3029"><span class="linenos">3029</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># we don&#39;t check always-enclosed statement fields here because statements will never get here</span>
</span><span id="FST.is_enclosed-3030"><a href="#FST.is_enclosed-3030"><span class="linenos">3030</span></a>            <span class="n">children</span> <span class="o">=</span> <span class="n">syntax_ordered_children</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span>
</span><span id="FST.is_enclosed-3031"><a href="#FST.is_enclosed-3031"><span class="linenos">3031</span></a>
</span><span id="FST.is_enclosed-3032"><a href="#FST.is_enclosed-3032"><span class="linenos">3032</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
</span><span id="FST.is_enclosed-3033"><a href="#FST.is_enclosed-3033"><span class="linenos">3033</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">loc</span> <span class="o">:=</span> <span class="p">(</span><span class="n">childf</span> <span class="o">:=</span> <span class="n">child</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">pars</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="n">child_end_ln</span> <span class="o">:=</span> <span class="n">loc</span><span class="o">.</span><span class="n">end_ln</span><span class="p">)</span> <span class="o">==</span> <span class="n">last_ln</span><span class="p">:</span>
</span><span id="FST.is_enclosed-3034"><a href="#FST.is_enclosed-3034"><span class="linenos">3034</span></a>                <span class="k">continue</span>
</span><span id="FST.is_enclosed-3035"><a href="#FST.is_enclosed-3035"><span class="linenos">3035</span></a>
</span><span id="FST.is_enclosed-3036"><a href="#FST.is_enclosed-3036"><span class="linenos">3036</span></a>            <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_ln</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">ln</span><span class="p">):</span>
</span><span id="FST.is_enclosed-3037"><a href="#FST.is_enclosed-3037"><span class="linenos">3037</span></a>                <span class="k">if</span> <span class="n">re_line_end_cont_or_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="FST.is_enclosed-3038"><a href="#FST.is_enclosed-3038"><span class="linenos">3038</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_enclosed-3039"><a href="#FST.is_enclosed-3039"><span class="linenos">3039</span></a>
</span><span id="FST.is_enclosed-3040"><a href="#FST.is_enclosed-3040"><span class="linenos">3040</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">childf</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="FST.is_enclosed-3041"><a href="#FST.is_enclosed-3041"><span class="linenos">3041</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_enclosed-3042"><a href="#FST.is_enclosed-3042"><span class="linenos">3042</span></a>
</span><span id="FST.is_enclosed-3043"><a href="#FST.is_enclosed-3043"><span class="linenos">3043</span></a>            <span class="n">last_ln</span> <span class="o">=</span> <span class="n">child_end_ln</span>
</span><span id="FST.is_enclosed-3044"><a href="#FST.is_enclosed-3044"><span class="linenos">3044</span></a>
</span><span id="FST.is_enclosed-3045"><a href="#FST.is_enclosed-3045"><span class="linenos">3045</span></a>        <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_ln</span><span class="p">,</span> <span class="n">end_ln</span><span class="p">):</span>  <span class="c1"># tail</span>
</span><span id="FST.is_enclosed-3046"><a href="#FST.is_enclosed-3046"><span class="linenos">3046</span></a>            <span class="k">if</span> <span class="n">re_line_end_cont_or_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">ln</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="FST.is_enclosed-3047"><a href="#FST.is_enclosed-3047"><span class="linenos">3047</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_enclosed-3048"><a href="#FST.is_enclosed-3048"><span class="linenos">3048</span></a>
</span><span id="FST.is_enclosed-3049"><a href="#FST.is_enclosed-3049"><span class="linenos">3049</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> lives on a single line or is otherwise enclosed in some kind of delimiters <code>()</code>, <code>[]</code>, <code>{}</code> or
entirely terminated with line continuations so that it can be parsed without error due to being spread across
multiple lines. This does not mean it can't have other errors, such as a <code>Slice</code> outside of <code>Subscript.slice</code>.</p>

<p>Node types where this doesn't normally apply like <code>stmt</code>, <code>ExceptHandler</code>, <code>boolop</code>, <code>expr_context</code>, etc...
return <code>True</code>. Node types that are not enclosed but which are never used without being enclosed by a parent like
<code>Slice</code>, <code>keyword</code> or <code>type_param</code> will also return <code>True</code>. Other node types which cannot be enclosed
individually and are not on a single line or not parenthesized and do not have line continuations but would need
a parent to enclose them like <code>arguments</code> or the <code>cmpop</code>s <code>is not</code> or <code>not in</code> will return <code>False</code>.</p>

<p>This function does NOT check whether <code>self</code> is enclosed by some parent up the tree if it is not enclosed itself,
for that see <code><a href="#FST.is_enclosed_in_parents">is_enclosed_in_parents()</a></code>.</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code><a href="#FST.pars">pars</a></code>: Whether to check for grouping parentheses or not for nodes which are not enclosed or otherwise
multiline-safe. Grouping parentheses are different from tuple parentheses which are always checked.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>True</code>: Mode is enclosed.</li>
<li><code>'pars'</code> Enclosed by grouping parentheses and would not be otherwise.</li>
<li><code>False</code>: Not enclosed and should be parenthesized or put into an enclosed parent for successful parse.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a + </span><span class="se">\\\n</span><span class="s1"> b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>  <span class="c1"># because of the line continuation</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a + </span><span class="se">\n</span><span class="s1"> b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>
<span class="s1">&#39;pars&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;a + </span><span class="se">\n</span><span class="s1"> b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[a + </span><span class="se">\n</span><span class="s1"> b]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[a + </span><span class="se">\n</span><span class="s1"> b]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(a, b): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="c1"># because the parentheses belong to the FunctionDef</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(a,</span><span class="se">\n</span><span class="s1"> b): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;def f(a,</span><span class="se">\n</span><span class="s1"> b): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a is not b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(a is </span><span class="se">\n</span><span class="s1"> not b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_enclosed</span><span class="p">()</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_enclosed_in_parents" class="classattr">
                                        <input id="FST.is_enclosed_in_parents-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_enclosed_in_parents</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.is_enclosed_in_parents-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_enclosed_in_parents"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_enclosed_in_parents-3051"><a href="#FST.is_enclosed_in_parents-3051"><span class="linenos">3051</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed_in_parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_enclosed_in_parents-3052"><a href="#FST.is_enclosed_in_parents-3052"><span class="linenos">3052</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is enclosed by some parent up the tree. This is different from `is_enclosed()` as it does not</span>
</span><span id="FST.is_enclosed_in_parents-3053"><a href="#FST.is_enclosed_in_parents-3053"><span class="linenos">3053</span></a><span class="sd">        check for line continuations or anyting like that, just enclosing delimiters like from `Call` or `FunctionDef`</span>
</span><span id="FST.is_enclosed_in_parents-3054"><a href="#FST.is_enclosed_in_parents-3054"><span class="linenos">3054</span></a><span class="sd">        arguments parentheses, `List` brackets, `FormattedValue`, parent grouping parentheses, etc... Statements do not</span>
</span><span id="FST.is_enclosed_in_parents-3055"><a href="#FST.is_enclosed_in_parents-3055"><span class="linenos">3055</span></a><span class="sd">        generally enclose except for a few parts of things like `FunctionDef.args` or `type_params`, `ClassDef.bases`,</span>
</span><span id="FST.is_enclosed_in_parents-3056"><a href="#FST.is_enclosed_in_parents-3056"><span class="linenos">3056</span></a><span class="sd">        etc...</span>
</span><span id="FST.is_enclosed_in_parents-3057"><a href="#FST.is_enclosed_in_parents-3057"><span class="linenos">3057</span></a>
</span><span id="FST.is_enclosed_in_parents-3058"><a href="#FST.is_enclosed_in_parents-3058"><span class="linenos">3058</span></a><span class="sd">        **Parameters:**</span>
</span><span id="FST.is_enclosed_in_parents-3059"><a href="#FST.is_enclosed_in_parents-3059"><span class="linenos">3059</span></a><span class="sd">        - `field`: This is meant to allow check for nonexistent child which would go into this field of `self`. If this</span>
</span><span id="FST.is_enclosed_in_parents-3060"><a href="#FST.is_enclosed_in_parents-3060"><span class="linenos">3060</span></a><span class="sd">            is not `None` then `self` is considered the first parent with an imaginary child being checked at `field`.</span>
</span><span id="FST.is_enclosed_in_parents-3061"><a href="#FST.is_enclosed_in_parents-3061"><span class="linenos">3061</span></a>
</span><span id="FST.is_enclosed_in_parents-3062"><a href="#FST.is_enclosed_in_parents-3062"><span class="linenos">3062</span></a><span class="sd">        **WARNING!** This will not pick up parentheses which belong to `self` and the rules for this can be confusing. E.g.</span>
</span><span id="FST.is_enclosed_in_parents-3063"><a href="#FST.is_enclosed_in_parents-3063"><span class="linenos">3063</span></a><span class="sd">        in `with (x): pass` the parentheses belong to the variable `x` while `with (x as y): pass` they belong to the</span>
</span><span id="FST.is_enclosed_in_parents-3064"><a href="#FST.is_enclosed_in_parents-3064"><span class="linenos">3064</span></a><span class="sd">        `with` because `alias`es cannot be parenthesized.</span>
</span><span id="FST.is_enclosed_in_parents-3065"><a href="#FST.is_enclosed_in_parents-3065"><span class="linenos">3065</span></a>
</span><span id="FST.is_enclosed_in_parents-3066"><a href="#FST.is_enclosed_in_parents-3066"><span class="linenos">3066</span></a><span class="sd">        Will pick up parentheses which belong to `self` if `field` is passed because in that case `self` is considered</span>
</span><span id="FST.is_enclosed_in_parents-3067"><a href="#FST.is_enclosed_in_parents-3067"><span class="linenos">3067</span></a><span class="sd">        the first parent and we are really considering the node which would live at `field`, whether it exists or not.</span>
</span><span id="FST.is_enclosed_in_parents-3068"><a href="#FST.is_enclosed_in_parents-3068"><span class="linenos">3068</span></a>
</span><span id="FST.is_enclosed_in_parents-3069"><a href="#FST.is_enclosed_in_parents-3069"><span class="linenos">3069</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_enclosed_in_parents-3070"><a href="#FST.is_enclosed_in_parents-3070"><span class="linenos">3070</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_enclosed_in_parents-3071"><a href="#FST.is_enclosed_in_parents-3071"><span class="linenos">3071</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1 + 2&#39;).left.is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3072"><a href="#FST.is_enclosed_in_parents-3072"><span class="linenos">3072</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed_in_parents-3073"><a href="#FST.is_enclosed_in_parents-3073"><span class="linenos">3073</span></a>
</span><span id="FST.is_enclosed_in_parents-3074"><a href="#FST.is_enclosed_in_parents-3074"><span class="linenos">3074</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1 + 2)&#39;).left.is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3075"><a href="#FST.is_enclosed_in_parents-3075"><span class="linenos">3075</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_in_parents-3076"><a href="#FST.is_enclosed_in_parents-3076"><span class="linenos">3076</span></a>
</span><span id="FST.is_enclosed_in_parents-3077"><a href="#FST.is_enclosed_in_parents-3077"><span class="linenos">3077</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1 + 2)&#39;).is_enclosed_in_parents()  # because owns the parentheses</span>
</span><span id="FST.is_enclosed_in_parents-3078"><a href="#FST.is_enclosed_in_parents-3078"><span class="linenos">3078</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed_in_parents-3079"><a href="#FST.is_enclosed_in_parents-3079"><span class="linenos">3079</span></a>
</span><span id="FST.is_enclosed_in_parents-3080"><a href="#FST.is_enclosed_in_parents-3080"><span class="linenos">3080</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1 + 2]&#39;).elts[0].left.is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3081"><a href="#FST.is_enclosed_in_parents-3081"><span class="linenos">3081</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_in_parents-3082"><a href="#FST.is_enclosed_in_parents-3082"><span class="linenos">3082</span></a>
</span><span id="FST.is_enclosed_in_parents-3083"><a href="#FST.is_enclosed_in_parents-3083"><span class="linenos">3083</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[1 + 2]&#39;).elts[0].is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3084"><a href="#FST.is_enclosed_in_parents-3084"><span class="linenos">3084</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_in_parents-3085"><a href="#FST.is_enclosed_in_parents-3085"><span class="linenos">3085</span></a>
</span><span id="FST.is_enclosed_in_parents-3086"><a href="#FST.is_enclosed_in_parents-3086"><span class="linenos">3086</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f(1)&#39;).args[0].is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3087"><a href="#FST.is_enclosed_in_parents-3087"><span class="linenos">3087</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_in_parents-3088"><a href="#FST.is_enclosed_in_parents-3088"><span class="linenos">3088</span></a>
</span><span id="FST.is_enclosed_in_parents-3089"><a href="#FST.is_enclosed_in_parents-3089"><span class="linenos">3089</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;f&quot;{1}&quot;&#39;).values[0].value.is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3090"><a href="#FST.is_enclosed_in_parents-3090"><span class="linenos">3090</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_in_parents-3091"><a href="#FST.is_enclosed_in_parents-3091"><span class="linenos">3091</span></a>
</span><span id="FST.is_enclosed_in_parents-3092"><a href="#FST.is_enclosed_in_parents-3092"><span class="linenos">3092</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3093"><a href="#FST.is_enclosed_in_parents-3093"><span class="linenos">3093</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed_in_parents-3094"><a href="#FST.is_enclosed_in_parents-3094"><span class="linenos">3094</span></a>
</span><span id="FST.is_enclosed_in_parents-3095"><a href="#FST.is_enclosed_in_parents-3095"><span class="linenos">3095</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;[]&#39;).is_enclosed_in_parents(field=&#39;elts&#39;)</span>
</span><span id="FST.is_enclosed_in_parents-3096"><a href="#FST.is_enclosed_in_parents-3096"><span class="linenos">3096</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_in_parents-3097"><a href="#FST.is_enclosed_in_parents-3097"><span class="linenos">3097</span></a>
</span><span id="FST.is_enclosed_in_parents-3098"><a href="#FST.is_enclosed_in_parents-3098"><span class="linenos">3098</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;with (x): pass&#39;).items[0].is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3099"><a href="#FST.is_enclosed_in_parents-3099"><span class="linenos">3099</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed_in_parents-3100"><a href="#FST.is_enclosed_in_parents-3100"><span class="linenos">3100</span></a>
</span><span id="FST.is_enclosed_in_parents-3101"><a href="#FST.is_enclosed_in_parents-3101"><span class="linenos">3101</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;with (x as y): pass&#39;).items[0].is_enclosed_in_parents()</span>
</span><span id="FST.is_enclosed_in_parents-3102"><a href="#FST.is_enclosed_in_parents-3102"><span class="linenos">3102</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_in_parents-3103"><a href="#FST.is_enclosed_in_parents-3103"><span class="linenos">3103</span></a><span class="sd">        ```</span>
</span><span id="FST.is_enclosed_in_parents-3104"><a href="#FST.is_enclosed_in_parents-3104"><span class="linenos">3104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_enclosed_in_parents-3105"><a href="#FST.is_enclosed_in_parents-3105"><span class="linenos">3105</span></a>
</span><span id="FST.is_enclosed_in_parents-3106"><a href="#FST.is_enclosed_in_parents-3106"><span class="linenos">3106</span></a>        <span class="k">if</span> <span class="n">field</span><span class="p">:</span>
</span><span id="FST.is_enclosed_in_parents-3107"><a href="#FST.is_enclosed_in_parents-3107"><span class="linenos">3107</span></a>            <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="s1">&#39;ctx&#39;</span><span class="p">:</span>  <span class="c1"># so that the `ctx` of a List is not considered enclosed</span>
</span><span id="FST.is_enclosed_in_parents-3108"><a href="#FST.is_enclosed_in_parents-3108"><span class="linenos">3108</span></a>                <span class="bp">self</span> <span class="o">=</span> <span class="n">nspace</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">pfield</span><span class="o">=</span><span class="n">astfield</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
</span><span id="FST.is_enclosed_in_parents-3109"><a href="#FST.is_enclosed_in_parents-3109"><span class="linenos">3109</span></a>
</span><span id="FST.is_enclosed_in_parents-3110"><a href="#FST.is_enclosed_in_parents-3110"><span class="linenos">3110</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">expr_context</span><span class="p">):</span>  <span class="c1"># so that the `ctx` of a List is not considered enclosed</span>
</span><span id="FST.is_enclosed_in_parents-3111"><a href="#FST.is_enclosed_in_parents-3111"><span class="linenos">3111</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3112"><a href="#FST.is_enclosed_in_parents-3112"><span class="linenos">3112</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_enclosed_in_parents-3113"><a href="#FST.is_enclosed_in_parents-3113"><span class="linenos">3113</span></a>
</span><span id="FST.is_enclosed_in_parents-3114"><a href="#FST.is_enclosed_in_parents-3114"><span class="linenos">3114</span></a>        <span class="k">while</span> <span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
</span><span id="FST.is_enclosed_in_parents-3115"><a href="#FST.is_enclosed_in_parents-3115"><span class="linenos">3115</span></a>            <span class="n">parenta</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span>
</span><span id="FST.is_enclosed_in_parents-3116"><a href="#FST.is_enclosed_in_parents-3116"><span class="linenos">3116</span></a>
</span><span id="FST.is_enclosed_in_parents-3117"><a href="#FST.is_enclosed_in_parents-3117"><span class="linenos">3117</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">ListComp</span><span class="p">,</span> <span class="n">SetComp</span><span class="p">,</span> <span class="n">DictComp</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">,</span>
</span><span id="FST.is_enclosed_in_parents-3118"><a href="#FST.is_enclosed_in_parents-3118"><span class="linenos">3118</span></a>                                    <span class="n">FormattedValue</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">,</span> <span class="n">JoinedStr</span><span class="p">,</span> <span class="n">TemplateStr</span><span class="p">,</span>
</span><span id="FST.is_enclosed_in_parents-3119"><a href="#FST.is_enclosed_in_parents-3119"><span class="linenos">3119</span></a>                                    <span class="n">MatchMapping</span><span class="p">)):</span>
</span><span id="FST.is_enclosed_in_parents-3120"><a href="#FST.is_enclosed_in_parents-3120"><span class="linenos">3120</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed_in_parents-3121"><a href="#FST.is_enclosed_in_parents-3121"><span class="linenos">3121</span></a>
</span><span id="FST.is_enclosed_in_parents-3122"><a href="#FST.is_enclosed_in_parents-3122"><span class="linenos">3122</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">AsyncFunctionDef</span><span class="p">)):</span>
</span><span id="FST.is_enclosed_in_parents-3123"><a href="#FST.is_enclosed_in_parents-3123"><span class="linenos">3123</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span>
</span><span id="FST.is_enclosed_in_parents-3124"><a href="#FST.is_enclosed_in_parents-3124"><span class="linenos">3124</span></a>
</span><span id="FST.is_enclosed_in_parents-3125"><a href="#FST.is_enclosed_in_parents-3125"><span class="linenos">3125</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">ClassDef</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3126"><a href="#FST.is_enclosed_in_parents-3126"><span class="linenos">3126</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;type_params&#39;</span><span class="p">,</span> <span class="s1">&#39;bases&#39;</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">)</span>
</span><span id="FST.is_enclosed_in_parents-3127"><a href="#FST.is_enclosed_in_parents-3127"><span class="linenos">3127</span></a>
</span><span id="FST.is_enclosed_in_parents-3128"><a href="#FST.is_enclosed_in_parents-3128"><span class="linenos">3128</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">TypeAlias</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3129"><a href="#FST.is_enclosed_in_parents-3129"><span class="linenos">3129</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;type_params&#39;</span>
</span><span id="FST.is_enclosed_in_parents-3130"><a href="#FST.is_enclosed_in_parents-3130"><span class="linenos">3130</span></a>
</span><span id="FST.is_enclosed_in_parents-3131"><a href="#FST.is_enclosed_in_parents-3131"><span class="linenos">3131</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">ImportFrom</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3132"><a href="#FST.is_enclosed_in_parents-3132"><span class="linenos">3132</span></a>                <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_is_parenthesized_ImportFrom_names</span><span class="p">()</span>  <span class="c1"># we know we are in `names`</span>
</span><span id="FST.is_enclosed_in_parents-3133"><a href="#FST.is_enclosed_in_parents-3133"><span class="linenos">3133</span></a>
</span><span id="FST.is_enclosed_in_parents-3134"><a href="#FST.is_enclosed_in_parents-3134"><span class="linenos">3134</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">With</span><span class="p">,</span> <span class="n">AsyncWith</span><span class="p">)):</span>
</span><span id="FST.is_enclosed_in_parents-3135"><a href="#FST.is_enclosed_in_parents-3135"><span class="linenos">3135</span></a>                <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">_is_parenthesized_With_items</span><span class="p">()</span>  <span class="c1"># we know we are in `names`</span>
</span><span id="FST.is_enclosed_in_parents-3136"><a href="#FST.is_enclosed_in_parents-3136"><span class="linenos">3136</span></a>
</span><span id="FST.is_enclosed_in_parents-3137"><a href="#FST.is_enclosed_in_parents-3137"><span class="linenos">3137</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">ExceptHandler</span><span class="p">,</span> <span class="n">match_case</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">TypeIgnore</span><span class="p">)):</span>
</span><span id="FST.is_enclosed_in_parents-3138"><a href="#FST.is_enclosed_in_parents-3138"><span class="linenos">3138</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_enclosed_in_parents-3139"><a href="#FST.is_enclosed_in_parents-3139"><span class="linenos">3139</span></a>
</span><span id="FST.is_enclosed_in_parents-3140"><a href="#FST.is_enclosed_in_parents-3140"><span class="linenos">3140</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">Call</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3141"><a href="#FST.is_enclosed_in_parents-3141"><span class="linenos">3141</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;args&#39;</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3142"><a href="#FST.is_enclosed_in_parents-3142"><span class="linenos">3142</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed_in_parents-3143"><a href="#FST.is_enclosed_in_parents-3143"><span class="linenos">3143</span></a>
</span><span id="FST.is_enclosed_in_parents-3144"><a href="#FST.is_enclosed_in_parents-3144"><span class="linenos">3144</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3145"><a href="#FST.is_enclosed_in_parents-3145"><span class="linenos">3145</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;slice&#39;</span><span class="p">:</span>
</span><span id="FST.is_enclosed_in_parents-3146"><a href="#FST.is_enclosed_in_parents-3146"><span class="linenos">3146</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed_in_parents-3147"><a href="#FST.is_enclosed_in_parents-3147"><span class="linenos">3147</span></a>
</span><span id="FST.is_enclosed_in_parents-3148"><a href="#FST.is_enclosed_in_parents-3148"><span class="linenos">3148</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3149"><a href="#FST.is_enclosed_in_parents-3149"><span class="linenos">3149</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">,</span> <span class="s1">&#39;kwd_attrs&#39;</span><span class="p">,</span> <span class="s1">&#39;kwd_patterns&#39;</span><span class="p">):</span>
</span><span id="FST.is_enclosed_in_parents-3150"><a href="#FST.is_enclosed_in_parents-3150"><span class="linenos">3150</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed_in_parents-3151"><a href="#FST.is_enclosed_in_parents-3151"><span class="linenos">3151</span></a>
</span><span id="FST.is_enclosed_in_parents-3152"><a href="#FST.is_enclosed_in_parents-3152"><span class="linenos">3152</span></a>            <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_enclosed_in_parents-3153"><a href="#FST.is_enclosed_in_parents-3153"><span class="linenos">3153</span></a>                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="FST.is_enclosed_in_parents-3154"><a href="#FST.is_enclosed_in_parents-3154"><span class="linenos">3154</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed_in_parents-3155"><a href="#FST.is_enclosed_in_parents-3155"><span class="linenos">3155</span></a>
</span><span id="FST.is_enclosed_in_parents-3156"><a href="#FST.is_enclosed_in_parents-3156"><span class="linenos">3156</span></a>            <span class="k">elif</span> <span class="p">(</span><span class="n">ret</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_enclosed_in_parents-3157"><a href="#FST.is_enclosed_in_parents-3157"><span class="linenos">3157</span></a>                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="FST.is_enclosed_in_parents-3158"><a href="#FST.is_enclosed_in_parents-3158"><span class="linenos">3158</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed_in_parents-3159"><a href="#FST.is_enclosed_in_parents-3159"><span class="linenos">3159</span></a>
</span><span id="FST.is_enclosed_in_parents-3160"><a href="#FST.is_enclosed_in_parents-3160"><span class="linenos">3160</span></a>            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">pars</span><span class="p">(),</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>  <span class="c1"># could be empty args which has None for a loc</span>
</span><span id="FST.is_enclosed_in_parents-3161"><a href="#FST.is_enclosed_in_parents-3161"><span class="linenos">3161</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="FST.is_enclosed_in_parents-3162"><a href="#FST.is_enclosed_in_parents-3162"><span class="linenos">3162</span></a>
</span><span id="FST.is_enclosed_in_parents-3163"><a href="#FST.is_enclosed_in_parents-3163"><span class="linenos">3163</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="FST.is_enclosed_in_parents-3164"><a href="#FST.is_enclosed_in_parents-3164"><span class="linenos">3164</span></a>
</span><span id="FST.is_enclosed_in_parents-3165"><a href="#FST.is_enclosed_in_parents-3165"><span class="linenos">3165</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is enclosed by some parent up the tree. This is different from <code><a href="#FST.is_enclosed">is_enclosed()</a></code> as it does not
check for line continuations or anyting like that, just enclosing delimiters like from <code>Call</code> or <code>FunctionDef</code>
arguments parentheses, <code>List</code> brackets, <code>FormattedValue</code>, parent grouping parentheses, etc... Statements do not
generally enclose except for a few parts of things like <code>FunctionDef.args</code> or <code>type_params</code>, <code>ClassDef.bases</code>,
etc...</p>

<p><strong>Parameters:</strong></p>

<ul>
<li><code>field</code>: This is meant to allow check for nonexistent child which would go into this field of <code>self</code>. If this
is not <code>None</code> then <code>self</code> is considered the first parent with an imaginary child being checked at <code>field</code>.</li>
</ul>

<p><strong>WARNING!</strong> This will not pick up parentheses which belong to <code>self</code> and the rules for this can be confusing. E.g.
in <code>with (x): pass</code> the parentheses belong to the variable <code>x</code> while <code>with (x as y): pass</code> they belong to the
<code>with</code> because <code>alias</code>es cannot be parenthesized.</p>

<p>Will pick up parentheses which belong to <code>self</code> if <code>field</code> is passed because in that case <code>self</code> is considered
the first parent and we are really considering the node which would live at <code>field</code>, whether it exists or not.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;1 + 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(1 + 2)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(1 + 2)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>  <span class="c1"># because owns the parentheses</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[1 + 2]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[1 + 2]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;f(1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;f&quot;</span><span class="si">{1}</span><span class="s1">&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;elts&#39;</span><span class="p">)</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;with (x): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;with (x as y): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_enclosed_in_parents</span><span class="p">()</span>
<span class="kc">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_parenthesized_tuple" class="classattr">
                                        <input id="FST.is_parenthesized_tuple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_parenthesized_tuple</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.is_parenthesized_tuple-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_parenthesized_tuple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_parenthesized_tuple-3167"><a href="#FST.is_parenthesized_tuple-3167"><span class="linenos">3167</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_parenthesized_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_parenthesized_tuple-3168"><a href="#FST.is_parenthesized_tuple-3168"><span class="linenos">3168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a parenthesized `Tuple` or not, or not a `Tuple` at all.</span>
</span><span id="FST.is_parenthesized_tuple-3169"><a href="#FST.is_parenthesized_tuple-3169"><span class="linenos">3169</span></a>
</span><span id="FST.is_parenthesized_tuple-3170"><a href="#FST.is_parenthesized_tuple-3170"><span class="linenos">3170</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_parenthesized_tuple-3171"><a href="#FST.is_parenthesized_tuple-3171"><span class="linenos">3171</span></a><span class="sd">        - `True` if is parenthesized `Tuple`, `False` if is unparenthesized `Tuple`, `None` if is not `Tuple` at all.</span>
</span><span id="FST.is_parenthesized_tuple-3172"><a href="#FST.is_parenthesized_tuple-3172"><span class="linenos">3172</span></a>
</span><span id="FST.is_parenthesized_tuple-3173"><a href="#FST.is_parenthesized_tuple-3173"><span class="linenos">3173</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_parenthesized_tuple-3174"><a href="#FST.is_parenthesized_tuple-3174"><span class="linenos">3174</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_parenthesized_tuple-3175"><a href="#FST.is_parenthesized_tuple-3175"><span class="linenos">3175</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;1, 2&#39;).is_parenthesized_tuple()</span>
</span><span id="FST.is_parenthesized_tuple-3176"><a href="#FST.is_parenthesized_tuple-3176"><span class="linenos">3176</span></a><span class="sd">        False</span>
</span><span id="FST.is_parenthesized_tuple-3177"><a href="#FST.is_parenthesized_tuple-3177"><span class="linenos">3177</span></a>
</span><span id="FST.is_parenthesized_tuple-3178"><a href="#FST.is_parenthesized_tuple-3178"><span class="linenos">3178</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;(1, 2)&#39;).is_parenthesized_tuple()</span>
</span><span id="FST.is_parenthesized_tuple-3179"><a href="#FST.is_parenthesized_tuple-3179"><span class="linenos">3179</span></a><span class="sd">        True</span>
</span><span id="FST.is_parenthesized_tuple-3180"><a href="#FST.is_parenthesized_tuple-3180"><span class="linenos">3180</span></a>
</span><span id="FST.is_parenthesized_tuple-3181"><a href="#FST.is_parenthesized_tuple-3181"><span class="linenos">3181</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;1&#39;).is_parenthesized_tuple())</span>
</span><span id="FST.is_parenthesized_tuple-3182"><a href="#FST.is_parenthesized_tuple-3182"><span class="linenos">3182</span></a><span class="sd">        None</span>
</span><span id="FST.is_parenthesized_tuple-3183"><a href="#FST.is_parenthesized_tuple-3183"><span class="linenos">3183</span></a><span class="sd">        ```</span>
</span><span id="FST.is_parenthesized_tuple-3184"><a href="#FST.is_parenthesized_tuple-3184"><span class="linenos">3184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_parenthesized_tuple-3185"><a href="#FST.is_parenthesized_tuple-3185"><span class="linenos">3185</span></a>
</span><span id="FST.is_parenthesized_tuple-3186"><a href="#FST.is_parenthesized_tuple-3186"><span class="linenos">3186</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is a parenthesized <code>Tuple</code> or not, or not a <code>Tuple</code> at all.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>True</code> if is parenthesized <code>Tuple</code>, <code>False</code> if is unparenthesized <code>Tuple</code>, <code>None</code> if is not <code>Tuple</code> at all.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;1, 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;(1, 2)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_parenthesized_tuple</span><span class="p">())</span>
<span class="kc">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_enclosed_matchseq" class="classattr">
                                        <input id="FST.is_enclosed_matchseq-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_enclosed_matchseq</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.is_enclosed_matchseq-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_enclosed_matchseq"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_enclosed_matchseq-3188"><a href="#FST.is_enclosed_matchseq-3188"><span class="linenos">3188</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_enclosed_matchseq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_enclosed_matchseq-3189"><a href="#FST.is_enclosed_matchseq-3189"><span class="linenos">3189</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is an enclosed `MatchSequence` or not, or not a `MatchSequence` at all (can be pars `()` or</span>
</span><span id="FST.is_enclosed_matchseq-3190"><a href="#FST.is_enclosed_matchseq-3190"><span class="linenos">3190</span></a><span class="sd">        brackets `[]`).</span>
</span><span id="FST.is_enclosed_matchseq-3191"><a href="#FST.is_enclosed_matchseq-3191"><span class="linenos">3191</span></a>
</span><span id="FST.is_enclosed_matchseq-3192"><a href="#FST.is_enclosed_matchseq-3192"><span class="linenos">3192</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_enclosed_matchseq-3193"><a href="#FST.is_enclosed_matchseq-3193"><span class="linenos">3193</span></a><span class="sd">        - `True` if is enclosed `MatchSequence`, `False` if is unparenthesized `MatchSequence`, `None` if is not</span>
</span><span id="FST.is_enclosed_matchseq-3194"><a href="#FST.is_enclosed_matchseq-3194"><span class="linenos">3194</span></a><span class="sd">            `MatchSequence` at all.</span>
</span><span id="FST.is_enclosed_matchseq-3195"><a href="#FST.is_enclosed_matchseq-3195"><span class="linenos">3195</span></a>
</span><span id="FST.is_enclosed_matchseq-3196"><a href="#FST.is_enclosed_matchseq-3196"><span class="linenos">3196</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_enclosed_matchseq-3197"><a href="#FST.is_enclosed_matchseq-3197"><span class="linenos">3197</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_enclosed_matchseq-3198"><a href="#FST.is_enclosed_matchseq-3198"><span class="linenos">3198</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case 1, 2: pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="FST.is_enclosed_matchseq-3199"><a href="#FST.is_enclosed_matchseq-3199"><span class="linenos">3199</span></a><span class="sd">        False</span>
</span><span id="FST.is_enclosed_matchseq-3200"><a href="#FST.is_enclosed_matchseq-3200"><span class="linenos">3200</span></a>
</span><span id="FST.is_enclosed_matchseq-3201"><a href="#FST.is_enclosed_matchseq-3201"><span class="linenos">3201</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case [1, 2]: pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="FST.is_enclosed_matchseq-3202"><a href="#FST.is_enclosed_matchseq-3202"><span class="linenos">3202</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_matchseq-3203"><a href="#FST.is_enclosed_matchseq-3203"><span class="linenos">3203</span></a>
</span><span id="FST.is_enclosed_matchseq-3204"><a href="#FST.is_enclosed_matchseq-3204"><span class="linenos">3204</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;match a:\n  case (1, 2): pass&#39;).cases[0].pattern.is_enclosed_matchseq()</span>
</span><span id="FST.is_enclosed_matchseq-3205"><a href="#FST.is_enclosed_matchseq-3205"><span class="linenos">3205</span></a><span class="sd">        True</span>
</span><span id="FST.is_enclosed_matchseq-3206"><a href="#FST.is_enclosed_matchseq-3206"><span class="linenos">3206</span></a>
</span><span id="FST.is_enclosed_matchseq-3207"><a href="#FST.is_enclosed_matchseq-3207"><span class="linenos">3207</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;match a:\n  case 1: pass&#39;).cases[0].pattern.is_enclosed_matchseq())</span>
</span><span id="FST.is_enclosed_matchseq-3208"><a href="#FST.is_enclosed_matchseq-3208"><span class="linenos">3208</span></a><span class="sd">        None</span>
</span><span id="FST.is_enclosed_matchseq-3209"><a href="#FST.is_enclosed_matchseq-3209"><span class="linenos">3209</span></a><span class="sd">        ```</span>
</span><span id="FST.is_enclosed_matchseq-3210"><a href="#FST.is_enclosed_matchseq-3210"><span class="linenos">3210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_enclosed_matchseq-3211"><a href="#FST.is_enclosed_matchseq-3211"><span class="linenos">3211</span></a>
</span><span id="FST.is_enclosed_matchseq-3212"><a href="#FST.is_enclosed_matchseq-3212"><span class="linenos">3212</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchSequence</span><span class="p">):</span>
</span><span id="FST.is_enclosed_matchseq-3213"><a href="#FST.is_enclosed_matchseq-3213"><span class="linenos">3213</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.is_enclosed_matchseq-3214"><a href="#FST.is_enclosed_matchseq-3214"><span class="linenos">3214</span></a>
</span><span id="FST.is_enclosed_matchseq-3215"><a href="#FST.is_enclosed_matchseq-3215"><span class="linenos">3215</span></a>        <span class="n">ln</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span>
</span><span id="FST.is_enclosed_matchseq-3216"><a href="#FST.is_enclosed_matchseq-3216"><span class="linenos">3216</span></a>        <span class="n">lpar</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[</span><span class="n">ln</span><span class="p">][</span><span class="n">col</span> <span class="p">:</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># could be end of line</span>
</span><span id="FST.is_enclosed_matchseq-3217"><a href="#FST.is_enclosed_matchseq-3217"><span class="linenos">3217</span></a>
</span><span id="FST.is_enclosed_matchseq-3218"><a href="#FST.is_enclosed_matchseq-3218"><span class="linenos">3218</span></a>        <span class="k">if</span> <span class="n">lpar</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
</span><span id="FST.is_enclosed_matchseq-3219"><a href="#FST.is_enclosed_matchseq-3219"><span class="linenos">3219</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">)</span>
</span><span id="FST.is_enclosed_matchseq-3220"><a href="#FST.is_enclosed_matchseq-3220"><span class="linenos">3220</span></a>        <span class="k">if</span> <span class="n">lpar</span> <span class="o">==</span> <span class="s1">&#39;[&#39;</span><span class="p">:</span>
</span><span id="FST.is_enclosed_matchseq-3221"><a href="#FST.is_enclosed_matchseq-3221"><span class="linenos">3221</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized_seq</span><span class="p">(</span><span class="s1">&#39;patterns&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
</span><span id="FST.is_enclosed_matchseq-3222"><a href="#FST.is_enclosed_matchseq-3222"><span class="linenos">3222</span></a>
</span><span id="FST.is_enclosed_matchseq-3223"><a href="#FST.is_enclosed_matchseq-3223"><span class="linenos">3223</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is an enclosed <code>MatchSequence</code> or not, or not a <code>MatchSequence</code> at all (can be pars <code>()</code> or
brackets <code>[]</code>).</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>True</code> if is enclosed <code>MatchSequence</code>, <code>False</code> if is unparenthesized <code>MatchSequence</code>, <code>None</code> if is not
<code>MatchSequence</code> at all.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case 1, 2: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case [1, 2]: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case (1, 2): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case 1: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">is_enclosed_matchseq</span><span class="p">())</span>
<span class="kc">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_empty_set_call" class="classattr">
                                        <input id="FST.is_empty_set_call-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_empty_set_call</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.is_empty_set_call-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_empty_set_call"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_empty_set_call-3225"><a href="#FST.is_empty_set_call-3225"><span class="linenos">3225</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty_set_call</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_empty_set_call-3226"><a href="#FST.is_empty_set_call-3226"><span class="linenos">3226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an empty `set()` call.</span>
</span><span id="FST.is_empty_set_call-3227"><a href="#FST.is_empty_set_call-3227"><span class="linenos">3227</span></a>
</span><span id="FST.is_empty_set_call-3228"><a href="#FST.is_empty_set_call-3228"><span class="linenos">3228</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_empty_set_call-3229"><a href="#FST.is_empty_set_call-3229"><span class="linenos">3229</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_empty_set_call-3230"><a href="#FST.is_empty_set_call-3230"><span class="linenos">3230</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{1}&#39;).is_empty_set_call()</span>
</span><span id="FST.is_empty_set_call-3231"><a href="#FST.is_empty_set_call-3231"><span class="linenos">3231</span></a><span class="sd">        False</span>
</span><span id="FST.is_empty_set_call-3232"><a href="#FST.is_empty_set_call-3232"><span class="linenos">3232</span></a>
</span><span id="FST.is_empty_set_call-3233"><a href="#FST.is_empty_set_call-3233"><span class="linenos">3233</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;set()&#39;).is_empty_set_call()</span>
</span><span id="FST.is_empty_set_call-3234"><a href="#FST.is_empty_set_call-3234"><span class="linenos">3234</span></a><span class="sd">        True</span>
</span><span id="FST.is_empty_set_call-3235"><a href="#FST.is_empty_set_call-3235"><span class="linenos">3235</span></a>
</span><span id="FST.is_empty_set_call-3236"><a href="#FST.is_empty_set_call-3236"><span class="linenos">3236</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;frozenset()&#39;).is_empty_set_call()</span>
</span><span id="FST.is_empty_set_call-3237"><a href="#FST.is_empty_set_call-3237"><span class="linenos">3237</span></a><span class="sd">        False</span>
</span><span id="FST.is_empty_set_call-3238"><a href="#FST.is_empty_set_call-3238"><span class="linenos">3238</span></a>
</span><span id="FST.is_empty_set_call-3239"><a href="#FST.is_empty_set_call-3239"><span class="linenos">3239</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{*()}&#39;).is_empty_set_call()</span>
</span><span id="FST.is_empty_set_call-3240"><a href="#FST.is_empty_set_call-3240"><span class="linenos">3240</span></a><span class="sd">        False</span>
</span><span id="FST.is_empty_set_call-3241"><a href="#FST.is_empty_set_call-3241"><span class="linenos">3241</span></a><span class="sd">        ```</span>
</span><span id="FST.is_empty_set_call-3242"><a href="#FST.is_empty_set_call-3242"><span class="linenos">3242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_empty_set_call-3243"><a href="#FST.is_empty_set_call-3243"><span class="linenos">3243</span></a>
</span><span id="FST.is_empty_set_call-3244"><a href="#FST.is_empty_set_call-3244"><span class="linenos">3244</span></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ast</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span>
</span><span id="FST.is_empty_set_call-3245"><a href="#FST.is_empty_set_call-3245"><span class="linenos">3245</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">func</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s1">&#39;set&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">Load</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is an empty <code>set()</code> call.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty_set_call</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;set()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty_set_call</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;frozenset()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty_set_call</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;{*()}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty_set_call</span><span class="p">()</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_empty_set_seq" class="classattr">
                                        <input id="FST.is_empty_set_seq-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_empty_set_seq</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.is_empty_set_seq-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_empty_set_seq"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_empty_set_seq-3247"><a href="#FST.is_empty_set_seq-3247"><span class="linenos">3247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty_set_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_empty_set_seq-3248"><a href="#FST.is_empty_set_seq-3248"><span class="linenos">3248</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is an empty `Set` from an empty `Starred` `Constant` sequence, recognized are `{*()}`, `{*[]}`</span>
</span><span id="FST.is_empty_set_seq-3249"><a href="#FST.is_empty_set_seq-3249"><span class="linenos">3249</span></a><span class="sd">        and `{*{}}`.</span>
</span><span id="FST.is_empty_set_seq-3250"><a href="#FST.is_empty_set_seq-3250"><span class="linenos">3250</span></a>
</span><span id="FST.is_empty_set_seq-3251"><a href="#FST.is_empty_set_seq-3251"><span class="linenos">3251</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_empty_set_seq-3252"><a href="#FST.is_empty_set_seq-3252"><span class="linenos">3252</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_empty_set_seq-3253"><a href="#FST.is_empty_set_seq-3253"><span class="linenos">3253</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{1}&#39;).is_empty_set_seq()</span>
</span><span id="FST.is_empty_set_seq-3254"><a href="#FST.is_empty_set_seq-3254"><span class="linenos">3254</span></a><span class="sd">        False</span>
</span><span id="FST.is_empty_set_seq-3255"><a href="#FST.is_empty_set_seq-3255"><span class="linenos">3255</span></a>
</span><span id="FST.is_empty_set_seq-3256"><a href="#FST.is_empty_set_seq-3256"><span class="linenos">3256</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;{*()}&#39;).is_empty_set_seq()</span>
</span><span id="FST.is_empty_set_seq-3257"><a href="#FST.is_empty_set_seq-3257"><span class="linenos">3257</span></a><span class="sd">        True</span>
</span><span id="FST.is_empty_set_seq-3258"><a href="#FST.is_empty_set_seq-3258"><span class="linenos">3258</span></a>
</span><span id="FST.is_empty_set_seq-3259"><a href="#FST.is_empty_set_seq-3259"><span class="linenos">3259</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;set()&#39;).is_empty_set_seq()</span>
</span><span id="FST.is_empty_set_seq-3260"><a href="#FST.is_empty_set_seq-3260"><span class="linenos">3260</span></a><span class="sd">        False</span>
</span><span id="FST.is_empty_set_seq-3261"><a href="#FST.is_empty_set_seq-3261"><span class="linenos">3261</span></a><span class="sd">        ```</span>
</span><span id="FST.is_empty_set_seq-3262"><a href="#FST.is_empty_set_seq-3262"><span class="linenos">3262</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_empty_set_seq-3263"><a href="#FST.is_empty_set_seq-3263"><span class="linenos">3263</span></a>
</span><span id="FST.is_empty_set_seq-3264"><a href="#FST.is_empty_set_seq-3264"><span class="linenos">3264</span></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ast</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Set</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">elts</span> <span class="o">:=</span> <span class="n">ast</span><span class="o">.</span><span class="n">elts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e0</span> <span class="o">:=</span> <span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Starred</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST.is_empty_set_seq-3265"><a href="#FST.is_empty_set_seq-3265"><span class="linenos">3265</span></a>                <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="n">e0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">elts</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Dict</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">keys</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is an empty <code>Set</code> from an empty <code>Starred</code> <code>Constant</code> sequence, recognized are <code>{*()}</code>, <code>{*[]}</code>
and <code>{*{}}</code>.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty_set_seq</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;{*()}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty_set_seq</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;set()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty_set_seq</span><span class="p">()</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_elif" class="classattr">
                                        <input id="FST.is_elif-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_elif</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.is_elif-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_elif"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_elif-3267"><a href="#FST.is_elif-3267"><span class="linenos">3267</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_elif</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_elif-3268"><a href="#FST.is_elif-3268"><span class="linenos">3268</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is an `elif` or not, or not an `If` at all.</span>
</span><span id="FST.is_elif-3269"><a href="#FST.is_elif-3269"><span class="linenos">3269</span></a>
</span><span id="FST.is_elif-3270"><a href="#FST.is_elif-3270"><span class="linenos">3270</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_elif-3271"><a href="#FST.is_elif-3271"><span class="linenos">3271</span></a><span class="sd">        - `True` if is `elif` `If`, `False` if is normal `If`, `None` if is not `If` at all.</span>
</span><span id="FST.is_elif-3272"><a href="#FST.is_elif-3272"><span class="linenos">3272</span></a>
</span><span id="FST.is_elif-3273"><a href="#FST.is_elif-3273"><span class="linenos">3273</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_elif-3274"><a href="#FST.is_elif-3274"><span class="linenos">3274</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_elif-3275"><a href="#FST.is_elif-3275"><span class="linenos">3275</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: pass\nelif 2: pass&#39;).orelse[0].is_elif()</span>
</span><span id="FST.is_elif-3276"><a href="#FST.is_elif-3276"><span class="linenos">3276</span></a><span class="sd">        True</span>
</span><span id="FST.is_elif-3277"><a href="#FST.is_elif-3277"><span class="linenos">3277</span></a>
</span><span id="FST.is_elif-3278"><a href="#FST.is_elif-3278"><span class="linenos">3278</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;if 1: pass\nelse:\n  if 2: pass&#39;).orelse[0].is_elif()</span>
</span><span id="FST.is_elif-3279"><a href="#FST.is_elif-3279"><span class="linenos">3279</span></a><span class="sd">        False</span>
</span><span id="FST.is_elif-3280"><a href="#FST.is_elif-3280"><span class="linenos">3280</span></a>
</span><span id="FST.is_elif-3281"><a href="#FST.is_elif-3281"><span class="linenos">3281</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;if 1: pass\nelse:\n  i = 2&#39;).orelse[0].is_elif())</span>
</span><span id="FST.is_elif-3282"><a href="#FST.is_elif-3282"><span class="linenos">3282</span></a><span class="sd">        None</span>
</span><span id="FST.is_elif-3283"><a href="#FST.is_elif-3283"><span class="linenos">3283</span></a><span class="sd">        ```</span>
</span><span id="FST.is_elif-3284"><a href="#FST.is_elif-3284"><span class="linenos">3284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_elif-3285"><a href="#FST.is_elif-3285"><span class="linenos">3285</span></a>
</span><span id="FST.is_elif-3286"><a href="#FST.is_elif-3286"><span class="linenos">3286</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">_lines</span><span class="p">[(</span><span class="n">loc</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span><span class="o">.</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;elif&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">col</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">If</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is an <code>elif</code> or not, or not an <code>If</code> at all.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>True</code> if is <code>elif</code> <code>If</code>, <code>False</code> if is normal <code>If</code>, <code>None</code> if is not <code>If</code> at all.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: pass</span><span class="se">\n</span><span class="s1">elif 2: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_elif</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: pass</span><span class="se">\n</span><span class="s1">else:</span><span class="se">\n</span><span class="s1">  if 2: pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_elif</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;if 1: pass</span><span class="se">\n</span><span class="s1">else:</span><span class="se">\n</span><span class="s1">  i = 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">orelse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_elif</span><span class="p">())</span>
<span class="kc">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_solo_class_base" class="classattr">
                                        <input id="FST.is_solo_class_base-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_solo_class_base</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FST.is_solo_class_base-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_solo_class_base"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_solo_class_base-3288"><a href="#FST.is_solo_class_base-3288"><span class="linenos">3288</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_class_base</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FST.is_solo_class_base-3289"><a href="#FST.is_solo_class_base-3289"><span class="linenos">3289</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `ClassDef` base in list without any keywords, or not a class base at all.</span>
</span><span id="FST.is_solo_class_base-3290"><a href="#FST.is_solo_class_base-3290"><span class="linenos">3290</span></a>
</span><span id="FST.is_solo_class_base-3291"><a href="#FST.is_solo_class_base-3291"><span class="linenos">3291</span></a><span class="sd">        **Returns:**</span>
</span><span id="FST.is_solo_class_base-3292"><a href="#FST.is_solo_class_base-3292"><span class="linenos">3292</span></a><span class="sd">        - `True` if is solo class base, `False` if is class base, but not solo and `None` if is not class base at all.</span>
</span><span id="FST.is_solo_class_base-3293"><a href="#FST.is_solo_class_base-3293"><span class="linenos">3293</span></a>
</span><span id="FST.is_solo_class_base-3294"><a href="#FST.is_solo_class_base-3294"><span class="linenos">3294</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_solo_class_base-3295"><a href="#FST.is_solo_class_base-3295"><span class="linenos">3295</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_solo_class_base-3296"><a href="#FST.is_solo_class_base-3296"><span class="linenos">3296</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="FST.is_solo_class_base-3297"><a href="#FST.is_solo_class_base-3297"><span class="linenos">3297</span></a><span class="sd">        True</span>
</span><span id="FST.is_solo_class_base-3298"><a href="#FST.is_solo_class_base-3298"><span class="linenos">3298</span></a>
</span><span id="FST.is_solo_class_base-3299"><a href="#FST.is_solo_class_base-3299"><span class="linenos">3299</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1, b2): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="FST.is_solo_class_base-3300"><a href="#FST.is_solo_class_base-3300"><span class="linenos">3300</span></a><span class="sd">        False</span>
</span><span id="FST.is_solo_class_base-3301"><a href="#FST.is_solo_class_base-3301"><span class="linenos">3301</span></a>
</span><span id="FST.is_solo_class_base-3302"><a href="#FST.is_solo_class_base-3302"><span class="linenos">3302</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;class cls(b1, meta=m): pass&#39;).bases[0].is_solo_class_base()</span>
</span><span id="FST.is_solo_class_base-3303"><a href="#FST.is_solo_class_base-3303"><span class="linenos">3303</span></a><span class="sd">        False</span>
</span><span id="FST.is_solo_class_base-3304"><a href="#FST.is_solo_class_base-3304"><span class="linenos">3304</span></a>
</span><span id="FST.is_solo_class_base-3305"><a href="#FST.is_solo_class_base-3305"><span class="linenos">3305</span></a><span class="sd">        &gt;&gt;&gt; print(FST(&#39;class cls(b1, meta=m): pass&#39;).keywords[0].is_solo_class_base())</span>
</span><span id="FST.is_solo_class_base-3306"><a href="#FST.is_solo_class_base-3306"><span class="linenos">3306</span></a><span class="sd">        None</span>
</span><span id="FST.is_solo_class_base-3307"><a href="#FST.is_solo_class_base-3307"><span class="linenos">3307</span></a><span class="sd">        ```</span>
</span><span id="FST.is_solo_class_base-3308"><a href="#FST.is_solo_class_base-3308"><span class="linenos">3308</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_solo_class_base-3309"><a href="#FST.is_solo_class_base-3309"><span class="linenos">3309</span></a>
</span><span id="FST.is_solo_class_base-3310"><a href="#FST.is_solo_class_base-3310"><span class="linenos">3310</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;bases&#39;</span><span class="p">:</span>
</span><span id="FST.is_solo_class_base-3311"><a href="#FST.is_solo_class_base-3311"><span class="linenos">3311</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="FST.is_solo_class_base-3312"><a href="#FST.is_solo_class_base-3312"><span class="linenos">3312</span></a>
</span><span id="FST.is_solo_class_base-3313"><a href="#FST.is_solo_class_base-3313"><span class="linenos">3313</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">((</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">bases</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is a solo <code>ClassDef</code> base in list without any keywords, or not a class base at all.</p>

<p><strong>Returns:</strong></p>

<ul>
<li><code>True</code> if is solo class base, <code>False</code> if is class base, but not solo and <code>None</code> if is not class base at all.</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;class cls(b1): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_class_base</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;class cls(b1, b2): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_class_base</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;class cls(b1, meta=m): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_class_base</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;class cls(b1, meta=m): pass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_class_base</span><span class="p">())</span>
<span class="kc">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_solo_call_arg" class="classattr">
                                        <input id="FST.is_solo_call_arg-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_solo_call_arg</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.is_solo_call_arg-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_solo_call_arg"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_solo_call_arg-3315"><a href="#FST.is_solo_call_arg-3315"><span class="linenos">3315</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_call_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_solo_call_arg-3316"><a href="#FST.is_solo_call_arg-3316"><span class="linenos">3316</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `Call` non-keyword argument.</span>
</span><span id="FST.is_solo_call_arg-3317"><a href="#FST.is_solo_call_arg-3317"><span class="linenos">3317</span></a>
</span><span id="FST.is_solo_call_arg-3318"><a href="#FST.is_solo_call_arg-3318"><span class="linenos">3318</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_solo_call_arg-3319"><a href="#FST.is_solo_call_arg-3319"><span class="linenos">3319</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_solo_call_arg-3320"><a href="#FST.is_solo_call_arg-3320"><span class="linenos">3320</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].is_solo_call_arg()</span>
</span><span id="FST.is_solo_call_arg-3321"><a href="#FST.is_solo_call_arg-3321"><span class="linenos">3321</span></a><span class="sd">        True</span>
</span><span id="FST.is_solo_call_arg-3322"><a href="#FST.is_solo_call_arg-3322"><span class="linenos">3322</span></a>
</span><span id="FST.is_solo_call_arg-3323"><a href="#FST.is_solo_call_arg-3323"><span class="linenos">3323</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a, b)&#39;).args[0].is_solo_call_arg()</span>
</span><span id="FST.is_solo_call_arg-3324"><a href="#FST.is_solo_call_arg-3324"><span class="linenos">3324</span></a><span class="sd">        False</span>
</span><span id="FST.is_solo_call_arg-3325"><a href="#FST.is_solo_call_arg-3325"><span class="linenos">3325</span></a>
</span><span id="FST.is_solo_call_arg-3326"><a href="#FST.is_solo_call_arg-3326"><span class="linenos">3326</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in range(3))&#39;).args[0].is_solo_call_arg()</span>
</span><span id="FST.is_solo_call_arg-3327"><a href="#FST.is_solo_call_arg-3327"><span class="linenos">3327</span></a><span class="sd">        True</span>
</span><span id="FST.is_solo_call_arg-3328"><a href="#FST.is_solo_call_arg-3328"><span class="linenos">3328</span></a><span class="sd">        ```</span>
</span><span id="FST.is_solo_call_arg-3329"><a href="#FST.is_solo_call_arg-3329"><span class="linenos">3329</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_solo_call_arg-3330"><a href="#FST.is_solo_call_arg-3330"><span class="linenos">3330</span></a>
</span><span id="FST.is_solo_call_arg-3331"><a href="#FST.is_solo_call_arg-3331"><span class="linenos">3331</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST.is_solo_call_arg-3332"><a href="#FST.is_solo_call_arg-3332"><span class="linenos">3332</span></a>                <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is a solo <code>Call</code> non-keyword argument.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(a)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_call_arg</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(a, b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_call_arg</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(i for i in range(3))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_call_arg</span><span class="p">()</span>
<span class="kc">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_solo_call_arg_genexp" class="classattr">
                                        <input id="FST.is_solo_call_arg_genexp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_solo_call_arg_genexp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.is_solo_call_arg_genexp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_solo_call_arg_genexp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_solo_call_arg_genexp-3334"><a href="#FST.is_solo_call_arg_genexp-3334"><span class="linenos">3334</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_call_arg_genexp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_solo_call_arg_genexp-3335"><a href="#FST.is_solo_call_arg_genexp-3335"><span class="linenos">3335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether `self` is the dreaded solo call non-keyword argument generator expression in `sum(i for i in a)`.</span>
</span><span id="FST.is_solo_call_arg_genexp-3336"><a href="#FST.is_solo_call_arg_genexp-3336"><span class="linenos">3336</span></a><span class="sd">        This function doesn&#39;t say if it shares its parentheses or not, so it could still be `sum((i for i in a))` or</span>
</span><span id="FST.is_solo_call_arg_genexp-3337"><a href="#FST.is_solo_call_arg_genexp-3337"><span class="linenos">3337</span></a><span class="sd">        even `sum(((i for i in a)))`. To differentiate that see `pars(shared=False)`.</span>
</span><span id="FST.is_solo_call_arg_genexp-3338"><a href="#FST.is_solo_call_arg_genexp-3338"><span class="linenos">3338</span></a>
</span><span id="FST.is_solo_call_arg_genexp-3339"><a href="#FST.is_solo_call_arg_genexp-3339"><span class="linenos">3339</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_solo_call_arg_genexp-3340"><a href="#FST.is_solo_call_arg_genexp-3340"><span class="linenos">3340</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_solo_call_arg_genexp-3341"><a href="#FST.is_solo_call_arg_genexp-3341"><span class="linenos">3341</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(i for i in range(3))&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="FST.is_solo_call_arg_genexp-3342"><a href="#FST.is_solo_call_arg_genexp-3342"><span class="linenos">3342</span></a><span class="sd">        True</span>
</span><span id="FST.is_solo_call_arg_genexp-3343"><a href="#FST.is_solo_call_arg_genexp-3343"><span class="linenos">3343</span></a>
</span><span id="FST.is_solo_call_arg_genexp-3344"><a href="#FST.is_solo_call_arg_genexp-3344"><span class="linenos">3344</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in range(3)))&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="FST.is_solo_call_arg_genexp-3345"><a href="#FST.is_solo_call_arg_genexp-3345"><span class="linenos">3345</span></a><span class="sd">        True</span>
</span><span id="FST.is_solo_call_arg_genexp-3346"><a href="#FST.is_solo_call_arg_genexp-3346"><span class="linenos">3346</span></a>
</span><span id="FST.is_solo_call_arg_genexp-3347"><a href="#FST.is_solo_call_arg_genexp-3347"><span class="linenos">3347</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call((i for i in range(3)), b)&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="FST.is_solo_call_arg_genexp-3348"><a href="#FST.is_solo_call_arg_genexp-3348"><span class="linenos">3348</span></a><span class="sd">        False</span>
</span><span id="FST.is_solo_call_arg_genexp-3349"><a href="#FST.is_solo_call_arg_genexp-3349"><span class="linenos">3349</span></a>
</span><span id="FST.is_solo_call_arg_genexp-3350"><a href="#FST.is_solo_call_arg_genexp-3350"><span class="linenos">3350</span></a><span class="sd">        &gt;&gt;&gt; FST(&#39;call(a)&#39;).args[0].is_solo_call_arg_genexp()</span>
</span><span id="FST.is_solo_call_arg_genexp-3351"><a href="#FST.is_solo_call_arg_genexp-3351"><span class="linenos">3351</span></a><span class="sd">        False</span>
</span><span id="FST.is_solo_call_arg_genexp-3352"><a href="#FST.is_solo_call_arg_genexp-3352"><span class="linenos">3352</span></a><span class="sd">        ```</span>
</span><span id="FST.is_solo_call_arg_genexp-3353"><a href="#FST.is_solo_call_arg_genexp-3353"><span class="linenos">3353</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_solo_call_arg_genexp-3354"><a href="#FST.is_solo_call_arg_genexp-3354"><span class="linenos">3354</span></a>
</span><span id="FST.is_solo_call_arg_genexp-3355"><a href="#FST.is_solo_call_arg_genexp-3355"><span class="linenos">3355</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">GeneratorExp</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="FST.is_solo_call_arg_genexp-3356"><a href="#FST.is_solo_call_arg_genexp-3356"><span class="linenos">3356</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">keywords</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is the dreaded solo call non-keyword argument generator expression in <code>sum(i for i in a)</code>.
This function doesn't say if it shares its parentheses or not, so it could still be <code>sum((i for i in a))</code> or
even <code>sum(((i for i in a)))</code>. To differentiate that see <code>pars(shared=False)</code>.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(i for i in range(3))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_call_arg_genexp</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call((i for i in range(3)))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_call_arg_genexp</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call((i for i in range(3)), b)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_call_arg_genexp</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">FST</span><span class="p">(</span><span class="s1">&#39;call(a)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_call_arg_genexp</span><span class="p">()</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FST.is_solo_matchcls_pat" class="classattr">
                                        <input id="FST.is_solo_matchcls_pat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_solo_matchcls_pat</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="FST.is_solo_matchcls_pat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FST.is_solo_matchcls_pat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FST.is_solo_matchcls_pat-3358"><a href="#FST.is_solo_matchcls_pat-3358"><span class="linenos">3358</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_solo_matchcls_pat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="FST.is_solo_matchcls_pat-3359"><a href="#FST.is_solo_matchcls_pat-3359"><span class="linenos">3359</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Whether `self` is a solo `MatchClass` non-keyword pattern. The solo `Constant` held by a `MatchValue`</span>
</span><span id="FST.is_solo_matchcls_pat-3360"><a href="#FST.is_solo_matchcls_pat-3360"><span class="linenos">3360</span></a><span class="sd">        qualifies as `True` for this check if the `MatchValue` does.</span>
</span><span id="FST.is_solo_matchcls_pat-3361"><a href="#FST.is_solo_matchcls_pat-3361"><span class="linenos">3361</span></a>
</span><span id="FST.is_solo_matchcls_pat-3362"><a href="#FST.is_solo_matchcls_pat-3362"><span class="linenos">3362</span></a><span class="sd">        **Examples:**</span>
</span><span id="FST.is_solo_matchcls_pat-3363"><a href="#FST.is_solo_matchcls_pat-3363"><span class="linenos">3363</span></a><span class="sd">        ```py</span>
</span><span id="FST.is_solo_matchcls_pat-3364"><a href="#FST.is_solo_matchcls_pat-3364"><span class="linenos">3364</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n  case cls(a): pass&#39;)</span>
</span><span id="FST.is_solo_matchcls_pat-3365"><a href="#FST.is_solo_matchcls_pat-3365"><span class="linenos">3365</span></a><span class="sd">        ...  .cases[0].pattern.patterns[0].is_solo_matchcls_pat())</span>
</span><span id="FST.is_solo_matchcls_pat-3366"><a href="#FST.is_solo_matchcls_pat-3366"><span class="linenos">3366</span></a><span class="sd">        True</span>
</span><span id="FST.is_solo_matchcls_pat-3367"><a href="#FST.is_solo_matchcls_pat-3367"><span class="linenos">3367</span></a>
</span><span id="FST.is_solo_matchcls_pat-3368"><a href="#FST.is_solo_matchcls_pat-3368"><span class="linenos">3368</span></a><span class="sd">        &gt;&gt;&gt; (FST(&#39;match a:\n  case cls(a, b): pass&#39;)</span>
</span><span id="FST.is_solo_matchcls_pat-3369"><a href="#FST.is_solo_matchcls_pat-3369"><span class="linenos">3369</span></a><span class="sd">        ...  .cases[0].pattern.patterns[0].is_solo_matchcls_pat())</span>
</span><span id="FST.is_solo_matchcls_pat-3370"><a href="#FST.is_solo_matchcls_pat-3370"><span class="linenos">3370</span></a><span class="sd">        False</span>
</span><span id="FST.is_solo_matchcls_pat-3371"><a href="#FST.is_solo_matchcls_pat-3371"><span class="linenos">3371</span></a><span class="sd">        ```</span>
</span><span id="FST.is_solo_matchcls_pat-3372"><a href="#FST.is_solo_matchcls_pat-3372"><span class="linenos">3372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FST.is_solo_matchcls_pat-3373"><a href="#FST.is_solo_matchcls_pat-3373"><span class="linenos">3373</span></a>
</span><span id="FST.is_solo_matchcls_pat-3374"><a href="#FST.is_solo_matchcls_pat-3374"><span class="linenos">3374</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
</span><span id="FST.is_solo_matchcls_pat-3375"><a href="#FST.is_solo_matchcls_pat-3375"><span class="linenos">3375</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FST.is_solo_matchcls_pat-3376"><a href="#FST.is_solo_matchcls_pat-3376"><span class="linenos">3376</span></a>
</span><span id="FST.is_solo_matchcls_pat-3377"><a href="#FST.is_solo_matchcls_pat-3377"><span class="linenos">3377</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchValue</span><span class="p">):</span>
</span><span id="FST.is_solo_matchcls_pat-3378"><a href="#FST.is_solo_matchcls_pat-3378"><span class="linenos">3378</span></a>            <span class="bp">self</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="FST.is_solo_matchcls_pat-3379"><a href="#FST.is_solo_matchcls_pat-3379"><span class="linenos">3379</span></a>
</span><span id="FST.is_solo_matchcls_pat-3380"><a href="#FST.is_solo_matchcls_pat-3380"><span class="linenos">3380</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">parent</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfield</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;patterns&#39;</span> <span class="ow">and</span>
</span><span id="FST.is_solo_matchcls_pat-3381"><a href="#FST.is_solo_matchcls_pat-3381"><span class="linenos">3381</span></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">parenta</span> <span class="o">:=</span> <span class="n">parent</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">MatchClass</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parenta</span><span class="o">.</span><span class="n">kwd_patterns</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parenta</span><span class="o">.</span><span class="n">patterns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Whether <code>self</code> is a solo <code>MatchClass</code> non-keyword pattern. The solo <code>Constant</code> held by a <code>MatchValue</code>
qualifies as <code>True</code> for this check if the <code>MatchValue</code> does.</p>

<p><strong>Examples:</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case cls(a): pass&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_matchcls_pat</span><span class="p">())</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">FST</span><span class="p">(</span><span class="s1">&#39;match a:</span><span class="se">\n</span><span class="s1">  case cls(a, b): pass&#39;</span><span class="p">)</span>
<span class="o">...</span>  <span class="o">.</span><span class="n">cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_solo_matchcls_pat</span><span class="p">())</span>
<span class="kc">False</span>
</code></pre>
</div>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>